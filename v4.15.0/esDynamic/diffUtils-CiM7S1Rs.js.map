{"version":3,"file":"diffUtils-CiM7S1Rs.js","sources":["../../node_modules/@arcgis/core/core/accessorSupport/diffUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport t from\"../Accessor.js\";import e from\"../Collection.js\";import{getProperties as n}from\"./utils.js\";const o=new Set([\"esri.Color\",\"esri.portal.Portal\",\"esri.symbols.support.Symbol3DAnchorPosition2D\",\"esri.symbols.support.Symbol3DAnchorPosition3D\"]);function r(e){return e instanceof t}function f(t){return t instanceof e?Object.keys(t.items):r(t)?n(t).keys():t?Object.keys(t):[]}function i(t,n){return t instanceof e?t.items[n]:t[n]}function l(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function u(t){return t?t.declaredClass:null}function c(t,e){const n=t.diff;if(n&&\"function\"==typeof n)return n(t,e);const s=f(t),p=f(e);if(0===s.length&&0===p.length)return;if(!s.length||!p.length||l(t,e))return{type:\"complete\",oldValue:t,newValue:e};const a=p.filter(t=>!s.includes(t)),y=s.filter(t=>!p.includes(t)),d=s.filter(n=>p.includes(n)&&i(t,n)!==i(e,n)).concat(a,y).sort(),m=u(t);if(m&&o.has(m)&&d.length)return{type:\"complete\",oldValue:t,newValue:e};let h;const b=r(t)&&r(e);for(const o of d){const r=i(t,o),f=i(e,o);let l;if((b||\"function\"!=typeof r&&\"function\"!=typeof f)&&(r!==f&&(null!=r||null!=f))){if(n&&n[o]&&\"function\"==typeof n[o])l=n[o]?.(r,f);else if(r instanceof Date&&f instanceof Date){if(r.getTime()===f.getTime())continue;l={type:\"complete\",oldValue:r,newValue:f}}else l=\"object\"==typeof r&&\"object\"==typeof f&&u(r)===u(f)?c(r,f):{type:\"complete\",oldValue:r,newValue:f};null!=l&&(null!=h?h.diff[o]=l:h={type:\"partial\",diff:{[o]:l}})}}return h}function s(t,e){return p(t,e)}function p(t,e){if(null==t)return!1;const n=e.split(\".\");let o=t;for(const r of n){if(\"complete\"===o.type)return!0;if(\"partial\"!==o.type)return!1;{const t=o.diff[r];if(!t)return!1;o=t}}return!0}function a(t,e){if(!t)return!1;if(\"partial\"===t.type){const n=Object.keys(t.diff);return 1===n.length&&n[0]===e}return!1}function y(t,e){if(\"function\"!=typeof t&&\"function\"!=typeof e&&(null!=t||null!=e))return null==t||null==e||\"object\"==typeof t&&\"object\"==typeof e&&u(t)!==u(e)?{type:\"complete\",oldValue:t,newValue:e}:c(t,e)}function d(t){if(null==t)return!0;switch(t.type){case\"complete\":return!1;case\"collection\":{const e=t;for(const t of e.added)if(!d(t))return!1;for(const t of e.removed)if(!d(t))return!1;for(const t of e.changed)if(!d(t))return!1;return!0}case\"partial\":for(const e in t.diff){if(!d(t.diff[e]))return!1}return!0}}export{y as diff,p as hasDiff,s as hasRootDiff,a as hasRootDiffOnly,d as isEmpty};\n"],"names":["o","r","t","f","e","n","i","l","u","c","s","p","a","y","d","m","h","b"],"mappings":"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","x_google_ignoreList":[0]}