{"version":3,"file":"AGraphicContainer-D4my7ifY.js","sources":["../../node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js","../../node_modules/@arcgis/core/views/2d/layers/graphics/GraphicBoundsRenderer.js","../../node_modules/@arcgis/core/views/2d/layers/graphics/AGraphicContainer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{FeatureTechniqueInstance as e}from\"./TechniqueInstance.js\";import{Techniques as i}from\"./TechniqueRegistry.js\";import{castInstanceId as t}from\"./mesh/instanceIdUtils.js\";let n=0;function a(i,a){return new e(t(n++),i,a)}const o={visualVariableColor:null,visualVariableOpacity:null,visualVariableSizeMinMaxValue:null,visualVariableSizeScaleStops:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null,visualVariableRotation:null,visualVariableSizeOutlineScaleStops:null};class l{constructor(){this.instances={fill:a(i.fill,{uniforms:o,optionalAttributes:{zoomRange:!0}}),marker:a(i.marker,{uniforms:o,optionalAttributes:{zoomRange:!0}}),line:a(i.line,{uniforms:o,optionalAttributes:{zoomRange:!0}}),text:a(i.text,{uniforms:o,optionalAttributes:{zoomRange:!0,referenceSymbol:!1,clipAngle:!1,visibility:!1}}),outlineFill:a(i.outlineFill,{uniforms:o,optionalAttributes:{zoomRange:!0}}),complexFill:a(i.complexFill,{uniforms:o,optionalAttributes:{zoomRange:!0}}),gradientFill:a(i.gradientFill,{uniforms:o,optionalAttributes:{zoomRange:!0}}),texturedLine:a(i.texturedLine,{uniforms:o,optionalAttributes:{zoomRange:!0}}),gradientStroke:a(i.gradientStroke,{uniforms:o,optionalAttributes:{zoomRange:!0}}),animatedMarker:a(i.animatedMarker,{uniforms:o,optionalAttributes:{zoomRange:!0,value1Position2Value2:!1,lineLength:!1}}),animatedMarkerShift:a(i.animatedMarkerShift,{uniforms:o,optionalAttributes:{zoomRange:!0,value1Position2Value2:!0,lineLength:!0}}),animatedPolygon:a(i.animatedFill,{uniforms:o,optionalAttributes:{zoomRange:!0,value1Position2Value2:!1,lineLength:!1}}),animatedPolyline:a(i.animatedLine,{uniforms:o,optionalAttributes:{zoomRange:!0,value1Position2Value2:!1,accumulatedDistance:!0,segmentDirection:!0,normal:!0,lineLength:!1}}),animatedPolylineShift:a(i.animatedLine,{uniforms:o,optionalAttributes:{zoomRange:!0,value1Position2Value2:!1,accumulatedDistance:!0,segmentDirection:!0,normal:!0,lineLength:!0}})},this._instancesById=Object.values(this.instances).reduce((e,i)=>(e.set(i.instanceId,i),e),new Map)}getInstance(e){return this._instancesById.get(e)}}export{l as GraphicInstanceStore};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../core/maybe.js\";import{identity as e,multiply as r,translate as i,scale as s,rotate as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{fromValues as n}from\"../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";import{fromValues as l}from\"../../../../core/libs/gl-matrix-2/factories/vec3f32.js\";import{normalizeMapX as f}from\"../../../../geometry/support/normalizeUtils.js\";import{DisplayObject as m}from\"../../engine/DisplayObject.js\";import{createProgramDescriptor as u}from\"../../engine/webgl/Utils.js\";import{BufferObject as c}from\"../../../webgl/BufferObject.js\";import{PrimitiveType as h,DataType as _}from\"../../../webgl/enums.js\";import{VertexArrayObject as p}from\"../../../webgl/VertexArrayObject.js\";import{VertexBuffer as d}from\"../../../webgl/VertexBuffer.js\";const g=Math.PI/180,v=4;class x extends m{constructor(t){super(),this._program=null,this._vao=null,this._vertexBuffer=null,this._indexBuffer=null,this._dvsMat3=a(),this._localOrigin={x:0,y:0},this._getBounds=t}destroy(){super.destroy(),this._vao&&(this._vao.dispose(),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program=t(this._program)}doRender(t){const{context:e}=t,r=this._getBounds();if(r.length<1)return;this._createShaderProgram(e),this._updateMatricesAndLocalOrigin(t),this._updateBufferData(e,r),e.setBlendingEnabled(!0),e.setDepthTestEnabled(!1),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1),e.setBlendFunction(1,771),e.setColorMask(!0,!0,!0,!0);const i=this._program;e.bindVAO(this._vao),e.useProgram(i),i.setUniformMatrix3fv(\"u_dvsMat3\",this._dvsMat3),e.gl.lineWidth(1),e.drawElements(h.LINES,8*r.length,_.UNSIGNED_INT,0),e.bindVAO(null)}_createTransforms(){return{displayViewScreenMat3:a()}}_createShaderProgram(t){if(this._program)return;const e=\"precision highp float;\\n        uniform mat3 u_dvsMat3;\\n\\n        attribute vec2 a_position;\\n\\n        void main() {\\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\\n        }\",r=\"precision mediump float;\\n      void main() {\\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\\n      }\";this._program=t.programCache.acquire(e,r,b().attributes)}_updateMatricesAndLocalOrigin(t){const{state:a}=t,{displayMat3:m,size:u,resolution:c,pixelRatio:h,rotation:_,viewpoint:p}=a,d=g*_,{x:v,y:x}=p.targetGeometry,b=f(v,a.spatialReference);this._localOrigin.x=b,this._localOrigin.y=x;const B=h*u[0],y=h*u[1],j=c*B,M=c*y,O=e(this._dvsMat3);r(O,O,m),i(O,O,n(B/2,y/2)),s(O,O,l(u[0]/j,-y/M,1)),o(O,O,-d)}_updateBufferData(t,e){const{x:r,y:i}=this._localOrigin,s=2*v*e.length,o=new Float32Array(s),a=new Uint32Array(8*e.length);let n=0,l=0;for(const m of e)m&&(o[2*n]=m[0]-r,o[2*n+1]=m[1]-i,o[2*n+2]=m[0]-r,o[2*n+3]=m[3]-i,o[2*n+4]=m[2]-r,o[2*n+5]=m[3]-i,o[2*n+6]=m[2]-r,o[2*n+7]=m[1]-i,a[l]=n+0,a[l+1]=n+3,a[l+2]=n+3,a[l+3]=n+2,a[l+4]=n+2,a[l+5]=n+1,a[l+6]=n+1,a[l+7]=n+0,n+=4,l+=8);const f=b();this._vertexBuffer?this._vertexBuffer.setData(o.buffer):this._vertexBuffer=new d(t,f.bufferLayout,o.buffer,35048),this._indexBuffer?this._indexBuffer.setData(a):this._indexBuffer=c.createIndex(t,35048,a),this._vao||(this._vao=new p(t,this._vertexBuffer,this._indexBuffer))}}const b=()=>u(\"bounds\",[{location:0,name:\"a_position\",count:2,type:_.FLOAT}]);export{x as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as e}from\"../../../../core/maybe.js\";import{AFeatureContainer as t}from\"../../engine/AFeatureContainer.js\";import{GraphicInstanceStore as r}from\"../../engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js\";import n from\"./GraphicBoundsRenderer.js\";class s extends t{constructor(e){super(e),this._instanceStore=new r,this.checkHighlight=()=>!0}destroy(){super.destroy(),this._boundsRenderer=e(this._boundsRenderer)}get instanceStore(){return this._instanceStore}enableRenderingBounds(e){this._boundsRenderer=new n(e),this.requestRender()}get hasHighlight(){return this.checkHighlight()}onTileData(e,t){e.onMessage(t),this.contains(e)||this.addChild(e),this.requestRender()}_renderChildren(e,t){e.selection=t;for(const r of this.children){if(!r.visible)continue;const t=r.getDisplayList(this._instanceStore,1);t?.render(e)}}}export{s as AGraphicContainer};\n"],"names":["n","i","a","e","t","o","l","g","v","x","m","h","_","u","c","p","d","b","f","B","y","j","M","O","r","s"],"mappings":"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","x_google_ignoreList":[0,1,2]}