import{f7 as s}from"./main-pOgmbpmS.js";import{e as u}from"./grouping-CLtz7YBB.js";function c(t){return s(t.frameDurations.reduce((e,i)=>e+i,0))}function d(t){const{width:e,height:i}=t,o=t.frameDurations.reverse(),n=r=>{const a=t.frameDurations.length-1-r;return t.getFrame(a)};return{frameCount:t.frameCount,duration:t.duration,frameDurations:o,getFrame:n,width:e,height:i}}function f(t,e){const{width:i,height:o,getFrame:n}=t,r=e/t.duration,a=t.frameDurations.map(m=>s(m*r));return{frameCount:t.frameCount,duration:t.duration,frameDurations:a,getFrame:n,width:i,height:o}}function _(t,e){const{width:i,height:o,getFrame:n}=t,r=t.frameDurations.slice(),a=r.shift();return r.unshift(s(a+e)),{frameCount:t.frameCount,duration:t.duration+e,frameDurations:r,getFrame:n,width:i,height:o}}function h(t,e){const{width:i,height:o,getFrame:n}=t,r=t.frameDurations.slice(),a=r.pop();return r.push(s(a+e)),{frameCount:t.frameCount,duration:t.duration+e,frameDurations:r,getFrame:n,width:i,height:o}}class F{constructor(e,i,o,n){this._animation=e,this._repeatType=o,this._onFrameData=n,this._direction=1,this._currentFrame=0,this._lastUpdated=s(0),this.timeInFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let r=0;for(;i>r;)r+=this.timeToFrame,this.nextFrame();const a=this._animation.getFrame(this._currentFrame);this._onFrameData(a)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case"None":this._currentFrame-=this._direction;break;case"Loop":this._currentFrame=0;break;case"Oscillate":this._currentFrame-=this._direction,this._direction=-1}}else if(this._currentFrame===-1)switch(this._repeatType){case"None":this._currentFrame-=this._direction;break;case"Loop":this._currentFrame=this._animation.frameDurations.length-1;break;case"Oscillate":this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame],this.timeInFrame=0;const e=this._animation.getFrame(this._currentFrame);this._onFrameData(e)}update(e){const i=s(e-this._lastUpdated);this._lastUpdated=e,this._advance(i)}_advance(e){this.timeInFrame+=e,this.timeInFrame>this.timeToFrame&&this.nextFrame()}}function l(t,e){t.animationsEnabled&&e?.update(s(t.time))}function p(t,e,i,o){let n,{repeatType:r}=e;if(r==null&&(r="Loop"),e.reverseAnimation===!0&&(t=d(t)),e.duration!=null&&(t=f(t,s(1e3*e.duration))),e.repeatDelay!=null){const a=1e3*e.repeatDelay;r==="Loop"?t=h(t,s(a)):r==="Oscillate"&&(t=_(h(t,s(a/2)),s(a/2)))}if(e.startTimeOffset!=null)n=s(1e3*e.startTimeOffset);else if(e.randomizeStartTime!=null){const a=e.randomizeStartSeed!=null?e.randomizeStartSeed:82749913,m=u(i,a);n=s(m*c(t))}else n=s(0);return new F(t,n,r,o)}export{p as h,l as m};
