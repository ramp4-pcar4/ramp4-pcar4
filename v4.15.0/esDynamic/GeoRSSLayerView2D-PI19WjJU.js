import{av as o,fc as h,O as u,bS as S,_ as b,Y as V}from"./main-pOgmbpmS.js";import{s as v,o as _}from"./GraphicOrigin-CdlK6np3.js";import{p}from"./SimpleRenderer-DR8lcC8P.js";import{fromJSON as T}from"./jsonUtils-BYfNDtR0.js";import{g as M}from"./FeatureSet-TOSsHSzA.js";import{b as C}from"./LayerView2D-BkQnW8KL.js";import{i as O}from"./GraphicContainer-B2LTly0M.js";import{O as x}from"./GraphicsView2D-BarV8C6s.js";import{d as G}from"./LayerView-CP_O_RTc.js";const q=Symbol("isGeoRSSGraphicOrigin");var m;class J extends v{get[(m=q,_)](){return this.layer}constructor(i){super(),this[m]=!0,this.type="geo-rss",this.layer=i}get id(){return this.layer.id}}let y=class extends C(G){constructor(){super(...arguments),this._graphicsViewMap={},this.graphicsViews=[]}async hitTest(e,i){if(!this.graphicsViews.length)return null;const l=this.layer;return this.graphicsViews.reverse().flatMap(s=>s.hitTest(e)).map(s=>({type:"graphic",graphic:s,layer:l,mapPoint:e}))}update(e){if(this.graphicsViews)for(const i of this.graphicsViews)i.processUpdate(e)}attach(){this.addAttachHandles([o(()=>this.layer?.featureCollections,e=>{this._clear();const{layer:i}=this,l=new J(this.layer);for(const{popupInfo:s,featureSet:g,layerDefinition:f}of e){const r=M.fromJSON(g),c=new u(r.features),w=s?S.fromJSON(s):null;c.forEach(a=>{a.layer=i,a.sourceLayer=i,a.popupTemplate=w,a.origin=l});const d=f.drawingInfo,t=T(d.renderer),n=new x({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:c,renderer:t,container:new O(this.view.featuresTilingScheme)});this._graphicsViewMap[r.geometryType]=n,r.geometryType!=="polygon"||this.layer.polygonSymbol?r.geometryType!=="polyline"||this.layer.lineSymbol?r.geometryType!=="point"||this.layer.pointSymbol||(this.layer.pointSymbol=t.symbol):this.layer.lineSymbol=t.symbol:this.layer.polygonSymbol=t.symbol,this.graphicsViews.push(n),this.container.addChild(n.container)}},h),o(()=>this.layer?.polygonSymbol,e=>{this._graphicsViewMap.polygon.renderer=new p({symbol:e})},h),o(()=>this.layer?.lineSymbol,e=>{this._graphicsViewMap.polyline.renderer=new p({symbol:e})},h),o(()=>this.layer?.pointSymbol,e=>{this._graphicsViewMap.point.renderer=new p({symbol:e})},h)])}detach(){this._clear()}moveEnd(){}viewChange(){for(const e of this.graphicsViews)e.viewChange()}_clear(){this.container.removeAllChildren();for(const e of this.graphicsViews)e.destroy();this._graphicsViewMap={},this.graphicsViews.length=0}};y=b([V("esri.views.2d.layers.GeoRSSLayerView2D")],y);const N=y;export{N as default};
