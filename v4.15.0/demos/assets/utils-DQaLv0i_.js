import{o as A,t as R}from"./defaultCIMValues-XI-Li77m.js";function _(t){return typeof t=="function"}function Q(t,r,e,n){return _(t)?t(r,e,n):t}function Z(t){return[t.r,t.g,t.b,t.a]}const B=` /-,
`;function N(t){let r=t.length;for(;r--;)if(!B.includes(t.charAt(r)))return!1;return!0}function tt(t,r){const e=[];let n=0,l=-1;do if(l=t.indexOf("[",n),l>=n){if(l>n){const o=t.slice(n,l);e.push([o,null,N(o)])}if(n=l+1,l=t.indexOf("]",n),l>=n){if(l>n){const o=r[t.slice(n,l)];o&&e.push([null,o,!1])}n=l+1}}while(l!==-1);if(n<t.length){const o=t.slice(n);e.push([o,null,N(o)])}return e}function rt(t,r,e){let n="",l=null;for(const o of r){const[a,i,u]=o;if(a!=null&&a!=="")u?l=a:(l!=null&&(n+=l,l=null),n+=a);else{const s=t.readAttribute(i);s!=null&&s!==""&&(l!==null&&(n+=l,l=null),n+=s)}}return D(n,e)}function et(t,r,e,n){let l="",o=null;for(const a of r){const[i,u,s]=a;if(i!=null&&i!=="")s?o=i:(o!=null&&(l+=o,o=null),l+=i);else{let m=u;e!=null&&(m=J(u,e));const c=t.attributes[m];c!=null&&c!==""&&(o!=null&&(l+=o,o=null),l+=c)}}return D(l,n)}function D(t,r){switch(typeof t!="string"&&(t=String(t)),r){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function nt(t,r,e,n,l,o,a=!0){const i=r/l,u=e/o,s=Math.ceil(i/2),m=Math.ceil(u/2);for(let c=0;c<o;c++)for(let f=0;f<l;f++){const p=4*(f+(a?o-c-1:c)*l);let M=0,h=0,b=0,d=0,S=0,P=0,k=0;const L=(c+.5)*u;for(let I=Math.floor(c*u);I<(c+1)*u;I++){const T=Math.abs(L-(I+.5))/m,q=(f+.5)*i,E=T*T;for(let g=Math.floor(f*i);g<(f+1)*i;g++){let y=Math.abs(q-(g+.5))/s;const C=Math.sqrt(E+y*y);C>=-1&&C<=1&&(M=2*C*C*C-3*C*C+1,M>0&&(y=4*(g+I*r),k+=M*t[y+3],b+=M,t[y+3]<255&&(M=M*t[y+3]/250),d+=M*t[y],S+=M*t[y+1],P+=M*t[y+2],h+=M))}}n[p]=d/h,n[p+1]=S/h,n[p+2]=P/h,n[p+3]=k/b}}function j(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function ot(t){return t.data?.symbol??null}function lt(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function it(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function at(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function $(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const st=(t,r=0)=>t==null||isNaN(t)?r:t,ct=(t,r)=>t??r,ut=(t,r)=>t??r,ft=t=>t.tintColor?j(t.tintColor):[255,255,255,1];class H{constructor(r){this._import=r}getImportPromise(){return this._promise==null&&(this._promise=this._import().then(r=>this.module=r)),this._promise}}function Mt(t){return new H(t)}function yt(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function mt(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function Ct(t){let r="normal",e="normal";if(t){const n=t.toLowerCase();n.includes("italic")?r="italic":n.includes("oblique")&&(r="oblique"),n.includes("bold")?e="bold":n.includes("light")&&(e="lighter")}return{style:r,weight:e}}function pt(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function x(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const r of t.symbolLayers){const e=x(r);if(e!=null)return e}break;case"CIMTextSymbol":return x(t.symbol);case"CIMSolidFill":return t.color}return null}function v(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const r=t.symbolLayers;if(r)for(const e of r){const n=v(e);if(n!=null)return n}break}case"CIMTextSymbol":return v(t.symbol);case"CIMSolidStroke":return t.color}}function ht(t){for(const r of t)if(r.enable)switch(r.type){case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return!0}return!1}function F(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const r of t.symbolLayers){const e=F(r);if(e!==void 0)return e}break;case"CIMTextSymbol":return F(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function It(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function bt(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function dt(t){return(t?Object.keys(t):[]).map(r=>({name:r,alias:r,type:typeof t[r]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const kt=t=>t.includes("data:image/svg+xml");function St(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function w(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function Pt(t,r,e,n,l,o,a=!0){const{infos:i}=o;let u=1,s=0,m=0,c=0,f=1;for(const{absoluteAnchorPoint:h,offsetX:b,offsetY:d,rotation:S,size:P,frameHeight:k,rotateClockWise:L,scaleSymbolsProportionally:I}of i)f=h?1:u,m=G(b,d,s,f,m),c=z(b,d,s,f,c),k&&(I||a)&&(u*=P/k),s=O(S,L,s);const p=G(n,l,s,f,m),M=z(n,l,s,f,c);return{size:t*u,rotation:O(r,e,s),offsetX:p,offsetY:M}}function U(t){if(t==null)return!1;if(Array.isArray(t))return t.every(r=>U(r));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function W(t,r){if(r==="color"||r==="outlinecolor"||r==="backgroundcolor"||r==="borderlinecolor"||r==="tintcolor")return[...R[r]];const e=A[t];if(!e)throw new Error(`InternalError: default value for type ${t}.`);return e[r]}function X(t){return t.split(" ").map(r=>Number(r))}function Y(t){return typeof t=="string"?X(t):t}function gt(t){return t?.dashTemplate&&(t.dashTemplate=Y(t.dashTemplate)),t}function V(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const r=t.symbolLayers;if(!r)return"Normal";for(const e of r)if(e.type==="CIMVectorMarker")return V(e)}break;case"CIMVectorMarker":{const r=t.markerGraphics;if(!r)return"Normal";for(const e of r)if(e.symbol)return V(e.symbol)}}return"Normal"}function wt(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let r=0;if(t.symbolLayers){for(const e of t.symbolLayers)if(e)switch(e.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const n=e.size??A.CIMVectorMarker.size;n>r&&(r=n);break}}}return r}case"CIMLineSymbol":case"CIMPolygonSymbol":{let r=0;if(t.symbolLayers){for(const e of t.symbolLayers)if(e)switch(e.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const n=e.width;n!=null&&n>r&&(r=n);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(e.markerPlacement&&$(e.markerPlacement)){const n=e.size??A.CIMVectorMarker.size;n>r&&(r=n)}break;case"CIMPictureFill":{const n=e.height;n!=null&&n>r&&(r=n)}}}return r}}}function J(t,r){if(r!==null){const e=r.get(t);return e?e.name:t}return t}function Lt(t){return t.map(r=>({...r,propertyName:w(r.propertyName)}))}function At(t){const r={};for(const e in t){const n=t[e];r[w(e)]=n}return r}function z(t,r,e,n,l){const o=e*Math.PI/180;if(o){const a=Math.cos(o);return(Math.sin(o)*t+a*r)*n+l}return r*n+l}function G(t,r,e,n,l){const o=e*Math.PI/180;return o?(Math.cos(o)*t-Math.sin(o)*r)*n+l:t*n+l}function O(t,r,e){return r?e-t:e+t}function Tt(t,r,e){const n=e==="Color"||e==="TintColor"||e==="ToColor",l=e==="Rotation"||e==="Angle"||e==="ToRotation";let o=r[w(e)];if(o!=null&&(n?o=[o[0]/255,o[1]/255,o[2]/255,o[3]/255]:l&&(o*=Math.PI/180)),o==null&&(o=W(r.type,e.toLowerCase()),o!=null&&(n?o=[o[0]/255,o[1]/255,o[2]/255,o[3]]:l&&(o*=Math.PI/180))),r.primitiveName!=null){const a=t[r.primitiveName];if(a!=null){const i=a[e];i==null||(typeof i=="string"||typeof i=="number"||Array.isArray(i)?(o=i,o!=null&&(n?o=[o[0]/255,o[1]/255,o[2]/255,o[3]/255]:l&&(o*=Math.PI/180))):(o={valueExpressionInfo:i,defaultValue:o},o!=null&&(n?o={type:"Process",op:"ArcadeColor",value:o}:l&&(o={type:"Process",op:"Divide",left:o,right:180/Math.PI}))))}}if(o==null)throw new Error(`Failed to derive a value or an expression for "${e}".`);return o}function Nt(t,r,e){if(r[w(e)]!=null)return!0;if(r.primitiveName!=null){const n=t[r.primitiveName];if(n!=null&&n[e]!=null)return!0}return!1}function xt(t,r){return Math.max(Math.min((t??r)/100,1),0)}export{pt as A,gt as B,it as C,w as D,U as E,It as F,kt as G,V as H,st as I,Ct as L,j as M,v as N,St as O,Mt as P,Tt as Q,W as R,x as T,wt as U,bt as V,Lt as X,At as Y,Nt as Z,tt as a,ct as b,et as c,ut as d,xt as e,nt as f,yt as g,$ as h,Y as j,ft as k,lt as m,Q as n,Z as o,at as p,Pt as q,rt as s,F as v,mt as w,ht as x,ot as y,dt as z};
