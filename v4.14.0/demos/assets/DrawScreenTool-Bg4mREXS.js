import{V as k,h0 as u,h1 as O,gD as _,al as T,h2 as $,h3 as C,_ as r,Y as o,Z as v,aj as y,a9 as D}from"./main-DJoDgHy1.js";import{r as b}from"./mat2df64-DJ_RMjZ3.js";import{r as S,A as M,u as g}from"./drawSurfaces-CqE9gWGv.js";import{R as x,k as I,b as V,v as U,U as z}from"./createUtils-2nq9FQ8U.js";import{n as h}from"./jsxFactory-JatJKb6K.js";import"./preload-helper-DMGCcr4D.js";import"./elevationInfoUtils-DDBvXGGl.js";import"./ElevationInfo-rZECiOfs.js";import"./lengthUtils-DTCBAnCf.js";import"./ReactiveSet-mM5qFKTN.js";import"./diffUtils-rhP3e9jP.js";import"./UpdatingHandles-B-5OkGd0.js";import"./SnappingContext-BgZQMltr.js";import"./vec2f64-Cgb6qxNH.js";import"./vec32-Cug0iGhu.js";import"./vec42-C8IJxs4z.js";import"./vec4f64-DPb6J-GU.js";import"./plane-ZGj-8_WI.js";import"./vectorStacks-BbylamMy.js";import"./quatf64-aQ5IuZRd.js";import"./SketchViewModel-Cj8uEiXG.js";import"./projectionUtils-BnZegCzy.js";import"./projectBuffer-CvUxwxfU.js";import"./zscale-uj2q40qk.js";import"./GraphicsLayer-DyM81qeL.js";import"./GraphicsCollection-CL3D25Q2.js";import"./BlendLayer-CyNfx66v.js";import"./layerContainerType-CSXZNpHb.js";import"./jsonUtils-CstQvJeQ.js";import"./parser-BnRWC6yN.js";import"./mat4f32-Djp3mnm5.js";import"./mat4-2MTFrsuN.js";import"./ScaleRangeLayer-B5DeYT7P.js";import"./editableLayers-C0xHqn3u.js";import"./utils-CjSTERX-.js";import"./Queue-DaUDwAqr.js";import"./signal-BaW-Bcbs.js";import"./Version-C6XZCcoI.js";import"./asyncUtils-dxk0lkVi.js";import"./projectVectorToVector-CKUUwHjx.js";import"./projectPointToVector-DRrpaIHi.js";import"./Query-BDCdTeKY.js";import"./Field-BjIZIuuv.js";import"./fieldType-B3Jc2rgt.js";import"./geodesicUtils-B3wsgxFJ.js";import"./sphere-Dgp7tg6C.js";import"./quantityUtils-m4o856R2.js";import"./geodeticLengthOperator-D9IB3V30.js";import"./geodeticCurveType-CirnHLSB.js";import"./earcut-D9gy186-.js";import"./triangle-BpZbkAPp.js";import"./lineSegment-gD1fcp9j.js";import"./spatialReferenceEllipsoidUtils-CJ_KWh8h.js";import"./rotate-BGPDlZHz.js";import"./curveOperationUtils-BF870piJ.js";import"./meshVertexSpaceUtils-CUoYVWsV.js";import"./MeshLocalVertexSpace-BbFfCj73.js";import"./hydratedFeatures-D4DG5p2d.js";import"./angularMeasurementUtils-CTzK9eL6.js";import"./Cyclical-CcbL6dUf.js";import"./Scheduler-BvhG-7pC.js";import"./debugFlags-XlpYn9IJ.js";import"./distanceOperator-D0D9pPNm.js";import"./Point2D-Cl-0kgBQ.js";import"./Distance2DCalculator-CXhBP-8I-BxSce69-.js";import"./ProjectionTransformation-CQdCRDfR.js";import"./Envelope2D-D_vzSDeK.js";import"./Transformation2D-BcDHHNrs.js";import"./SimpleGeometryCursor-B92kdZ15.js";import"./OperatorDefinitions-DP7_WWTp.js";import"./apiConverter-x7K4DQXS.js";import"./jsonConverter-CV1U2Tkg.js";import"./simplifyOperator-DB305ZCK.js";import"./operatorSimplify-DwLnpJ6B.js";import"./mat2d-CaJtLH6t.js";import"./quat-BxA_vG_d.js";import"./intl-CnfmQOd0.js";import"./messages-DyY-tQe4.js";import"./uuid-Oe6SV2kF.js";import"./sanitizerUtils-BSv1Bmu5.js";let i=class extends k{constructor(t){super(t),this.coordinates=void 0,this.strokeDash=[],this.strokeWidth=1,this.strokeColor=[0,0,0,1],this.strokeDashColor=[255,255,255,1],this.fillColor=[0,0,0,0],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){const t=this.strokeColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _strokeBackgroundStyle(){const t=this.strokeDashColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _fillStyle(){const t=this.fillColor;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get _renderCoordinates(){const t=[];if(!this.coordinates)return{coordinates:t,rect:u};const e=O(_(T(u),this.coordinates),2*this.strokeWidth);e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]+.5),e[3]=Math.ceil(e[3]+.5);for(const a of this.coordinates)t.push([Math.floor(a[0]-e[0])+.5,Math.floor(a[1]-e[1])+.5]);return t.reverse(),{coordinates:t,rect:e}}render(){const{coordinates:t,rect:e}=this._renderCoordinates,a=$(e),n=C(e);return h("div",{classes:{"esri-outline-overlay-item":!0},styles:{left:e[0]+"px",top:e[1]+"px",width:a+"px",height:n+"px",visibility:this.visible?"visible":"hidden"}},h("svg",{height:n,styles:{display:"block"},width:a},h("polygon",{fill:this._fillStyle,points:t.map(([l,p])=>`${l},${p}`).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),h("polygon",{fill:"transparent",points:t.map(([l,p])=>`${l},${p}`).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};r([o()],i.prototype,"coordinates",void 0),r([o()],i.prototype,"strokeDash",void 0),r([o()],i.prototype,"strokeWidth",void 0),r([o()],i.prototype,"strokeColor",void 0),r([o()],i.prototype,"strokeDashColor",void 0),r([o()],i.prototype,"fillColor",void 0),r([o()],i.prototype,"visible",void 0),r([o()],i.prototype,"isDecoration",void 0),r([o({readOnly:!0})],i.prototype,"_strokeStyle",null),r([o({readOnly:!0})],i.prototype,"_strokeBackgroundStyle",null),r([o({readOnly:!0})],i.prototype,"_fillStyle",null),r([o({readOnly:!0})],i.prototype,"_renderCoordinates",null),i=r([v("esri.views.overlay.OutlineOverlayItem")],i);let s=class extends S{constructor(t){super(t),this.drawOperation=null,this._overlayItem=void 0,this.geometryType=null,this.mode=null,this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();const t=e=>this.drawOperation?.on(e,a=>{this._updateVisuals(),this.emit(e,a)})??y();this.addHandles([t("vertex-add"),t("vertex-remove"),t("vertex-update"),t("cursor-update"),t("complete")]),this.finishToolCreation()}destroy(){this.drawOperation=D(this.drawOperation),this._set("view",null)}get canRedo(){return!!this.drawOperation?.canRedo}get canUndo(){return!!this.drawOperation?.canUndo}set centeredToggled(t){this._set("centeredToggled",t),this._updateVisuals()}set enabled(t){const{drawOperation:e}=this;e&&(e.interactive=t),this._set("enabled",t)}set uniformSizeToggled(t){this._set("uniformSizeToggled",t),this._updateVisuals()}get updating(){return this.drawOperation?.updating??!1}get cursor(){return this._get("cursor")??"crosshair"}set cursor(t){this._set("cursor",t);const{drawOperation:e}=this;e&&(e.cursor=t)}completeCreateOperation(){this.drawOperation?.complete()}onInputEvent(t){this.destroyed||this.drawOperation?.onInputEvent(t)}redo(){this.drawOperation?.redo()}undo(){this.drawOperation?.undo()}reset(){}_makeDrawOperation(){const{view:t}=this;return new M({view:t,manipulators:this.manipulators,geometryType:W(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new g,hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor,automaticLengthMeasurementUtils:this.automaticLengthMeasurementUtils})}get coordinates(){const{drawOperation:t}=this;if(!t?.geometryIncludingUncommittedVertices.length)return[];const{coordinateHelper:e}=t,a=t.committableVertex,n=t.committedVertices.slice();a!=null&&n.push(e.pointToArray(a));const l=n.length;switch(this.geometryType){case"point":return n.slice(0,1);case"circle":case"rectangle":{const p=new x(b,g.spatialReference),c=this.geometryType==="circle"?I:V,w=this.geometryType==="circle"?U:z;if(l===1&&t.isCompleted){const m=n[0],d=p.makeMapPoint(m[0]+j,m[1]);return c([m,d],p,!0)?.geometry.rings[0]??[]}if(l===2){const m=this.geometryType!=="rectangle",d=this.centeredToggled!==m,f=this.geometryType!=="rectangle";return(this.uniformSizeToggled!==f?c(n,p,d)?.geometry.rings[0]:w(n,p,d)?.geometry.rings[0])??[]}return[]}}return n}_updateVisuals(){if(!this._overlayItem){const t=new i({strokeDash:[5],strokeDashColor:[255,255,255,255]});this.view.overlay?.addItem(t),this.addHandles(y(()=>{this.view.overlay?.removeItem(t),t?.destroy(),this._overlayItem=void 0})),this._overlayItem=t}this._overlayItem.coordinates=this.coordinates}onDeactivate(){this.drawOperation?.isCompleted||this.drawOperation?.cancel()}};function W(t){switch(t){case"polygon":case"point":return t;case"circle":case"rectangle":return"segment"}}r([o({value:!1})],s.prototype,"centeredToggled",null),r([o()],s.prototype,"drawOperation",void 0),r([o({value:!0})],s.prototype,"enabled",null),r([o({value:!1})],s.prototype,"uniformSizeToggled",null),r([o({constructOnly:!0})],s.prototype,"geometryType",void 0),r([o({constructOnly:!0})],s.prototype,"mode",void 0),r([o({readOnly:!0})],s.prototype,"type",void 0),r([o({readOnly:!0})],s.prototype,"updating",null),r([o({constructOnly:!0,nonNullable:!0})],s.prototype,"view",void 0),r([o({constructOnly:!0})],s.prototype,"automaticLengthMeasurementUtils",void 0),r([o()],s.prototype,"cursor",null),s=r([v("esri.views.draw.DrawScreenTool")],s);const j=48;export{s as DrawScreenTool,W as geometryTypeToDrawOperationGeometryType};
