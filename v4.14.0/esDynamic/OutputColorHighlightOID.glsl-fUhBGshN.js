import{dX as He,N as Ue,_ as f,X as p,Y as je,i as $e,o6 as dn,e4 as fn,cS as Z,dk as pn,aI as Di,az as _,gx as qe,gv as Fi,l6 as mn,he as At,C as vn,cW as gn,s as ce,aJ as Yt,k$ as et,o7 as _n,o8 as yn,db as xn,o9 as bn,cY as X,oa as wn,cR as Li,eB as Vi,al as Sn,hO as Zt,g1 as Mn,ca as Tn,nM as ue,ob as Kt,gp as Cn,eU as We,oc as Pn,d$ as kt,j7 as zn,nX as On,gO as An,od as En,d3 as Ni,m7 as In,d4 as Et,e0 as Ge,ch as ki,ci as st,aH as Xe,gV as Bi,hs as he,hS as Rn,z as Dn,eY as Fn,aB as Hi,av as Ln,fc as Vn,hW as Ye,dY as Ui}from"./main-CSjwO60s.js";import{Y as Ze,D as Ke,C as Qe,U as Nn,_ as kn,A as Bn,R as ji}from"./enums-DDJfd4_p.js";import{A as Hn,a as Je}from"./Texture-DLw7oaIg.js";import{I as de,v as Un,o as N,u as nt,g as q,W as jn,E as mt,R as vt,s as $,_ as ut,A as xt,r as Y,q as bt,c as wt,p as $i,H as It,P as ht,Z as qi,X as ti,K as Wi,y as Gi}from"./vec32-CI1xtKog.js";import{e as $n,A as qn}from"./Indices-CAn-HCVv.js";import{l as Wn,s as H,g as Xi,h as Gn,o as fe,m as Xn,T as Yi,f as Zi,J as Ki,p as Yn,y as Zn}from"./BufferView-B6RYETl3.js";import{S as Kn}from"./triangle-DA_o7I-u.js";import{c as Qn,e as Jn,l as Qi,r as to,T as eo,d as io}from"./renderState-CsafAKLy.js";import{h as pe,s as ei,n as Bt,c as me,H as Ji,G as tr,i as ve,r as ro,f as so,o as no,x as oo,l as er,m as ao,A as lo,C as co,X as uo,R as ho,p as fo,b as po}from"./mat4-R0VY9B_E.js";import{t as v,n as ot}from"./glsl-CfY1Aoj6.js";import{s as ge,a as Ht,m as ir,L as rr,E as ii,x as sr,z as _e,p as mo}from"./vec42-DHp-FUwt.js";import{n as Rt,i as vo,r as nr}from"./vec4f64-DD-nkcCV.js";import{m as or}from"./lengthUtils-CopeXEyE.js";import"./projectBuffer-CMNsPBq1.js";import"./projectionUtils-CsX1UTBu.js";import{n as ar}from"./projectVectorToVector-OCoJKalB.js";import{r as lr,n as ri,t as cr}from"./vec2f64-CkowXrDb.js";import{h as ur,x as go,y as hr,k as _o,S as yo,w as xo,O as bo,d as wo,q as So,A as Mo}from"./frustum-D1Y7pP8E.js";import{P as ye,I as dr,V as fr,b as pr,k as mr,e as To,d as Co}from"./sphere-CIGsF4vz.js";import{f as Po}from"./vectorStacks-B2ngxq6F.js";import{G as zo,K as Oo}from"./orientedBoundingBox-DAJ-bKlA.js";import{i as vr}from"./projectPointToVector-BHS0gJJf.js";import{m as Ao,v as Eo,b as Io}from"./lineSegment-D8lwRkdT.js";import{L as Ro,U as gr,j as _r,b as Do,O as yr,Z as Fo,k as Lo}from"./plane-wUwHaY3K.js";import{r as Vo}from"./Cyclical-Bzwh_QaL.js";import{A as No}from"./normalizeUtils-DK5542Ty.js";import{n as xr}from"./VertexAttributeLocations-DBgVVQz-.js";import{t as br}from"./VertexElementDescriptor-DLvjNrmQ.js";function ko(t,e=!1){return t<=He?e?new Array(t).fill(0):new Array(t):new Float32Array(t)}function Bo(t){return(Array.isArray(t)?t.length:t.byteLength/8)<=He?Array.from(t):new Float32Array(t)}function Ho(t,e,i){return Array.isArray(t)?t.slice(e,e+i):t.subarray(e,e+i)}let j=class extends Ue{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1}};f([p()],j.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),f([p()],j.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),f([p()],j.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),f([p()],j.prototype,"DECONFLICTOR_SHOW_GRID",void 0),f([p()],j.prototype,"LABELS_SHOW_BORDER",void 0),f([p()],j.prototype,"TEXT_SHOW_BASELINE",void 0),f([p()],j.prototype,"TEXT_SHOW_BORDER",void 0),f([p()],j.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),f([p()],j.prototype,"OVERLAY_SHOW_CENTER",void 0),f([p()],j.prototype,"SHOW_POI",void 0),f([p()],j.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),f([p()],j.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),f([p()],j.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),f([p()],j.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),f([p()],j.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),f([p()],j.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),f([p()],j.prototype,"I3S_TREE_SHOW_TILES",void 0),f([p()],j.prototype,"I3S_SHOW_MODIFICATIONS",void 0),f([p()],j.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),f([p()],j.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),f([p()],j.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),f([p()],j.prototype,"LINE_WIREFRAMES",void 0),j=f([je("esri.views.3d.support.debugFlags")],j);const wr=new j,xe=()=>$e.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),Uo=542327876,jo=131072,$o=4;function si(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}function qo(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}const Wo=si("DXT1"),Go=si("DXT3"),Xo=si("DXT5"),Yo=31,Zo=0,Ko=1,Qo=2,Jo=3,ta=4,ea=7,ia=20,ra=21;function sa(t,e,i){const r=na(i,e.hasMipmap??!1);if(r==null)throw new Error("DDS texture data is null");const{textureData:s,internalFormat:n,width:o,height:a}=r;return e.samplingMode=s.levels.length>1?9987:9729,e.hasMipmap=s.levels.length>1,e.internalFormat=n,e.width=o,e.height=a,new Hn(t,e,s)}function na(t,e){const i=new Int32Array(t.buffer,t.byteOffset,Yo);if(i[Zo]!==Uo)return xe().error("Invalid magic number in DDS header"),null;if(!(i[ia]&$o))return xe().error("Unsupported format, must contain a FourCC code"),null;const r=i[ra];let s,n;switch(r){case Wo:s=8,n=Ze.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case Go:s=16,n=Ze.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case Xo:s=16,n=Ze.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return xe().error("Unsupported FourCC code:",qo(r)),null}let o=1,a=i[ta],l=i[Jo];(3&a||3&l)&&(xe().warn("Rounding up compressed texture size to nearest multiple of 4."),a=a+3&-4,l=l+3&-4);const u=a,c=l;let h,m;i[Qo]&jo&&e!==!1&&(o=Math.max(1,i[ea]));let y=t.byteOffset+i[Ko]+4;const d=[];for(let w=0;w<o;++w)m=(a+3>>2)*(l+3>>2)*s,h=new Uint8Array(t.buffer,y,m),d.push(h),y+=m,a=Math.max(1,a>>1),l=Math.max(1,l>>1);return{textureData:{type:"compressed",levels:d},internalFormat:n,width:u,height:c}}function Sr(t){if(t.length<He)return Array.from(t);if(Array.isArray(t))return Float64Array.from(t);if(!("BYTES_PER_ELEMENT"in t))return Array.from(t);switch(t.BYTES_PER_ELEMENT){case 1:return Uint8Array.from(t);case 2:return dn(t)?Wn().from(t):fn(t)?Uint16Array.from(t):Int16Array.from(t);case 4:return Float32Array.from(t);default:return Float64Array.from(t)}}let Mr=class un{get center(){return Z(this._data[0],this._data[1],this._data[2])}get radius(){return this._data[3]}get bbMin(){return Z(this._data[4],this._data[5],this._data[6])}get bbMax(){return Z(this._data[7],this._data[8],this._data[9])}constructor(e,i,r){this.primitiveIndices=e,this._numIndexPerPrimitive=i,this.position=r,this._data=[.1,0,0,0,0,0,0,0,0,0],this._children=void 0,H(e.length>=1),H(r.size===3||r.size===4);const{data:s,size:n,indices:o}=r;H(o.length%this._numIndexPerPrimitive===0),H(o.length>=e.length*this._numIndexPerPrimitive);const a=e.length;let l=n*o[this._numIndexPerPrimitive*e[0]];Dt.clear(),Dt.push(l);const u=Z(s[l],s[l+1],s[l+2]),c=Di(u);for(let d=0;d<a;++d){const w=this._numIndexPerPrimitive*e[d];for(let b=0;b<this._numIndexPerPrimitive;++b){l=n*o[w+b],Dt.push(l);let z=s[l];u[0]=Math.min(z,u[0]),c[0]=Math.max(z,c[0]),z=s[l+1],u[1]=Math.min(z,u[1]),c[1]=Math.max(z,c[1]),z=s[l+2],u[2]=Math.min(z,u[2]),c[2]=Math.max(z,c[2])}}for(let d=0;d<3;++d)this._data[4+d]=u[d],this._data[7+d]=c[d];const h=de(_(),this.bbMin,this.bbMax,.5);let m=.5*Math.max(Math.max(c[0]-u[0],c[1]-u[1]),c[2]-u[2]),y=m*m;for(let d=0;d<Dt.length;++d){l=Dt.at(d);const w=s[l]-h[0],b=s[l+1]-h[1],z=s[l+2]-h[2],O=w*w+b*b+z*z;if(O<=y)continue;const C=Math.sqrt(O),A=.5*(C-m);m+=A,y=m*m;const D=A/C;h[0]+=w*D,h[1]+=b*D,h[2]+=z*D}this._data[3]=m;for(let d=0;d<3;++d)this._data[0+d]=h[d];Dt.clear()}getChildren(){if(this._children||Un(this.bbMin,this.bbMax)<=1)return this._children;const e=de(_(),this.bbMin,this.bbMax,.5),i=this.primitiveIndices.length,r=new Uint8Array(i),s=new Array(8);for(let c=0;c<8;++c)s[c]=0;const{data:n,size:o,indices:a}=this.position;for(let c=0;c<i;++c){let h=0;const m=this._numIndexPerPrimitive*this.primitiveIndices[c];let y=o*a[m],d=n[y],w=n[y+1],b=n[y+2];for(let z=1;z<this._numIndexPerPrimitive;++z){y=o*a[m+z];const O=n[y],C=n[y+1],A=n[y+2];O<d&&(d=O),C<w&&(w=C),A<b&&(b=A)}d<e[0]&&(h|=1),w<e[1]&&(h|=2),b<e[2]&&(h|=4),r[c]=h,++s[h]}let l=0;for(let c=0;c<8;++c)s[c]>0&&++l;if(l<2)return;const u=new Array(8);for(let c=0;c<8;++c)u[c]=s[c]>0?new Uint32Array(s[c]):void 0;for(let c=0;c<8;++c)s[c]=0;for(let c=0;c<i;++c){const h=r[c];u[h][s[h]++]=this.primitiveIndices[c]}this._children=new Array;for(let c=0;c<8;++c)u[c]!==void 0&&this._children.push(new un(u[c],this._numIndexPerPrimitive,this.position));return this._children}static prune(){Dt.prune()}};const Dt=new pn({deallocator:null});let Tr=class{constructor(t){this.id=qe(),this._attributes=new Map;for(const[e,i]of t)this._attributes.set(e,{...i,indices:$n(i.indices)})}get attributes(){return this._attributes}};function oa(t,e){if(!t)return!1;const{size:i,data:r,indices:s}=t;N(e,0,0,0),N(at,0,0,0);let n=0,o=0;for(let a=0;a<s.length-2;a+=3){const l=s[a]*i,u=s[a+1]*i,c=s[a+2]*i;N(G,r[l],r[l+1],r[l+2]),N(St,r[u],r[u+1],r[u+2]),N(be,r[c],r[c+1],r[c+2]);const h=Kn(G,St,be);h?(nt(G,G,St),nt(G,G,be),q(G,G,1/3*h),nt(e,e,G),n+=h):(nt(at,at,G),nt(at,at,St),nt(at,at,be),o+=3)}return(o!==0||n!==0)&&(n!==0?(q(e,e,1/n),!0):o!==0&&(q(e,at,1/o),!0))}function aa(t,e){if(!t)return!1;const{size:i,data:r,indices:s}=t;N(e,0,0,0);let n=-1,o=0;for(let a=0;a<s.length;a++){const l=s[a]*i;n!==l&&(e[0]+=r[l],e[1]+=r[l+1],e[2]+=r[l+2],o++),n=l}return o>1&&q(e,e,1/o),o>0}function la(t,e,i){if(!t)return!1;N(i,0,0,0),N(at,0,0,0);let r=0,s=0;const{size:n,data:o,indices:a}=t,l=a.length-1,u=l+(e?2:0);for(let c=0;c<u;c+=2){const h=c<l?c+1:0,m=a[c<l?c:l]*n,y=a[h]*n;G[0]=o[m],G[1]=o[m+1],G[2]=o[m+2],St[0]=o[y],St[1]=o[y+1],St[2]=o[y+2],q(G,nt(G,G,St),.5);const d=jn(G,St);d>0?(nt(i,i,q(G,G,d)),r+=d):r===0&&(nt(at,at,G),s++)}return r!==0?(q(i,i,1/r),!0):s!==0&&(q(i,at,1/s),!0)}const G=_(),St=_(),be=_(),at=_();let Cr=class{constructor(){this.uid=qe()}},Pr=class extends Cr{constructor(t){super(),this.highlightName=t,this.channel=0}},ca=class extends Cr{constructor(){super(...arguments),this.channel=1}},ua=class hn extends Tr{constructor(e,i,r=null,s=0,n=null,o=-1,a){super(i),this.material=e,this.mapPositions=r,this.type=s,this.olidColor=n,this.edgeIndicesLength=o,this.baseGeometry=a,this._highlights=null,this._highlightOptionsCounts=null,this.visible=!0,this._boundingInfo=null;const l=this.positionAttribute;l!=null&&this.edgeIndicesLength<0&&(this.edgeIndicesLength=l.indices.length)}instantiate(e={}){const i=new hn(e.material||this.material,[],this.mapPositions,this.type,this.olidColor,this.edgeIndicesLength,this.baseGeometry);return this._attributes.forEach((r,s)=>{r.exclusive=!1,i._attributes.set(s,r)}),i._boundingInfo=this._boundingInfo,i.transformation=e.transformation||this.transformation,i}getMutableAttribute(e){let i=this._attributes.get(e);return i&&!i.exclusive&&(i={...i,exclusive:!0,data:Sr(i.data)},this._attributes.set(e,i)),i}setAttributeData(e,i){const r=this._attributes.get(e);r?this._attributes.set(e,{...r,exclusive:!0,data:i}):Je()&&console.warn(`Setting undefined attribute ${e} data`)}get positionAttribute(){return this.attributes.get("position")??this.baseGeometry?.attributes.get("position")}get indexCount(){return this._attributes.values().next().value?.indices?.length??0}get faceCount(){return this.indexCount/3}get boundingInfo(){return this._boundingInfo??=this._calculateBoundingInfo(),this._boundingInfo}computeAttachmentOrigin(e){return!!(this.type===0?this._computeAttachmentOriginTriangles(e):this.type===2?this._computeAttachmentOriginLines(e):this._computeAttachmentOriginPoints(e))&&(this._transformation!=null&&mt(e,e,this._transformation),!0)}_computeAttachmentOriginTriangles(e){const i=this.positionAttribute;return oa(i,e)}_computeAttachmentOriginLines(e){const i=this.positionAttribute;return la(i,ha(this.material.parameters,i),e)}_computeAttachmentOriginPoints(e){const i=this.positionAttribute;return aa(i,e)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const e=this.positionAttribute;if(!e||e.indices.length===0)return null;const i=this.type===0?3:1;H(e.indices.length%i===0,"Indexing error: "+e.indices.length+" not divisible by "+i);const r=qn(e.indices.length/i);return new Mr(r,i,e)}get transformation(){return this._transformation??Fi}set transformation(e){this._transformation=e&&e!==Fi?mn(e):null}get highlights(){return this._highlights||da}get hasHighlights(){return(this._highlightOptionsCounts?.size??0)>0}foreachHighlightOptions(e){this._highlightOptionsCounts?.forEach((i,r)=>e(r))}allocateIdAndHighlight(e){const i=new Pr(e);return this.addHighlight(i)}addHighlight(e){this._ensureHighlights().add(e);const{highlightName:i}=e,r=(this._highlightOptionsCounts?.get(i)??0)+1;return this._ensureHighlightOptionsCounts().set(i,r),e}_ensureHighlights(){let e=this._highlights;return e||(e=new Set,this._highlights=e),e}_ensureHighlightOptionsCounts(){let e=this._highlightOptionsCounts;return e||(e=new Map,this._highlightOptionsCounts=e),e}removeHighlight(e){if(this._highlights?.delete(e)){const{highlightName:i}=e,r=this._highlightOptionsCounts?.get(i)??0;r<=1?this._highlightOptionsCounts?.delete(i):this._ensureHighlightOptionsCounts().set(i,r-1)}}};function ha(t,e){return!(!("isClosed"in t)||!t.isClosed)&&e.indices.length>2}const da=new Set;function zr(t){return t===4||t===5||t===6||t===7||t===8}function fa(t){return Ar(t)||t===3}function ni(t){return t===9||t===10}function pa(t){return oi(t)||ni(t)}function oi(t){return t===0}function Ut(t){return oi(t)||li(t)}function ma(t){return Ut(t)||t===10}function Or(t){return Ut(t)||ni(t)}function Ar(t){return Or(t)||ai(t)}function ai(t){return t===2}function li(t){return t===1}function va(t){return ai(t)||zr(t)}let Er=class{constructor(t){this._material=t.material,this._techniques=t.techniques,this._output=t.output}dispose(){}get _stippleTextures(){return this._techniques.context?.stippleTextures}get _markerTextures(){return this._techniques.context?.markerTextures}getTechnique(t,e){return this._techniques.get(t,this._material.getConfiguration(this._output,e))}ensureResources(t){return 2}},ga=class{};const Qt=ga;let _a=class extends Er{constructor(t){super(t),this._numLoading=0,this._disposed=!1,this._textures=t.textures,this.updateTexture(t.textureId),this._acquire(t.normalTextureId,e=>this._textureNormal=e),this._acquire(t.emissiveTextureId,e=>this._textureEmissive=e),this._acquire(t.occlusionTextureId,e=>this._textureOcclusion=e),this._acquire(t.metallicRoughnessTextureId,e=>this._textureMetallicRoughness=e)}dispose(){super.dispose(),this._texture=At(this._texture),this._textureNormal=At(this._textureNormal),this._textureEmissive=At(this._textureEmissive),this._textureOcclusion=At(this._textureOcclusion),this._textureMetallicRoughness=At(this._textureMetallicRoughness),this._disposed=!0}ensureResources(t){return this._numLoading===0?2:1}get textureBindParameters(){return new Ir(this._texture?.glTexture??null,this._textureNormal?.glTexture??null,this._textureEmissive?.glTexture??null,this._textureOcclusion?.glTexture??null,this._textureMetallicRoughness?.glTexture??null)}updateTexture(t){this._texture!=null&&t===this._texture.id||(this._texture=At(this._texture),this._acquire(t,e=>this._texture=e))}_acquire(t,e){if(t==null)return void e(null);const i=this._textures.acquire(t);if(vn(i))return++this._numLoading,void i.then(r=>{if(this._disposed)return At(r),void e(null);e(r)}).finally(()=>--this._numLoading);e(i)}},ya=class extends Qt{constructor(t=null){super(),this.textureEmissive=t}},Ir=class extends ya{constructor(t,e,i,r,s,n,o){super(i),this.texture=t,this.textureNormal=e,this.textureOcclusion=r,this.textureMetallicRoughness=s,this.scale=n,this.normalTextureTransformMatrix=o}},xa=class{constructor(t){this._bits=[...t]}equals(t){return gn(this._bits,t.bits)}get code(){return this._code??=String.fromCharCode(...this._bits),this._code}get bits(){return this._bits}},Rr=class extends Qt{constructor(){super(),this._parameterBits=this._parameterBits?.map(()=>0)??[],this._parameterNames??=[]}get key(){return this._key??=new xa(this._parameterBits),this._key}decode(t=this.key){const e=this._parameterBits;this._parameterBits=[...t.bits];const i=this._parameterNames.map(r=>`    ${r}: ${this[r]}`).join(`
`);return this._parameterBits=e,i}};function Jt(t={}){return(e,i)=>{e.hasOwnProperty("_parameterNames")||Object.defineProperty(e,"_parameterNames",{value:e._parameterNames?.slice()??[],configurable:!0,writable:!0}),e.hasOwnProperty("_parameterBits")||Object.defineProperty(e,"_parameterBits",{value:e._parameterBits?.slice()??[0],configurable:!0,writable:!0}),e._parameterNames.push(i);const r=t.count||2,s=Math.ceil(Math.log2(r)),n=e._parameterBits;let o=0;for(;n[o]+s>16;)o++,o>=n.length&&n.push(0);const a=n[o],l=(1<<s)-1<<a;n[o]+=s,t.count?Object.defineProperty(e,i,{get(){return(this._parameterBits[o]&l)>>a},set(u){if(this[i]!==u){if(this._key=null,this._parameterBits[o]=this._parameterBits[o]&~l|+u<<a&l,typeof u!="number")throw new ce("internal:invalid-shader-configuration",`Configuration value for ${i} must be a number, got ${typeof u}`);if(t.count==null)throw new ce("internal:invalid-shader-configuration",`Configuration value for ${i} must provide a count option`)}}}):Object.defineProperty(e,i,{get(){return!!((this._parameterBits[o]&l)>>a)},set(u){if(this[i]!==u&&(this._key=null,this._parameterBits[o]=this._parameterBits[o]&~l|+u<<a&l,typeof u!="boolean"))throw new ce("internal:invalid-shader-configuration",`Configuration value for ${i} must be boolean, got ${typeof u}`)}})}}let ba=class extends Rr{constructor(){super(...arguments),this.instancedDoublePrecision=!1,this.hasModelTransformation=!1}},jt=class extends ba{constructor(){super(...arguments),this.output=0,this.oitPass=0,this.hasSlicePlane=!1,this.hasHighlightMixTexture=!1,this.bindType=1,this.instanced=!1,this.writeDepth=!0}};f([Jt({count:11})],jt.prototype,"output",void 0),f([Jt({count:3})],jt.prototype,"oitPass",void 0),f([Jt()],jt.prototype,"hasSlicePlane",void 0),f([Jt()],jt.prototype,"hasHighlightMixTexture",void 0);let ci=class{constructor(){this._scale=0,this._angleFactor=0,this._minScale=0}update(t,e,i,r){i?(this._scale=Math.min(i.divisor/(e-i.offset),1),this._angleFactor=Sa(t),this._minScale=r!=null?Math.min(i.minPixelSize/r,1):0):(this._scale=1,this._minScale=1,this._angleFactor=1)}apply(t){const{_scale:e,_angleFactor:i,_minScale:r}=this;return t*Yt(et(e,1,i),r,1)}applyVec2(t,e){t[0]=this.apply(e[0]),t[1]=this.apply(e[1])}},wa=class{constructor(){this.evaluator=new ci,this.alignmentEvaluator=new ci}update(t,e,i,r,s,n){this.evaluator.update(t,e,i,r),this.alignmentEvaluator.update(t,e,s??i,(s?n:null)??r)}};function Sa(t){return Math.abs(t)**3}function Ma(t){return!!t&&!0}function Ta(t,e,i,r,s,n){let o=i.screenLength*t.pixelRatio;s!=null&&(Dr.update(r,e,s,n),o=Dr.apply(o));const a=o*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return Yt(a*e,i.minWorldLength,i.maxWorldLength)}const Ca=_n();function ui(t,e){let i=!1;for(const r in e){const s=e[r];s!==void 0&&(Array.isArray(s)?Array.isArray(t[r])&&Ca(s,t[r])||(t[r]=s.slice(),i=!0):t[r]!==s&&(i=!0,t[r]=s))}return i}const Pa={multiply:1,ignore:2,replace:3,tint:4},Dr=new ci;let za=class{constructor(t,e){this.id=qe(),this.supportsEdges=!1,this._renderPriority=0,this._parameters=new e,ui(this._parameters,t),this.validateParameters(this._parameters)}get parameters(){return this._parameters}update(t){return!1}setParameters(t,e=!0){ui(this._parameters,t)&&(this.validateParameters(this._parameters),e&&this._parametersChanged())}validateParameters(t){}shouldRender(t){return this.visible&&this.isVisibleForOutput(t.output)&&(!this.parameters.isDecoration||t.bind.decorations)&&(this.parameters.renderOccluded&t.renderOccludedMask)!==0}isVisibleForOutput(t){return!0}get renderPriority(){return this._renderPriority}set renderPriority(t){t!==this._renderPriority&&(this._renderPriority=t,this._parametersChanged())}_parametersChanged(){this.repository?.materialChanged(this)}get renderOccludedFlags(){return this.visible?this.parameters.renderOccluded:0}get hasEmissions(){return!1}getConfiguration(t,e,i=new jt){return i.output=t,i.hasHighlightMixTexture=t===9&&e.highlightMixTexture!=null,i}},Oa=class extends Qt{constructor(){super(...arguments),this.renderOccluded=1,this.isDecoration=!1}};const Aa=Jn(1,0,1,771);function Ea(t,e=!1){switch(t){case 0:return e?Qi:to;case 1:return Aa;case 2:case 3:return null}}function Ia(t){if(t.draped)return null;switch(t.oitPass){case 0:case 2:return t.writeDepth?Qn:null;case 1:case 3:return null}}const Ra=5e5,Fr={factor:-1,units:-2};function Da({oitPass:t,enableOffset:e}){return e&&t===1?Fr:null}function Fa(t,e=513){return t===0||t===2?e:515}function La(t,e){const i=li(e);return t===1?i?{buffers:[Ke,Qe,Nn]}:{buffers:[Ke,Qe]}:i?{buffers:[Ke,Qe]}:null}let Lr=class{constructor(t=0,e=!1,i=!0){this.tolerance=t,this.isVerticalRay=e,this.normalRequired=i}};const we=xn();function Va(t,e,i,r,s,n){if(!t.visible)return;const o=vt(Ur,r,i),a=(c,h,m)=>n(c,m,h),{tolerance:l}=e,u=new Lr(l,!1,e.options.normalRequired);if(t.boundingInfo)H(t.type===0),Vr(t.boundingInfo,i,o,l,s,u,a);else{const c=t.positionAttribute,h=c.indices;Nr(i,o,0,h.length/3,h,c.data,c.stride,s,u,a)}}const Na=_();function Vr(t,e,i,r,s,n,o){if(t==null)return;const a=Xa(i,Na);if(yn(we,t.bbMin),bn(we,t.bbMax),s?.applyToAabb(we),Br(we,e,a,r)){const{primitiveIndices:l,position:u}=t,c=l?l.length:u.indices.length/3;if(c>Za){const h=t.getChildren();if(h!==void 0){for(const m of h)Vr(m,e,i,r,s,n,o);return}}ja(e,i,0,c,u.indices,u.data,u.stride,l,s,n,o)}}const $t=_();function ka(t,e,i,r,s,n,o,a,l){const{data:u,stride:c}=n;Nr(t,vt(Ur,e,t),i,r,s,u,c,o,a,l)}function Ba(t,e,i,r){if(!i.visible)return;const s=(l,u,c)=>r(l,c,u),{boundingInfo:n}=i;if(n){const{bbMin:l,bbMax:u}=n;if(t<l[0]||t>u[0]||e<l[1]||e>u[1])return}const o=i.positionAttribute,a=o.indices;Ha(t,e,0,a.length/3,a,o,s)}function Ha(t,e,i,r,s,n,o){const{data:a,stride:l}=n;for(let u=i;u<r;++u){const c=3*u,h=l*s[c],m=l*s[c+1],y=l*s[c+2],d=a[h+0]-t,w=a[h+1]-e,b=a[m+0]-t,z=a[m+1]-e,O=a[y+0]-t,C=a[y+1]-e,A=O*z-C*b,D=d*C-w*O,L=b*w-z*d;(A<0||D<0||L<0)&&(A>0||D>0||L>0)||o(0,u,null)}}function Ua(t,e,i,r,s,n,o,a){const l=t[0],u=t[1],c=t[2],h=e[0],m=e[1],y=e[2];for(let d=i;d<r;++d){const w=3*d,b=w+1,z=w+2,O=n*w,C=s[O],A=s[O+1],D=s[O+2],L=n*b,T=n*z,S=s[L]-C,x=s[L+1]-A,E=s[L+2]-D,g=s[T]-C,I=s[T+1]-A,M=s[T+2]-D,F=m*M-I*y,V=y*g-M*h,B=h*I-g*m,k=S*F+x*V+E*B;if(Math.abs(k)<=Hr)continue;const K=l-C,it=u-A,lt=c-D,J=K*F+it*V+lt*B;if(k>0){if(J<0||J>k)continue}else if(J>0||J<k)continue;const rt=it*E-x*lt,ft=lt*S-E*K,pt=K*x-S*it,ct=h*rt+m*ft+y*pt;if(k>0){if(ct<0||J+ct>k)continue}else if(ct>0||J+ct<k)continue;const tt=(g*rt+I*ft+M*pt)/k;tt>=0&&a(tt,d,o?kr(S,x,E,g,I,M,$t):null)}}function ja(t,e,i,r,s,n,o,a,l,u,c){const h=t[0],m=t[1],y=t[2],d=e[0],w=e[1],b=e[2],{normalRequired:z}=u;for(let O=i;O<r;++O){const C=a[O],A=3*C,D=o*s[A];let L=n[D],T=n[D+1],S=n[D+2];const x=o*s[A+1];let E=n[x],g=n[x+1],I=n[x+2];const M=o*s[A+2];let F=n[M],V=n[M+1],B=n[M+2];l!=null&&([L,T,S]=l.applyToVertex(L,T,S,O),[E,g,I]=l.applyToVertex(E,g,I,O),[F,V,B]=l.applyToVertex(F,V,B,O));const k=E-L,K=g-T,it=I-S,lt=F-L,J=V-T,rt=B-S,ft=w*rt-J*b,pt=b*lt-rt*d,ct=d*J-lt*w,tt=k*ft+K*pt+it*ct;if(Math.abs(tt)<=Hr)continue;const Vt=h-L,ke=m-T,Be=y-S,Nt=Vt*ft+ke*pt+Be*ct;if(tt>0){if(Nt<0||Nt>tt)continue}else if(Nt>0||Nt<tt)continue;const Ai=ke*it-K*Be,Ei=Be*k-it*Vt,Ii=Vt*K-k*ke,le=d*Ai+w*Ei+b*Ii;if(tt>0){if(le<0||Nt+le>tt)continue}else if(le>0||Nt+le<tt)continue;const Ri=(lt*Ai+J*Ei+rt*Ii)/tt;Ri>=0&&c(Ri,C,z?kr(k,K,it,lt,J,rt,$t):null)}}function Nr(t,e,i,r,s,n,o,a,l,u){const c=e,h=Ka,m=Math.abs(c[0]),y=Math.abs(c[1]),d=Math.abs(c[2]),w=m>=y?m>=d?0:2:y>=d?1:2,b=w,z=c[b]<0?2:1,O=(w+z)%3,C=(w+(3-z))%3,A=c[O]/c[b],D=c[C]/c[b],L=1/c[b],T=$a,S=qa,x=Wa,{normalRequired:E}=l;for(let g=i;g<r;++g){const I=3*g,M=o*s[I];N(h[0],n[M+0],n[M+1],n[M+2]);const F=o*s[I+1];N(h[1],n[F+0],n[F+1],n[F+2]);const V=o*s[I+2];N(h[2],n[V+0],n[V+1],n[V+2]),a&&($(h[0],a.applyToVertex(h[0][0],h[0][1],h[0][2],g)),$(h[1],a.applyToVertex(h[1][0],h[1][1],h[1][2],g)),$(h[2],a.applyToVertex(h[2][0],h[2][1],h[2][2],g))),vt(T,h[0],t),vt(S,h[1],t),vt(x,h[2],t);const B=T[O]-A*T[b],k=T[C]-D*T[b],K=S[O]-A*S[b],it=S[C]-D*S[b],lt=x[O]-A*x[b],J=x[C]-D*x[b],rt=lt*it-J*K,ft=B*J-k*lt,pt=K*k-it*B;if((rt<0||ft<0||pt<0)&&(rt>0||ft>0||pt>0))continue;const ct=rt+ft+pt;if(ct===0)continue;const tt=rt*(L*T[b])+ft*(L*S[b])+pt*(L*x[b]);if(tt*Math.sign(ct)<0)continue;const Vt=tt/ct;Vt>=0&&u(Vt,g,E?Ga(h):null)}}const $a=_(),qa=_(),Wa=_();function kr(t,e,i,r,s,n,o){return N(Se,t,e,i),N(Me,r,s,n),ut(o,Se,Me),xt(o,o),o}function Ga(t){return vt(Se,t[1],t[0]),vt(Me,t[2],t[0]),ut($t,Se,Me),xt($t,$t),$t}const Se=_(),Me=_();function Xa(t,e){return N(e,1/t[0],1/t[1],1/t[2])}function Br(t,e,i,r){return Ya(t,e,i,r,1/0)}function Ya(t,e,i,r,s){const n=(t[0]-r-e[0])*i[0],o=(t[3]+r-e[0])*i[0];let a=Math.min(n,o),l=Math.max(n,o);const u=(t[1]-r-e[1])*i[1],c=(t[4]+r-e[1])*i[1];if(l=Math.min(l,Math.max(u,c)),l<0||(a=Math.max(a,Math.min(u,c)),a>l))return!1;const h=(t[2]-r-e[2])*i[2],m=(t[5]+r-e[2])*i[2];return l=Math.min(l,Math.max(h,m)),!(l<0)&&(a=Math.max(a,Math.min(h,m)),!(a>l)&&a<s)}const Za=1e3,Hr=1e-7,Ur=_(),Ka=[_(),_(),_()];let Qa=class{constructor(){this._transform=X(),this._transformInverse=new Te({value:this._transform},pe,X),this._transformInverseTranspose=new Te(this._transformInverse,ei,X),this._transformTranspose=new Te({value:this._transform},ei,X),this._transformInverseRotation=new Te({value:this._transform},wn,Li)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(t){Bt(this._transform,t)}multiplyTransform(t){me(this._transform,this._transform,t)}set(t){Bt(this._transform,t),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(t,e){this.setTransformMatrix(t),this.multiplyTransform(e),this._invalidateLazyTransforms()}},Te=class{constructor(t,e,i){this._original=t,this._update=e,this._dirty=!0,this._transform=i()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}},Ja=class{constructor(t=0){this.componentLocalOriginLength=0,this._totalOffset=0,this._offset=0,this._tmpVertex=_(),this._tmpMbs=ye(),this._tmpObb=new zo,this._resetOffset(t)}_resetOffset(t){this._offset=t,this._totalOffset=t}set offset(t){this._resetOffset(t)}get offset(){return this._offset}set componentOffset(t){this._totalOffset=this._offset+t}set localOrigin(t){this.componentLocalOriginLength=Y(t)}applyToVertex(t,e,i){const r=N($r,t,e,i),s=N(il,t,e,i+this.componentLocalOriginLength),n=this._totalOffset/Y(s);return bt(this._tmpVertex,r,s,n),this._tmpVertex}applyToAabb(t){const e=this.componentLocalOriginLength,i=t[0],r=t[1],s=t[2]+e,n=t[3],o=t[4],a=t[5]+e,l=Math.abs(i),u=Math.abs(r),c=Math.abs(s),h=Math.abs(n),m=Math.abs(o),y=Math.abs(a),d=.5*(1+Math.sign(i*n))*Math.min(l,h),w=.5*(1+Math.sign(r*o))*Math.min(u,m),b=.5*(1+Math.sign(s*a))*Math.min(c,y),z=Math.max(l,h),O=Math.max(u,m),C=Math.max(c,y),A=Math.sqrt(d*d+w*w+b*b),D=Math.sign(l+i),L=Math.sign(u+r),T=Math.sign(c+s),S=Math.sign(h+n),x=Math.sign(m+o),E=Math.sign(y+a),g=this._totalOffset;if(A<g)return t[0]-=(1-D)*g,t[1]-=(1-L)*g,t[2]-=(1-T)*g,t[3]+=S*g,t[4]+=x*g,t[5]+=E*g,t;const I=g/Math.sqrt(z*z+O*O+C*C),M=g/A,F=M-I,V=-F;return t[0]+=i*(D*V+M),t[1]+=r*(L*V+M),t[2]+=s*(T*V+M),t[3]+=n*(S*F+I),t[4]+=o*(x*F+I),t[5]+=a*(E*F+I),t}applyToMbs(t){const e=dr(t),i=Y(e),r=this._totalOffset/i,s=bt(qr,e,e,r),n=t[3]+t[3]*this._totalOffset/i;return fr(this._tmpMbs,s,n),this._tmpMbs}applyToObb(t){return Oo(t,this._totalOffset,this._totalOffset,1,this._tmpObb),this._tmpObb}},tl=class{constructor(t=0){this.offset=t,this.sphere=ye(),this.tmpVertex=_()}applyToVertex(t,e,i){const r=this.objectTransform.transform,s=N($r,t,e,i),n=mt(s,s,r),o=this.offset/Y(n);bt(n,n,n,o);const a=this.objectTransform.inverse;return mt(this.tmpVertex,n,a),this.tmpVertex}applyToMinMax(t,e){const i=this.offset/Y(t);bt(t,t,t,i);const r=this.offset/Y(e);bt(e,e,e,r)}applyToAabb(t){const e=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*e,t[1]+=t[1]*e,t[2]+=t[2]*e;const i=this.offset/Math.sqrt(t[3]*t[3]+t[4]*t[4]+t[5]*t[5]);return t[3]+=t[3]*i,t[4]+=t[4]*i,t[5]+=t[5]*i,t}applyToBoundingSphere(t){const e=dr(t),i=Y(e),r=this.offset/i,s=bt(qr,e,e,r),n=t[3]+t[3]*this.offset/i;return fr(this.sphere,s,n),this.sphere}};const jr=new tl;function el(t){return t!=null?(jr.offset=t,jr):null}new Ja;const $r=_(),il=_(),qr=_();function rl(t,e,i,r=1){const{data:s,indices:n}=t,o=e.typedBuffer,a=e.typedBufferStride,l=n.length;if(i*=a,r===1)for(let u=0;u<l;++u)o[i]=s[n[u]],i+=a;else for(let u=0;u<l;++u){const c=s[n[u]];for(let h=0;h<r;h++)o[i]=c,i+=a}}function Ce(t,e,i){const{data:r,indices:s}=t,n=e.typedBuffer,o=e.typedBufferStride,a=s.length;i*=o;for(let l=0;l<a;++l){const u=2*s[l];n[i]=r[u],n[i+1]=r[u+1],i+=o}}function hi(t,e,i,r=1){const{data:s,indices:n}=t,o=e.typedBuffer,a=e.typedBufferStride,l=n.length;if(i*=a,r===1)for(let u=0;u<l;++u){const c=3*n[u];o[i]=s[c],o[i+1]=s[c+1],o[i+2]=s[c+2],i+=a}else for(let u=0;u<l;++u){const c=3*n[u];for(let h=0;h<r;++h)o[i]=s[c],o[i+1]=s[c+1],o[i+2]=s[c+2],i+=a}}function di(t,e,i,r=1){const{data:s,indices:n}=t,o=e.typedBuffer,a=e.typedBufferStride,l=n.length;if(i*=a,r===1)for(let u=0;u<l;++u){const c=4*n[u];o[i]=s[c],o[i+1]=s[c+1],o[i+2]=s[c+2],o[i+3]=s[c+3],i+=a}else for(let u=0;u<l;++u){const c=4*n[u];for(let h=0;h<r;++h)o[i]=s[c],o[i+1]=s[c+1],o[i+2]=s[c+2],o[i+3]=s[c+3],i+=a}}function sl(t,e,i){const r=t.typedBuffer,s=t.typedBufferStride;e*=s;for(let n=0;n<i;++n)r[e]=0,r[e+1]=0,r[e+2]=0,r[e+3]=0,e+=s}function Wr(t,e,i,r,s=1){if(!e)return void hi(t,i,r,s);const{data:n,indices:o}=t,a=i.typedBuffer,l=i.typedBufferStride,u=o.length,c=e[0],h=e[1],m=e[2],y=e[4],d=e[5],w=e[6],b=e[8],z=e[9],O=e[10],C=e[12],A=e[13],D=e[14];r*=l;let L=0,T=0,S=0;const x=Ji(e)?E=>{L=n[E]+C,T=n[E+1]+A,S=n[E+2]+D}:E=>{const g=n[E],I=n[E+1],M=n[E+2];L=c*g+y*I+b*M+C,T=h*g+d*I+z*M+A,S=m*g+w*I+O*M+D};if(s===1)for(let E=0;E<u;++E)x(3*o[E]),a[r]=L,a[r+1]=T,a[r+2]=S,r+=l;else for(let E=0;E<u;++E){x(3*o[E]);for(let g=0;g<s;++g)a[r]=L,a[r+1]=T,a[r+2]=S,r+=l}}function Gr(t,e,i,r,s=1){if(!e)return void hi(t,i,r,s);const{data:n,indices:o}=t,a=e,l=i.typedBuffer,u=i.typedBufferStride,c=o.length,h=a[0],m=a[1],y=a[2],d=a[4],w=a[5],b=a[6],z=a[8],O=a[9],C=a[10],A=!tr(a),D=1e-6,L=1-D;r*=u;let T=0,S=0,x=0;const E=Ji(a)?g=>{T=n[g],S=n[g+1],x=n[g+2]}:g=>{const I=n[g],M=n[g+1],F=n[g+2];T=h*I+d*M+z*F,S=m*I+w*M+O*F,x=y*I+b*M+C*F};if(s===1)if(A)for(let g=0;g<c;++g){E(3*o[g]);const I=T*T+S*S+x*x;if(I<L&&I>D){const M=1/Math.sqrt(I);l[r]=T*M,l[r+1]=S*M,l[r+2]=x*M}else l[r]=T,l[r+1]=S,l[r+2]=x;r+=u}else for(let g=0;g<c;++g)E(3*o[g]),l[r]=T,l[r+1]=S,l[r+2]=x,r+=u;else for(let g=0;g<c;++g){if(E(3*o[g]),A){const I=T*T+S*S+x*x;if(I<L&&I>D){const M=1/Math.sqrt(I);T*=M,S*=M,x*=M}}for(let I=0;I<s;++I)l[r]=T,l[r+1]=S,l[r+2]=x,r+=u}}function nl(t,e,i,r,s=1){if(!e)return void di(t,i,r,s);const{data:n,indices:o}=t,a=e,l=i.typedBuffer,u=i.typedBufferStride,c=o.length,h=a[0],m=a[1],y=a[2],d=a[4],w=a[5],b=a[6],z=a[8],O=a[9],C=a[10],A=!tr(a),D=1e-6,L=1-D;if(r*=u,s===1)for(let T=0;T<c;++T){const S=4*o[T],x=n[S],E=n[S+1],g=n[S+2],I=n[S+3];let M=h*x+d*E+z*g,F=m*x+w*E+O*g,V=y*x+b*E+C*g;if(A){const B=M*M+F*F+V*V;if(B<L&&B>D){const k=1/Math.sqrt(B);M*=k,F*=k,V*=k}}l[r]=M,l[r+1]=F,l[r+2]=V,l[r+3]=I,r+=u}else for(let T=0;T<c;++T){const S=4*o[T],x=n[S],E=n[S+1],g=n[S+2],I=n[S+3];let M=h*x+d*E+z*g,F=m*x+w*E+O*g,V=y*x+b*E+C*g;if(A){const B=M*M+F*F+V*V;if(B<L&&B>D){const k=1/Math.sqrt(B);M*=k,F*=k,V*=k}}for(let B=0;B<s;++B)l[r]=M,l[r+1]=F,l[r+2]=V,l[r+3]=I,r+=u}}function Xr(t,e,i,r,s=1){const{data:n,indices:o}=t,a=i.typedBuffer,l=i.typedBufferStride,u=o.length;if(r*=l,e===n.length&&e===4){a[r]=n[0],a[r+1]=n[1],a[r+2]=n[2],a[r+3]=n[3];const c=new Uint32Array(i.typedBuffer.buffer,i.start),h=l/4,m=c[r/=4];r+=h;const y=u*s;for(let d=1;d<y;++d)c[r]=m,r+=h;return}if(s!==1)if(e!==4)for(let c=0;c<u;++c){const h=3*o[c];for(let m=0;m<s;++m)a[r]=n[h],a[r+1]=n[h+1],a[r+2]=n[h+2],a[r+3]=255,r+=l}else for(let c=0;c<u;++c){const h=4*o[c];for(let m=0;m<s;++m)a[r]=n[h],a[r+1]=n[h+1],a[r+2]=n[h+2],a[r+3]=n[h+3],r+=l}else{if(e===4){for(let c=0;c<u;++c){const h=4*o[c];a[r]=n[h],a[r+1]=n[h+1],a[r+2]=n[h+2],a[r+3]=n[h+3],r+=l}return}for(let c=0;c<u;++c){const h=3*o[c];a[r]=n[h],a[r+1]=n[h+1],a[r+2]=n[h+2],a[r+3]=255,r+=l}}}function ol(t,e,i){const{data:r,indices:s}=t,n=e.typedBuffer,o=e.typedBufferStride,a=s.length,l=r[0];i*=o;for(let u=0;u<a;++u)n[i]=l,i+=o}function al(t,e,i,r){wt(Ft,t,e);const s=Math.max(Math.sqrt(Y(Ft)),1e-4);q(Ft,Ft,1/s),i[r++]=Ft[0],i[r++]=Ft[1],i[r++]=Ft[2],i[r++]=s}const Ft=_();function Yr(t,e,i,r,s=1){const n=e.typedBuffer,o=e.typedBufferStride;if(r*=o,s===1)for(let a=0;a<i;++a)n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],n[r+3]=t[3],r+=o;else for(let a=0;a<i;++a)for(let l=0;l<s;++l)n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],n[r+3]=t[3],r+=o}function Zr(t,e,i,r,s,n,o){let a={numItems:0,numVerticesPerItem:0};for(const l of i.fields.keys()){const u=t.get(l),c=u?.indices;if(u&&c)l==="position"&&(a={numItems:1,numVerticesPerItem:c.length}),Kr(l,u,r,s,n,o);else if(l==="olidColor"&&e!=null){const h=t.get("position")?.indices;if(h){const m=h.length;Yr(e,n.getField(l,Xi),m,o)}}}return a}function Kr(t,e,i,r,s,n){switch(t){case"position":{H(e.size===3);const o=s.getField(t,fe);H(!!o,`No buffer view for ${t}`),Wr(e,i,o,n);break}case"normal":{H(e.size===3);const o=s.getField(t,fe);H(!!o,`No buffer view for ${t}`),Gr(e,r,o,n);break}case"normalCompressed":case"profileRight":case"profileUp":{H(e.size===2);const o=s.getField(t,Ki);H(!!o,`No buffer view for ${t}`),Ce(e,o,n);break}case"uv0":{H(e.size===2);const o=s.getField(t,Yn)??s.getField(t,Zn);H(!!o,`No buffer view for ${t}`),Ce(e,o,n);break}case"uvi":{H(e.size===2);const o=s.getField(t,Ki);H(!!o,`No buffer view for ${t}`),Ce(e,o,n);break}case"color":case"symbolColor":{const o=s.getField(t,Xi);H(!!o,`No buffer view for ${t}`),H(e.size===3||e.size===4),Xr(e,e.size,o,n);break}case"colorFeatureAttribute":case"opacityFeatureAttribute":case"sizeFeatureAttribute":{const o=s.getField(t,Zi)??s.getField(t,Zi);H(!!o,`No buffer view for ${t}`),H(e.size===1),ol(e,o,n);break}case"tangent":{H(e.size===4);const o=s.getField(t,Yi);H(!!o,`No buffer view for ${t}`),nl(e,i,o,n);break}case"profileVertexAndNormal":{H(e.size===4);const o=s.getField(t,Xn)??s.getField(t,Yi);H(!!o,`No buffer view for ${t}`),di(e,o,n);break}case"profileAuxData":{H(e.size===3);const o=s.getField(t,Gn)??s.getField(t,fe);H(!!o,`No buffer view for ${t}`),hi(e,o,n);break}}}let ll=class{constructor(t){this.layout=t}elementCount(t){return t.get("position").indices.length}write(t,e,i,r,s,n){return Zr(i,r,this.layout,t,e,s,n)}intersect(t,e,i,r,s,n,o){const a=this.layout.createView(t).getField("position",fe);if(a==null)return;const l=vt(cl,n,s),u=0,c=a.count/3,h=r.options.normalRequired,m=(y,d,w)=>o(y,w,d);Ua(s,l,u,c,a.typedBuffer,a.typedBufferStride,h,m)}};const cl=_();let U=class{constructor(t,e,i,r,s=null){if(this.name=t,this.type=e,this.arraySize=s,this.bind={0:null,1:null,2:null},r)switch(i){case void 0:break;case 0:this.bind[0]=r;break;case 1:this.bind[1]=r;break;case 2:this.bind[2]=r}}equals(t){return this.type===t.type&&this.name===t.name&&this.arraySize===t.arraySize}},Qr=class extends U{constructor(t,e,i){super(t,"float",0,(r,s)=>r.setUniform1f(t,e(s),i))}},gt=class extends U{constructor(t,e,i){super(t,"vec3",2,(r,s,n,o)=>r.setUniform3fv(t,e(s,n,o),i))}},_t=class extends U{constructor(t,e,i){super(t,"vec3",1,(r,s,n)=>r.setUniform3fv(t,e(s,n),i))}},Jr=class extends U{constructor(t,e,i){super(t,"mat3",1,(r,s,n)=>r.setUniformMatrix3fv(t,e(s,n),i))}},ul=class extends U{constructor(t,e,i){super(t,"mat4",1,(r,s,n)=>r.setUniformMatrix4fv(t,e(s,n),i))}},hl=class{constructor(t,e){this._module=t,this._load=e}get(){return this._module}async reload(){return this._module=await this._load(),this._module}},ts=class{constructor(t,e,i){this._context=t,this.locations=i,this._textures=new Map,this.source=Je()?e:null,e.attributeNames.forEach(r=>{i.has(r)||console.error(`Missing VertexAttributeLocation for ${r} used in shader`)}),this._glProgram=t.programCache.acquire(e.generate("vertex",!0),e.generate("fragment",!0),i),this._glProgram.stop=()=>{throw new Error("Wrapped _glProgram used directly")},this.bind=e.generateBind(this),this.bindPass=e.generateBindPass(this),this.bindDraw=e.generateBindDraw(this)}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get hasTransformFeedbackVaryings(){return this._glProgram.hasTransformFeedbackVaryings}get compiled(){return this._glProgram.compiled}setUniform1b(t,e){this._glProgram.setUniform1i(t,e?1:0)}setUniform1i(t,e){this._glProgram.setUniform1i(t,e)}setUniform1f(t,e,i){this._glProgram.setUniform1f(t,e,i)}setUniform2fv(t,e,i){this._glProgram.setUniform2fv(t,e,i)}setUniform3fv(t,e,i){this._glProgram.setUniform3fv(t,e,i)}setUniform4fv(t,e,i){this._glProgram.setUniform4fv(t,e,i)}setUniformMatrix3fv(t,e,i){this._glProgram.setUniformMatrix3fv(t,e,!1,i)}setUniformMatrix4fv(t,e,i){this._glProgram.setUniformMatrix4fv(t,e,!1,i)}setUniformMatrices4fv(t,e,i){this._glProgram.setUniformMatrices4fv(t,e,!1,i)}setUniform1fv(t,e,i){this._glProgram.setUniform1fv(t,e,i)}setUniform1iv(t,e){this._glProgram.setUniform1iv(t,e)}setUniform2iv(t,e){this._glProgram.setUniform2iv(t,e)}setUniform3iv(t,e){this._glProgram.setUniform3iv(t,e)}setUniform4iv(t,e){this._glProgram.setUniform4iv(t,e)}assertCompatibleVertexAttributeLocations(t,e){let i=t.locations;if(e){const r=new Map(i);e.forEach((s,n)=>r.set(n,i.size+s)),i=r}i.size!==this.locations.size&&console.error(`VertexAttributeLocations are incompatible: ${i}, ${this.locations}`),this.locations.forEach((r,s)=>{i.get(s)!==r&&console.error(`VertexAttributeLocations are incompatible: Program has ${s} at position ${r}, VAO has it at position ${i.get(s)}.`)})}stop(){this._textures.clear()}bindTexture(t,e){e?.glName||(Je()&&console.error(`Texture sampler ${t} has no given Texture in ${new Error().stack} `),e=this._context.emptyTexture);const i=this._ensureTextureUnit(t,e);this._context.useProgram(this),this.setUniform1i(t,i.unit),this._context.bindTexture(e,i.unit)}_ensureTextureUnit(t,e){let i=this._textures.get(t);return i==null?(i={texture:e,unit:this._textures.size},this._textures.set(t,i)):i.texture=e,i}};const dl=()=>$e.getLogger("esri.views.3d.webgl.ShaderTechnique");let fl=class{constructor(t,e,i,r){this.primitiveType=kn.TRIANGLES,this.key=e.key,this._program=new ts(t.rctx,i.get().build(e),r),this._pipeline=this.initializePipeline(e),this.reload=async s=>{s&&await i.reload(),this.key.equals(e.key)||dl().warn("Configuration was changed after construction, cannot reload shader.",i),Vi(this._program),this._program=new ts(t.rctx,i.get().build(e),r),this._pipeline=this.initializePipeline(e)}}destroy(){this._program=Vi(this._program),this._pipeline=null}get program(){return this._program}get compiled(){return this.program.compiled}ensureAttributeLocations(t){this.program.assertCompatibleVertexAttributeLocations(t)}getPipeline(t,e){return this._pipeline}initializePipeline(t){return eo({blending:Qi,colorWrite:io})}};function pl(t,e){return va(t)?{buffers:[Bn]}:e??null}function es(){return!!Sn("enable-feature:objectAndLayerId-rendering")}const ml={func:513},vl={func:519},gl={mask:255},_l={mask:0},yl={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},xl={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},bl={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},wl={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};function Sl(t,e){Cl(t,e,new gt("slicePlaneOrigin",(i,r)=>os(e,i,r)),new gt("slicePlaneBasis1",(i,r)=>Pe(e,i,r,r.slicePlane?.basis1)),new gt("slicePlaneBasis2",(i,r)=>Pe(e,i,r,r.slicePlane?.basis2)))}function Ml(t,e){is(t,e,new gt("slicePlaneOrigin",(i,r)=>os(e,i,r)),new gt("slicePlaneBasis1",(i,r)=>Pe(e,i,r,r.slicePlane?.basis1)),new gt("slicePlaneBasis2",(i,r)=>Pe(e,i,r,r.slicePlane?.basis2)))}const Tl=v`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
bool rejectBySlice(vec3 pos) {
return sliceByPlane(pos);
}`;function is(t,e,...i){e.hasSlicePlane?(t.uniforms.add(...i),t.code.add(Tl)):t.code.add("bool rejectBySlice(vec3 pos) { return false; }")}function Cl(t,e,...i){is(t,e,...i),e.hasSlicePlane?t.code.add(`
    void discardBySlice(vec3 pos) {
      if (sliceByPlane(pos)) {
        discard;
      }
    }

    vec4 applySliceOutline(vec4 color, vec3 pos) {
      SliceFactors factors = calculateSliceFactors(pos);

      factors.front /= 2.0 * fwidth(factors.front);
      factors.side0 /= 2.0 * fwidth(factors.side0);
      factors.side1 /= 2.0 * fwidth(factors.side1);
      factors.side2 /= 2.0 * fwidth(factors.side2);
      factors.side3 /= 2.0 * fwidth(factors.side3);

      // return after calling fwidth, to avoid aliasing caused by discontinuities in the input to fwidth
      if (sliceByFactors(factors)) {
        return color;
      }

      float outlineFactor = (1.0 - step(0.5, factors.front))
        * (1.0 - step(0.5, factors.side0))
        * (1.0 - step(0.5, factors.side1))
        * (1.0 - step(0.5, factors.side2))
        * (1.0 - step(0.5, factors.side3));

      return mix(color, vec4(vec3(0.0), color.a), outlineFactor * 0.3);
    }

    vec4 applySlice(vec4 color, vec3 pos) {
      return sliceEnabled() ? applySliceOutline(color, pos) : color;
    }
  `):t.code.add(v`void discardBySlice(vec3 pos) { }
vec4 applySlice(vec4 color, vec3 pos) { return color; }`)}function rs(t,e,i){return t.instancedDoublePrecision?N(Pl,i.camera.viewInverseTransposeMatrix[3],i.camera.viewInverseTransposeMatrix[7],i.camera.viewInverseTransposeMatrix[11]):e.slicePlaneLocalOrigin}function ss(t,e){return t!=null?wt(ze,e.origin,t):e.origin}function ns(t,e,i){return t.hasSliceTranslatedView?e!=null?ve(zl,i.camera.viewMatrix,e):i.camera.viewMatrix:null}function os(t,e,i){if(i.slicePlane==null)return Zt;const r=rs(t,e,i),s=ss(r,i.slicePlane),n=ns(t,r,i);return n!=null?mt(ze,s,n):s}function Pe(t,e,i,r){if(r==null||i.slicePlane==null)return Zt;const s=rs(t,e,i),n=ss(s,i.slicePlane),o=ns(t,s,i);return o!=null?(nt(te,r,n),mt(ze,n,o),mt(te,te,o),wt(te,te,ze)):r}const Pl=_(),ze=_(),te=_(),zl=X();let Oe=class extends U{constructor(t,e,i){super(t,"vec2",0,(r,s)=>r.setUniform2fv(t,e(s),i))}};function Ol(t){t.vertex.uniforms.add(new Oe("nearFar",e=>e.camera.nearFar))}function Al(t){t.vertex.code.add(v`float calculateLinearDepth(vec2 nearFar,float z) {
return (-z - nearFar[0]) / (nearFar[1] - nearFar[0]);
}`)}function El(t){Al(t),t.vertex.code.add(v`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = calculateLinearDepth(nearFar,eye.z);
return proj * eye;
}`),t.vertex.code.add(v`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}function ee(t){t.code.add(v`struct MaskedColor {
vec4 color;
bvec4 mask;
};`)}function Il(t){t.include(ee),t.code.add(v`
    MaskedColor createMaskedFromUInt8NaNColor(vec4 color) {
      return MaskedColor(color * ${v.float(1/254)}, equal(color, vec4(255)));
    }
  `)}function as(t){t.include(ee),t.code.add(v`vec4 maskedColorSelectOrOne(MaskedColor color) {
return vec4(
color.mask.r ? 1.0 : color.color.r,
color.mask.g ? 1.0 : color.color.g,
color.mask.b ? 1.0 : color.color.b,
color.mask.a ? 1.0 : color.color.a
);
}
MaskedColor multiplyMaskedColors(MaskedColor color1, MaskedColor color2) {
vec4 masked1 = maskedColorSelectOrOne(color1);
vec4 masked2 = maskedColorSelectOrOne(color2);
return MaskedColor(masked1 * masked2, bvec4(ivec4(color1.mask) & ivec4(color2.mask)));
}`)}function ls(t){t.include(ee),t.code.add(v`MaskedColor createMaskedFromNaNColor(vec4 color) {
return MaskedColor(color, isnan(color));
}`)}let cs=class extends U{constructor(t,e,i){super(t,"vec3",0,(r,s)=>r.setUniform3fv(t,e(s),i))}},ie=class extends U{constructor(t,e,i){super(t,"mat4",0,(r,s)=>r.setUniformMatrix4fv(t,e(s),i))}},us=class extends U{constructor(t,e,i){super(t,"mat4",2,(r,s,n)=>r.setUniformMatrix4fv(t,e(s,n),i))}};function hs(t,e){e.instancedDoublePrecision?t.constants.add("cameraPosition","vec3",Zt):t.uniforms.add(new gt("cameraPosition",(i,r)=>N(fs,r.camera.viewInverseTransposeMatrix[3]-i.origin[0],r.camera.viewInverseTransposeMatrix[7]-i.origin[1],r.camera.viewInverseTransposeMatrix[11]-i.origin[2])))}function Rl(t,e){if(!e.instancedDoublePrecision)return void t.uniforms.add(new ie("proj",r=>r.camera.projectionMatrix),new us("view",(r,s)=>ve(ds,s.camera.viewMatrix,r.origin)),new gt("localOrigin",r=>r.origin));const i=({camera:r})=>N(fs,r.viewInverseTransposeMatrix[3],r.viewInverseTransposeMatrix[7],r.viewInverseTransposeMatrix[11]);t.uniforms.add(new ie("proj",r=>r.camera.projectionMatrix),new ie("view",r=>ve(ds,r.camera.viewMatrix,i(r))),new cs("localOrigin",r=>i(r)))}const ds=X(),fs=_();function Dl(t){t.uniforms.add(new ie("viewNormal",e=>e.camera.viewInverseTransposeMatrix))}function Fl(t){t.uniforms.add(new Qr("pixelRatio",e=>e.camera.pixelRatio/e.overlayStretch))}function Ll(t,e,i){for(let r=0;r<i;++r)e[2*r]=t[r],e[2*r+1]=t[r]-e[2*r]}function Vl(t,e){const i=t.length;for(let r=0;r<i;++r)qt[0]=t[r],e[r]=qt[0];return e}function Nl(t,e){const i=t.length;for(let r=0;r<i;++r)qt[0]=t[r],qt[1]=t[r]-qt[0],e[r]=qt[1];return e}const qt=new Float32Array(2);let kl=class extends U{constructor(t,e){super(t,"int",1,(i,r,s)=>i.setUniform1i(t,e(r,s)))}};function ps(t,e){switch(e.textureCoordinateType){case 1:return t.attributes.add("uv0","vec2"),t.varyings.add("vuv0","vec2"),void t.vertex.code.add(v`void forwardTextureCoordinates() { vuv0 = uv0; }`);case 2:return t.attributes.add("uv0","vec2"),t.attributes.add("uvRegion","vec4"),t.varyings.add("vuv0","vec2"),t.varyings.add("vuvRegion","vec4"),void t.vertex.code.add(v`void forwardTextureCoordinates() {
vuv0 = uv0;
vuvRegion = uvRegion;
}`);default:Mn(e.textureCoordinateType);case 0:return void t.vertex.code.add(v`void forwardTextureCoordinates() {}`);case 3:return}}function Bl(t,e){e.hasVertexColors?(t.attributes.add("color","vec4"),t.varyings.add("vColor","vec4"),t.vertex.code.add(v`void forwardVertexColor() { vColor = color; }`),t.vertex.code.add(v`
      void forwardNormalizedVertexColor() { vColor = color * ${v.float(1/255)}; }
    `)):t.vertex.code.add(v`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}function ms(t){t.vertex.code.add(v`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`),t.vertex.code.add(v`vec3 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec3 params) {
return vec3(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z
);
}`),t.vertex.code.add(v`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec3 factor) {
return size * clamp(mix(factor.x, 1.0, factor.y), factor.z, 1.0);
}`),t.vertex.code.add(v`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec3 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`),t.vertex.code.add(v`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec3 factor) {
return size * clamp(mix(factor.x, 1.0, factor.y), factor.z, 1.0);
}`),t.vertex.code.add(v`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec3 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)}function Hl(t){t.uniforms.add(new _t("screenSizePerspective",e=>gs(e.screenSizePerspective,e.screenSizePerspectiveMinPixelReferenceSize)))}function vs(t){t.uniforms.add(new _t("screenSizePerspectiveAlignment",e=>gs(e.screenSizePerspectiveAlignment||e.screenSizePerspective,e.screenSizePerspectiveAlignment?null:e.screenSizePerspectiveMinPixelReferenceSize)))}function gs(t,e){const i=e!=null&&t!=null?Math.min(t.minPixelSize/e,1):0;return t?N(_s,t.divisor,t.offset,i):N(_s,0,0,0)}const _s=_();let fi=class extends U{constructor(t,e,i){super(t,"vec4",1,(r,s,n)=>r.setUniform4fv(t,e(s,n),i))}},Ul=class{constructor(t){this.screenLength=Tn(t.screenLength),this.minWorldLength=t.minWorldLength??0,this.maxWorldLength=t.maxWorldLength??1/0}};function jl(t,e){const i=t.vertex;e.hasVerticalOffset?(ys(i),e.hasScreenSizePerspective&&(t.include(ms),vs(i),hs(t.vertex,e)),i.code.add(v`
      vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
        ${e.spherical?v`vec3 worldNormal = normalize(worldPos + localOrigin);`:v`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
        ${e.hasScreenSizePerspective?v`
            float cosAngle = dot(worldNormal, normalize(worldPos - cameraPosition));
            float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:v`
            float verticalOffsetScreenHeight = verticalOffset.x;`}
        // Screen sized offset in world space, used for example for line callouts
        float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
        return worldNormal * worldOffset;
      }

      vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        return worldPos + calculateVerticalOffset(worldPos, localOrigin);
      }
    `)):i.code.add(v`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}const $l=Rt();function ys(t){t.uniforms.add(new fi("verticalOffset",(e,i)=>{const{minWorldLength:r,maxWorldLength:s,screenLength:n}=e.verticalOffset,o=Math.tan(.5*i.camera.fovY)/(.5*i.camera.fullViewport[3]),a=i.camera.pixelRatio||1;return ge($l,n*a,o,r,s)}))}function ql(t,e){if(e.output!==10)return t.vertex.code.add(v`void forwardObjectAndLayerIdColor() {}`),void t.fragment.code.add(v`void outputObjectAndLayerIdColor() {}`);const i=e.instanced;t.varyings.add("objectAndLayerIdColorVarying","vec4");const r=i?"instanceOlidColor":"olidColor";t.attributes.add(r,"vec4"),t.vertex.code.add(v`
    void forwardObjectAndLayerIdColor() {
      objectAndLayerIdColorVarying = ${r} * 0.003921568627451;
    }`),t.fragment.code.add(v`void outputObjectAndLayerIdColor() {
fragColor = objectAndLayerIdColorVarying;
}`)}function xs(t){const{fragment:e}=t;e.code.add(v`uint readChannelBits(uint channel, int highlightLevel) {
int llc = (highlightLevel & 3) << 1;
return (channel >> llc) & 3u;
}
uint readChannel(uvec2 texel, int highlightLevel) {
int lic = (highlightLevel >> 2) & 1;
return texel[lic];
}
uint readLevelBits(uvec2 texel, int highlightLevel) {
return readChannelBits(readChannel(texel, highlightLevel), highlightLevel);
}`)}let Wl=class extends U{constructor(t,e){super(t,"ivec2",0,(i,r)=>i.setUniform2iv(t,e(r)))}},bs=class extends U{constructor(t,e){super(t,"int",0,(i,r)=>i.setUniform1i(t,e(r)))}},pi=class extends U{constructor(t,e){super(t,"sampler2D",0,(i,r)=>i.bindTexture(t,e(r)))}},Gl=class extends U{constructor(t,e){super(t,"usampler2D",0,(i,r)=>i.bindTexture(t,e(r)))}};function ws(t,e){const{fragment:i}=t,{output:r,draped:s,hasHighlightMixTexture:n}=e;r===9?(i.uniforms.add(new bs("highlightLevel",o=>o.highlightLevel??0),new Wl("highlightMixOrigin",o=>o.highlightMixOrigin)),t.outputs.add("fragHighlight","uvec2",0),t.include(xs),n?i.uniforms.add(new Gl("highlightMixTexture",o=>o.highlightMixTexture)).code.add(v`uvec2 getAccumulatedHighlight() {
return texelFetch(highlightMixTexture, ivec2(gl_FragCoord.xy) - highlightMixOrigin, 0).rg;
}
void outputHighlight(bool occluded) {
if (highlightLevel == 0) {
uint bits = occluded ? 3u : 1u;
fragHighlight = uvec2(bits, 0);
} else {
int ll = (highlightLevel & 3) << 1;
int li = (highlightLevel >> 2) & 3;
uint bits;
if (occluded) {
bits = 3u << ll;
} else {
bits = 1u << ll;
}
uvec2 combinedHighlight = getAccumulatedHighlight();
combinedHighlight[li] |= bits;
fragHighlight = combinedHighlight;
}
}`):i.code.add(v`void outputHighlight(bool occluded) {
uint bits = occluded ? 3u : 1u;
fragHighlight = uvec2(bits, 0);
}`),s?i.code.add(v`bool isHighlightOccluded() {
return false;
}`):i.uniforms.add(new pi("depthTexture",o=>o.mainDepth)).code.add(v`bool isHighlightOccluded() {
float sceneDepth = texelFetch(depthTexture, ivec2(gl_FragCoord.xy), 0).x;
return gl_FragCoord.z > sceneDepth + 5e-7;
}`),i.code.add(v`void calculateOcclusionAndOutputHighlight() {
outputHighlight(isHighlightOccluded());
}`)):i.code.add(v`void calculateOcclusionAndOutputHighlight() {}`)}let Ss=class extends U{constructor(t,e,i,r){super(t,"vec4",1,(s,n,o)=>s.setUniform4fv(t,e(n,o),r),i)}},Ms=class extends U{constructor(t,e,i,r){super(t,"float",1,(s,n,o)=>s.setUniform1fv(t,e(n,o),r),i)}},mi=class{constructor(t){this.field=t}},Xl=class extends mi{constructor(t){super(t),this.minSize=[0,0,0],this.maxSize=[0,0,0],this.offset=[0,0,0],this.factor=[0,0,0],this.type=[0,0,0],this.fallback=[0,0,0]}},Ts=class extends mi{constructor(t){super(t),this.colors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.values=[0,0,0,0,0,0,0,0],this.fallback=[0,0,0,0]}};class Yl extends mi{constructor(e,i=0){super(e),this.fallback=i,this.values=[0,0,0,0,0,0,0,0],this.opacityValues=[0,0,0,0,0,0,0,0]}}class Zl{}function re(t){return t!=null}function Kl(t,e,i,r=X()){const s=t||0,n=e||0,o=i||0;return s!==0&&oo(r,r,-s/180*Math.PI),n!==0&&er(r,r,n/180*Math.PI),o!==0&&ao(r,r,o/180*Math.PI),r}function Pt(t,e,i,r,s){const n=t.minSize,o=t.maxSize;if(t.useSymbolValue){const a=r.symbolSize[i];return e.minSize[i]=a,e.maxSize[i]=a,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=1,!0}if(re(t.field))return re(t.stops)?t.stops.length===2&&kt(t.stops[0].size)&&kt(t.stops[1].size)?(Cs(t.stops[0].size,t.stops[1].size,t.stops[0].value,t.stops[1].value,e,i),e.type[i]=1,!0):!1:kt(n)&&kt(o)&&re(t.minDataValue)&&re(t.maxDataValue)?(Cs(n,o,t.minDataValue,t.maxDataValue,e,i),e.type[i]=1,!0):t.valueUnit==="unknown"?!1:or[t.valueUnit]!=null?(e.minSize[i]=-1/0,e.maxSize[i]=1/0,e.offset[i]=0,e.factor[i]=1/or[t.valueUnit],e.type[i]=1,!0):!1;if(!re(t.field)){if(t.stops?.[0]&&kt(t.stops[0].size))return e.minSize[i]=t.stops[0].size,e.maxSize[i]=t.stops[0].size,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=1,!0;if(kt(n))return e.minSize[i]=n,e.maxSize[i]=n,e.offset[i]=n,e.factor[i]=0,e.type[i]=1,!0}return!1}function Cs(t,e,i,r,s,n){const o=Math.abs(r-i)>0?(e-t)/(r-i):0;s.minSize[n]=o>0?t:e,s.maxSize[n]=o>0?e:t,s.offset[n]=t-i*o,s.factor[n]=o}function Ql(t,e,i,r){if(t.normalizationField||t.valueRepresentation||!Pn(t.field))return null;if(e.size){if(t.field)if(e.size.field){if(t.field!==e.size.field)return null}else e.size.field=t.field}else e.size=new Xl(t.field),$(e.size.fallback,i.fallbackSize);let s;switch(t.axis){case"width":return s=Pt(t,e.size,0,i),s?e:null;case"height":return s=Pt(t,e.size,2,i),s?e:null;case"depth":return s=Pt(t,e.size,1,i),s?e:null;case"width-and-depth":return s=Pt(t,e.size,0,i),s&&Pt(t,e.size,1,i),s?e:null;case null:case void 0:case"all":return s=Pt(t,e.size,0,i),s=s&&Pt(t,e.size,1,i),s=s&&Pt(t,e.size,2,i),s?e:null;default:return`${t.axis}`,null}}function Jl(t,e,i){for(let s=0;s<3;++s){let n=e.unitInMeters;t.type[s]===1&&(n*=e.modelSize[s],t.type[s]=2),t.minSize[s]=t.minSize[s]/n,t.maxSize[s]=t.maxSize[s]/n,t.offset[s]=t.offset[s]/n,t.factor[s]=t.factor[s]/n}let r;if(t.type[0]!==0)r=0;else if(t.type[1]!==0)r=1;else{if(t.type[2]===0)return!1;r=2}for(let s=0;s<3;++s)t.type[s]===0&&(t.minSize[s]=t.minSize[r],t.maxSize[s]=t.maxSize[r],t.offset[s]=t.offset[r],t.factor[s]=t.factor[r],t.type[s]=t.type[r]);return!0}function Ps(t,e,i){t[4*e]=i.r/255,t[4*e+1]=i.g/255,t[4*e+2]=i.b/255,t[4*e+3]=i.a}function tc(t,e,i,r){if(t.normalizationField)return null;if(We(t.field)){if(!t.stops)return null;{if(t.stops.length>8)return null;e.color=new Ts(t.field);const s=t.stops;for(let n=0;n<8;++n){const o=s[Math.min(n,s.length-1)];e.color.values[n]=o.value,Ps(e.color.colors,n,o.color)}Ht(e.color.fallback,i.fallbackColor)}}else{if(!(t.stops&&t.stops.length>=0))return null;{const s=t.stops&&t.stops.length>=0&&t.stops[0].color;e.color=new Ts(null);for(let n=0;n<8;n++)e.color.values[n]=1/0,Ps(e.color.colors,n,s);Ht(e.color.fallback,i.fallbackColor)}}return e}function ec(t,e,i,r){if(t.normalizationField)return null;if(We(t.field)){if(!t.stops)return null;{if(t.stops.length>8)return null;e.opacity=new Yl(t.field,i.fallbackColor[3]);const s=t.stops;for(let n=0;n<8;++n){const o=s[Math.min(n,s.length-1)];e.opacity.values[n]=o.value,e.opacity.opacityValues[n]=o.opacity}}}else{if(!(t.stops&&t.stops.length>=0))return null;{const s=t.stops&&t.stops.length>=0?t.stops[0].opacity:0;e.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0],fallback:i.fallbackColor[3]};for(let n=0;n<8;n++)e.opacity.values[n]=1/0,e.opacity.opacityValues[n]=s}}return e}function vi(t,e,i){const r=i===2&&t.rotationType==="arithmetic";e.offset[i]=r?90:0,e.factor[i]=r?-1:1,e.type[i]=1}function ic(t,e,i){if(!We(t.field))return null;if(e.rotation){if(t.field)if(e.rotation.field){if(t.field!==e.rotation.field)return null}else e.rotation.field=t.field}else e.rotation={field:t.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(t.axis){case"tilt":return vi(t,e.rotation,0),e;case"roll":return vi(t,e.rotation,1),e;case null:case void 0:case"heading":return vi(t,e.rotation,2),e;default:return`${t.axis}`,null}}class rc{constructor({supports:e,modelSize:i,symbolSize:r,unitInMeters:s,anchor:n,scale:o,rotation:a,fallbackColor:l,fallbackSize:u}){this.supports=e,this.modelSize=i??ue(),this.symbolSize=r??ue(),this.unitInMeters=s??1,this.anchor=n??Kt(),this.scale=o??ue(),this.rotation=a??Kt(),this.fallbackColor=l??vo(),this.fallbackSize=u??ue()}}function zs(t,e,i){if(!t)return null;const r=t.reduce((s,n)=>{if(!s)return s;if(n.valueExpression)return null;switch(n.type){case"size":return e.supports.size?Ql(n,s,e,i):s;case"color":return e.supports.color?tc(n,s,e):s;case"opacity":return e.supports.opacity?ec(n,s,e):null;case"rotation":return e.supports.rotation?ic(n,s,i):s;default:return null}},new Zl);return!(t.length>0&&r)||r.size||r.color||r.opacity||r.rotation?r?.size&&!Jl(r.size,e)?null:r:null}class sc{constructor(e,i,r){this.visualVariables=e,this.materialParameters=i,this.requiresShaderTransformation=r}}function nc(t,e){if(!t||es()||wr.TESTS_DISABLE_FAST_UPDATES)return null;const i=zs(t.visualVariables,e);return i?new sc(i,As(i,e),!!i.size):null}function oc(t,e,i){if(!e||!t)return!1;const r=t.visualVariables,s=zs(e.visualVariables,i);return!!s&&!!(Ae(r.size,s.size,"size")&&Ae(r.color,s.color,"color")&&Ae(r.rotation,s.rotation,"rotation")&&Ae(r.opacity,s.opacity,"opacity"))&&(t.visualVariables=s,t.materialParameters=As(s,i),t.requiresShaderTransformation=!!s.size,!0)}function Ae(t,e,i){if(!!t!=!!e||t&&t.field!==e?.field)return!1;if(t&&i==="rotation"){const r=t,s=e;for(let n=0;n<3;n++)if(r.type[n]!==s.type[n]||r.offset[n]!==s.offset[n]||r.factor[n]!==s.factor[n])return!1}return!0}class Os extends Qt{constructor(e){super(),this.vvSize=e?.size??null,this.vvColor=e?.color??null,this.vvOpacity=e?.opacity??null}get hasVVSize(){return!!this.vvSize}get hasVVColor(){return!!this.vvColor}get hasVVOpacity(){return!!this.vvOpacity}}function As(t,e){const i=new Os(t);return i.vvSize&&(i.vvSymbolAnchor=e.anchor,no(se),Kl(e.rotation[2],e.rotation[0],e.rotation[1],se),i.vvSymbolRotationMatrix=i.vvSymbolRotationMatrix||Li(),Cn(i.vvSymbolRotationMatrix,se)),i}function ac(t,e,i){if(!t.vvSize)return i;Bt(zt,i);const r=t.vvSymbolRotationMatrix;return ro(se,r[0],r[1],r[2],0,r[3],r[4],r[5],0,r[6],r[7],r[8],0,0,0,0,1),me(zt,zt,se),Es(Is,t,e),so(zt,zt,Is),ve(zt,zt,t.vvSymbolAnchor),zt}function Es(t,e,i){if(!e.vvSize)return N(t,1,1,1),t;if(Number.isNaN(i[0]))return $(t,e.vvSize.fallback);for(let r=0;r<3;++r){const s=e.vvSize.offset[r]+i[0]*e.vvSize.factor[r];t[r]=Yt(s,e.vvSize.minSize[r],e.vvSize.maxSize[r])}return t}function lc(t,e){const i=t==null?0:e.attributes[t];return typeof i=="number"&&isFinite(i)?i:NaN}const zt=X(),Is=_(),se=X();let cc=class extends Os{constructor(){super(...arguments),this.renderOccluded=1,this.isDecoration=!1}};const Ee=8;function uc(t,e){const{vertex:i,attributes:r}=t;e.hasVVInstancing&&(e.hasVVSize||e.hasVVColor)&&r.add("instanceFeatureAttribute","vec4"),e.hasVVSize?(i.uniforms.add(new _t("vvSizeMinSize",s=>s.vvSize.minSize)),i.uniforms.add(new _t("vvSizeMaxSize",s=>s.vvSize.maxSize)),i.uniforms.add(new _t("vvSizeOffset",s=>s.vvSize.offset)),i.uniforms.add(new _t("vvSizeFactor",s=>s.vvSize.factor)),i.uniforms.add(new _t("vvSizeFallback",s=>s.vvSize.fallback)),i.uniforms.add(new Jr("vvSymbolRotationMatrix",s=>s.vvSymbolRotationMatrix)),i.uniforms.add(new _t("vvSymbolAnchor",s=>s.vvSymbolAnchor)),i.code.add(v`vec3 vvScale(vec4 _featureAttribute) {
if (isnan(_featureAttribute.x)) {
return vvSizeFallback;
}
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),i.code.add(v`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 scale = max(vvScale(_featureAttribute), eps);
        return vec4(vvSymbolRotationMatrix * _normal / scale, 1.0);
      }

      ${e.hasVVInstancing?v`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):i.code.add(v`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),t.vertex.include(ee),e.hasVVColor?(i.constants.add("vvColorNumber","int",Ee),i.uniforms.add(new Ms("vvColorValues",s=>s.vvColor.values,Ee),new Ss("vvColorColors",s=>s.vvColor.colors,Ee),new fi("vvColorFallback",s=>s.vvColor.fallback,{supportsNaN:!0})),e.hasVVInstancing&&(t.vertex.include(as),t.vertex.include(ls)),i.code.add(v`
      vec4 interpolateVVColor(float value) {
        if (isnan(value)) {
          return vvColorFallback;
        }

        if (value <= vvColorValues[0]) {
          return vvColorColors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (vvColorValues[i] >= value) {
            float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);
            return mix(vvColorColors[i-1], vvColorColors[i], f);
          }
        }
        return vvColorColors[vvColorNumber - 1];
      }

      vec4 vvGetColor(vec4 featureAttribute) {
        return interpolateVVColor(featureAttribute.y);
      }

      ${e.hasVVInstancing?v`
            vec4 vvColor() {
              return vvGetColor(instanceFeatureAttribute);
            }

            MaskedColor applyVVColor(MaskedColor color) {
              return multiplyMaskedColors(color, createMaskedFromNaNColor(vvColor()));
            }
            `:v`
            vec4 vvColor() {
              return vec4(1.0);
            }

            MaskedColor applyVVColor(MaskedColor color) {
              return color;
            }
            `}
    `)):i.code.add(v`vec4 vvColor() {
return vec4(1.0);
}
MaskedColor applyVVColor(MaskedColor color) {
return color;
}`)}let hc=class extends U{constructor(t,e,i){super(t,"float",2,(r,s,n)=>r.setUniform1f(t,e(s,n),i))}},Rs=class extends U{constructor(t,e,i){super(t,"float",1,(r,s,n)=>r.setUniform1f(t,e(s,n),i))}};const Ds=1/255.5;let Fs=class extends U{constructor(t,e){super(t,"sampler2D",1,(i,r,s)=>i.bindTexture(t,e(r,s)))}};function dc(t){t.fragment.code.add(v`vec4 textureAtlasLookup(sampler2D tex, vec2 textureCoordinates, vec4 atlasRegion) {
vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;
vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;
float maxdUV = 0.125;
vec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
vec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
return textureGrad(tex, uvAtlas, dUVdx, dUVdy);
}`)}function Ls(t,e){const{textureCoordinateType:i}=e;if(i===0||i===3)return;t.include(ps,e);const r=i===2;r&&t.include(dc),t.fragment.code.add(v`
    vec4 textureLookup(sampler2D tex, vec2 uv) {
      return ${r?"textureAtlasLookup(tex, uv, vuvRegion)":"texture(tex, uv)"};
    }
  `)}let fc=class extends U{constructor(t,e,i){super(t,"vec2",1,(r,s,n)=>r.setUniform2fv(t,e(s,n),i))}},Vs=class extends U{constructor(t,e){super(t,"sampler2D",2,(i,r,s)=>i.bindTexture(t,e(r,s)))}};function pc(t,e,i){return 2*Math.atan(Math.sqrt(e*e+i*i)*Math.tan(.5*t)/e)}function mc(t,e,i){return 2*Math.atan(Math.sqrt(e*e+i*i)*Math.tan(.5*t)/i)}function vc(t,e,i){return 2*Math.atan(e*Math.tan(.5*t)/Math.sqrt(e*e+i*i))}function gc(t,e,i){return 2*Math.atan(i*Math.tan(.5*t)/Math.sqrt(e*e+i*i))}var gi;let P=gi=class extends Ue{constructor(t){super(t),this._ray=pr(),this._viewport=nr(0,0,1,1),this._padding=nr(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=lr(1,1e3),this._viewDirty=!0,this._viewMatrix=X(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=X(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=X(),this._frustumDirty=!0,this._frustum=ur(),this._fullViewport=Rt(),this._pixelRatio=1,this.row=0,this.column=0,this._rows=1,this._columns=1,this._center=_(),this._up=_(),this.relativeElevation=0}get pixelRatio(){return this._pixelRatio}set pixelRatio(t){this._pixelRatio=t>0?t:1}get rows(){return this._rows}set rows(t){this._rows=Math.max(1,t)}get columns(){return this._columns}set columns(t){this._columns=Math.max(1,t)}get eye(){return this._ray.origin}set eye(t){this._compareAndSetView(t,this._ray.origin)}get center(){return this._center}set center(t){this._compareAndSetView(t,this._center,"_center")}get ray(){return wt(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(t){this._compareAndSetView(t,this._up,"_up")}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(t){Bt(this._viewMatrix,t),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),N(_(),-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10])}get viewUp(){return this._ensureViewClean(),N(_(),this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9])}get viewRight(){return this._ensureViewClean(),N(_(),this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8])}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(t){this._nearFar[0]!==t&&(this._nearFar[0]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get far(){return this._nearFar[1]}set far(t){this._nearFar[1]!==t&&(this._nearFar[1]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get viewport(){return this._viewport}set viewport(t){this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]}get screenViewport(){if(this.pixelRatio===1)return this._viewport;const t=ir(Rt(),this._viewport,1/this.pixelRatio),e=this._get("screenViewport");return e&&rr(t,e)?e:t}get screenPadding(){if(this.pixelRatio===1)return this._padding;const t=ir(Rt(),this._padding,1/this.pixelRatio),e=this._get("screenPadding");return e&&rr(t,e)?e:t}get x(){return this._viewport[0]}set x(t){t+=this._padding[3],this._viewport[0]!==t&&(this._viewport[0]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get y(){return this._viewport[1]}set y(t){t+=this._padding[2],this._viewport[1]!==t&&(this._viewport[1]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get width(){return this._viewport[2]}set width(t){this._viewport[2]!==t&&(this._viewport[2]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get height(){return this._viewport[3]}set height(t){this._viewport[3]!==t&&(this._viewport[3]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get fullWidth(){return this._viewport[2]+this._padding[1]+this._padding[3]}set fullWidth(t){this.width=t-(this._padding[1]+this._padding[3])}get fullHeight(){return this._viewport[3]+this._padding[0]+this._padding[2]}set fullHeight(t){this.height=t-(this._padding[0]+this._padding[2])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get _aspect(){return this.width/this.height}get padding(){return this._padding}set padding(t){ii(this._padding,t)||(this._viewport[0]+=t[3]-this._padding[3],this._viewport[1]+=t[2]-this._padding[2],this._viewport[2]-=t[1]+t[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=t[0]+t[2]-(this._padding[0]+this._padding[2]),Ht(this._padding,t),this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_padding"),this.notifyChange("_viewport"))}get viewProjectionMatrix(){return this._viewProjectionDirty&&(me(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){return this._projectionMatrixInternal}get inverseProjectionMatrix(){return pe(X(),this.projectionMatrix)||this._get("inverseProjectionMatrix")||X()}get fov(){return this._fov}set fov(t){this._fov=t,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return vc(this._fov,this.width,this.height)}set fovX(t){this._fov=pc(t,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return gc(this._fov,this.width,this.height)}set fovY(t){this._fov=mc(t,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return $i(this.center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(pe(this._viewInverseTransposeMatrix,this.viewMatrix),ei(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(t){const{near:e,far:i}=this;return 2*e*i/(i+e-t*(i-e))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this.pixelRatio}get aboveGround(){return this.relativeElevation!=null&&this.relativeElevation>=0}get _projectionMatrixInternal(){const t=this.width,e=this.height,i=this.near*Math.tan(this.fovY/2)*2,r=i*this._aspect,s=i/this.rows,n=r/this.columns,o=-r/2+this.column*n,a=o+n,l=-i/2+this.row*s,u=l+s,c=lo(X(),o*(1+2*this._padding[3]/t),a*(1+2*this._padding[1]/t),l*(1+2*this._padding[2]/e),u*(1+2*this._padding[0]/e),this.near,this.far),h=this._get("projectionMatrix");return h&&co(h,c)?h:c}copyFrom(t){$(this._ray.origin,t.eye),this.center=t.center,this.up=t.up,Ht(this._viewport,t.viewport),this.notifyChange("_viewport"),Ht(this._padding,t.padding),this.notifyChange("_padding"),zn(this._nearFar,t.nearFar),this.notifyChange("_nearFar"),this._fov=t.fov,this.row=t.row,this.column=t.column,this.rows=t.rows,this.columns=t.columns,this.relativeElevation=t.relativeElevation;const e=t;return this._viewDirty=e._viewDirty,this._viewDirty||(Bt(this._viewMatrix,t.viewMatrix),this.notifyChange("_viewMatrix")),this._viewProjectionDirty=!0,this._frustumDirty=e._frustumDirty,this._frustumDirty||(go(this._frustum,t.frustum),this._frustumDirty=!1),e._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(Bt(this._viewInverseTransposeMatrix,t.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),Ht(this._fullViewport,t.fullViewport),this.pixelRatio=t.pixelRatio,this}copyViewFrom(t){this.eye=t.eye,this.center=t.center,this.up=t.up,this.fov=t.fov}clone(){return new gi().copyFrom(this)}equals(t){return It(this.eye,t.eye)&&It(this.center,t.center)&&It(this.up,t.up)&&ii(this._viewport,t.viewport)&&ii(this._padding,t.padding)&&On(this.nearFar,t.nearFar)&&this._fov===t.fov&&this.pixelRatio===t.pixelRatio&&this.relativeElevation===t.relativeElevation&&this.row===t.row&&this.column===t.column&&this.rows===t.rows&&this.columns===t.columns}almostEquals(t){const e=Math.max(1,1/this.pixelRatio,1/t.pixelRatio);if(Math.abs(t.fov-this._fov)>=.001||sr(t.screenPadding,this.screenPadding)>=e||sr(this.screenViewport,t.screenViewport)>=e||this.row!==t.row||this.column!==t.column||this.rows!==t.rows||this.columns!==t.columns)return!1;vt(W,t.eye,t.center),vt(yt,this.eye,this.center);const i=ht(W,yt),r=qi(W),s=qi(yt),n=5e-4;return i*i>=(1-1e-10)*r*s&&ti(t.eye,this.eye)<Math.max(r,s)*n*n}computeRenderPixelSizeAt(t){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(t))}computeRenderPixelSizeAtDist(t){return t*this.perRenderPixelRatio}computeScreenPixelSizeAt(t){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(t))}_viewDirectionDistance(t){return Math.abs(Po(this.viewForward,wt(W,t,this.eye)))}computeScreenPixelSizeAtDist(t){return t*this.perScreenPixelRatio}computeDistanceFromRadius(t,e){return t/Math.tan(Math.min(this.fovX,this.fovY)/(2*(e||1)))}getScreenCenter(t=An()){return t[0]=(this.padding[3]+this.width/2)/this.pixelRatio,t[1]=(this.padding[0]+this.height/2)/this.pixelRatio,t}getRenderCenter(t,e=.5,i=.5){return t[0]=this.padding[3]+this.width*e,t[1]=this.padding[2]+this.height*i,t[2]=.5,t}setGLViewport(t){const e=this.viewport,i=this.padding;t.setViewport(e[0]-i[3],e[1]-i[2],e[2]+i[1]+i[3],e[3]+i[0]+i[2])}applyProjection(t,e){t!==R&&$(R,t),R[3]=1,_e(R,R,this.projectionMatrix);const i=Math.abs(R[3]);q(R,R,1/i);const r=this.fullViewport;e[0]=et(0,r[0]+r[2],.5+.5*R[0]),e[1]=et(0,r[1]+r[3],.5+.5*R[1]),e[2]=.5*(R[2]+1),e[3]=i}unapplyProjection(t,e){const i=this.fullViewport;R[0]=(t[0]/(i[0]+i[2])*2-1)*t[3],R[1]=(t[1]/(i[1]+i[3])*2-1)*t[3],R[2]=(2*t[2]-1)*t[3],R[3]=t[3],this.inverseProjectionMatrix!=null&&(_e(R,R,this.inverseProjectionMatrix),e[0]=R[0],e[1]=R[1],e[2]=R[2])}projectToScreen(t,e){return this.projectToRenderScreen(t,_i),this.renderToScreen(_i,e),e}projectToRenderScreen(t,e){if(R[0]=t[0],R[1]=t[1],R[2]=t[2],R[3]=1,_e(R,R,this.viewProjectionMatrix),R[3]===0)return null;const i=R;q(i,i,1/Math.abs(R[3]));const r=this.fullViewport,s=et(0,r[0]+r[2],.5+.5*i[0]),n=et(0,r[1]+r[3],.5+.5*i[1]);return"x"in e?(e.x=s,e.y=n):(e[0]=s,e[1]=n,e.length>2&&(e[2]=.5*(i[2]+1))),e}unprojectFromScreen(t,e){return this.unprojectFromRenderScreen(this.screenToRender(t,_i),e)}unprojectFromRenderScreen(t,e){if(me(Ie,this.projectionMatrix,this.viewMatrix),!pe(Ie,Ie))return null;const i=this.fullViewport;return R[0]=2*(t[0]-i[0])/i[2]-1,R[1]=2*(t[1]-i[1])/i[3]-1,R[2]=2*t[2]-1,R[3]=1,_e(R,R,Ie),R[3]===0?null:(e[0]=R[0]/R[3],e[1]=R[1]/R[3],e[2]=R[2]/R[3],e)}constrainWindowSize(t,e,i,r){const s=t*this.pixelRatio,n=e*this.pixelRatio,o=Math.max(s-i/2,0),a=Math.max(this.fullHeight-n-r/2,0),l=-Math.min(s-i/2,0),u=-Math.min(this.fullHeight-n-r/2,0),c=i-l- -Math.min(this.fullWidth-s-i/2,0),h=r-u- -Math.min(n-r/2,0);return[Math.round(o),Math.round(a),Math.round(c),Math.round(h)]}computeUp(t){t===1?this._computeUpGlobal():this._computeUpLocal()}screenToRender(t,e){const i=t[0]*this.pixelRatio,r=this.fullHeight-t[1]*this.pixelRatio;return e[0]=i,e[1]=r,e}renderToScreen(t,e){const i=t[0]/this.pixelRatio,r=(this.fullHeight-t[1])/this.pixelRatio;e[0]=i,e[1]=r}_computeUpGlobal(){wt(W,this.center,this.eye);const t=Y(this.center);t<1?It(this._up,Ni)&&($(this._up,Ni),this._markViewDirty(),this.notifyChange("_up")):Math.abs(ht(W,this.center))>.9999*Y(W)*t||(ut(yt,W,this.center),ut(yt,yt,W),xt(yt,yt),It(this._up,yt)||($(this._up,yt),this.notifyChange("_up"),this._markViewDirty()))}_computeUpLocal(){Wi(W,this.eye,this.center),Math.abs(W[2])<=.9999&&(q(W,W,W[2]),N(W,-W[0],-W[1],1-W[2]),xt(W,W),It(this._up,W)||($(this._up,W),this.notifyChange("_up"),this._markViewDirty()))}_compareAndSetView(t,e,i=""){typeof t[0]=="number"&&isFinite(t[0])&&typeof t[1]=="number"&&isFinite(t[1])&&typeof t[2]=="number"&&isFinite(t[2])?It(t,e)||($(e,t),this._markViewDirty(),i.length&&this.notifyChange(i)):$e.getLogger("esri.views.3d.webgl-engine.lib.RenderCamera").warn("RenderCamera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(hr(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(uo(this._viewMatrix,this.eye,this.center,this.up),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};f([p()],P.prototype,"_viewport",void 0),f([p()],P.prototype,"_padding",void 0),f([p()],P.prototype,"_fov",void 0),f([p()],P.prototype,"_nearFar",void 0),f([p()],P.prototype,"_viewDirty",void 0),f([p()],P.prototype,"_viewMatrix",void 0),f([p()],P.prototype,"_pixelRatio",void 0),f([p()],P.prototype,"pixelRatio",null),f([p()],P.prototype,"row",void 0),f([p()],P.prototype,"column",void 0),f([p()],P.prototype,"_rows",void 0),f([p()],P.prototype,"rows",null),f([p()],P.prototype,"_columns",void 0),f([p()],P.prototype,"columns",null),f([p()],P.prototype,"eye",null),f([p()],P.prototype,"center",null),f([p()],P.prototype,"_center",void 0),f([p()],P.prototype,"up",null),f([p()],P.prototype,"_up",void 0),f([p()],P.prototype,"viewMatrix",null),f([p({readOnly:!0})],P.prototype,"viewForward",null),f([p({readOnly:!0})],P.prototype,"viewUp",null),f([p({readOnly:!0})],P.prototype,"viewRight",null),f([p({readOnly:!0})],P.prototype,"nearFar",null),f([p()],P.prototype,"near",null),f([p()],P.prototype,"far",null),f([p()],P.prototype,"viewport",null),f([p({readOnly:!0})],P.prototype,"screenViewport",null),f([p({readOnly:!0})],P.prototype,"screenPadding",null),f([p()],P.prototype,"x",null),f([p()],P.prototype,"y",null),f([p()],P.prototype,"width",null),f([p()],P.prototype,"height",null),f([p()],P.prototype,"fullWidth",null),f([p()],P.prototype,"fullHeight",null),f([p({readOnly:!0})],P.prototype,"_aspect",null),f([p()],P.prototype,"padding",null),f([p({readOnly:!0})],P.prototype,"projectionMatrix",null),f([p({readOnly:!0})],P.prototype,"inverseProjectionMatrix",null),f([p()],P.prototype,"fov",null),f([p()],P.prototype,"fovX",null),f([p()],P.prototype,"fovY",null),f([p()],P.prototype,"viewInverseTransposeMatrix",null),f([p({readOnly:!0})],P.prototype,"_projectionMatrixInternal",null),f([p()],P.prototype,"relativeElevation",void 0),P=gi=f([je("esri.views.3d.webgl.RenderCamera")],P);const _c=P,R=Rt(),Ie=X(),W=_(),yt=_(),_i=En();let yc=class Oi{constructor(e=1/0,i=-1/0){this.near=e,this.far=i}set(e,i){this.near=e,this.far=i}union(e){e!=null&&(this.near=Math.min(this.near,e.near),this.far=Math.max(this.far,e.far))}within(e){return this.near<=e&&e<=this.far}equals(e){return this.near===e.near&&this.far===e.far}static{this.Zero=new Oi(0,0)}static{this.Infinite=new Oi}};function xc(t,e){const i=[],r=[];return Re(i,t,e,0),Re(r,i,e,1),Re(i,r,e,2),Re(r,i,e,3),r}function Re(t,e,i,r){const s=bc(i,r);if(t.length=0,e.length){s(De,e[0],e[0])===1&&ne(t,e[0]);for(let n=0;n<e.length;n++){const o=e[n===e.length-1?0:n+1];switch(s(De,e[n],o)){case 1:ne(t,o);break;case 3:ne(t,cr(De));break;case 2:ne(t,cr(De)),ne(t,o)}}}}function ne(t,e){t.length!==0&&In(t.at(-1),e)||t.push(e)}function bc(t,e){const i=e===0||e===2?0:1,r=t[e],s=e===0||e===1?1:-1,n=i===0?1:0;return(o,a,l)=>{if(a[i]<r&&l[i]<r)return s===1?0:1;if(a[i]>r&&l[i]>r)return s===1?1:0;const u=(l[n]-a[n])/(l[i]-a[i]),c=a[n]+u*(r-a[i]);return o[i]=r,o[n]=c,(a[i]<r?1:-1)*s>0?2:3}}const De=ri(),wc=_(),Fe=_();function Ns(){return{direction:_(),up:_()}}function ks(t,e,i,r,s){let n=xt(wc,t),o=ht(n,r);const a=o>0;o=Math.abs(o),o>.99&&(o=Math.abs(ht(e,r)),o<.99?($(n,e),a&&q(n,n,-1)):n=null);let l=0;if(n){q(Fe,r,ht(r,n)),wt(n,n,Fe);const c=ht(n,s)/(Y(n)*Y(s));ut(Fe,n,s),l=(ht(Fe,r)>0?1:-1)*Et(Ge(c))}const u=Et(Ge(-ht(r,t)/Y(t)));return i?(i.heading=l,i.tilt=u,i):{heading:l,tilt:u}}function Bs(t,e,i,r){wt(Hs,i,e),Ro(r,Ao(e,Hs),t)||t===i||$(t,i)}const Hs=_(),Us=Z(0,1,0),js=Z(0,0,1),oe=X(),Mt=_(),Tt=_();function $s(t,e,i,r=Ns()){const{direction:s,up:n}=r;return ho(oe,-st(e)),er(oe,oe,st(i)),mt(s,js,oe),q(s,s,-1),mt(n,Us,oe),r}function Sc(t,e,i,r){return ks(e,i,r,js,Us)}function Mc(t,e,i,r){const s=$s(t,i,r),n=_();return q(n,s.direction,-e),nt(n,n,t),{up:s.up,eye:n,heading:i,tilt:r}}function Tc(t){return Et(t)}function Cc(t){return st(t)}function Pc(t,e,i,r,s){const n=t.renderSpatialReference,o=t.spatialReference??e.spatialReference;return vr(e,Mt,n),vr(e,Tt,n),Mt[0]-=i/2,Tt[0]+=i/2,Mt[1]-=r/2,Tt[1]+=r/2,ar(Mt,n,Mt,o),ar(Tt,n,Tt,o),s?(s.xmin=Mt[0],s.ymin=Mt[1],s.xmax=Tt[0],s.ymax=Tt[1],s.spatialReference=o):s=new ki(Mt[0],Mt[1],Tt[0],Tt[1],o),s}function zc(t,e){const i=t.frustum,{renderCoordsHelper:r}=t,s=r.getAltitude(e),n=t.spatialReference,o=t.state.camera.eye,a=[],l=i.planes[5];for(let u=0;u<4;u++){const c=i.lines[u];r.intersectInfiniteManifold(mr(c.origin,c.direction),s,dt)||Oc(dt,i,r,c.endpoint,s),Bs(dt,o,dt,l),a.push(lr(dt[0],dt[1]))}return Ac(xc(a,r.extent),r,n)}function Oc(t,e,i,r,s){const n=e.lines[11].direction,o=(s-i.getAltitude(r))/n[2];bt(t,r,n,o)}function Ac(t,e,i){const r=t.map(s=>(N(dt,s[0],s[1],0),e.fromRenderCoords(dt,dt,i),[dt[0],dt[1]]));return r.length<=2?new Xe({spatialReference:i}):(r.push(r[0].slice()),Bi(r)||r.reverse(),new Xe({rings:[r],spatialReference:i}))}const dt=_();Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:Sc,eyeForCenterWithHeadingTilt:Mc,eyeTiltToLookAtTilt:Cc,headingTiltToDirectionUp:$s,lookAtTiltToEyeTilt:Tc,toArea:zc,toExtent:Pc},Symbol.toStringTag,{value:"Module"}));let Ec=class{get planes(){return this.frustum}get points(){return this._points}get mutablePoints(){return this._points}get direction(){return this._direction}get origin(){return this._origin}constructor(t){this.renderCoordsHelper=t,this.frustum=ur(),this._points=_o(),this.lines=new Array(12),this._origin=_(),this._direction=_(),this._altitude=null;for(let e=0;e<12;e++)this.lines[e]={origin:null,direction:_(),endpoint:null}}update(t){hr(t.viewMatrix,t.projectionMatrix,this.frustum,this._points),$(this._origin,t.eye),$(this._direction,t.viewForward),this._altitude=this.renderCoordsHelper.getAltitude(this._origin),this._updateLines()}updatePoints(t){for(let e=0;e<this._points.length;e++)$(this._points[e],t[e]);yo(this.frustum,this._points),this._updateLines()}get altitude(){return this._altitude}intersectsSphere(t){return xo(this.frustum,t)}intersectsRay(t){return bo(this.frustum,t)}intersectsLineSegment(t,e){return wo(this.frustum,t,e)}intersectsPoint(t){return So(this.frustum,t)}_updateLines(){const t=this._points;for(let e=0;e<4;e++){const i=e+4;yi(this.lines[e],t[e],t[i]),yi(this.lines[e+4],t[e],e===3?t[0]:t[e+1]),yi(this.lines[e+8],t[i],e===3?t[4]:t[i+1])}}static{this.planePointIndices=Mo}static{this.nearFarLineIndices=[[0,4],[1,5],[2,6],[3,7]]}};function yi(t,e,i){t.origin=e,t.endpoint=i,Wi(t.direction,e,i)}const xi=Z(parseFloat(5802e-9.toFixed(6)),parseFloat(13558e-9.toFixed(6)),parseFloat(331e-7.toFixed(6))),bi=3,wi=Z(bi*parseFloat(65e-8.toFixed(6)),bi*parseFloat(1881e-9.toFixed(6)),bi*parseFloat(85e-9.toFixed(6)));Z(parseFloat(Number(xi[0]+wi[0]).toFixed(6)),parseFloat(Number(xi[1]+wi[1]).toFixed(6)),parseFloat(Number(xi[2]+wi[2]).toFixed(6)));const Ic=2;ye(),pr();function Rc(t,e,i){t.worldUpAtPosition(e,qs),wt(Si,i,e);const r=Y(Si);return r===0?0:Ge(ht(Si,qs)/r)}const qs=_(),Si=_();function Dc(t,e,i){const r=e/i,s=st(t),n=Math.sin(r/2),o=Math.cos(s),a=2*he(Math.sqrt(n*n/(o*o)));return Et(a)}const Ws=Z(0,0,1),Gs=xt(_(),Z(1,1,1)),ae=X(),Ot=_(),Wt=_();function Xs(t,e,i,r=Ns()){ut(Ot,t,Ws),ht(Ot,Ot)===0&&ut(Ot,t,Gs),fo(ae,-st(e),t),po(ae,ae,-st(i),Ot);const{up:s,direction:n}=r;return ut(s,Ot,t),xt(s,s),mt(s,s,ae),xt(n,t),Gi(n,n),mt(n,n,ae),r}function Fc(t,e,i,r){const s=Ot,n=Wt;return xt(s,t),ut(Wt,s,Ws),ht(Wt,Wt)===0&&ut(Wt,s,Gs),ut(n,Wt,s),ks(e,i,r,s,n)}function Lc(t,e,i,r){const s={eye:_(),up:null,tilt:r,heading:i},n=Ot;n[0]=t[0],n[1]=t[2],n[2]=-t[1];const o=e,a=st(i),l=st(r),u=Math.sin(a),c=Math.cos(a),h=Math.sin(l),m=Math.cos(l),y=Y(n);let d;if(Math.abs(l)<1e-8)d=o+y;else{const B=y/h,k=he(o/B),K=Math.PI-l-k;d=B*Math.sin(K)}const w=m*o,b=o*o*(h*h),z=c*c*b,O=d-w,C=O*O,A=z*(z+C-n[1]*n[1]);if(A<0)return q(s.eye,n,d/y),s.tilt=0,Le(s,t);const D=Math.sqrt(A),L=n[1]*O,T=z+C;let S;if(S=c>0?-D+L:D+L,Math.abs(T)<1e-8)return y<1e-8?(s.eye[0]=0,s.eye[1]=0,s.eye[2]=o):q(s.eye,n,d/y),s.tilt=0,Mi(s.eye),Le(s,t);s.eye[1]=S/T;const x=u*u*b,E=h*o,g=c*E*s.eye[1],I=s.eye[1]*s.eye[1],M=1-I,F=Math.sqrt(M),V=z*I+x-2*g*F*O+M*C;return Math.abs(V)<1e-8?(q(s.eye,n,d/y),s.tilt=0,Mi(s.eye),Le(s,t)):(s.eye[0]=(M*(d*n[0]-w*n[0])-E*F*(n[0]*s.eye[1]*c+n[2]*u))/V,s.eye[2]=(M*(d*n[2]-w*n[2])-E*F*(n[2]*s.eye[1]*c-n[0]*u))/V,q(s.eye,s.eye,d),Mi(s.eye),Le(s,t))}function Mi(t){const e=t[1];t[1]=-t[2],t[2]=e}function Le(t,e){const i=Xs(e,t.heading,t.tilt);return t.up=i.up,t}function Vc(t,e,i){const r=Y(e),s=Math.sqrt(i*i+r*r-2*i*r*Math.cos(Math.PI-t)),n=he(i/(s/Math.sin(t)));return Et(t-n)}function Nc(t,e,i){const r=st(t),s=Y(e);return he(i/(s/Math.sin(r)))+r}function kc(t,e,i,r,s){let n,o,a,l;const u=e.latitude,c=Rn(t.spatialReference).radius,h=e.longitude,m=Dc(u,i,c)/2;n=h-m,o=h+m;const y=st(u),d=(1+Math.sin(y))/(1-Math.sin(y)),w=(d+1)*Math.tan(r/c/2),b=w*w;function z(C){const A=Math.PI/2;return(C=Vo.normalize(C,-A))>A&&(C=Math.PI-C),C}if(a=1.5*Math.PI-2*Math.atan(.5*(w+Math.sqrt(4*d+b))),l=a+r/c,a=z(a),l=z(l),l<a){const C=l;l=a,a=C}if(a=Math.max(Et(a),-90),l=Math.min(Et(l),90),o=No.monotonic(n,o),o-n>180){const C=(o-n-180)/2;n+=C,o-=C}const O=t.spatialReference&&t.spatialReference.isGeographic?t.spatialReference:Dn.WGS84;return s?(s.xmin=n,s.ymin=a,s.xmax=o,s.ymax=l,s.spatialReference=O):s=new ki(n,a,o,l,O),t.spatialReference&&t.spatialReference.isWebMercator&&Fn(s,!1,s),s}function Bc(t,e){const{renderCoordsHelper:i}=t,r=t.state.camera.clone(),s=new Ec(i);r.near=Ic,s.update(r);const n=i.getAltitude(e),o=t.spatialReference,a=i.referenceEllipsoid.radius,l=r.eye,u=1+$i(l,e)/(a+n),c=Math.sqrt(u*u-1),{minCurvature:h,maxCurvature:m,minSamples:y,maxSamples:d}=$c,w=jc(t),b=Yt((c-h)/(m-h),0,1),z=Math.round(et(y,d,b)),O=r.aboveGround,C=s.planes[5],A=[],D=gr(Zt,qc,_r()),L=gr(Zt,Wc,_r());ge(Ti,0,0,0,0);const T=x=>{};for(let x=0;x<4;x++){const E=x===1&&!O||x===3&&O?1-w:0,g=x===1&&O||x===3&&!O?w:1,I=s.lines[x],M=s.lines[x===3?0:x+1];for(let F=0;F<z;F++){const V=F/z,B=F===0?0:et(E,g,x===1?1-(1-V)**2:x===3?V**2:V),k=de(Xc,I.origin,M.origin,B),K=Do(I.direction,M.direction,B,Gc);i.intersectManifoldClosestSilhouette(mr(k,K),n,Q),Bs(Q,l,Q,C),A.push(Di(Q)),A.length!==0&&T(ti(A.at(-1),Q));const it=(yr(D,Q)?1:0)|(yr(L,Q)?2:0);Ti[it]=1}}A.length>2&&T(ti(A[0],A.at(-1)));const S=Hc(mo(Ti)>1?Uc(Ys(A,D),L):[A],i,o);return new Xe({rings:S,spatialReference:o})}function Hc(t,e,i){const r=2*Hi();return t.map(s=>{const n=[];let o=!1;for(const a of s)e.fromRenderCoords(a,Q,i),Math.abs(a[0])<r&&Math.abs(a[1])<r?(n.push([null,Q[1]]),n.push([null,Q[1]]),o=!0):n.push([Q[0],Q[1]]);if(o)for(let a=0;a<n.length;a++){const l=n[a];if(l[0]!=null)continue;const u=n[a+1],c=n.at(a===0?-1:a-1);l[0]=c[0],a++;const h=n.at(a===n.length-1?0:a+1);u[0]=h[0]}return n.push(n[0]),Bi(n)||n.reverse(),n})}function Uc(t,e){const i=[];for(const r of t)i.push(...Ys(r,e));return i}function Ys(t,e){const i=[],r=[],s=Hi();for(let o=0;o<t.length;o++){const a=t[o],l=o===t.length-1?t[0]:t[o+1],u=Io(a,l,Yc),c=Fo(e,u.origin,u.vector,0,Q);switch(c){case 2:i.push(a);break;case 3:r.push(a);break;case 0:case 1:{const[h,m,y]=c===0?[1,i,r]:[-1,r,i],d=Lo(e),w=bt(_(),Q,d,h*s),b=bt(_(),Q,d,h*-s);m.push(a),m.push(w),y.push(b)}}}const n=[];return i.length&&n.push(i),r.length&&n.push(r),n}function jc(t){const{renderCoordsHelper:e,state:{camera:i}}=t,{center:r,eye:s}=i,n=Math.abs(e.getAltitude(r)),o=Math.abs(Math.PI/2-Rc(e,r,s));return Co(Zs,e.referenceEllipsoid.radius+n),To(Zs,o,i.distance,i.fovY)}const $c={minCurvature:st(5),maxCurvature:st(50),minSamples:1,maxSamples:6},qc=Z(1,0,0),Wc=Z(0,1,0),Gc=_(),Xc=_(),Q=_(),Zs=ye(),Yc=Eo(),Ti=Rt();Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:Fc,eyeForCenterWithHeadingTilt:Lc,eyeTiltToLookAtTilt:Nc,headingTiltToDirectionUp:Xs,lookAtTiltToEyeTilt:Vc,toArea:Bc,toExtent:kc},Symbol.toStringTag,{value:"Module"}));const Zc={COMPOSITE:"composite-color"},Kc={SSAO:"ssao",LASERLINES:"laserline-color",HIGHLIGHTS:"highlight-color"};let Lt=class extends Ue{constructor(t){super(t),this.view=null,this.consumes={required:[]},this.produces=Zc.COMPOSITE,this.requireGeometryDepth=!1,this._dirty=!0}initialize(){this.addHandles([Ln(()=>this.view.ready,t=>{t&&this.view.stage?.renderer.addRenderNode(this)},Vn)])}destroy(){this.view.stage?.renderer?.removeRenderNode(this)}precompile(){}render(){throw new ce("RenderNode:render-function-not-implemented","render() is not implemented.")}get camera(){return this.view.state.camera.clone()}get sunLight(){return this.bindParameters.lighting.legacy}get gl(){return this.view.stage.renderView.renderingContext.gl}get techniques(){return this.view.stage.renderView.techniques}acquireOutputFramebuffer(){const t=this._frameBuffer?.getTexture()?.descriptor,e=this.view.stage.renderer.fboCache.acquire(t?.width??640,t?.height??480,this.produces);return e.fbo?.initializeAndBind(),e}bindRenderTarget(){return this._frameBuffer?.fbo?.initializeAndBind(),this._frameBuffer}requestRender(t){switch(t){case 2:this.view.state.fading=!0;case 1:this.view.stage?.renderView.requestRender(t);case 0:case void 0:this._dirty=!0}}resetWebGLState(){this.renderingContext.resetState(),this.renderingContext.bindFramebuffer(this._frameBuffer?.fbo)}get fboCache(){return this.view.stage.renderer.fboCache}get bindParameters(){return this.renderContext.bind}get renderingContext(){return this.view.stage.renderView.renderingContext}get renderContext(){return this.view.stage?.renderer.renderContext}updateAnimation(t){return!!this._dirty&&(this._dirty=!1,!0)}doRender(t){this._frameBuffer=t.find(({name:e})=>e===this.produces);try{return this.render(t)}finally{this._frameBuffer=null}}};f([p({constructOnly:!0})],Lt.prototype,"view",void 0),f([p({constructOnly:!0})],Lt.prototype,"consumes",void 0),f([p()],Lt.prototype,"produces",void 0),f([p({readOnly:!0})],Lt.prototype,"techniques",null),Lt=f([je("esri.views.3d.webgl.RenderNode")],Lt);const Qc=[],Jc=[new br("position",3,ji.FLOAT,0,12)],tu=[new br("position",2,ji.FLOAT,0,8)],eu=xr(tu);xr(Jc);function iu(t,e=!0){t.attributes.add("position","vec2"),e&&t.varyings.add("uv","vec2"),t.vertex.main.add(v`
      gl_Position = vec4(position, 0.0, 1.0);
      ${e?v`uv = position * 0.5 + vec2(0.5);`:""}
  `)}function Ks(t){t.uniforms.add(new Oe("zProjectionMap",e=>ru(e.camera))),t.code.add(v`float linearizeDepth(float depth) {
float depthNdc = depth * 2.0 - 1.0;
float c1 = zProjectionMap[0];
float c2 = zProjectionMap[1];
return -(c1 / (depthNdc + c2 + 1e-7));
}`),t.code.add(v`float delinearizeDepth(float linearDepth) {
float c1 = zProjectionMap[0];
float c2 = zProjectionMap[1];
float depthNdc = (-c1/linearDepth) - c2 - 1e-7;
float depthNonlinear01 = (depthNdc + 1.0 ) / 2.0;
return depthNonlinear01;
}`),t.code.add(v`float depthFromTexture(sampler2D depthTexture, vec2 uv) {
ivec2 iuv = ivec2(uv * vec2(textureSize(depthTexture, 0)));
float depth = texelFetch(depthTexture, iuv, 0).r;
return depth;
}`),t.code.add(v`float linearDepthFromTexture(sampler2D depthTexture, vec2 uv) {
return linearizeDepth(depthFromTexture(depthTexture, uv));
}`)}function ru(t){const e=t.projectionMatrix;return Ye(su,e[14],e[10])}const su=ri();let nu=class extends U{constructor(t,e,i){super(t,"vec2",2,(r,s,n,o)=>r.setUniform2fv(t,e(s,n,o),i))}},Qs=class extends U{constructor(t,e,i){super(t,"vec4",0,(r,s)=>r.setUniform4fv(t,e(s),i))}};function ou(t){t.fragment.uniforms.add(new Qs("projInfo",e=>au(e.camera))),t.fragment.uniforms.add(new Oe("zScale",e=>lu(e.camera))),t.fragment.code.add(v`vec3 reconstructPosition(vec2 fragCoord, float depth) {
return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
}`)}function au(t){const e=t.projectionMatrix;return e[11]===0?ge(Js,2/(t.fullWidth*e[0]),2/(t.fullHeight*e[5]),(1+e[12])/e[0],(1+e[13])/e[5]):ge(Js,-2/(t.fullWidth*e[0]),-2/(t.fullHeight*e[5]),(1-e[8])/e[0],(1-e[9])/e[5])}const Js=Rt();function lu(t){return t.projectionMatrix[11]===0?Ye(tn,0,1):Ye(tn,1,0)}const tn=ri();function cu(t){const e=3.141592653589793,i=.3183098861837907;t.constants.add("PI","float",e),t.constants.add("LIGHT_NORMALIZATION","float",i),t.constants.add("INV_PI","float",i),t.constants.add("HALF_PI","float",1.570796326794897),t.constants.add("TWO_PI","float",6.28318530717958)}let uu=class extends U{constructor(t,e){super(t,"bool",0,(i,r)=>i.setUniform1b(t,e(r)))}},en=class{constructor(t=Kt()){this.intensity=t}};class hu{constructor(e=Kt(),i=Z(.57735,.57735,.57735)){this.intensity=e,this.direction=i}}class Ci{constructor(e=Kt(),i=Z(.57735,.57735,.57735),r=!0,s=1,n=1){this.intensity=e,this.direction=i,this.castShadows=r,this.specularStrength=s,this.environmentStrength=n}}let rn=class{constructor(){this.r=[0],this.g=[0],this.b=[0]}};function du(t,e,i){(i=i||t).length=t.length;for(let r=0;r<t.length;r++)i[r]=t[r]*e[r];return i}function Pi(t,e,i){(i=i||t).length=t.length;for(let r=0;r<t.length;r++)i[r]=t[r]*e;return i}function Gt(t,e,i){(i=i||t).length=t.length;for(let r=0;r<t.length;r++)i[r]=t[r]+e[r];return i}function sn(t){return(t+1)*(t+1)}function fu(t){return Yt(Math.floor(Math.sqrt(t)-1),0,2)}function nn(t,e,i){const r=t[0],s=t[1],n=t[2],o=i||[];return o.length=sn(e),e>=0&&(o[0]=.28209479177),e>=1&&(o[1]=.4886025119*r,o[2]=.4886025119*n,o[3]=.4886025119*s),e>=2&&(o[4]=1.09254843059*r*s,o[5]=1.09254843059*s*n,o[6]=.31539156525*(3*n*n-1),o[7]=1.09254843059*r*n,o[8]=.54627421529*(r*r-s*s)),o}function pu(t,e){const i=sn(t),r=e||{r:[],g:[],b:[]};r.r.length=r.g.length=r.b.length=i;for(let s=0;s<i;s++)r.r[s]=r.g[s]=r.b[s]=0;return r}function mu(t,e){const i=fu(e.r.length);for(const r of t)Gi(zi,r.direction),nn(zi,i,Ct),du(Ct,Ve),Pi(Ct,r.intensity[0],Xt),Gt(e.r,Xt),Pi(Ct,r.intensity[1],Xt),Gt(e.g,Xt),Pi(Ct,r.intensity[2],Xt),Gt(e.b,Xt);return e}function vu(t,e){nn(zi,0,Ct);for(const i of t)e.r[0]+=Ct[0]*Ve[0]*i.intensity[0]*4*Math.PI,e.g[0]+=Ct[0]*Ve[0]*i.intensity[1]*4*Math.PI,e.b[0]+=Ct[0]*Ve[0]*i.intensity[2]*4*Math.PI;return e}function gu(t,e,i,r){pu(e,r),N(i.intensity,0,0,0);let s=!1;const n=_u,o=yu,a=xu;n.length=0,o.length=0,a.length=0;for(const l of t)l instanceof Ci&&!s?($(i.direction,l.direction),$(i.intensity,l.intensity),i.specularStrength=l.specularStrength,i.environmentStrength=l.environmentStrength,i.castShadows=l.castShadows,s=!0):l instanceof Ci||l instanceof hu?n.push(l):l instanceof en?o.push(l):l instanceof rn&&a.push(l);mu(n,r),vu(o,r);for(const l of a)Gt(r.r,l.r),Gt(r.g,l.g),Gt(r.b,l.b)}const _u=[],yu=[],xu=[],Ct=[0],Xt=[0],zi=_(),Ve=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398];class on{constructor(){this.color=_(),this.intensity=1}}class bu{constructor(){this.direction=_(),this.ambient=new on,this.diffuse=new on}}const an=.4;class wu{constructor(){this._shOrder=2,this._legacy=new bu,this.globalFactor=.5,this.noonFactor=.5,this._sphericalHarmonics=new rn,this._mainLight=new Ci(_(),Z(1,0,0),!1)}get legacy(){return this._legacy}get sh(){return this._sphericalHarmonics}get mainLight(){return this._mainLight}set(e){gu(e,this._shOrder,this._mainLight,this._sphericalHarmonics),this.updateLegacy()}updateLegacy(){$(this._legacy.direction,this._mainLight.direction);const e=1/Math.PI;this._legacy.ambient.color[0]=.282095*this._sphericalHarmonics.r[0]*e,this._legacy.ambient.color[1]=.282095*this._sphericalHarmonics.g[0]*e,this._legacy.ambient.color[2]=.282095*this._sphericalHarmonics.b[0]*e,q(this._legacy.diffuse.color,this._mainLight.intensity,e),$(Ne,this._legacy.diffuse.color),q(Ne,Ne,an*this.globalFactor),nt(this._legacy.ambient.color,this._legacy.ambient.color,Ne)}copyFrom(e){this._sphericalHarmonics.r=Array.from(e.sh.r),this._sphericalHarmonics.g=Array.from(e.sh.g),this._sphericalHarmonics.b=Array.from(e.sh.b),$(this._mainLight.direction,e.mainLight.direction),$(this._mainLight.intensity,e.mainLight.intensity),this._mainLight.castShadows=e.mainLight.castShadows,this._mainLight.specularStrength=e.mainLight.specularStrength,this._mainLight.environmentStrength=e.mainLight.environmentStrength,this.globalFactor=e.globalFactor,this.noonFactor=e.noonFactor}lerpLighting(e,i,r){if(de(this._mainLight.intensity,e.mainLight.intensity,i.mainLight.intensity,r),this._mainLight.environmentStrength=et(e.mainLight.environmentStrength,i.mainLight.environmentStrength,r),this._mainLight.specularStrength=et(e.mainLight.specularStrength,i.mainLight.specularStrength,r),$(this._mainLight.direction,i.mainLight.direction),this._mainLight.castShadows=i.mainLight.castShadows,this.globalFactor=et(e.globalFactor,i.globalFactor,r),this.noonFactor=et(e.noonFactor,i.noonFactor,r),e.sh.r.length===i.sh.r.length)for(let s=0;s<i.sh.r.length;s++)this._sphericalHarmonics.r[s]=et(e.sh.r[s],i.sh.r[s],r),this._sphericalHarmonics.g[s]=et(e.sh.g[s],i.sh.g[s],r),this._sphericalHarmonics.b[s]=et(e.sh.b[s],i.sh.b[s],r);else for(let s=0;s<i.sh.r.length;s++)this._sphericalHarmonics.r[s]=i.sh.r[s],this._sphericalHarmonics.g[s]=i.sh.g[s],this._sphericalHarmonics.b[s]=i.sh.b[s];this.updateLegacy()}}const Ne=_();function Su(t,{occlusionPass:e,terrainDepthTest:i,cullAboveTerrain:r}){const{vertex:s,fragment:n,varyings:o}=t;if(!i)return s.code.add("void forwardViewPosDepth(vec3 pos) {}"),void n.code.add(`${e?"bool":"void"} discardByTerrainDepth() { ${ot(e,"return false;")}}`);o.add("viewPosDepth","float",{invariant:!0}),s.code.add(`void forwardViewPosDepth(vec3 pos) {
    viewPosDepth = pos.z;
  }`),n.include(Ks),n.uniforms.add(new pi("terrainDepthTexture",a=>a.terrainDepth?.attachment)).code.add(v`
    ${e?"bool":"void"} discardByTerrainDepth() {
      float depth = texelFetch(terrainDepthTexture, ivec2(gl_FragCoord.xy), 0).r;
      float linearDepth = linearizeDepth(depth);
      ${e?"return viewPosDepth < linearDepth && depth < 1.0;":`if(viewPosDepth ${r?">":"<="} linearDepth) discard;`}
    }`)}function ln(t){t.code.add(v`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}function cn(t){t.code.add(v`
    const float GAMMA = ${v.float(Ui)};
    const float INV_GAMMA = ${v.float(1/Ui)};

    vec4 delinearizeGamma(vec4 color) {
      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.a);
    }

    vec3 linearizeGamma(vec3 color) {
      return pow(color, vec3(GAMMA));
    }
  `)}const Mu=1;function Tu(t,e){if(!Ut(e.output))return;t.fragment.include(cn);const{emissionSource:i,hasEmissiveTextureTransform:r,bindType:s}=e,n=i===3||i===4||i===5;n&&(t.include(Ls,e),t.fragment.uniforms.add(s===1?new Fs("texEmission",h=>h.textureEmissive):new Vs("texEmission",h=>h.textureEmissive)));const o=i===2||n;o&&t.fragment.uniforms.add(s===1?new _t("emissiveBaseColor",h=>h.emissiveBaseColor):new gt("emissiveBaseColor",h=>h.emissiveBaseColor));const a=i!==0;a&&!(i===7||i===6||i===4||i===5)&&t.fragment.uniforms.add(s===1?new Rs("emissiveStrength",h=>h.emissiveStrength):new hc("emissiveStrength",h=>h.emissiveStrength));const l=i===7,u=i===5,c=i===1||i===6||l;t.fragment.code.add(v`
    vec4 getEmissions(vec3 symbolColor) {
      vec4 emissions = ${o?u?"emissiveSource == 0 ? vec4(emissiveBaseColor, 1.0): vec4(linearizeGamma(symbolColor), 1.0)":"vec4(emissiveBaseColor, 1.0)":c?l?"emissiveSource == 0 ? vec4(0.0): vec4(linearizeGamma(symbolColor), 1.0)":"vec4(linearizeGamma(symbolColor), 1.0)":"vec4(0.0)"};
      ${ot(n,`${ot(u,`if(emissiveSource == 0) {
              vec4 emissiveFromTex = textureLookup(texEmission, ${r?"emissiveUV":"vuv0"});
              emissions *= vec4(linearizeGamma(emissiveFromTex.rgb), emissiveFromTex.a);
           }`,`vec4 emissiveFromTex = textureLookup(texEmission, ${r?"emissiveUV":"vuv0"});
           emissions *= vec4(linearizeGamma(emissiveFromTex.rgb), emissiveFromTex.a);`)}
        emissions.w = emissions.rgb == vec3(0.0) ? 0.0: emissions.w;`)}
      ${ot(a,`emissions.rgb *= emissiveStrength * ${v.float(Mu)};`)}
      return emissions;
    }
  `)}function Cu(t,e){t.include(ws,e),t.include(Tu,e),t.fragment.include(ln);const{output:i,oitPass:r,discardInvisibleFragments:s,snowCover:n}=e,o=i===10,a=li(i),l=Ut(i)&&r===1,u=Ut(i)&&r!==1;let c=0;(u||a||l)&&t.outputs.add("fragColor","vec4",c++),a&&t.outputs.add("fragEmission","vec4",c++),l&&t.outputs.add("fragAlpha","float",c++),t.fragment.code.add(v`
    void outputColorHighlightOID(vec4 finalColor, const in vec3 vWorldPosition, vec3 emissiveSymbolColor ${ot(n,", float snow")}) {
      ${ot(o,"finalColor.a = 1.0;")}

      ${ot(s,`if (finalColor.a < ${v.float(Ds)}) { discard; }`)}

      finalColor = applySlice(finalColor, vWorldPosition);
      ${ot(l,v`fragColor = premultiplyAlpha(finalColor);
             fragAlpha = finalColor.a;`)}
      ${ot(u,"fragColor = finalColor;")}
      ${ot(a,`fragEmission = ${ot(n,"mix(finalColor.a * getEmissions(emissiveSymbolColor), vec4(0.0), snow);","finalColor.a * getEmissions(emissiveSymbolColor);")}`)}
      calculateOcclusionAndOutputHighlight();
      ${ot(o,"outputObjectAndLayerIdColor();")}
    }
  `)}export{ai as $,za as A,Va as B,Ba as C,Rl as D,El as E,Bl as F,uc as G,ql as H,Sl as I,Cu as J,Su as K,fi as L,ln as M,Da as N,xl as O,yl as P,gl as Q,pl as R,sa as S,Ia as T,Fa as U,Ea as V,La as W,Ut as X,jt as Y,ma as Z,wu as _,es as a,us as a$,pa as a0,Ra as a1,Ds as a2,ll as a3,cc as a4,Er as a5,Qr as a6,Jr as a7,ee as a8,Il as a9,zr as aA,Ta as aB,el as aC,_a as aD,Tr as aE,Bo as aF,ms as aG,ys as aH,Fl as aI,vs as aJ,Ml as aK,Hl as aL,Or as aM,wa as aN,Ir as aO,Es as aP,Wr as aQ,Gr as aR,Xr as aS,Ce as aT,rl as aU,di as aV,sl as aW,Yr as aX,Ll as aY,ca as aZ,Pr as a_,as as aa,ul as ab,cs as ac,Vl as ad,Nl as ae,Dl as af,Pa as ag,ps as ah,ws as ai,Ol as aj,Ls as ak,fc as al,Ks as am,ou as an,Oe as ao,pi as ap,Qs as aq,cu as ar,uu as as,an as at,gt as au,bs as av,jl as aw,hs as ax,ls as ay,fa as az,Fs as b,Ms as b0,ie as b1,Fr as b2,wl as b3,vl as b4,bl as b5,_l as b6,ml as b7,ni as b8,Ar as b9,al as ba,Qa as bb,lc as bc,Oa as bd,Ma as be,Ul as bf,nc as bg,oc as bh,rc as bi,yc as bj,ac as bk,Ho as bl,ka as bm,Ee as bn,Ss as bo,Lr as bp,Br as bq,Zr as br,cn as bs,ui as bt,oi as bu,Kr as bv,_t as c,Qt as d,Sr as e,kl as f,nu as g,Mr as h,U as i,fl as j,hl as k,xs as l,ua as m,ko as n,iu as o,Qc as p,Vs as q,Rs as r,eu as s,wr as t,Lt as u,Kc as v,_c as w,Jt as x,Rr as y,en as z};
