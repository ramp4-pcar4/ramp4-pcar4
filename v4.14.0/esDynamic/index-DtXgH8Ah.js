import{fy as R,F as x,fA as S,fN as k,ar as u,fC as y,fS as B,fP as M,fR as N,fq as m,fT as O,e8 as z,e9 as P,ea as p,fD as T,iI as q,iJ as D,fK as H,fG as I,e7 as V}from"./main-CSjwO60s.js";const G={class:"swipe-container"},Y=["id","aria-valuenow","aria-label","content"],F=["swipe-position","view"],J=R({__name:"swipe",props:{fixture:{type:x,required:!0},message:String},setup(L){const r=B("iApi"),c=S(),i=k("slider"),g=u(45),v=u(0),d=u(0),h=u(50),f=u(),t=u(),$=y(()=>{const l=30+d.value-d.value,a=i.value?.getBoundingClientRect()?i.value?.getBoundingClientRect().right-i.value?.getBoundingClientRect().left:0,e=+g.value/90,n=(a-l)*e,_=(i.value?.getBoundingClientRect().x??0)+n+(l-5.25)/2;return h.value=_/r.$rootEl.clientWidth*100+.2,`${_}px`}),C=y(()=>`${v.value}px`),A=y(()=>`${-v.value/2-18}px`),E=L;M(()=>{v.value=r.$rootEl?.clientHeight??1200});const w=()=>{v.value=r.$rootEl?.clientHeight??v.value,d.value++,setTimeout(()=>{d.value++},50)},s=()=>{c.setOpacity(.1),i.value.style.background=""},o=()=>{c.setOpacity(1),i.value.style.background="inherit"};N(async()=>{"ontouchstart"in document.documentElement||!window.matchMedia("(pointer:fine)").matches||(i.value.style.background="inherit"),window.addEventListener("resize",w),i.value?.addEventListener("focus",s),i.value?.addEventListener("blur",o),i.value?.addEventListener("mouseover",s),i.value?.addEventListener("mouseleave",o),i.value?.addEventListener("touchstart",s),i.value?.addEventListener("touchend",o),setTimeout(()=>{d.value++},50),await b();const l=()=>{const a=t.value?.querySelector(".arcgis-swipe__container");return a?(a.removeAttribute("tabindex"),!0):!1};if(!l()){const a=new MutationObserver((e,n)=>{l()&&n.disconnect()});a.observe(t.value,{childList:!0,subtree:!0,attributes:!1}),setTimeout(()=>a.disconnect(),5e3)}r.event.on(m.MAP_BASEMAPCHANGE,async a=>{a.schemaChanged&&(t.value?.trailingLayers.forEach(e=>{t.value?.trailingLayers.remove(e)}),t.value?.leadingLayers.forEach(e=>{t.value?.leadingLayers.remove(e)}),await b())}),r.event.on(m.LAYER_RELOAD_END,a=>{t.value?.trailingLayers.forEach(e=>{e.id===a.id&&(t.value?.trailingLayers.remove(e),t.value?.trailingLayers.add(a.esriLayer))}),t.value?.leadingLayers.forEach(e=>{e.id===a.id&&(t.value?.leadingLayers.remove(e),t.value?.leadingLayers.add(a.esriLayer))})}),r.event.on(m.LAYER_REMOVE,a=>{t.value?.trailingLayers.forEach(e=>{e.id===a.id&&t.value?.trailingLayers.remove(e)}),t.value?.leadingLayers.forEach(e=>{e.id===a.id&&t.value?.leadingLayers.remove(e)})})});const b=async()=>{await r.geo.map.viewPromise,f.value=r.geo.map.esriView;const l=E.fixture.trailing,a=E.fixture.leading;l.forEach(e=>{r.geo.layer.awaitLayer(e,!0).then(n=>{n.esriLayer?t.value?.trailingLayers.add(n.esriLayer):console.warn(`Invalid layer instance: ${e}`)})}),a.forEach(e=>{r.geo.layer.awaitLayer(e,!0).then(n=>{n.esriLayer?t.value?.leadingLayers.add(n.esriLayer):console.warn(`Invalid layer instance: ${e}`)})})};return O(()=>{window.removeEventListener("resize",w),i.value?.removeEventListener("focus",()=>s),i.value?.removeEventListener("blur",()=>o),i.value?.removeEventListener("mouseover",s),i.value?.removeEventListener("mouseleave",o),i.value?.removeEventListener("touchstart",s),i.value?.removeEventListener("touchend",o)}),(l,a)=>{const e=H("tippy");return P(),z("div",G,[p("div",{class:"verticalLine",style:q({left:$.value,height:C.value,bottom:A.value})},null,4),T(p("input",{"onUpdate:modelValue":a[0]||(a[0]=n=>g.value=n),id:"layerSlider"+I(r).$element._uid,class:"layerSliderElement",type:"range",ref_key:"slider",ref:i,min:"0","aria-valuemin":"0","aria-valuemax":"90","aria-valuenow":g.value,"aria-label":l.$t("map.layerSwipe.label"),max:"90",step:"0.5",content:l.$t("map.layerSwipe.drag"),style:{"z-index":10}},null,8,Y),[[D,g.value],[e,{followCursor:!0,trigger:"mouseenter"}]]),p("arcgis-swipe",{direction:"horizontal","swipe-position":h.value,view:f.value,"auto-destroy-disable":"",ref_key:"swipeComponent",ref:t},null,8,F)])}}}),U=V(J,[["__scopeId","data-v-49cd9ac9"]]);class W extends x{_parseConfig(r){this.leading=r?.leading??[],this.trailing=r?.trailing??[]}leading=[];trailing=[];async added(){this._parseConfig(this.config);const{el:r,destroy:c}=this.mount(U,{app:this.$element,props:{fixture:this}});r.childNodes[0]&&this.$vApp.$el.appendChild(r.childNodes[0]),this.removed=()=>{c()}}}export{W as default};
