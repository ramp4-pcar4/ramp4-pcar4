import{eP as p}from"./main-CSjwO60s.js";function d(){return new Promise(s=>import("./lyr3DWorker-sQHFmCIw.js").then(e=>e.l).then(({default:e})=>{const r=e({locateFile:h,onRuntimeInitialized:()=>s(r)})})).catch(s=>{throw s})}function h(s){return p(`esri/libs/lyr3d/${s}`)}let o,t;async function m(s){await l();const e={status:1,error:"",jobDescJson:"",data:new Uint8Array(0),missingInputUrls:[]};if(s.inputs.length<1)return{result:e,transferList:[]};const r={ptrs:[],sizes:[]};for(const n of s.inputs){const f=t._malloc(n.byteLength);new Uint8Array(t.HEAPU8.buffer,f,n.byteLength).set(new Uint8Array(n)),r.ptrs.push(f),r.sizes.push(n.byteLength)}const i=t.process(s.jobDescJson,s.id,r,s.isMissingResourceCase);e.status=i.status,e.missingInputUrls=i.missingInputUrls.slice();const u=i.status===0&&i.data,c=e.status===2&&e.missingInputUrls.length>0;e.jobDescJson=i.jobDescJson.slice(),e.error=i.error.slice(),u?e.data=i.data.slice():c&&(e.originalInputs=s.inputs.slice());for(let n=0;n<r.ptrs.length;++n)t._free(r.ptrs[n]);const a=[];if(u)a.push(e.data.buffer);else if(c)for(const n of s.inputs)a.push(n);return{result:e,transferList:a}}async function g(s){await l(),t.add_spatial_reference_info(s.sr,s.isGCS,s.toMetersXY,s.toMetersZ)}function y(){t&&(t.uninitialize_lyr3d_worker_wasm(),t=null)}function l(){return t?Promise.resolve():(o||(o=d().then(s=>{t=s,t.initialize_lyr3d_worker_wasm(),o=null})),o)}export{g as addSpatialReferenceInfo,y as destroyWasm,l as initialize,m as process};
