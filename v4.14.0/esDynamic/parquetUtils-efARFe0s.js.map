{"version":3,"file":"parquetUtils-efARFe0s.js","sources":["../../node_modules/@arcgis/core/layers/support/ParquetEncodingBase.js","../../node_modules/@arcgis/core/layers/support/ParquetEncodingLocation.js","../../node_modules/@arcgis/core/layers/support/ParquetEncodingWkb.js","../../node_modules/@arcgis/core/layers/support/parquetUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as o}from\"tslib\";import{ClonableMixin as r}from\"../../core/Clonable.js\";import{JSONSupport as e}from\"../../core/JSONSupport.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";let p=class extends(r(e)){constructor(o){super(o),this.type=null}};o([s({type:[\"wkb\",\"location\"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],p.prototype,\"type\",void 0),p=o([t(\"esri.layers.support.ParquetEncodingBase\")],p);export{p as ParquetEncodingBase};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{ParquetEncodingBase as r}from\"./ParquetEncodingBase.js\";let i=class extends r{constructor(e){super(e),this.type=\"location\",this.latitudeFieldName=null,this.longitudeFieldName=null}};e([o({type:[\"location\"]})],i.prototype,\"type\",void 0),e([o({type:String,json:{name:\"yField\",write:{isRequired:!0}}})],i.prototype,\"latitudeFieldName\",void 0),e([o({type:String,json:{name:\"xField\",write:{isRequired:!0}}})],i.prototype,\"longitudeFieldName\",void 0),i=e([t(\"esri.layers.support.ParquetEncodingLocation\")],i);export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as r}from\"tslib\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as e}from\"../../core/accessorSupport/decorators/subclass.js\";import{ParquetEncodingBase as t}from\"./ParquetEncodingBase.js\";let s=class extends t{constructor(r){super(r),this.type=\"wkb\",this.primaryFieldName=null}};r([o({type:[\"wkb\"]})],s.prototype,\"type\",void 0),r([o({type:[\"counter-clockwise\"],json:{write:!0}})],s.prototype,\"orientation\",void 0),r([o({type:String,json:{name:\"field\",write:{isRequired:!0}}})],s.prototype,\"primaryFieldName\",void 0),s=r([e(\"esri.layers.support.ParquetEncodingWkb\")],s);export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Collection.js\";import t from\"../../core/Error.js\";import{JSONMap as o}from\"../../core/jsonMap.js\";import n from\"../../geometry/SpatialReference.js\";import i from\"./Field.js\";import{inferLocationInfo as r}from\"./locationUtils.js\";import l from\"./ParquetEncodingLocation.js\";import s from\"./ParquetEncodingWkb.js\";import{createParquetFile as a,readGeoMetadata as u,readEsriMetadata as m}from\"../../libs/parquet/parquet.js\";const c=new o({esriGeometryPoint:\"point\",esriGeometryPolygon:\"polygon\",esriGeometryPolyline:\"polyline\",esriGeometryMultipoint:\"multipoint\"});function p(e){return c.toJSON(e)}function f(e){return c.fromJSON(e)}function d(t,o={}){return y({urls:new e(t)},o)}async function y(e,o={}){if(e.urls.length<1)throw new t(\"parquet:bad-input\",\"At least one url must be specified\",e);if(e.geometryType&&e.spatialReference&&e.encoding&&e.fields)return e;const r=await a(e.urls.getItemAt(0),{getCustomParameters:()=>o.customParameters}),l=u(r),s={...e,file:r};null==s.fields&&(s.fields=r.fields().map(e=>i.fromJSON({name:e.name,alias:e.name,type:e.type}))),null==s.encoding&&(s.encoding=g(l,s.fields));const c=m(r);if(c)switch(c.mode){case\"z\":s.displayOptimization={mode:\"z\"};break;case\"xz\":{const e=c.multiscale;if(!e)throw new t(\"parquet:bad-format\",\"XZ display optimization requires multiscale geometries\");s.displayOptimization={mode:\"xz\",multiscale:e};break}}if(!s.encoding)return s;switch(s.encoding.type){case\"location\":null==s.spatialReference&&(s.spatialReference=n.WGS84),null==s.geometryType&&(s.geometryType=\"point\");break;case\"wkb\":{if(!l)return s;const e=l.primary_column,t=l.columns[e];if(s.geometryType||(s.geometryType=P(t)),s.spatialReference||(s.spatialReference=b(t)),s.fields)for(const o of Object.keys(l.columns))s.fields=s.fields.filter(e=>e.name!==o)}}return s}function g(e,t){if(null!=e){const t=e.primary_column,o=e.columns[t];return new s({primaryFieldName:t,orientation:\"counterclockwise\"===o.orientation?\"counter-clockwise\":null})}const o=r(t.map(e=>e.name));return o.latitudeFieldName&&o.longitudeFieldName?new l({latitudeFieldName:o.latitudeFieldName,longitudeFieldName:o.longitudeFieldName}):null}function w(e){switch(e){case\"Point\":return\"point\";case\"Polygon\":case\"MultiPolygon\":return\"polygon\";case\"LineString\":return\"polyline\";case\"MultiPoint\":return\"multipoint\";default:return null}}function P(e){const{geometry_types:o}=e,n=new Set;for(const t of o){const e=w(t);e&&n.add(e)}if(n.size>1)throw new t(\"parquet:unsupported\",\"Parquet mixed geometry types are not supported\",{geometryTypes:n});return 1===n.size?n.values().next().value:void 0}function b(e){const t=e.crs?.id?.code;return t&&\"number\"==typeof t?new n({wkid:t}):void 0}export{y as completeParquetLayerInfo,f as fromParquetJSONGeometryType,d as getParquetLayerInfo,c as parquetGeometryTypeKebabDict,p as toParquetJSONGeometryType};\n"],"names":["p","r","e","o","s","t","i","c","f","y","a","l","u","g","m","n","P","b","w"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}