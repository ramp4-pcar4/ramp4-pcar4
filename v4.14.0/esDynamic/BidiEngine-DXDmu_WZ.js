const x=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["\xAB","\xBB"],["\xBB","\xAB"],["\u2039","\u203A"],["\u203A","\u2039"],["\u207D","\u207E"],["\u207E","\u207D"],["\u208D","\u208E"],["\u208E","\u208D"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232A"],["\u232A","\u2329"],["\uFE59","\uFE5A"],["\uFE5A","\uFE59"],["\uFE5B","\uFE5C"],["\uFE5C","\uFE5B"],["\uFE5D","\uFE5E"],["\uFE5E","\uFE5D"],["\uFE64","\uFE65"],["\uFE65","\uFE64"]],v=["\u0622","\u0623","\u0625","\u0627"],X=["\uFEF5","\uFEF7","\uFEF9","\uFEFB"],tt=["\uFEF6","\uFEF8","\uFEFA","\uFEFC"],W=["\u0627","\u0628","\u062A","\u062B","\u062C","\u062D","\u062E","\u062F","\u0630","\u0631","\u0632","\u0633","\u0634","\u0635","\u0636","\u0637","\u0638","\u0639","\u063A","\u0641","\u0642","\u0643","\u0644","\u0645","\u0646","\u0647","\u0648","\u064A","\u0625","\u0623","\u0622","\u0629","\u0649","\u0644","\u0645","\u0646","\u0647","\u0648","\u064A","\u0625","\u0623","\u0622","\u0629","\u0649","\u06CC","\u0626","\u0624"],rt=["\uFE8D","\uFE8F","\uFE95","\uFE99","\uFE9D","\uFEA1","\uFEA5","\uFEA9","\uFEAB","\uFEAD","\uFEAF","\uFEB1","\uFEB5","\uFEB9","\uFEBD","\uFEC1","\uFEC5","\uFEC9","\uFECD","\uFED1","\uFED5","\uFED9","\uFEDD","\uFEE1","\uFEE5","\uFEE9","\uFEED","\uFEF1","\uFE87","\uFE83","\uFE81","\uFE93","\uFEEF","\uFBFC","\uFE89","\uFE85","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE89","\uFE85"],et=["\uFE8E","\uFE90","\uFE96","\uFE9A","\uFE9E","\uFEA2","\uFEA6","\uFEAA","\uFEAC","\uFEAE","\uFEB0","\uFEB2","\uFEB6","\uFEBA","\uFEBE","\uFEC2","\uFEC6","\uFECA","\uFECE","\uFED2","\uFED6","\uFEDA","\uFEDE","\uFEE2","\uFEE6","\uFEEA","\uFEEE","\uFEF2","\uFE88","\uFE84","\uFE82","\uFE94","\uFEF0","\uFBFD","\uFE8A","\uFE86","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE8A","\uFE86"],nt=["\uFE8E","\uFE92","\uFE98","\uFE9C","\uFEA0","\uFEA4","\uFEA8","\uFEAA","\uFEAC","\uFEAE","\uFEB0","\uFEB4","\uFEB8","\uFEBC","\uFEC0","\uFEC4","\uFEC8","\uFECC","\uFED0","\uFED4","\uFED8","\uFEDC","\uFEE0","\uFEE4","\uFEE8","\uFEEC","\uFEEE","\uFEF4","\uFE88","\uFE84","\uFE82","\uFE94","\uFEF0","\uFBFF","\uFE8C","\uFE86","\uFE71","\uFE72","\uFE74","\uFE77","\uFE79","\uFE7B","\uFE7D","\uFE7F","\uFE80","\uFE8C","\uFE86"],it=["\uFE8D","\uFE91","\uFE97","\uFE9B","\uFE9F","\uFEA3","\uFEA7","\uFEA9","\uFEAB","\uFEAD","\uFEAF","\uFEB3","\uFEB7","\uFEBB","\uFEBF","\uFEC3","\uFEC7","\uFECB","\uFECF","\uFED3","\uFED7","\uFEDB","\uFEDF","\uFEE3","\uFEE7","\uFEEB","\uFEED","\uFEF3","\uFE87","\uFE83","\uFE81","\uFE93","\uFEEF","\uFBFE","\uFE8B","\uFE85","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE8B","\uFE85"],z=["\u0621","\u0622","\u0623","\u0624","\u0625","\u0627","\u0629","\u062F","\u0630","\u0631","\u0632","\u0648","\u0649"],ot=["\u064B","\u064B","\u064C","\u061F","\u064D","\u061F","\u064E","\u064E","\u064F","\u064F","\u0650","\u0650","\u0651","\u0651","\u0652","\u0652","\u0621","\u0622","\u0622","\u0623","\u0623","\u0624","\u0624","\u0625","\u0625","\u0626","\u0626","\u0626","\u0626","\u0627","\u0627","\u0628","\u0628","\u0628","\u0628","\u0629","\u0629","\u062A","\u062A","\u062A","\u062A","\u062B","\u062B","\u062B","\u062B","\u062C","\u062C","\u062C","\u062C","\u062D","\u062D","\u062D","\u062D","\u062E","\u062E","\u062E","\u062E","\u062F","\u062F","\u0630","\u0630","\u0631","\u0631","\u0632","\u0632","\u0633","\u0633","\u0633","\u0633","\u0634","\u0634","\u0634","\u0634","\u0635","\u0635","\u0635","\u0635","\u0636","\u0636","\u0636","\u0636","\u0637","\u0637","\u0637","\u0637","\u0638","\u0638","\u0638","\u0638","\u0639","\u0639","\u0639","\u0639","\u063A","\u063A","\u063A","\u063A","\u0641","\u0641","\u0641","\u0641","\u0642","\u0642","\u0642","\u0642","\u0643","\u0643","\u0643","\u0643","\u0644","\u0644","\u0644","\u0644","\u0645","\u0645","\u0645","\u0645","\u0646","\u0646","\u0646","\u0646","\u0647","\u0647","\u0647","\u0647","\u0648","\u0648","\u0649","\u0649","\u064A","\u064A","\u064A","\u064A","\uFEF5","\uFEF6","\uFEF7","\uFEF8","\uFEF9","\uFEFA","\uFEFB","\uFEFC","\u061F","\u061F","\u061F"],Z=["\u0621","\u0641"],lt=["\u063A","\u064A"],ct=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ut=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],e=0,l=1,T=2,B=3,t=4,p=5,j=6,r=7,F=8,m=9,_=10,A=11,n=12,st=13,ht=14,ft=15,Tt=16,At=17,f=18,at=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],S=100,Lt=[S+0,e,e,e,e,S+1,S+2,S+3,l,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,S+4,t,t,t,e,t,e,t,e,t,t,t,e,e,t,t,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,e,e,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,S+5,r,r,S+6,S+7],Ut=[[f,f,f,f,f,f,f,f,f,j,p,j,F,p,f,f,f,f,f,f,f,f,f,f,f,f,f,f,p,p,p,j,F,t,t,A,A,A,t,t,t,t,t,_,m,_,m,m,T,T,T,T,T,T,T,T,T,T,m,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,f,f,f,f,f,f,p,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,m,t,A,A,A,A,t,t,t,t,e,t,t,f,t,t,A,A,T,T,t,e,t,t,t,T,e,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,l,n,l,n,n,l,n,n,l,n,t,t,t,t,t,t,t,t,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,t,t,t,t,t,l,l,l,l,l,t,t,t,t,t,t,t,t,t,t,t],[B,B,B,B,t,t,t,t,r,A,A,r,m,r,t,t,n,n,n,n,n,n,n,n,n,n,n,r,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,B,B,B,B,B,B,B,B,B,B,A,B,B,r,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,B,t,n,n,n,n,n,n,r,r,n,n,t,n,n,n,n,r,r,T,T,T,T,T,T,T,T,T,T,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,n,n,n,n,n,n,n,n,n,l,l,t,t,t,t,l,t,t,t,t,t],[F,F,F,F,F,F,F,F,F,F,F,f,f,f,e,l,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,F,p,st,ht,ft,Tt,At,m,A,A,A,A,A,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,F,f,f,f,f,f,t,t,t,t,t,f,f,f,f,f,f,T,e,t,t,T,T,T,T,T,T,_,_,t,t,t,e,T,T,T,T,T,T,T,T,T,T,_,_,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,t,t,t,t,t,l,n,l,l,l,l,l,l,l,l,l,l,_,l,l,l,l,l,l,l,l,l,l,l,l,l,t,l,l,l,l,l,t,l,t,l,l,t,l,l,t,l,l,l,l,l,l,l,l,l,l,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,t,m,t,t,m,t,t,t,t,t,t,t,t,t,A,t,t,_,_,t,t,t,t,t,A,A,t,t,t,t,t,r,r,r,r,r,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,f],[t,t,t,A,A,A,t,t,t,t,t,_,m,_,m,m,T,T,T,T,T,T,T,T,T,T,m,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,t,t,t,A,A,t,t,t,A,A,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];class dt{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(i,c,u){if(this.sourceToTarget=[],this.targetToSource=[],!i)return"";if(It(this.sourceToTarget,this.targetToSource,i.length),!this.checkParameters(c,u))return i;c=this.inputFormat,u=this.outputFormat;let s=i;const h=Wt,L=J(c.charAt(1)),a=J(u.charAt(1)),U=(c.startsWith("I")?"L":c.charAt(0))+L,d=(u.startsWith("I")?"L":u.charAt(0))+a,g=c.charAt(2)+u.charAt(2);h.defInFormat=U,h.defOutFormat=d,h.defSwap=g;const w=V(i,U,d,g,h);let N=!1;return u.charAt(1)==="R"?N=!0:u.charAt(1)!=="C"&&u.charAt(1)!=="D"||(N=this.checkContextual(w)==="rtl"),this.sourceToTarget=R,this.targetToSource=xt(this.sourceToTarget),k=this.targetToSource,s=c.charAt(3)===u.charAt(3)?w:u.charAt(3)==="S"?gt(N,w):Rt(w,N,!0),this.sourceToTarget=R,this.targetToSource=k,this.levels=y,s}_inputFormatSetter(i){if(!Q.test(i))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=i}_outputFormatSetter(i){if(!Q.test(i))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=i}checkParameters(i,c){return i?this._inputFormatSetter(i):i=this.inputFormat,c?this._outputFormatSetter(c):c=this.outputFormat,i!==c}checkContextual(i){let c=D(i);if(c!=="ltr"&&c!=="rtl"){try{c=document.dir.toLowerCase()}catch{}c!=="ltr"&&c!=="rtl"&&(c="ltr")}return c}hasBidiChar(i){return kt.test(i)}}function V(o,i,c,u,s){const h=Bt(o,{inFormat:i,outFormat:c,swap:u},s);if(h.inFormat===h.outFormat)return o;i=h.inFormat,c=h.outFormat,u=h.swap;const L=i.slice(0,1),a=i.slice(1,4),U=c.slice(0,1),d=c.slice(1,4);if(s.inFormat=i,s.outFormat=c,s.swap=u,L==="L"&&c==="VLTR"){if(a==="LTR")return s.dir=E,b(o,s);if(a==="RTL")return s.dir=I,b(o,s)}if(L==="V"&&U==="V")return s.dir=a==="RTL"?I:E,Y(o,s);if(L==="L"&&c==="VRTL")return a==="LTR"?(s.dir=E,o=b(o,s)):(s.dir=I,o=b(o,s)),Y(o);if(i==="VLTR"&&c==="LLTR")return s.dir=E,b(o,s);if(L==="V"&&U==="L"&&a!==d)return o=Y(o),a==="RTL"?V(o,"LLTR","VLTR",u,s):V(o,"LRTL","VRTL",u,s);if(i==="VRTL"&&c==="LRTL")return V(o,"LRTL","VRTL",u,s);if(L==="L"&&U==="L"){const g=s.swap;return s.swap=g.slice(0,1)+"N",a==="RTL"?(s.dir=I,o=b(o,s),s.swap="N"+g.slice(1,3),s.dir=E,o=b(o,s)):(s.dir=E,o=b(o,s),s.swap="N"+g.slice(1,3),o=V(o,"VLTR","LRTL",s.swap,s)),o}return o}function Bt(o,i,c){if(i.inFormat===void 0&&(i.inFormat=c.defInFormat),i.outFormat===void 0&&(i.outFormat=c.defOutFormat),i.swap===void 0&&(i.swap=c.defSwap),i.inFormat===i.outFormat)return i;const u=i.inFormat.slice(0,1),s=i.outFormat.slice(0,1);let h,L=i.inFormat.slice(1,4),a=i.outFormat.slice(1,4);return L.startsWith("C")&&(h=D(o),L=h==="ltr"||h==="rtl"?h.toUpperCase():i.inFormat.charAt(2)==="L"?"LTR":"RTL",i.inFormat=u+L),a.startsWith("C")&&(h=D(o),h==="rtl"?a="RTL":h==="ltr"?(h=mt(o),a=h.toUpperCase()):a=i.outFormat.charAt(2)==="L"?"LTR":"RTL",i.outFormat=s+a),i}function gt(o,i,c){if(i.length===0)return"";o===void 0&&(o=!0);const u=(i=String(i)).split("");let s=0,h=1,L=u.length;o||(s=u.length-1,h=-1,L=1);const a=Ft(u,s,h,L);let U="";for(let d=0;d<u.length;d++)bt(a,a.length,d)>-1?(K(k,d,!o,-1),R.splice(d,1)):U+=u[d];return U}function Ft(o,i,c,u,s){let h=0;const L=[];let a=0;for(let U=i;U*c<u;U+=c)if(q(o[U])||O(o[U])){if(o[U]==="\u0644"&&wt(o,U+c,c,u)){o[U]=Ot(o[U+c],h===0?X:tt),U+=c,Vt(o,U,c,u),L[a]=U,a++,h=0;continue}const d=o[U];h===1?o[U]=G(o,U+c,c,u)?Et(o[U]):M(o[U],et):G(o,U+c,c,u)===!0?o[U]=M(o[U],it):o[U]=M(o[U],rt),O(d)||(h=1),vt(d)===!0&&(h=0)}else h=0;return L}function D(o){const i=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(o);return i?i[0]<="z"?"ltr":"rtl":""}function mt(o){const i=o.split("");return i.reverse(),D(i.join(""))}function Rt(o,i,c){if(o.length===0)return"";i===void 0&&(i=!0);let u="";const s=(o=String(o)).split("");for(let h=0;h<o.length;h++){let L=!1;if(s[h]>="\uFE70"&&s[h]<"\uFEFF"){const a=o.charCodeAt(h);s[h]>="\uFEF5"&&s[h]<="\uFEFC"?(i?(h>0&&c&&s[h-1]===" "?u=u.slice(0,-1)+"\u0644":(u+="\u0644",L=!0),u+=v[(a-65269)/2]):(u+=v[(a-65269)/2],u+="\u0644",h+1<o.length&&c&&s[h+1]===" "?h++:L=!0),L&&(K(k,h,!0,1),R.splice(h,0,R[h]))):u+=ot[a-65136]}else u+=s[h]}return u}function b(o,i){const c=o.split(""),u=[];return $(c,u,i),pt(c,u,i),H(2,c,u,i),H(1,c,u,i),y=u,c.join("")}function $(o,i,c){const u=o.length,s=c.dir?ut:ct;let h=0,L=-1;const a=[],U=[];c.hiLevel=c.dir,c.lastArabic=!1,c.hasUbatAl=!1,c.hasUbatB=!1,c.hasUbatS=!1;for(let d=0;d<u;d++)a[d]=St(o[d]);for(let d=0;d<u;d++){const g=h,w=Nt(o,a,U,d,c);U[d]=w,h=s[g][w];const N=240&h;h&=15;const P=s[h][jt];if(i[d]=P,N>0)if(N===16){for(let C=L;C<d;C++)i[C]=1;L=-1}else L=-1;if(s[h][Dt])L===-1&&(L=d);else if(L>-1){for(let C=L;C<d;C++)i[C]=P;L=-1}a[d]===p&&(i[d]=0),c.hiLevel|=P}c.hasUbatS&&_t(a,i,u,c)}function _t(o,i,c,u){for(let s=0;s<c;s++)if(o[s]===j){i[s]=u.dir;for(let h=s-1;h>=0&&o[h]===F;h--)i[h]=u.dir}}function pt(o,i,c){if(c.hiLevel!==0&&c.swap[0]!==c.swap[1])for(let u=0;u<o.length;u++)i[u]===1&&(o[u]=Ct(o[u]))}function St(o){const i=o.charCodeAt(0),c=Lt[i>>8];return c<S?c:Ut[c-S][255&i]}function Y(o,i){const c=o.split("");if(i){const u=[];$(c,u,i),y=u}return c.reverse(),R.reverse(),c.join("")}function bt(o,i,c){for(let u=0;u<i;u++)if(o[u]===c)return u;return-1}function q(o){for(let i=0;i<Z.length;i++)if(o>=Z[i]&&o<=lt[i])return!0;return!1}function G(o,i,c,u){for(;i*c<u&&O(o[i]);)i+=c;return!!(i*c<u&&q(o[i]))}function wt(o,i,c,u){for(;i*c<u&&O(o[i]);)i+=c;let s=" ";if(!(i*c<u))return!1;s=o[i];for(let h=0;h<v.length;h++)if(v[h]===s)return!0;return!1}function H(o,i,c,u){if(u.hiLevel<o)return;if(o===1&&u.dir===I&&!u.hasUbatB)return i.reverse(),void R.reverse();const s=i.length;let h,L,a,U,d,g=0;for(;g<s;){if(c[g]>=o){for(h=g+1;h<s&&c[h]>=o;)h++;for(L=g,a=h-1;L<a;L++,a--)U=i[L],i[L]=i[a],i[a]=U,d=R[L],R[L]=R[a],R[a]=d;g=h}g++}}function Nt(o,i,c,u,s){const h=i[u];return{UBAT_L:()=>(s.lastArabic=!1,e),UBAT_R:()=>(s.lastArabic=!1,l),UBAT_ON:()=>t,UBAT_AN:()=>B,UBAT_EN:()=>s.lastArabic?B:T,UBAT_AL:()=>(s.lastArabic=!0,s.hasUbatAl=!0,l),UBAT_WS:()=>t,UBAT_CS:()=>{let L,a;return u<1||u+1>=i.length||(L=c[u-1])!==T&&L!==B||(a=i[u+1])!==T&&a!==B?t:(s.lastArabic&&(a=B),a===L?a:t)},UBAT_ES:()=>(u>0?c[u-1]:p)===T&&u+1<i.length&&i[u+1]===T?T:t,UBAT_ET:()=>{if(u>0&&c[u-1]===T)return T;if(s.lastArabic)return t;let L=u+1;const a=i.length;for(;L<a&&i[L]===A;)L++;return L<a&&i[L]===T?T:t},UBAT_NSM:()=>{if(s.inFormat==="VLTR"){const L=i.length;let a=u+1;for(;a<L&&i[a]===n;)a++;if(a<L){const U=o[u].charCodeAt(0),d=U>=1425&&U<=2303||U===64286,g=i[a];if(d&&(g===l||g===r))return l}}return u<1||i[u-1]===p?t:c[u-1]},UBAT_B:()=>(s.lastArabic=!0,s.hasUbatB=!0,s.dir),UBAT_S:()=>(s.hasUbatS=!0,t),UBAT_LRE:()=>(s.lastArabic=!1,t),UBAT_RLE:()=>(s.lastArabic=!1,t),UBAT_LRO:()=>(s.lastArabic=!1,t),UBAT_RLO:()=>(s.lastArabic=!1,t),UBAT_PDF:()=>(s.lastArabic=!1,t),UBAT_BN:()=>t}[at[h]]()}function Ct(o){let i,c=0,u=x.length-1;for(;c<=u;)if(i=Math.floor((c+u)/2),o<x[i][0])u=i-1;else{if(!(o>x[i][0]))return x[i][1];c=i+1}return o}function vt(o){for(let i=0;i<z.length;i++)if(z[i]===o)return!0;return!1}function Et(o){for(let i=0;i<W.length;i++)if(o===W[i])return nt[i];return o}function M(o,i){for(let c=0;c<W.length;c++)if(o===W[c])return i[c];return o}function O(o){return o>="\u064B"&&o<="\u0655"}function J(o){return o==="L"?"LTR":o==="R"?"RTL":o==="C"?"CLR":o==="D"?"CRL":""}function Vt(o,i,c,u){for(;i*c<u&&O(o[i]);)i+=c;return i*c<u&&(o[i]=" ",!0)}function Ot(o,i){for(let c=0;c<v.length;c++)if(o===v[c])return i[c];return o}function It(o,i,c){R=[],y=[];for(let u=0;u<c;u++)o[u]=u,i[u]=u,R[u]=u}function xt(o){const i=new Array(o.length);for(let c=0;c<o.length;c++)i[o[c]]=c;return i}function K(o,i,c,u){for(let s=0;s<o.length;s++)(o[s]>i||!c&&o[s]===i)&&(o[s]+=u)}let R=[],k=[],y=[];const Wt={dir:0,defInFormat:"LLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:""},jt=5,Dt=6,E=0,I=1,Q=/^[(I|V)][(L|RCD)][(Y|N)][(S|N)]N$/,kt=/[\u0591-\u06ff\ufb1d-\ufefc]/;export{dt as C};
