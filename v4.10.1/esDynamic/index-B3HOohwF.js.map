{"version":3,"file":"index-B3HOohwF.js","sources":["../../src/fixtures/export-map/index.ts"],"sourcesContent":["import { fabric } from 'fabric';\n\nimport { FixtureInstance } from '@/api/internal';\nimport type { ExportAPI, ExportSubFixture } from '@/fixtures/export/api/export';\nimport type { ExportConfig } from '../export/store';\n\nclass ExportMapFixture extends FixtureInstance implements ExportSubFixture {\n    get config(): any {\n        const fixtureConfig: ExportConfig | undefined = this.$iApi.fixture.get<ExportAPI>('export').config;\n        return fixtureConfig?.map;\n    }\n\n    async make(options: any): Promise<fabric.Image> {\n        const screenshot = await this.$iApi.geo.map.takeScreenshot({\n            quality: 1,\n            format: 'png'\n        });\n\n        // screenshot function returns a raw image data and a dataUrl\n        // load the dataUrl as an image and wrap it into the fabric.Image\n        const img = new Image();\n        img.src = screenshot.dataUrl;\n\n        const esriImage = await new Promise<HTMLImageElement>(resolve => (img.onload = () => resolve(img)));\n\n        return new fabric.Image(esriImage, options);\n    }\n}\n\nexport default ExportMapFixture;\n"],"names":["ExportMapFixture","FixtureInstance","options","screenshot","img","esriImage","resolve","fabric"],"mappings":";;AAMA,MAAMA,UAAyBC,EAA4C;AAAA,EACvE,IAAI,SAAc;AAEd,WADgD,KAAK,MAAM,QAAQ,IAAe,QAAQ,EAAE,QACtE;AAAA,EAAA;AAAA,EAG1B,MAAM,KAAKC,GAAqC;AAC5C,UAAMC,IAAa,MAAM,KAAK,MAAM,IAAI,IAAI,eAAe;AAAA,MACvD,SAAS;AAAA,MACT,QAAQ;AAAA,IAAA,CACX,GAIKC,IAAM,IAAI,MAAM;AACtB,IAAAA,EAAI,MAAMD,EAAW;AAEf,UAAAE,IAAY,MAAM,IAAI,QAA0B,CAAAC,MAAYF,EAAI,SAAS,MAAME,EAAQF,CAAG,CAAE;AAElG,WAAO,IAAIG,EAAA,OAAO,MAAMF,GAAWH,CAAO;AAAA,EAAA;AAElD;"}