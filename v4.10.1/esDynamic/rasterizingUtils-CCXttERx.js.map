{"version":3,"file":"rasterizingUtils-CCXttERx.js","sources":["../../node_modules/@arcgis/core/symbols/cim/rasterizingUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{packFloatRGBA as o}from\"../../core/floatRGBA.js\";import{nextPowerOfTwo as t}from\"../../core/mathUtils.js\";import{dashSdfRasterizationScale as r,dashSdfDistanceNormalization as a,dashRadius as e}from\"./constants.js\";const n=o=>\"vertical\"===o||\"horizontal\"===o||\"cross\"===o||\"esriSFSCross\"===o||\"esriSFSVertical\"===o||\"esriSFSHorizontal\"===o;function s(o,r,a){const e=r.style,s=t(Math.ceil(a)),i=n(e)?8*s:16*s,l=2*s;o.width=i,o.height=i;const h=o.getContext(\"2d\");h.strokeStyle=\"#ffffff\",h.lineWidth=s,h.beginPath(),\"vertical\"!==e&&\"cross\"!==e&&\"esriSFSCross\"!==e&&\"esriSFSVertical\"!==e||(h.moveTo(i/2,-l),h.lineTo(i/2,i+l)),\"horizontal\"!==e&&\"cross\"!==e&&\"esriSFSCross\"!==e&&\"esriSFSHorizontal\"!==e||(h.moveTo(-l,i/2),h.lineTo(i+l,i/2)),\"backward-diagonal\"!==e&&\"diagonal-cross\"!==e&&\"esriSFSDiagonalCross\"!==e&&\"esriSFSBackwardDiagonal\"!==e||(h.moveTo(-l,-l),h.lineTo(i+l,i+l),h.moveTo(i-l,-l),h.lineTo(i+l,l),h.moveTo(-l,i-l),h.lineTo(l,i+l)),\"forward-diagonal\"!==e&&\"diagonal-cross\"!==e&&\"esriSFSForwardDiagonal\"!==e&&\"esriSFSDiagonalCross\"!==e||(h.moveTo(i+l,-l),h.lineTo(-l,i+l),h.moveTo(l,-l),h.lineTo(-l,l),h.moveTo(i+l,i-l),h.lineTo(i-l,i+l)),h.stroke();const c=h.getImageData(0,0,o.width,o.height),m=new Uint8Array(c.data);let f;for(let t=0;t<m.length;t+=4)f=m[t+3]/255,m[t]=m[t]*f,m[t+1]=m[t+1]*f,m[t+2]=m[t+2]*f;return[m,o.width,o.height,s]}function i(t){t.length%2==1&&(t=[...t,...t]);const e=t.reduce(((o,t)=>o+t),0),n=Math.round(e*r),s=1,i=new Float32Array(n*s);let l=0,h=0,c=.5,m=!0;for(const o of t){for(l=h,h+=o*r;c<=h;){const o=c-.5,t=Math.min(Math.abs(c-l),Math.abs(c-h));i[o]=m?-t:t,c++}m=!m}const f=i.length,S=new Uint8Array(4*f);for(let g=0;g<f;++g){const t=i[g]/r;o(t/a*.5+.5,S,4*g)}return[S,n,s]}function l(t,r){null==t&&(t=[]);const a=\"Butt\"===r,n=\"Square\"===r,s=!a&&!n;t.length%2==1&&(t=[...t,...t]);const i=e,l=2*i;let h=0;for(const o of t)h+=o;const c=Math.round(h*i),m=new Float32Array(c*l),f=.5*i;let S=0,g=0,M=.5,d=!0;for(const o of t){for(S=g,g+=o*i;M<=g;){let o=.5;for(;o<l;){const t=(o-.5)*c+M-.5,r=s?(o-i)*(o-i):Math.abs(o-i);m[t]=d?a?Math.max(Math.max(S+f-M,r),Math.max(M-g+f,r)):r:s?Math.min((M-S)*(M-S)+r,(M-g)*(M-g)+r):n?Math.min(Math.max(M-S,r),Math.max(g-M,r)):Math.min(Math.max(M-S+f,r),Math.max(g+f-M,r)),o++}M++}d=!d}const T=m.length,F=new Uint8Array(4*T);for(let e=0;e<T;++e){const t=(s?Math.sqrt(m[e]):m[e])/i;o(t,F,4*e)}return[F,c,l]}export{l as rasterizeDash,i as rasterizeDash1D,s as rasterizeFillStyle};\n"],"names":["n","o","s","r","a","e","t","i","l","h","c","m","f","S","g","M","d","T","F"],"mappings":"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","x_google_ignoreList":[0]}