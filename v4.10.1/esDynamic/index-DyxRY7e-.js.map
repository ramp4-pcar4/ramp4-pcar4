{"version":3,"file":"index-DyxRY7e-.js","sources":["../../src/fixtures/appbar/store/appbar-state.ts","../../src/fixtures/appbar/default-button.vue","../../src/fixtures/appbar/divider.vue","../../node_modules/popper-max-size-modifier/dist/popper-max-size-modifier.esm.js","../../src/fixtures/appbar/more-button.vue","../../src/components/notification-center/appbar-button.vue","../../src/fixtures/appbar/appbar.vue","../../src/fixtures/appbar/api/appbar.ts","../../src/fixtures/appbar/lang/lang.csv?raw","../../src/fixtures/appbar/index.ts"],"sourcesContent":["export type AppbarItemSet = { [name: string]: string | AppbarItemInstance };\n\nexport interface AppbarFixtureConfig {\n    items: (string | AppbarItemConfig)[][];\n}\n\nexport interface AppbarItemConfig {\n    /**\n     * ID of this Appbar item.\n     *\n     * @type {string}\n     * @memberof AppbarItemConfig\n     */\n    id: string;\n\n    /**\n     * ID of the component of this appbar item.\n     *\n     * @type {string}\n     * @memberof AppbarItemConfig\n     */\n    componentId?: string;\n\n    /**\n     * The options for the displayed appbar button.\n     *\n     * @type {object}\n     * @memberof AppbarItemConfig\n     */\n    options?: object;\n}\n\nexport class AppbarItemInstance implements AppbarItemConfig {\n    id: string;\n\n    /**\n     * Optional object containing any options to be passed to the appbar component.\n     *\n     * @type {object}\n     * @memberof AppbarItemInstance\n     */\n    options: object;\n\n    /**\n     * An actual id of the appbar Vue component to use when rendering in the template.\n     *\n     * @type {string}\n     * @memberof AppbarItemInstance\n     */\n    componentId?: string;\n\n    constructor(value: AppbarItemConfig) {\n        const params = {\n            options: {},\n            ...value\n        };\n        ({ id: this.id, options: this.options, componentId: this.componentId } = params);\n\n        // this should work too, but it doesn't;\n        // ({ id: this.id, options: this.options } = { options: {}, ...(typeof value === 'string' ? { id: value} : value) });\n    }\n}\n","<template>\n    <appbar-button v-if=\"panelButton\" :onClickFunction=\"onClickFunction\" :tooltip=\"t(panelButton.tooltip)\" :id=\"panelId\"\n        ><div\n            class=\"default fill-current w-24 h-24 ml-8 sm:ml-20\"\n            :class=\"{ 'ml-20': overflow }\"\n            v-html=\"panelButton.icon\"\n        ></div\n    ></appbar-button>\n</template>\n\n<script setup lang=\"ts\">\nimport type { InstanceAPI } from '@/api';\nimport { computed, inject } from 'vue';\nimport { useI18n } from 'vue-i18n';\n\nconst { t } = useI18n();\nconst iApi = inject<InstanceAPI>('iApi');\n\nconst props = defineProps({\n    panelId: {\n        type: String,\n        required: true\n    },\n    minimize: {\n        type: Boolean,\n        default: false\n    },\n    overflow: {\n        type: Boolean\n    }\n});\n\nconst panelButton = computed(() => iApi?.panel.get(props.panelId)?.button);\n\nconst onClickFunction = () => {\n    if (props.minimize) {\n        iApi?.panel.toggleMinimize(props.panelId);\n    } else {\n        iApi?.panel.toggle(props.panelId);\n    }\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n","<template>\n    <span class=\"border-b p-0 self-center w-2/3\"></span>\n</template>\n\n<script setup lang=\"ts\"></script>\n\n<style lang=\"scss\" scoped>\nspan {\n    height: 0 !important;\n}\n</style>\n","import { detectOverflow } from '@popperjs/core';\n\nvar maxSize = {\n  name: 'maxSize',\n  enabled: true,\n  phase: 'main',\n  requiresIfExists: ['offset', 'preventOverflow', 'flip'],\n  fn: function fn(_ref) {\n    var state = _ref.state,\n        name = _ref.name,\n        options = _ref.options;\n    var overflow = detectOverflow(state, options);\n\n    var _ref2 = state.modifiersData.preventOverflow || {\n      x: 0,\n      y: 0\n    },\n        x = _ref2.x,\n        y = _ref2.y;\n\n    var _state$rects$popper = state.rects.popper,\n        width = _state$rects$popper.width,\n        height = _state$rects$popper.height;\n\n    var _state$placement$spli = state.placement.split('-'),\n        basePlacement = _state$placement$spli[0];\n\n    var widthProp = basePlacement === 'left' ? 'left' : 'right';\n    var heightProp = basePlacement === 'top' ? 'top' : 'bottom';\n    state.modifiersData[name] = {\n      width: width - overflow[widthProp] - x,\n      height: height - overflow[heightProp] - y\n    };\n  }\n};\n\nexport default maxSize;\n","<template>\n    <div class=\"appbar-item relative inset-x-0 w-full text-center\" ref=\"el\">\n        <!-- this is for appbar overflow button  -->\n        <button\n            type=\"button\"\n            class=\"text-gray-400 w-full h-48 focus:outline-none hover:text-white\"\n            @click=\"popperSetUp()\"\n            v-focus-item\n            :content=\"t('appbar.more')\"\n            :aria-label=\"t('appbar.more')\"\n            v-tippy=\"{ placement: 'right-end' }\"\n            ref=\"dropdownTrigger\"\n        >\n            <svg class=\"fill-current w-24 h-24 m-auto\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                <path\n                    d=\"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"\n                />\n            </svg>\n        </button>\n        <!-- this is for appbar overflow menu  -->\n        <div\n            v-show=\"open\"\n            id=\"dropdown\"\n            class=\"dropdown shadow-md border border-gray:200 absolute w-64 flex flex-col bg-white rounded\"\n            ref=\"dropdown\"\n        >\n            <slot></slot>\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { inject, nextTick, onBeforeUnmount, onMounted, ref, watch } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport type { InstanceAPI } from '@/api/internal';\n\nimport type { Placement, Modifier, State } from '@popperjs/core';\nimport { createPopper } from '@popperjs/core';\nimport maxSize from 'popper-max-size-modifier';\n\nconst { t } = useI18n();\nconst iApi = inject('iApi') as InstanceAPI;\n\nconst props = defineProps({\n    position: {\n        type: String,\n        default: 'right-end'\n    },\n    popperOptions: {\n        type: Object,\n        default() {\n            return {};\n        }\n    },\n    numItems: {\n        type: Number,\n        default: 1\n    },\n\n    renderWatch: {\n        type: Number,\n        default: 0\n    }\n});\nconst emit = defineEmits(['updateParent']);\n\nfunction updateParent() {\n    emit('updateParent');\n}\n\nconst open = ref(false);\nconst numRenders = ref(0);\nconst el = ref<Element>();\nconst dropdownTrigger = ref<Element>();\nconst dropdown = ref<HTMLElement>();\n\nfunction rerender() {\n    updateParent();\n    nextTick(() => {\n        popperSetUp();\n        open.value = !open.value;\n    });\n}\n\nwatch(\n    () => props.renderWatch,\n    () => {\n        rerender();\n    }\n);\n\nconst popperSetUp = () => {\n    open.value = !open.value;\n\n    const innerShell = iApi.$vApp.$el.querySelector('.inner-shell');\n\n    const applyMaxSize = {\n        name: 'applyMaxSize',\n        enabled: true,\n        phase: 'beforeWrite',\n        requires: ['maxSize'],\n        fn({ state }: { state: State }) {\n            // The `maxSize` modifier provides this data\n            const { width } = state.modifiersData.maxSize;\n\n            state.styles.popper = {\n                ...state.styles.popper,\n                maxWidth: `${width}px`,\n                maxHeight: `${innerShell.offsetHeight - 45}px`\n            };\n\n            const realHeight = Math.min(\n                props.numItems <= 0 ? 0 : 55 + 44 * (props.numItems - 1),\n                innerShell.offsetHeight - 45\n            );\n\n            state.styles.popper.height = `${realHeight}px`;\n            if (dropdown?.value?.offsetHeight) {\n                dropdown.value.style.height = `${realHeight}px`;\n            }\n\n            state.styles.popper.overflowY = 'auto';\n            state.styles.popper.overflowX = 'hidden';\n        }\n    };\n\n    if (dropdownTrigger.value && dropdown.value) {\n        numRenders.value++;\n        createPopper(dropdownTrigger.value as Element, dropdown.value as HTMLElement, {\n            placement: (props.position || 'right-end') as Placement,\n            modifiers: [\n                {\n                    ...maxSize,\n                    options: {\n                        boundary: innerShell\n                    }\n                },\n                applyMaxSize as Modifier<'applyMaxsize', {}>,\n                {\n                    name: 'offset',\n                    options: {\n                        offset: [0, 5]\n                    }\n                },\n                {\n                    name: 'preventOverflow',\n                    enabled: true,\n                    options: {\n                        boundary: innerShell\n                    }\n                }\n            ],\n            ...props.popperOptions\n        });\n    }\n\n    // if this is the first time the popper is being rendered, re-render it\n    if (numRenders.value === 1) rerender();\n};\n\nonMounted(() => {\n    window.addEventListener(\n        'click',\n        event => {\n            if (event.target instanceof HTMLElement && !el.value?.contains(event.target)) {\n                open.value = false;\n            }\n        },\n        { capture: true }\n    );\n});\n\nonBeforeUnmount(() => {\n    window.removeEventListener(\n        'click',\n        event => {\n            if (event.target instanceof HTMLElement && !el.value?.contains(event.target)) {\n                open.value = false;\n            }\n        },\n        { capture: true }\n    );\n});\n\ndefineExpose({\n    rerender\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.dropdown {\n    @apply left-full bottom-0;\n}\n\nbutton {\n    outline: none !important;\n\n    &.focused {\n        @apply bg-blue-900 text-white;\n    }\n}\n</style>\n","<template>\n    <appbar-button :onClickFunction=\"onClick\" :tooltip=\"t('notifications.title')\" class=\"notification-button\" id=\"\">\n        <!-- https://fonts.google.com/icons?selected=Material%20Icons%3Anotifications -->\n        <svg class=\"fill-current w-24 h-24 mx-8 sm:mx-20\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n            <path\n                d=\"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z\"\n            />\n        </svg>\n        <span class=\"number absolute top-1 right-2 text-white w-18 rounded-full\" v-if=\"number && number > 0\">{{\n            number\n        }}</span>\n    </appbar-button>\n</template>\n\n<script setup lang=\"ts\">\nimport { inject, computed } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport { useNotificationStore } from '@/stores/notification';\nimport type { InstanceAPI } from '@/api';\n\nconst notificationStore = useNotificationStore();\nconst { t } = useI18n();\nconst iApi = inject('iApi') as InstanceAPI;\n\nconst number = computed(() => notificationStore.notificationNumber);\n\nconst onClick = () => {\n    iApi.panel.toggle('notifications');\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.number {\n    background: red;\n    font-size: 0.8em;\n}\n\n.notification-button {\n    position: absolute !important;\n}\n</style>\n","<template>\n    <div\n        class=\"absolute top-0 left-0 bottom-28 flex flex-col w-40 pointer-events-auto appbar z-50 sm:z-20 bg-black-75 sm:w-64 sm:bottom-38\"\n        v-focus-list\n        :content=\"t('panels.controls.items')\"\n        v-tippy=\"{\n            trigger: 'manual',\n            touch: false,\n            placement: 'top-end',\n            popperOptions: {\n                placement: 'top',\n                modifiers: [\n                    { name: 'preventOverflow', options: { altAxis: true } },\n                    { name: 'flip', options: { fallbackPlacements: ['top'] } }\n                ]\n            }\n        }\"\n        ref=\"el\"\n    >\n        <template v-for=\"(subArray, index) in items\">\n            <template v-for=\"(item, index2) in subArray\">\n                <default-button\n                    v-if=\"typeof item === 'string' && overflowFlags[`${item}-${index2}`] !== true\"\n                    :key=\"`${item}-${index2}-default`\"\n                    :panelId=\"item\"\n                    class=\"appbar-item h-48\"\n                    :class=\"`identifier-${item}-${index2}`\"\n                ></default-button>\n                <component\n                    v-else-if=\"overflowFlags[`${item}-${index2}`] !== true\"\n                    :is=\"item.componentId\"\n                    :key=\"`${item}-${index2}-custom`\"\n                    :options=\"item.options\"\n                    class=\"appbar-item h-48\"\n                    :id=\"item.id\"\n                    :class=\"`identifier-${item}-${index2}`\"\n                ></component>\n            </template>\n            <divider\n                class=\"appbar-item\"\n                :class=\"`identifier-divider-${index}`\"\n                v-if=\"overflowFlags[`divider-${index}`] !== true\"\n                :key=\"`${subArray}-${index}-default`\"\n            />\n        </template>\n\n        <default-button\n            v-for=\"item in temporaryItems?.filter(t => overflowFlags[`${t}-temp`] !== true)\"\n            :panelId=\"item\"\n            :minimize=\"true\"\n            :key=\"`${item}-temp`\"\n            :class=\"`identifier-${item}-temp`\"\n            class=\"appbar-item h-48\"\n        ></default-button>\n\n        <more-button\n            id=\"more\"\n            v-show=\"overflow\"\n            :numItems=\"numberOverflow\"\n            :renderWatch=\"popperRerender\"\n            @update-parent=\"rerender\"\n        >\n            <template v-slot:default>\n                <template v-for=\"(subArray, index) in items\" :key=\"index\">\n                    <template v-for=\"(item, index2) in subArray\">\n                        <default-button\n                            v-if=\"typeof item === 'string' && overflowFlags[`${item}-${index2}`]\"\n                            :key=\"`${item}-${index2}-default`\"\n                            :panelId=\"item\"\n                            class=\"text-black hover:bg-gray my-4 h-36\"\n                            :class=\"`identifier-${item}-${index2}`\"\n                            overflow\n                        ></default-button>\n                        <component\n                            v-else-if=\"overflowFlags[`${item}-${index2}`]\"\n                            :is=\"item!.componentId\"\n                            :key=\"`${item}-${index2}-custom`\"\n                            :options=\"item.options\"\n                            :id=\"item.id\"\n                            class=\"appbar-item h-48\"\n                            :class=\"`identifier-${item}-${index2}`\"\n                        ></component>\n                    </template>\n                    <divider\n                        class=\"border-black my-4\"\n                        :class=\"`identifier-divider-${index}`\"\n                        v-if=\"overflowFlags[`divider-${index}`]\"\n                    ></divider>\n                </template>\n\n                <default-button\n                    v-for=\"item in temporaryItems?.filter(t => overflowFlags[`${t}-temp`])\"\n                    :panelId=\"item\"\n                    :minimize=\"true\"\n                    :key=\"`${item}-temp`\"\n                    :class=\"`identifier-${item}-temp`\"\n                    class=\"text-black hover:bg-gray my-4 h-36\"\n                    overflow\n                ></default-button>\n            </template>\n        </more-button>\n        <notifications-appbar-button class=\"appbar-item bottom-48 h-48 sm:display-none\"></notifications-appbar-button>\n\n        <!-- TODO: disabled this button for now, revist this when we need it in the future -->\n        <!-- <nav-button id=\"nav\"></nav-button> -->\n        <about-ramp-dropdown\n            class=\"absolute bottom-0 h-40 sm:display-none w-full text-center\"\n            position=\"right-start\"\n        ></about-ramp-dropdown>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, getCurrentInstance, nextTick, onBeforeMount, onBeforeUnmount, onMounted, onUpdated, ref } from 'vue';\nimport DefaultButton from './default-button.vue';\nimport Divider from './divider.vue';\nimport MoreButton from './more-button.vue';\n//import NavAppbarButtonV from './nav-button.vue';\nimport NotificationsAppbarButton from '@/components/notification-center/appbar-button.vue';\nimport AboutRampDropdown from '@/components/about-ramp/about-ramp-dropdown.vue';\nimport { usePanelStore } from '@/stores/panel';\nimport { useAppbarStore } from './store';\nimport { useI18n } from 'vue-i18n';\n\nconst panelStore = usePanelStore();\nconst appbarStore = useAppbarStore();\nconst numberOverflow = ref(0);\nconst popperRerender = ref(0);\n\nconst items = computed<any>(() => appbarStore.visible);\nconst temporaryItems = computed<string[] | undefined>(() => appbarStore.temporary);\nconst { t } = useI18n();\nconst overflow = ref(false);\nconst overflowFlags = ref<{\n    [key: string]: boolean;\n}>({});\n\nconst el = ref<Element>();\n\n// When the popper (from the more-button component) is rendered for the first time, it tends to\n// overlap the top border of the `inner-shell` component. Re-rendering the appbar (as well as recreating\n// the popper) seems to resolve this. The same issue tends to occur when opening a new (non-default) panel,\n// then opening the popper. When closing a non-default panel (ex. grid, details) while the popper is open, there\n// would have been empty space in the popper (due to the way that the popper height is set in the more-button\n// component). Re-rendering the appbar also fixes this. Note: this solution isn't really tackling the root cause\n// of the issue, and seems inefficient. If a better solution exists, feel free to implement it and remove this\n// function (as well as the other code involved in re-rendering)\nconst rerender = () => {\n    nextTick(() => {\n        const instance = getCurrentInstance();\n        instance?.proxy?.$forceUpdate();\n    });\n};\n\nconst blurEvent = () => {\n    (el.value as any)._tippy.hide();\n};\n\nconst keyupEvent = (e: Event) => {\n    const evt = e as KeyboardEvent;\n    if (evt.key === 'Tab' && el.value?.matches(':focus')) {\n        (el.value as any)._tippy.show();\n    }\n};\n\nonMounted(() => {\n    el.value?.addEventListener('blur', blurEvent);\n\n    el.value?.addEventListener('keyup', keyupEvent);\n});\n\nonBeforeMount(() => {\n    const instance = getCurrentInstance();\n    window.addEventListener('resize', () => instance?.proxy?.$forceUpdate());\n});\n\nonBeforeUnmount(() => {\n    const instance = getCurrentInstance();\n    window.removeEventListener('resize', () => instance?.proxy?.$forceUpdate());\n\n    el.value?.removeEventListener('blur', blurEvent);\n\n    el.value?.removeEventListener('keyup', keyupEvent);\n});\n\nonUpdated(() => {\n    nextTick(() => {\n        const element: Element = el.value!;\n        let key: string | undefined = undefined;\n        let children: Element[] = [...element.children];\n        let bound: number | undefined = children[children.length - 2].getBoundingClientRect().top;\n        if (!panelStore.mobileView) {\n            bound = element.getBoundingClientRect().bottom - 38;\n        }\n        let dropdown: Element | null = element.querySelector('#dropdown');\n        // check positions of appbar buttons\n        for (let i = children.length - 4; i >= 0; i--) {\n            let bottom: number = children[i].getBoundingClientRect().bottom;\n            if (bound && dropdown && (bottom > bound || (overflow.value && bottom + 56 > bound))) {\n                children[i].classList.forEach(cl => {\n                    if (cl.includes('identifier')) {\n                        key = cl.slice(11);\n                    }\n                });\n                if (key) {\n                    overflowFlags.value[key] = true;\n                    if (!(key as String).includes('divider')) {\n                        numberOverflow.value++;\n                    }\n                    popperRerender.value++;\n                }\n                if (!overflow.value) overflow.value = true;\n            } else if (bottom !== 0) {\n                break;\n            }\n        }\n        // check position of more button\n        let more: Element | null = element.querySelector('#more');\n        let moreBottom = more!.getBoundingClientRect().bottom;\n        key = undefined;\n        if (\n            overflow.value &&\n            bound &&\n            more &&\n            dropdown &&\n            moreBottom !== 0 &&\n            (moreBottom <= bound - 56 || (dropdown.childElementCount == 1 && moreBottom <= bound))\n        ) {\n            // dropdown.classList.add(`max-h-${moreBottom - 8}`);\n            let buttonsRemaining: number = dropdown.childElementCount;\n            let index: number = 0;\n            while (moreBottom <= bound - 56 || buttonsRemaining == 1) {\n                let item: Element | null = dropdown.children[index];\n                if (item) {\n                    item.classList.forEach(cl => {\n                        if (cl.includes('identifier')) {\n                            key = cl.slice(11);\n                        }\n                    });\n                    if (key) {\n                        overflowFlags.value[key] = false;\n                        if (!(key as String).includes('divider')) {\n                            numberOverflow.value--;\n                        }\n                    }\n                    moreBottom += 48;\n                    buttonsRemaining -= 1;\n                    index += 1;\n                }\n                if (buttonsRemaining === 0) {\n                    overflow.value = false;\n                    break;\n                }\n            }\n        }\n        // clean up flags for items that were removed.\n        Object.keys(overflowFlags.value).forEach((key: string) => {\n            if (!element.querySelector(`.identifier-${key}`)) {\n                delete overflowFlags.value[key];\n                if (!key.includes('divider')) {\n                    numberOverflow.value = Math.max(0, numberOverflow.value - 1);\n                }\n                popperRerender.value++;\n            }\n        });\n    });\n});\n</script>\n\n<style lang=\"scss\">\n.appbar {\n    backdrop-filter: blur(5px);\n\n    .appbar-item {\n        @apply my-4 text-gray-400 first:mt-8 hover:text-white;\n    }\n}\n</style>\n","import { FixtureInstance } from '@/api';\n\nimport { AppbarItemInstance } from '../store';\n\nimport type { AppbarFixtureConfig, AppbarItemSet } from '../store';\n\nimport { useAppbarStore } from '../store';\n\nexport class AppbarAPI extends FixtureInstance {\n    /**\n     * Returns `AppbarFixtureConfig` section of the global config file.\n     *\n     * @readonly\n     * @type {AppbarFixtureConfig}\n     * @memberof AppbarFixture\n     */\n    get config(): AppbarFixtureConfig | undefined {\n        return super.config;\n    }\n\n    /**\n     * Parses the appbar config JSON snippet from the config file and save resulting objects to the fixture store.\n     *\n     * @param {AppbarFixtureConfig} [appbarConfig]\n     * @returns\n     * @memberof AppbarAPI\n     */\n    _parseConfig(appbarConfig?: AppbarFixtureConfig) {\n        if (!appbarConfig) {\n            return;\n        }\n\n        const appbarStore = useAppbarStore(this.$vApp.$pinia);\n\n        let config;\n        // wrap the appbar config if needed so it is always a 2d array\n        if (!Array.isArray(appbarConfig.items[0])) {\n            config = [appbarConfig.items];\n        } else {\n            config = appbarConfig.items;\n        }\n\n        const appbarItems: (string | AppbarItemInstance)[][] = [];\n\n        config.forEach((appbarItemList: any[]) => {\n            appbarItems.push(\n                appbarItemList.map(item => {\n                    if (typeof item === 'string') {\n                        return item;\n                    }\n                    return new AppbarItemInstance(item);\n                })\n            );\n        });\n\n        // save appbar items as a collection to the store\n        // they are saves as a set for easy by-id access\n        appbarStore.items = appbarItems.flat().reduce<AppbarItemSet>((map, item) => {\n            map[item instanceof AppbarItemInstance ? item.id : item] = item;\n            return map;\n        }, {});\n\n        // save an ordered list of item ids to use when rendering components\n        appbarStore.order = appbarItems.map(subArray =>\n            subArray.map(item => (item instanceof AppbarItemInstance ? item.id : item))\n        );\n\n        this._validateItems();\n    }\n\n    /**\n     * Checks if components specified as appbar items are registered or not.\n     *\n     * @memberof AppbarAPI\n     */\n    _validateItems() {\n        const appbarStore = useAppbarStore(this.$vApp.$pinia);\n        // get the ordered list of items and see if any of them are registered\n        appbarStore.order.flat().forEach(id => {\n            if (typeof appbarStore.items[id] === 'string') {\n                return;\n            }\n            // check for components with the id\n            [id].some(v => {\n                if (this.$iApi.fixture.exists(v) && !appbarStore.items[id]) {\n                    // if an item is registered globally, save the name of the registered component\n                    (appbarStore.items[id] as unknown as AppbarItemInstance).componentId = `${v}-appbar-button`;\n                }\n            });\n        });\n    }\n}\n","export default \"key,enValue,enValid,frValue,frValid\\nappbar.navigation,Navigation,1,Navigation,1\\nappbar.more,More,1,Plus,1\\nnavigation.export,Export,1,Exporter,1\\nnavigation.map.export,Export Map,1,Exporter la Carte,1\\n\"","import AppbarV from './appbar.vue';\nimport { AppbarAPI } from './api/appbar';\nimport { useAppbarStore } from './store';\nimport type { AppbarFixtureConfig } from './store';\nimport { GlobalEvents } from '@/api';\nimport messages from './lang/lang.csv?raw';\n\n// \"It's a trap!\" -- Admiral Appbar\n\nclass AppbarFixture extends AppbarAPI {\n    initialized() {\n        // console.log(`[fixture] ${this.id} initialized`);\n    }\n\n    async added() {\n        // console.log(`[fixture] ${this.id} added`);\n\n        // merge in translations since this has no panel\n        Object.entries(messages).forEach(value => (<any>this.$iApi.$i18n).mergeLocaleMessage(...value));\n\n        const { destroy, el } = this.mount(AppbarV, {\n            app: this.$element\n        });\n        const innerShell = this.$vApp.$el.getElementsByClassName('inner-shell')[0];\n        innerShell.insertBefore(el.childNodes[0], innerShell.querySelector('.panel-stack'));\n\n        this._parseConfig(this.config);\n        const unwatch = this.$vApp.$watch(\n            () => this.config,\n            (value: AppbarFixtureConfig | undefined) => this._parseConfig(value)\n        );\n\n        const eventHandlers: string[] = [];\n\n        // since components used in appbar can be registered after this point, listen to the global component registration event and re-validate items\n        // TODO revisit. this seems to be self-contained to the appbar fixture, so ideally can stay as is and not worry about events api.\n        eventHandlers.push(\n            this.$iApi.event.on(GlobalEvents.COMPONENT, () => {\n                this._parseConfig(this.config);\n            })\n        );\n\n        this.removed = () => {\n            const appbarStore = useAppbarStore(this.$vApp.$pinia);\n            // console.log(`[fixture] ${this.id} removed`);\n            unwatch();\n            eventHandlers.forEach(h => this.$iApi.event.off(h));\n\n            // gracefully remove all buttons first (in case anything is watching for button removal)\n            const items: any = { ...appbarStore.items };\n            const tempItems: string[] = [...appbarStore.temporary];\n            Object.keys(items).forEach(item => appbarStore.removeButton(item));\n            tempItems.forEach(item => appbarStore.removeButton(item));\n            destroy();\n\n            // reset the store\n            appbarStore.$reset();\n        };\n    }\n}\n\nexport default AppbarFixture;\n"],"names":["AppbarItemInstance","value","params","t","useI18n","iApi","inject","props","__props","panelButton","computed","onClickFunction","_sfc_render","_ctx","_cache","maxSize","_ref","state","name","options","overflow","detectOverflow","_ref2","x","y","_state$rects$popper","width","height","_state$placement$spli","basePlacement","widthProp","heightProp","emit","__emit","updateParent","open","ref","numRenders","el","dropdownTrigger","dropdown","rerender","nextTick","popperSetUp","watch","innerShell","applyMaxSize","realHeight","createPopper","onMounted","event","onBeforeUnmount","__expose","notificationStore","useNotificationStore","number","onClick","panelStore","usePanelStore","appbarStore","useAppbarStore","numberOverflow","popperRerender","items","temporaryItems","overflowFlags","getCurrentInstance","blurEvent","keyupEvent","e","onBeforeMount","instance","onUpdated","element","key","children","bound","bottom","cl","more","moreBottom","buttonsRemaining","index","item","AppbarAPI","FixtureInstance","appbarConfig","config","appbarItems","appbarItemList","map","subArray","id","v","messages","AppbarFixture","destroy","AppbarV","unwatch","eventHandlers","GlobalEvents","h","tempItems"],"mappings":"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","x_google_ignoreList":[3]}