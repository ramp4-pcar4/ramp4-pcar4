const V=new Int32Array(2),Pt=new Float32Array(V.buffer),Ut=new Float64Array(V.buffer),J=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var lt;(function(n){n[n.UTF8_BYTES=1]="UTF8_BYTES",n[n.UTF16_STRING=2]="UTF16_STRING"})(lt||(lt={}));class E{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new E(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return V[0]=this.readInt32(t),Pt[0]}readFloat64(t){return V[J?0:1]=this.readInt32(t),V[J?1:0]=this.readInt32(t+4),Ut[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){Pt[0]=e,this.writeInt32(t,V[0])}writeFloat64(t,e){Ut[0]=e,this.writeInt32(t,V[J?0:1]),this.writeInt32(t+4,V[J?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const r=t-this.readInt32(t);return e<this.readInt16(r)?this.readInt16(r+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const r=this.readInt32(t);t+=4;const s=this.bytes_.subarray(t,t+r);return e===lt.UTF8_BYTES?s:this.text_decoder_.decode(s)}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createScalarList(t,e){const r=[];for(let s=0;s<e;++s){const i=t(s);i!==null&&r.push(i)}return r}createObjList(t,e){const r=[];for(let s=0;s<e;++s){const i=t(s);i!==null&&r.push(i.unpack())}return r}}class st{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let e;t?e=t:e=1024,this.bb=E.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const r=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<r+t+e;){const s=this.bb.capacity();this.bb=st.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(r)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,r){(this.force_defaults||e!=r)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,r){(this.force_defaults||e!=r)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,r){(this.force_defaults||e!=r)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,r){(this.force_defaults||e!==r)&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,r){(this.force_defaults||e!=r)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,r){(this.force_defaults||e!=r)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,r){e!=r&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const r=e<<1,s=E.allocate(r);return s.setPosition(r-e),s.bytes().set(t.bytes(),r-e),s}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);const r=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);const s=2;this.addInt16(t-this.object_start);const i=(r+s)*2;this.addInt16(i);let o=0;const u=this.space;t:for(e=0;e<this.vtables.length;e++){const l=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(l)){for(let a=2;a<i;a+=2)if(this.bb.readInt16(u+a)!=this.bb.readInt16(l+a))continue t;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,r){const s=r?4:0;if(e){const i=e;if(this.prep(this.minalign,8+s),i.length!=4)throw new TypeError("FlatBuffers: file identifier must be length 4");for(let o=3;o>=0;o--)this.writeInt8(i.charCodeAt(o))}this.prep(this.minalign,4+s),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const r=this.bb.capacity()-t,s=r-this.bb.readInt32(r);if(!(e<this.bb.readInt16(s)&&this.bb.readInt16(s+e)!=0))throw new TypeError("FlatBuffers: field "+e+" must be set")}startVector(t,e,r){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(r,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(t==null)return 0;let e;return t instanceof Uint8Array?e=t:e=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length),this.bb.bytes().set(e,this.space),this.endVector()}createByteVector(t){return t==null?0:(this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),this.bb.bytes().set(t,this.space),this.endVector())}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let r=0;r<t.length;++r){const s=t[r];if(s!==null)e.push(this.createObjectOffset(s));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}}const ut=new Uint8Array(0);function Wt(){return this._source.cancel()}function Ht(n,t){if(!n.length)return t;if(!t.length)return n;var e=new Uint8Array(n.length+t.length);return e.set(n),e.set(t,n.length),e}function Xt(){var n=this,t=n._array.subarray(n._index);return n._source.read().then(function(e){return n._array=ut,n._index=0,e.done?t.length>0?{done:!1,value:t}:{done:!0,value:void 0}:{done:!1,value:Ht(t,e.value)}})}function Zt(n){if((n|=0)<0)throw new Error("invalid length");var t=this,e=this._array.length-this._index;if(this._index+n<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=n));var r=new Uint8Array(n);return r.set(this._array.subarray(this._index)),function s(){return t._source.read().then(function(i){return i.done?(t._array=ut,t._index=0,e>0?r.subarray(0,e):null):e+i.value.length>=n?(t._array=i.value,t._index=n-e,r.set(i.value.subarray(0,n-e),e),r):(r.set(i.value,e),e+=i.value.length,s())})}()}function Jt(n){return typeof n.slice=="function"?n:new $(typeof n.read=="function"?n:n.getReader())}function $(n){this._source=n,this._array=ut,this._index=0}$.prototype.read=Xt,$.prototype.slice=Zt,$.prototype.cancel=Wt;var g,y;(g=y||(y={}))[g.Byte=0]="Byte",g[g.UByte=1]="UByte",g[g.Bool=2]="Bool",g[g.Short=3]="Short",g[g.UShort=4]="UShort",g[g.Int=5]="Int",g[g.UInt=6]="UInt",g[g.Long=7]="Long",g[g.ULong=8]="ULong",g[g.Float=9]="Float",g[g.Double=10]="Double",g[g.String=11]="String",g[g.Json=12]="Json",g[g.DateTime=13]="DateTime",g[g.Binary=14]="Binary";class v{bb=null;bb_pos=0;__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsColumn(t,e){return(e||new v).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsColumn(t,e){return t.setPosition(t.position()+4),(e||new v).__init(t.readInt32(t.position())+t.position(),t)}name(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):y.Byte}title(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}width(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt32(this.bb_pos+t):-1}precision(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt32(this.bb_pos+t):-1}scale(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt32(this.bb_pos+t):-1}nullable(){let t=this.bb.__offset(this.bb_pos,18);return!t||!!this.bb.readInt8(this.bb_pos+t)}unique(){let t=this.bb.__offset(this.bb_pos,20);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}primaryKey(){let t=this.bb.__offset(this.bb_pos,22);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}metadata(t){let e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__string(this.bb_pos+e,t):null}static startColumn(t){t.startObject(11)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,y.Byte)}static addTitle(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWidth(t,e){t.addFieldInt32(4,e,-1)}static addPrecision(t,e){t.addFieldInt32(5,e,-1)}static addScale(t,e){t.addFieldInt32(6,e,-1)}static addNullable(t,e){t.addFieldInt8(7,+e,1)}static addUnique(t,e){t.addFieldInt8(8,+e,0)}static addPrimaryKey(t,e){t.addFieldInt8(9,+e,0)}static addMetadata(t,e){t.addFieldOffset(10,e,0)}static endColumn(t){let e=t.endObject();return t.requiredField(e,4),e}static createColumn(t,e,r,s,i,o,u,l,a,h,b,c){return v.startColumn(t),v.addName(t,e),v.addType(t,r),v.addTitle(t,s),v.addDescription(t,i),v.addWidth(t,o),v.addPrecision(t,u),v.addScale(t,l),v.addNullable(t,a),v.addUnique(t,h),v.addPrimaryKey(t,b),v.addMetadata(t,c),v.endColumn(t)}}class P{bb=null;bb_pos=0;__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCrs(t,e){return(e||new P).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCrs(t,e){return t.setPosition(t.position()+4),(e||new P).__init(t.readInt32(t.position())+t.position(),t)}org(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}code(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}name(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}wkt(t){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,t):null}codeString(t){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,t):null}static startCrs(t){t.startObject(6)}static addOrg(t,e){t.addFieldOffset(0,e,0)}static addCode(t,e){t.addFieldInt32(1,e,0)}static addName(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWkt(t,e){t.addFieldOffset(4,e,0)}static addCodeString(t,e){t.addFieldOffset(5,e,0)}static endCrs(t){return t.endObject()}static createCrs(t,e,r,s,i,o,u){return P.startCrs(t),P.addOrg(t,e),P.addCode(t,r),P.addName(t,s),P.addDescription(t,i),P.addWkt(t,o),P.addCodeString(t,u),P.endCrs(t)}}var _,I;(_=I||(I={}))[_.Unknown=0]="Unknown",_[_.Point=1]="Point",_[_.LineString=2]="LineString",_[_.Polygon=3]="Polygon",_[_.MultiPoint=4]="MultiPoint",_[_.MultiLineString=5]="MultiLineString",_[_.MultiPolygon=6]="MultiPolygon",_[_.GeometryCollection=7]="GeometryCollection",_[_.CircularString=8]="CircularString",_[_.CompoundCurve=9]="CompoundCurve",_[_.CurvePolygon=10]="CurvePolygon",_[_.MultiCurve=11]="MultiCurve",_[_.MultiSurface=12]="MultiSurface",_[_.Curve=13]="Curve",_[_.Surface=14]="Surface",_[_.PolyhedralSurface=15]="PolyhedralSurface",_[_.TIN=16]="TIN",_[_.Triangle=17]="Triangle";class S{bb=null;bb_pos=0;__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsHeader(t,e){return(e||new S).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsHeader(t,e){return t.setPosition(t.position()+4),(e||new S).__init(t.readInt32(t.position())+t.position(),t)}name(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}envelope(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}envelopeLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}envelopeArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}geometryType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):I.Unknown}hasZ(){let t=this.bb.__offset(this.bb_pos,10);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasM(){let t=this.bb.__offset(this.bb_pos,12);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasT(){let t=this.bb.__offset(this.bb_pos,14);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasTm(){let t=this.bb.__offset(this.bb_pos,16);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}columns(t,e){let r=this.bb.__offset(this.bb_pos,18);return r?(e||new v).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}columnsLength(){let t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}featuresCount(){let t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readUint64(this.bb_pos+t):BigInt("0")}indexNodeSize(){let t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint16(this.bb_pos+t):16}crs(t){let e=this.bb.__offset(this.bb_pos,24);return e?(t||new P).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}title(t){let e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){let e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__string(this.bb_pos+e,t):null}metadata(t){let e=this.bb.__offset(this.bb_pos,30);return e?this.bb.__string(this.bb_pos+e,t):null}static startHeader(t){t.startObject(14)}static addName(t,e){t.addFieldOffset(0,e,0)}static addEnvelope(t,e){t.addFieldOffset(1,e,0)}static createEnvelopeVector(t,e){t.startVector(8,e.length,8);for(let r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startEnvelopeVector(t,e){t.startVector(8,e,8)}static addGeometryType(t,e){t.addFieldInt8(2,e,I.Unknown)}static addHasZ(t,e){t.addFieldInt8(3,+e,0)}static addHasM(t,e){t.addFieldInt8(4,+e,0)}static addHasT(t,e){t.addFieldInt8(5,+e,0)}static addHasTm(t,e){t.addFieldInt8(6,+e,0)}static addColumns(t,e){t.addFieldOffset(7,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static addFeaturesCount(t,e){t.addFieldInt64(8,e,BigInt("0"))}static addIndexNodeSize(t,e){t.addFieldInt16(9,e,16)}static addCrs(t,e){t.addFieldOffset(10,e,0)}static addTitle(t,e){t.addFieldOffset(11,e,0)}static addDescription(t,e){t.addFieldOffset(12,e,0)}static addMetadata(t,e){t.addFieldOffset(13,e,0)}static endHeader(t){return t.endObject()}static finishHeaderBuffer(t,e){t.finish(e)}static finishSizePrefixedHeaderBuffer(t,e){t.finish(e,void 0,!0)}}class w{bb=null;bb_pos=0;__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGeometry(t,e){return(e||new w).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGeometry(t,e){return t.setPosition(t.position()+4),(e||new w).__init(t.readInt32(t.position())+t.position(),t)}ends(t){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+4*t):0}endsLength(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}endsArray(){let t=this.bb.__offset(this.bb_pos,4);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}xy(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}xyLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}xyArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}z(t){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}zLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}zArray(){let t=this.bb.__offset(this.bb_pos,8);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}m(t){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}mLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}mArray(){let t=this.bb.__offset(this.bb_pos,10);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}t(t){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}tLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}tArray(){let t=this.bb.__offset(this.bb_pos,12);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}tm(t){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+8*t):BigInt(0)}tmLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}type(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):I.Unknown}parts(t,e){let r=this.bb.__offset(this.bb_pos,18);return r?(e||new w).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}partsLength(){let t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startGeometry(t){t.startObject(8)}static addEnds(t,e){t.addFieldOffset(0,e,0)}static createEndsVector(t,e){t.startVector(4,e.length,4);for(let r=e.length-1;r>=0;r--)t.addInt32(e[r]);return t.endVector()}static startEndsVector(t,e){t.startVector(4,e,4)}static addXy(t,e){t.addFieldOffset(1,e,0)}static createXyVector(t,e){t.startVector(8,e.length,8);for(let r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startXyVector(t,e){t.startVector(8,e,8)}static addZ(t,e){t.addFieldOffset(2,e,0)}static createZVector(t,e){t.startVector(8,e.length,8);for(let r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startZVector(t,e){t.startVector(8,e,8)}static addM(t,e){t.addFieldOffset(3,e,0)}static createMVector(t,e){t.startVector(8,e.length,8);for(let r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startMVector(t,e){t.startVector(8,e,8)}static addT(t,e){t.addFieldOffset(4,e,0)}static createTVector(t,e){t.startVector(8,e.length,8);for(let r=e.length-1;r>=0;r--)t.addFloat64(e[r]);return t.endVector()}static startTVector(t,e){t.startVector(8,e,8)}static addTm(t,e){t.addFieldOffset(5,e,0)}static createTmVector(t,e){t.startVector(8,e.length,8);for(let r=e.length-1;r>=0;r--)t.addInt64(e[r]);return t.endVector()}static startTmVector(t,e){t.startVector(8,e,8)}static addType(t,e){t.addFieldInt8(6,e,I.Unknown)}static addParts(t,e){t.addFieldOffset(7,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(let r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static endGeometry(t){return t.endObject()}static createGeometry(t,e,r,s,i,o,u,l,a){return w.startGeometry(t),w.addEnds(t,e),w.addXy(t,r),w.addZ(t,s),w.addM(t,i),w.addT(t,o),w.addTm(t,u),w.addType(t,l),w.addParts(t,a),w.endGeometry(t)}}class x{bb=null;bb_pos=0;__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFeature(t,e){return(e||new x).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFeature(t,e){return t.setPosition(t.position()+4),(e||new x).__init(t.readInt32(t.position())+t.position(),t)}geometry(t){let e=this.bb.__offset(this.bb_pos,4);return e?(t||new w).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}properties(t){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}propertiesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}propertiesArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}columns(t,e){let r=this.bb.__offset(this.bb_pos,8);return r?(e||new v).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*t),this.bb):null}columnsLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFeature(t){t.startObject(3)}static addGeometry(t,e){t.addFieldOffset(0,e,0)}static addProperties(t,e){t.addFieldOffset(1,e,0)}static createPropertiesVector(t,e){t.startVector(1,e.length,1);for(let r=e.length-1;r>=0;r--)t.addInt8(e[r]);return t.endVector()}static startPropertiesVector(t,e){t.startVector(1,e,1)}static addColumns(t,e){t.addFieldOffset(2,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let r=e.length-1;r>=0;r--)t.addOffset(e[r]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static endFeature(t){return t.endObject()}static finishFeatureBuffer(t,e){t.finish(e)}static finishSizePrefixedFeatureBuffer(t,e){t.finish(e,void 0,!0)}static createFeature(t,e,r,s){return x.startFeature(t),x.addGeometry(t,e),x.addProperties(t,r),x.addColumns(t,s),x.endFeature(t)}}function ht(n){let t=S.getRootAsHeader(n),e=t.featuresCount(),r=t.indexNodeSize(),s=[];for(let u=0;u<t.columnsLength();u++){let l=t.columns(u);if(!l)throw Error("Column unexpectedly missing");if(!l.name())throw Error("Column name unexpectedly missing");s.push({name:l.name(),type:l.type(),title:l.title(),description:l.description(),width:l.width(),precision:l.precision(),scale:l.scale(),nullable:l.nullable(),unique:l.unique(),primary_key:l.primaryKey()})}let i=t.crs(),o=i?{org:i.org(),code:i.code(),name:i.name(),description:i.description(),wkt:i.wkt(),code_string:i.codeString()}:null;return{geometryType:t.geometryType(),columns:s,envelope:null,featuresCount:Number(e),indexNodeSize:r,crs:o,title:t.title(),description:t.description(),metadata:t.metadata()}}function St(n,t){let e,r,{xy:s,z:i,ends:o,parts:u,type:l}=t;if(u){let h=u.map(c=>St(n,c)),b=w.createPartsVector(n,h);return w.startGeometry(n),w.addParts(n,b),w.addType(n,l),w.endGeometry(n)}let a=w.createXyVector(n,s);return i&&(e=w.createZVector(n,i)),o&&(r=w.createEndsVector(n,o)),w.startGeometry(n),r&&w.addEnds(n,r),w.addXy(n,a),e&&w.addZ(n,e),w.addType(n,l),w.endGeometry(n)}function ct(n,t,e){if(n.length!==0)if(Array.isArray(n[0]))for(let r of n)ct(r,t,e);else n.length===2?t.push(...n):(t.push(n[0],n[1]),e.push(n[2]))}function bt(n,t){let e=[];for(let r=0;r<n.length;r+=2){let s=[n[r],n[r+1]];t&&s.push(t[r>>1]),e.push(s)}return e}function Y(n){return n?I[n]:I.Unknown}let Ot=new TextEncoder,Ct=new TextDecoder;function $t(n,t,e){let r=e.columns,s=new st,i=0,o=1024,u=new Uint8Array(1024),l=new DataView(u.buffer),a=function(d){if(i+d<o)return;let f=new Uint8Array(o=Math.max(o+d,2*o));f.set(u),l=new DataView((u=f).buffer)};if(r)for(let d=0;d<r.length;d++){let f=r[d],p=t[f.name];if(p!==null)switch(a(2),l.setUint16(i,d,!0),i+=2,f.type){case y.Bool:a(1),l.setUint8(i,p),i+=1;break;case y.Short:a(2),l.setInt16(i,p,!0),i+=2;break;case y.UShort:a(2),l.setUint16(i,p,!0),i+=2;break;case y.Int:a(4),l.setInt32(i,p,!0),i+=4;break;case y.UInt:a(4),l.setUint32(i,p,!0),i+=4;break;case y.Long:a(8),l.setBigInt64(i,BigInt(p),!0),i+=8;break;case y.Float:a(4),l.setFloat32(i,p,!0),i+=4;break;case y.Double:a(8),l.setFloat64(i,p,!0),i+=8;break;case y.DateTime:case y.String:{let m=Ot.encode(p);a(4),l.setUint32(i,m.length,!0),i+=4,a(m.length),u.set(m,i),i+=m.length;break}case y.Json:{let m=Ot.encode(JSON.stringify(p));a(4),l.setUint32(i,m.length,!0),i+=4,a(m.length),u.set(m,i),i+=m.length;break}default:throw Error("Unknown type "+f.type)}}let h=0;i>0&&(h=x.createPropertiesVector(s,u.slice(0,i)));let b=St(s,n);x.startFeature(s),x.addGeometry(s,b),h&&x.addProperties(s,h);let c=x.endFeature(s);return s.finishSizePrefixed(c),s.asUint8Array()}function Yt(n,t){let e={};if(!t||t.length===0)return e;let r=n.propertiesArray();if(!r)return e;let s=new DataView(r.buffer,r.byteOffset),i=n.propertiesLength(),o=0;for(;o<i;){let u=s.getUint16(o,!0);o+=2;let l=t[u],a=l.name;switch(l.type){case y.Bool:e[a]=!!s.getUint8(o),o+=1;break;case y.Byte:e[a]=s.getInt8(o),o+=1;break;case y.UByte:e[a]=s.getUint8(o),o+=1;break;case y.Short:e[a]=s.getInt16(o,!0),o+=2;break;case y.UShort:e[a]=s.getUint16(o,!0),o+=2;break;case y.Int:e[a]=s.getInt32(o,!0),o+=4;break;case y.UInt:e[a]=s.getUint32(o,!0),o+=4;break;case y.Long:e[a]=Number(s.getBigInt64(o,!0)),o+=8;break;case y.ULong:e[a]=Number(s.getBigUint64(o,!0)),o+=8;break;case y.Float:e[a]=s.getFloat32(o,!0),o+=4;break;case y.Double:e[a]=s.getFloat64(o,!0),o+=8;break;case y.DateTime:case y.String:{let h=s.getUint32(o,!0);o+=4,e[a]=Ct.decode(r.subarray(o,o+h)),o+=h;break}case y.Json:{let h=s.getUint32(o,!0);o+=4;let b=Ct.decode(r.subarray(o,o+h));e[a]=JSON.parse(b),o+=h;break}default:throw Error("Unknown type "+l.type)}}return e}var dt=function(n,t){return dt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])},dt(n,t)};function Kt(n,t){dt(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function G(n,t,e,r){function s(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function u(h){try{a(r.next(h))}catch(b){o(b)}}function l(h){try{a(r.throw(h))}catch(b){o(b)}}function a(h){h.done?i(h.value):s(h.value).then(u,l)}a((r=r.apply(n,[])).next())})}function B(n,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(h){return l([a,h])}}function l(a){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,s&&(i=a[0]&2?s.return:a[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,a[1])).done)return i;switch(s=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,s=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(n,e)}catch(h){a=[6,h],s=0}finally{r=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}function L(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function W(n){return this instanceof W?(this.v=n,this):new W(n)}function Qt(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e.apply(n,t||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(c){r[c]&&(s[c]=function(d){return new Promise(function(f,p){i.push([c,d,f,p])>1||u(c,d)})})}function u(c,d){try{l(r[c](d))}catch(f){b(i[0][3],f)}}function l(c){c.value instanceof W?Promise.resolve(c.value.v).then(a,h):b(i[0][2],c)}function a(c){u("next",c)}function h(c){u("throw",c)}function b(c,d){c(d),i.shift(),i.length&&u(i[0][0],i[0][1])}}var Et=function(n){Kt(t,n);function t(e){var r=n.call(this,e)||this;return Object.defineProperty(r,"name",{value:"RepeaterOverflowError",enumerable:!1}),typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf(r,r.constructor.prototype):r.__proto__=r.constructor.prototype,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(r,r.constructor),r}return t}(Error);(function(){function n(t){if(t<0)throw new RangeError("Capacity may not be less than 0");this._c=t,this._q=[]}return Object.defineProperty(n.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"full",{get:function(){return this._q.length>=this._c},enumerable:!1,configurable:!0}),n.prototype.add=function(t){if(this.full)throw new Error("Buffer full");this._q.push(t)},n.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},n})(),function(){function n(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(n.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.add=function(t){for(;this._q.length>=this._c;)this._q.shift();this._q.push(t)},n.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},n}(),function(){function n(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}return Object.defineProperty(n.prototype,"empty",{get:function(){return this._q.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.add=function(t){this._q.length<this._c&&this._q.push(t)},n.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()},n}();function ft(n){n!=null&&typeof n.then=="function"&&n.then(tt,tt)}var pt=0,Tt=1,A=2,K=3,_t=4,Q=1024,tt=function(){};function j(n){var t=n.err,e=Promise.resolve(n.execution).then(function(r){if(t!=null)throw t;return r});return n.err=void 0,n.execution=e.then(function(){},function(){}),n.pending===void 0?e:n.pending.then(function(){return e})}function N(n,t){var e=n.state>=K;return Promise.resolve(t).then(function(r){return!e&&n.state>=_t?j(n).then(function(s){return{value:s,done:!0}}):{value:r,done:e}})}function yt(n,t){var e,r;if(!(n.state>=A))if(n.state=A,n.onnext(),n.onstop(),n.err==null&&(n.err=t),n.pushes.length===0&&(typeof n.buffer>"u"||n.buffer.empty))H(n);else try{for(var s=L(n.pushes),i=s.next();!i.done;i=s.next()){var o=i.value;o.resolve()}}catch(u){e={error:u}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}}function H(n){var t,e;if(!(n.state>=K)){n.state<A&&yt(n),n.state=K,n.buffer=void 0;try{for(var r=L(n.nexts),s=r.next();!s.done;s=r.next()){var i=s.value,o=n.pending===void 0?j(n):n.pending.then(function(){return j(n)});i.resolve(N(n,o))}}catch(u){t={error:u}}finally{try{s&&!s.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}n.pushes=[],n.nexts=[]}}function Vt(n){n.state>=_t||(n.state<K&&H(n),n.state=_t)}function te(n,t){if(ft(t),n.pushes.length>=Q)throw new Et("No more than "+Q+" pending calls to push are allowed on a single repeater.");if(n.state>=A)return Promise.resolve(void 0);var e=n.pending===void 0?Promise.resolve(t):n.pending.then(function(){return t});e=e.catch(function(l){n.state<A&&(n.err=l),Vt(n)});var r;if(n.nexts.length){var s=n.nexts.shift();s.resolve(N(n,e)),n.nexts.length?r=Promise.resolve(n.nexts[0].value):typeof n.buffer<"u"&&!n.buffer.full?r=Promise.resolve(void 0):r=new Promise(function(l){return n.onnext=l})}else typeof n.buffer<"u"&&!n.buffer.full?(n.buffer.add(e),r=Promise.resolve(void 0)):r=new Promise(function(l){return n.pushes.push({resolve:l,value:e})});var i=!0,o={},u=r.catch(function(l){if(i)throw l});return o.then=function(l,a){return i=!1,Promise.prototype.then.call(r,l,a)},o.catch=function(l){return i=!1,Promise.prototype.catch.call(r,l)},o.finally=r.finally.bind(r),n.pending=e.then(function(){return u}).catch(function(l){n.err=l,Vt(n)}),o}function ee(n){var t=yt.bind(null,n),e=new Promise(function(r){return n.onstop=r});return t.then=e.then.bind(e),t.catch=e.catch.bind(e),t.finally=e.finally.bind(e),t}function ne(n){if(!(n.state>=Tt)){n.state=Tt;var t=te.bind(null,n),e=ee(n);n.execution=new Promise(function(r){return r(n.executor(t,e))}),n.execution.catch(function(){return yt(n)})}}var et=new WeakMap,X=function(){function n(t,e){et.set(this,{executor:t,buffer:e,err:void 0,state:pt,pushes:[],nexts:[],pending:void 0,execution:void 0,onnext:tt,onstop:tt})}return n.prototype.next=function(t){ft(t);var e=et.get(this);if(e===void 0)throw new Error("WeakMap error");if(e.nexts.length>=Q)throw new Et("No more than "+Q+" pending calls to next are allowed on a single repeater.");if(e.state<=pt&&ne(e),e.onnext(t),typeof e.buffer<"u"&&!e.buffer.empty){var r=N(e,e.buffer.remove());if(e.pushes.length){var s=e.pushes.shift();e.buffer.add(s.value),e.onnext=s.resolve}return r}else if(e.pushes.length){var i=e.pushes.shift();return e.onnext=i.resolve,N(e,i.value)}else if(e.state>=A)return H(e),N(e,j(e));return new Promise(function(o){return e.nexts.push({resolve:o,value:t})})},n.prototype.return=function(t){ft(t);var e=et.get(this);if(e===void 0)throw new Error("WeakMap error");return H(e),e.execution=Promise.resolve(e.execution).then(function(){return t}),N(e,j(e))},n.prototype.throw=function(t){var e=et.get(this);if(e===void 0)throw new Error("WeakMap error");return e.state<=pt||e.state>=A||typeof e.buffer<"u"&&!e.buffer.empty?(H(e),e.err==null&&(e.err=t),N(e,j(e))):this.next(Promise.reject(t))},n.prototype[Symbol.asyncIterator]=function(){return this},n.race=re,n.merge=ie,n.zip=se,n.latest=oe,n}();function nt(n,t){var e,r,s=[],i=function(a){a!=null&&typeof a[Symbol.asyncIterator]=="function"?s.push(a[Symbol.asyncIterator]()):a!=null&&typeof a[Symbol.iterator]=="function"?s.push(a[Symbol.iterator]()):s.push(function(){return Qt(this,arguments,function(){return B(this,function(h){switch(h.label){case 0:return t.yieldValues?[4,W(a)]:[3,3];case 1:return[4,h.sent()];case 2:h.sent(),h.label=3;case 3:return t.returnValues?[4,W(a)]:[3,5];case 4:return[2,h.sent()];case 5:return[2]}})})}())};try{for(var o=L(n),u=o.next();!u.done;u=o.next()){var l=u.value;i(l)}}catch(a){e={error:a}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return s}function re(n){var t=this,e=nt(n,{returnValues:!0});return new X(function(r,s){return G(t,void 0,void 0,function(){var i,o,u,l,a,h;return B(this,function(b){switch(b.label){case 0:if(!e.length)return s(),[2];o=!1,s.then(function(){i(),o=!0}),b.label=1;case 1:b.trys.push([1,,5,7]),l=void 0,a=0,h=function(){var c,d,f,p,m,O;return B(this,function(U){switch(U.label){case 0:c=a;try{for(d=(m=void 0,L(e)),f=d.next();!f.done;f=d.next())p=f.value,Promise.resolve(p.next()).then(function(F){F.done?(s(),u===void 0&&(u=F)):a===c&&(a++,i(F))},function(F){return s(F)})}catch(F){m={error:F}}finally{try{f&&!f.done&&(O=d.return)&&O.call(d)}finally{if(m)throw m.error}}return[4,new Promise(function(F){return i=F})];case 1:return l=U.sent(),l===void 0?[3,3]:[4,r(l.value)];case 2:U.sent(),U.label=3;case 3:return[2]}})},b.label=2;case 2:return o?[3,4]:[5,h()];case 3:return b.sent(),[3,2];case 4:return[2,u&&u.value];case 5:return s(),[4,Promise.race(e.map(function(c){return c.return&&c.return()}))];case 6:return b.sent(),[7];case 7:return[2]}})})})}function ie(n){var t=this,e=nt(n,{yieldValues:!0});return new X(function(r,s){return G(t,void 0,void 0,function(){var i,o,u,l=this;return B(this,function(a){switch(a.label){case 0:if(!e.length)return s(),[2];i=[],o=!1,s.then(function(){var h,b;o=!0;try{for(var c=L(i),d=c.next();!d.done;d=c.next()){var f=d.value;f()}}catch(p){h={error:p}}finally{try{d&&!d.done&&(b=c.return)&&b.call(c)}finally{if(h)throw h.error}}}),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,Promise.all(e.map(function(h,b){return G(l,void 0,void 0,function(){var c,d;return B(this,function(f){switch(f.label){case 0:f.trys.push([0,,6,9]),f.label=1;case 1:return o?[3,5]:(Promise.resolve(h.next()).then(function(p){return i[b](p)},function(p){return s(p)}),[4,new Promise(function(p){i[b]=p})]);case 2:return c=f.sent(),c===void 0?[3,4]:c.done?(u=c,[2]):[4,r(c.value)];case 3:f.sent(),f.label=4;case 4:return[3,1];case 5:return[3,9];case 6:return d=h.return,d?[4,h.return()]:[3,8];case 7:d=f.sent(),f.label=8;case 8:return[7];case 9:return[2]}})})}))];case 2:return a.sent(),[2,u&&u.value];case 3:return s(),[7];case 4:return[2]}})})})}function se(n){var t=this,e=nt(n,{returnValues:!0});return new X(function(r,s){return G(t,void 0,void 0,function(){var i,o,u,l;return B(this,function(a){switch(a.label){case 0:if(!e.length)return s(),[2,[]];o=!1,s.then(function(){i(),o=!0}),a.label=1;case 1:a.trys.push([1,,6,8]),a.label=2;case 2:return o?[3,5]:(Promise.all(e.map(function(h){return h.next()})).then(function(h){return i(h)},function(h){return s(h)}),[4,new Promise(function(h){return i=h})]);case 3:return u=a.sent(),u===void 0?[2]:(l=u.map(function(h){return h.value}),u.some(function(h){return h.done})?[2,l]:[4,r(l)]);case 4:return a.sent(),[3,2];case 5:return[3,8];case 6:return s(),[4,Promise.all(e.map(function(h){return h.return&&h.return()}))];case 7:return a.sent(),[7];case 8:return[2]}})})})}function oe(n){var t=this,e=nt(n,{yieldValues:!0,returnValues:!0});return new X(function(r,s){return G(t,void 0,void 0,function(){var i,o,u,l,a,h=this;return B(this,function(b){switch(b.label){case 0:if(!e.length)return s(),[2,[]];o=[],u=!1,s.then(function(){var c,d;i();try{for(var f=L(o),p=f.next();!p.done;p=f.next()){var m=p.value;m()}}catch(O){c={error:O}}finally{try{p&&!p.done&&(d=f.return)&&d.call(f)}finally{if(c)throw c.error}}u=!0}),b.label=1;case 1:return b.trys.push([1,,5,7]),Promise.all(e.map(function(c){return c.next()})).then(function(c){return i(c)},function(c){return s(c)}),[4,new Promise(function(c){return i=c})];case 2:return l=b.sent(),l===void 0?[2]:(a=l.map(function(c){return c.value}),l.every(function(c){return c.done})?[2,a]:[4,r(a.slice())]);case 3:return b.sent(),[4,Promise.all(e.map(function(c,d){return G(h,void 0,void 0,function(){var f;return B(this,function(p){switch(p.label){case 0:if(l[d].done)return[2,l[d].value];p.label=1;case 1:return u?[3,4]:(Promise.resolve(c.next()).then(function(m){return o[d](m)},function(m){return s(m)}),[4,new Promise(function(m){return o[d]=m})]);case 2:return f=p.sent(),f===void 0?[2,l[d].value]:f.done?[2,f.value]:(a[d]=f.value,[4,r(a.slice())]);case 3:return p.sent(),[3,1];case 4:return[2]}})})}))];case 4:return[2,b.sent()];case 5:return s(),[4,Promise.all(e.map(function(c){return c.return&&c.return()}))];case 6:return b.sent(),[7];case 7:return[2]}})})})}class ot{static global=new ot;_extraRequestThreshold=262144;extraRequestThreshold(){return this._extraRequestThreshold}setExtraRequestThreshold(t){if(t<0)throw Error("extraRequestThreshold cannot be negative");this._extraRequestThreshold=t}}const ae=40,le=16;function gt(n,t){t=Math.min(Math.max(+t,2),65535);let e=n,r=e;do r+=e=Math.ceil(e/t);while(e!==1);return 40*r}function ue(n,t){if(t<2)throw Error("Node size must be at least 2");if(n===0)throw Error("Number of items must be greater than 0");let e=n,r=e,s=[e];do r+=e=Math.ceil(e/t),s.push(e);while(e!==1);let i=[];for(let u of(e=r,s))i.push(e-u),e-=u;let o=[];for(let u=0;u<s.length;u++)o.push([i[u],i[u]+s[u]]);return o}async function*he(n,t,e,r){class s{_level;nodes;constructor(d,f){this._level=f,this.nodes=d}level(){return this._level}startNodeIdx(){return this.nodes[0]}endNodeIdx(){return this.nodes[1]}extendEndNodeIdx(d){this.nodes[1]=d}toString(){return`[NodeRange level: ${this._level}, nodes: ${this.nodes[0]}-${this.nodes[1]}]`}}let{minX:i,minY:o,maxX:u,maxY:l}=e,a=ue(n,t),h=a[0][0],b=[new s([0,1],a.length-1)];for(;b.length!=0;){let c=b.shift(),d=c.startNodeIdx(),f=d>=h,p=(()=>{let[,U]=a[c.level()],F=Math.min(c.endNodeIdx()+t,U);return f&&F<U?F+1:F})(),m=p-d,O=new DataView(await r(40*d,40*m));for(let U=d;U<p;U++){let F=U-d,D=40*F;if(u<O.getFloat64(D+0,!0)||l<O.getFloat64(D+8,!0)||i>O.getFloat64(D+16,!0)||o>O.getFloat64(D+24,!0))continue;let M=O.getBigUint64(D+32,!0);if(f){let at=(()=>{if(!(U<n-1))return null;{let Dt=(F+1)*40;return O.getBigUint64(Dt+32,!0)-M}})(),zt=U-h;yield[Number(M),zt,Number(at)];continue}let qt=ot.global.extraRequestThreshold()/40,R=b[b.length-1];if(R!==void 0&&R.level()==c.level()-1&&M<R.endNodeIdx()+qt){R.extendEndNodeIdx(Number(M));continue}let Ft=(()=>{let at=c.level()-1;return new s([Number(M),Number(M)+1],at)})();R!==void 0&&(R.level(),Ft.level()),b.push(Ft)}}}const C=new Uint8Array([102,103,98,3,102,103,98,0]),T=4;class xt{headerClient;header;headerLength;indexLength;nocache;constructor(t,e,r,s,i){this.headerClient=t,this.header=e,this.headerLength=r,this.indexLength=s,this.nocache=i}static async open(t,e){let r,s=new Bt(t,e),i=2024+(()=>{let a,h=0;for(a=0;a<3;a++)h+=le**a*ae;return h})();if(!new Uint8Array(await s.getRange(0,8,i,"header")).subarray(0,3).every((a,h)=>C[h]===a))throw Error("Not a FlatGeobuf file");if((r=new DataView(await s.getRange(8,4,i,"header")).getUint32(0,!0))>10485760||r<8)throw Error("Invalid header size");let o=await s.getRange(12,r,i,"header"),u=ht(new E(new Uint8Array(o))),l=gt(u.featuresCount,u.indexNodeSize);return new xt(s,u,r,l,e)}async*selectBbox(t){let e=this.lengthBeforeTree(),r=this.headerClient,s=async function(l,a){return r.getRange(e+l,a,0,"index")},i=[],o=[];for await(let l of he(this.header.featuresCount,this.header.indexNodeSize,t,s)){let[a,h]=l,[,,b]=l;if(b||(b=4),o.length==0){o.push([a,b,h]);continue}let c=o[o.length-1];a-(c[0]+c[1])>ot.global.extraRequestThreshold()&&(i.push(o),o=[]),o.push([a,b,h])}this.headerClient.logUsage("header+index"),o.length>0&&i.push(o);let u=i.flatMap(l=>this.readFeatureBatch(l,this.nocache));yield*X.merge(u)}lengthBeforeTree(){return C.length+T+this.headerLength}lengthBeforeFeatures(){return this.lengthBeforeTree()+this.indexLength}buildFeatureClient(t){return new Bt(this.headerClient.httpClient,t)}async*readFeatureBatch(t,e){let[r]=t[0],[s,i]=t[t.length-1],o=this.buildFeatureClient(e),u=s+i-r;for(let[l,,a]of t){let h=await this.readFeature(o,l,u);yield{id:a,feature:h},u=0}o.logUsage("feature")}async readFeature(t,e,r){let s,i=e+this.lengthBeforeFeatures();s=new DataView(await t.getRange(i,4,r,"feature length")).getUint32(0,!0);let o=new Uint8Array(await t.getRange(i+4,s,r,"feature data")),u=new Uint8Array(s+T);u.set(o,T);let l=new E(u);return l.setPosition(T),x.getRootAsFeature(l)}}class Bt{httpClient;bytesEverUsed=0;bytesEverFetched=0;buffer=new ArrayBuffer(0);head=0;constructor(t,e){if(typeof t=="string")this.httpClient=new At(t,e);else if(t instanceof At)this.httpClient=t;else throw Error("Unknown source ")}async getRange(t,e,r,s){this.bytesEverUsed+=e;let i=t-this.head,o=i+e;if(i>=0&&o<=this.buffer.byteLength)return this.buffer.slice(i,o);let u=Math.max(e,r);return this.bytesEverFetched+=u,this.buffer=await this.httpClient.getRange(t,u,s),this.head=t,this.buffer.slice(0,e)}logUsage(t){t.split(" ")[0],(100*this.bytesEverUsed/this.bytesEverFetched).toFixed(2)}}class At{url;nocache;requestsEverMade=0;bytesEverRequested=0;constructor(t,e){this.url=t,this.nocache=e}async getRange(t,e,r){this.requestsEverMade+=1,this.bytesEverRequested+=e;let s={Range:`bytes=${t}-${t+e-1}`};return this.nocache&&(s["Cache-Control"]="no-cache, no-store"),(await fetch(this.url,{headers:s})).arrayBuffer()}}function ce(n){let t;for(let e of n){if(t===I.Unknown)break;let r=e.getGeometry?Y(e.getGeometry().getType()):Y(e.geometry.type);t===void 0?t=r:t!==r&&(t=I.Unknown)}if(t===void 0)throw Error("Could not infer geometry type for collection of features.");return t}function be(n,t,e){if(!n.subarray(0,3).every((h,b)=>C[b]===h))throw Error("Not a FlatGeobuf file");let r=new E(n),s=r.readUint32(C.length);r.setPosition(C.length+T);let i=ht(r);e&&e(i);let o=C.length+T+s,{indexNodeSize:u,featuresCount:l}=i;u>0&&(o+=gt(l,u));let a=[];for(;o<r.capacity();){let h=r.readUint32(o);r.setPosition(o+T);let b=x.getRootAsFeature(r);a.push(t(a.length,b,i)),o+=T+h}return a}async function*de(n,t,e){let r,s=Jt(n),i=async d=>await s.slice(d),o=new Uint8Array(await i(8));if(!o.subarray(0,3).every((d,f)=>C[f]===d))throw Error("Not a FlatGeobuf file");o=new Uint8Array(await i(4));let u=new E(o),l=u.readUint32(0);o=new Uint8Array(await i(l));let a=ht(u=new E(o));e&&e(a);let{indexNodeSize:h,featuresCount:b}=a;if(h>0){let d=gt(b,h);await i(d)}let c=0;for(;r=await pe(i,a,t,c++);)yield r}async function*fe(n,t,e,r,s=!1){let i=await xt.open(n,s);for await(let o of(r&&r(i.header),i.selectBbox(t)))yield e(o.id,o.feature,i.header)}async function pe(n,t,e,r){let s=new Uint8Array(await n(4,"feature length"));if(s.byteLength===0)return;let i=new E(s),o=i.readUint32(0);s=new Uint8Array(await n(o,"feature data"));let u=new Uint8Array(o+4);return u.set(s,4),(i=new E(u)).setPosition(T),e(r,x.getRootAsFeature(i),t)}function _e(n,t=0){let e,r=new st,s=0;n.columns&&(s=S.createColumnsVector(r,n.columns.map(u=>function(l,a){let h=l.createString(a.name);return v.startColumn(l),v.addName(l,h),v.addType(l,a.type),v.endColumn(l)}(r,u))));let i=r.createString("L1");t&&(P.startCrs(r),P.addCode(r,t),e=P.endCrs(r)),S.startHeader(r),e&&S.addCrs(r,e),S.addFeaturesCount(r,BigInt(n.featuresCount)),S.addGeometryType(r,n.geometryType),S.addIndexNodeSize(r,0),s&&S.addColumns(r,s),S.addName(r,i);let o=S.endHeader(r);return r.finishSizePrefixed(o),r.asUint8Array()}function ye(n,t){return{name:t,type:function(e){if(typeof e=="boolean")return y.Bool;if(typeof e=="number")return e%1==0?y.Int:y.Double;if(typeof e=="string"||e===null)return y.String;if(typeof e=="object")return y.Json;throw Error(`Unknown type (value '${e}')`)}(n[t]),title:null,description:null,width:-1,precision:-1,scale:-1,nullable:!0,unique:!1,primary_key:!1}}const ge={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Nt{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||ge[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Z=6378137,q=Math.PI*Z,we=[-q,-q,q,q],me=[-180,-85,180,85],rt=Z*Math.log(Math.tan(Math.PI/2));class z extends Nt{constructor(t){super({code:t,units:"m",extent:we,global:!0,worldExtent:me,getPointResolution:function(e,r){return e/Math.cosh(r[1]/Z)}})}}const kt=[new z("EPSG:3857"),new z("EPSG:102100"),new z("EPSG:102113"),new z("EPSG:900913"),new z("http://www.opengis.net/def/crs/EPSG/0/3857"),new z("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ve(n,t,e,r){const s=n.length;e=e>1?e:2,r=r??e,t===void 0&&(e>2?t=n.slice():t=new Array(s));for(let i=0;i<s;i+=r){t[i]=q*n[i]/180;let o=Z*Math.log(Math.tan(Math.PI*(+n[i+1]+90)/360));o>rt?o=rt:o<-rt&&(o=-rt),t[i+1]=o}return t}function Ie(n,t,e,r){const s=n.length;e=e>1?e:2,r=r??e,t===void 0&&(e>2?t=n.slice():t=new Array(s));for(let i=0;i<s;i+=r)t[i]=180*n[i]/q,t[i+1]=360*Math.atan(Math.exp(n[i+1]/Z))/Math.PI-90;return t}const xe=6378137,Mt=[-180,-90,180,90],Fe=Math.PI*xe/180;class k extends Nt{constructor(t,e){super({code:t,units:"degrees",extent:Mt,axisOrientation:e,global:!0,metersPerUnit:Fe,worldExtent:Mt})}}const Rt=[new k("CRS:84"),new k("EPSG:4326","neu"),new k("urn:ogc:def:crs:OGC:1.3:CRS84"),new k("urn:ogc:def:crs:OGC:2:84"),new k("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new k("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new k("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let wt={};function it(n,t,e){const r=n.getCode(),s=t.getCode();r in wt||(wt[r]={}),wt[r][s]=e}function Gt(n,t){if(t!==void 0){for(let e=0,r=n.length;e<r;++e)t[e]=n[e];t=t}else t=n.slice();return t}function Pe(n){n.getCode(),it(n,n,Gt)}function Ue(n){n.forEach(Pe)}function Lt(n){Ue(n),n.forEach(function(t){n.forEach(function(e){t!==e&&it(t,e,Gt)})})}function Se(n,t,e,r){n.forEach(function(s){t.forEach(function(i){it(s,i,e),it(i,s,r)})})}function Oe(){Lt(kt),Lt(Rt),Se(Rt,kt,ve,Ie)}Oe();function mt(n){let t,e,r=n.coordinates,s=[],i=[],o=Y(n.type),u=0;switch(n.type){case"Point":case"MultiPoint":case"LineString":ct(r,s,i);break;case"MultiLineString":case"Polygon":ct(r,s,i),r.length>1&&(t=r.map(l=>u+=l.length));break;case"MultiPolygon":e=r.map(l=>({type:"Polygon",coordinates:l})).map(mt)}return{xy:s,z:i.length>0?i:void 0,ends:t,type:o,parts:e}}function jt(n){let t=Y(n.type),e=[];for(let r=0;r<n.geometries.length;r++){let s=n.geometries[r];s.type==="GeometryCollection"?e.push(jt(s)):e.push(mt(s))}return{type:t,parts:e}}function vt(n,t){let e=t;if(e===I.Unknown&&(e=n.type()),e===I.GeometryCollection){let s=[];for(let i=0;i<n.partsLength();i++){let o=n.parts(i),u=o.type();s.push(vt(o,u))}return{type:I[e],geometries:s}}if(e===I.MultiPolygon){let s=[];for(let i=0;i<n.partsLength();i++)s.push(vt(n.parts(i),I.Polygon));return{type:I[e],coordinates:s.map(i=>i.coordinates)}}let r=function(s,i){let o=s.xyArray(),u=s.zArray();switch(i){case I.Point:{let l=Array.from(o);return u&&l.push(u[0]),l}case I.MultiPoint:case I.LineString:return bt(o,u);case I.MultiLineString:case I.Polygon:return function(l,a,h){let b;if(!h||h.length===0)return[bt(l,a)];let c=0,d=Array.from(h).map(f=>l.slice(c,c=f<<1));return a&&(c=0,b=Array.from(h).map(f=>a.slice(c,c=f))),d.map((f,p)=>bt(f,b?b[p]:void 0))}(o,u,s.endsArray())}}(n,e);return{type:I[e],coordinates:r}}function It(n,t,e){let r=e.columns;return{type:"Feature",id:n,geometry:vt(t.geometry(),e.geometryType),properties:Yt(t,r)}}function Ce(n,t=0){let e=function(l){let a=l.features[0].properties,h=null;return a&&(h=Object.keys(a).map(b=>ye(a,b))),{geometryType:ce(l.features),columns:h,envelope:null,featuresCount:l.features.length,indexNodeSize:0,crs:null,title:null,description:null,metadata:null}}(n),r=_e(e,t),s=n.features.map(l=>$t(l.geometry.type==="GeometryCollection"?jt(l.geometry):mt(l.geometry),l.properties,e)),i=s.map(l=>l.length).reduce((l,a)=>l+a),o=new Uint8Array(C.length+r.length+i);o.set(r,C.length);let u=C.length+r.length;for(let l of s)o.set(l,u),u+=l.length;return o.set(C),o}function Ee(n,t){return{type:"FeatureCollection",features:be(n,It,t)}}function Te(n,t){return de(n,It,t)}function Ve(n,t,e,r=!1){return fe(n,t,It,e,r)}function Be(n,t=0){return Ce(n,t)}function Ae(n,t,e,r=!1){return n instanceof Uint8Array?Ee(n,e):n instanceof ReadableStream?Te(n,e):Ve(n,t,e,r)}const Ne=Object.freeze(Object.defineProperty({__proto__:null,deserialize:Ae,serialize:Be},Symbol.toStringTag,{value:"Module"}));export{v as Column,x as Feature,w as Geometry,Ne as geojson};
