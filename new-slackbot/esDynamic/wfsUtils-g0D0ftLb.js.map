{"version":3,"file":"wfsUtils-g0D0ftLb.js","sources":["../../node_modules/@arcgis/core/layers/ogc/wfsUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import e from\"../../request.js\";import t from\"../../core/Error.js\";import{cache as r,find as n}from\"../../core/iteratorUtils.js\";import{isHTTPSProtocol as a,hasSameOrigin as o,toHTTPS as i}from\"../../core/urlUtils.js\";import{initializeProjection as s,project as p}from\"../../geometry/projection.js\";import{wgs84 as u,equals as l}from\"../../geometry/support/spatialReferenceUtils.js\";import{featureGeometryTypeKebabDictionary as c}from\"../../geometry/support/typeUtils.js\";import{getGeometryType as m}from\"../graphics/sources/geojson/geojson.js\";import{visitXML as f,iterateXML as y}from\"./xmlUtils.js\";import{isArcGISUrl as d}from\"../support/arcgisLayerUrl.js\";import g from\"../support/Field.js\";import{getFieldDefaultLength as w}from\"../support/fieldUtils.js\";import b from\"../../geometry/SpatialReference.js\";import h from\"../../geometry/Extent.js\";const T=\"xlink:href\",F=\"2.0.0\",S=\"__esri_wfs_id__\",x=\"wfs-layer:getWFSLayerTypeInfo-error\",E=\"wfs-layer:empty-service\",C=\"wfs-layer:feature-type-not-found\",R=\"wfs-layer:geojson-not-supported\",k=\"wfs-layer:kvp-encoding-not-supported\",P=\"wfs-layer:malformed-json\",j=\"wfs-layer:unknown-geometry-type\",A=\"wfs-layer:unknown-field-type\",G=\"wfs-layer:unsupported-spatial-reference\",N=\"wfs-layer:unsupported-wfs-version\";async function v(t,r){const n=U((await e(t,{responseType:\"text\",query:{SERVICE:\"WFS\",REQUEST:\"GetCapabilities\",VERSION:F,...r?.customParameters},signal:r?.signal})).data);return L(t,n),n}function U(e){const t=te(e);ne(t),ae(t);const n=t.firstElementChild,a=r($(n));return{operations:D(n),get featureTypes(){return Array.from(a())},readFeatureTypes:a}}const I=[\"json\",\"application/json\",\"geojson\",\"application/json; subtype=geojson\",\"application/geo+json\"];function M(e){for(const t of I){const r=e.findIndex((e=>e.toLowerCase()===t));if(r>=0)return e[r]}return null}function D(e){let r=!1;const n={GetCapabilities:{url:\"\"},DescribeFeatureType:{url:\"\"},GetFeature:{url:\"\",outputFormat:null,supportsPagination:!1}},a=[],o=[];if(f(e,{OperationsMetadata:{Parameter:e=>{if(\"outputFormat\"===e.getAttribute(\"name\"))return{AllowedValues:{Value:({textContent:e})=>{e&&a.push(e)}}}},Operation:e=>{switch(e.getAttribute(\"name\")){case\"GetCapabilities\":return{DCP:{HTTP:{Get:e=>{n.GetCapabilities.url=e.getAttribute(T)}}}};case\"DescribeFeatureType\":return{DCP:{HTTP:{Get:e=>{n.DescribeFeatureType.url=e.getAttribute(T)}}}};case\"GetFeature\":return{DCP:{HTTP:{Get:e=>{n.GetFeature.url=e.getAttribute(T)}}},Parameter:e=>{if(\"outputFormat\"===e.getAttribute(\"name\"))return{AllowedValues:{Value:({textContent:e})=>{e&&o.push(e)}}}}}}},Constraint:e=>{switch(e.getAttribute(\"name\")){case\"KVPEncoding\":return{DefaultValue:e=>{r=\"true\"===e.textContent.toLowerCase()}};case\"ImplementsResultPaging\":return{DefaultValue:e=>{n.GetFeature.supportsPagination=\"true\"===e.textContent.toLowerCase()}}}}}}),n.GetFeature.outputFormat=M(o)??M(a),!r)throw new t(k,\"WFS service doesn't support key/value pair (KVP) encoding\");if(null==n.GetFeature.outputFormat)throw new t(R,\"WFS service doesn't support GeoJSON output format\");return n}function L(e,t){a(e)&&(o(e,t.operations.DescribeFeatureType.url,!0)&&(t.operations.DescribeFeatureType.url=i(t.operations.DescribeFeatureType.url)),o(e,t.operations.GetFeature.url,!0)&&(t.operations.GetFeature.url=i(t.operations.GetFeature.url)))}function V(e){const t=parseInt(e.textContent?.match(/(?<wkid>\\d+$)/i)?.groups?.wkid??\"\",10);if(!Number.isNaN(t))return t}function $(e){return y(e,{FeatureTypeList:{FeatureType:e=>{const t={typeName:\"undefined:undefined\",name:\"\",title:\"\",description:\"\",extent:null,namespacePrefix:\"\",namespaceUri:\"\",defaultSpatialReference:4326,supportedSpatialReferences:[]},r=new Set;return f(e,{Name:e=>{const{name:r,prefix:n}=re(e.textContent);t.typeName=`${n}:${r}`,t.name=r,t.namespacePrefix=n,t.namespaceUri=e.lookupNamespaceURI(n)},Abstract:e=>{t.description=e.textContent},Title:e=>{t.title=e.textContent},WGS84BoundingBox:e=>{t.extent=O(e)},DefaultCRS:e=>{const n=V(e);n&&(t.defaultSpatialReference=n,r.add(n))},OtherCRS:e=>{const t=V(e);t&&r.add(t)}}),t.title||(t.title=t.name),r.add(4326),t.supportedSpatialReferences.push(...r),t}}})}function O(e){let t,r,n,a;for(const o of e.children)switch(o.localName){case\"LowerCorner\":[t,r]=o.textContent.split(\" \").map((e=>Number.parseFloat(e)));break;case\"UpperCorner\":[n,a]=o.textContent.split(\" \").map((e=>Number.parseFloat(e)))}return{xmin:t,ymin:r,xmax:n,ymax:a,spatialReference:u}}function W(e,t,r){return n(e,(e=>r?e.name===t&&e.namespaceUri===r:e.typeName===t||e.name===t))}async function Y(e,t,r,n={}){const{featureType:a,extent:o}=await X(e,t,r,n),{spatialReference:i}=oe(e.operations.GetFeature.url,a,n.spatialReference),{fields:s,geometryType:p,swapXY:u,objectIdField:l,geometryField:c}=await q(e,a,i,n);return{url:e.operations.GetCapabilities.url,name:a.name,namespaceUri:a.namespaceUri,fields:s,geometryField:c,geometryType:p,objectIdField:l,spatialReference:n.spatialReference??new b({wkid:a.defaultSpatialReference}),extent:o,swapXY:u,wfsCapabilities:e,customParameters:n.customParameters}}async function X(e,r,n,a={}){const o=e.readFeatureTypes(),i=r?W(o,r,n):o.next().value,{spatialReference:u=new b({wkid:i?.defaultSpatialReference})}=a;if(null==i)throw r?new t(C,`The type '${r}' could not be found in the service`):new t(E,\"The service is empty\");let c=new h({...i.extent,spatialReference:b.WGS84});if(!l(c.spatialReference,u))try{await s(c.spatialReference,u,void 0,a),c=p(c,u)}catch{throw new t(G,\"Projection not supported\")}return{extent:c,spatialReference:u,featureType:i}}async function q(e,r,n,a={}){const{typeName:o}=r,[i,s]=await Promise.allSettled([Q(e.operations.DescribeFeatureType.url,o,a),_(e,o,n,a)]),p=e=>new t(x,`An error occurred while getting info about the feature type '${o}'`,{error:e});if(\"rejected\"===i.status)throw p(i.reason);if(\"rejected\"===s.status)throw p(s.reason);const{fields:u,errors:l}=i.value??{},c=i.value?.geometryType||s.value?.geometryType,m=s.value?.swapXY??!1;if(null==c)throw new t(j,`The geometry type could not be determined for type '${o}`,{typeName:o,geometryType:c,fields:u,errors:l});return{...z(u??[]),geometryType:c,swapXY:m}}function z(e){const t=e.find((e=>\"geometry\"===e.type));let r=e.find((e=>\"oid\"===e.type));return e=e.filter((e=>\"geometry\"!==e.type)),r||(r=new g({name:S,type:\"oid\",alias:S}),e.unshift(r)),{geometryField:t?.name??null,objectIdField:r.name,fields:e}}async function _(t,r,n,a={}){let o,i=!1;const[s,p]=await Promise.all([K(t.operations.GetFeature.url,r,n,t.operations.GetFeature.outputFormat,{...a,count:1}),e(t.operations.GetFeature.url,{responseType:\"text\",query:Z(r,n,void 0,{...a,count:1}),signal:a?.signal})]),u=\"FeatureCollection\"===s.type&&s.features[0]?.geometry;if(u){let e;switch(o=c.fromJSON(m(u.type)),u.type){case\"Point\":e=u.coordinates;break;case\"LineString\":case\"MultiPoint\":e=u.coordinates[0];break;case\"MultiLineString\":case\"Polygon\":e=u.coordinates[0][0];break;case\"MultiPolygon\":e=u.coordinates[0][0][0]}const t=/<[^>]*pos[^>]*> *(-?\\d+(?:\\.\\d+)?) (-?\\d+(?:\\.\\d+)?)/.exec(p.data);if(t){const r=e[0].toFixed(3),n=e[1].toFixed(3),a=parseFloat(t[1]).toFixed(3);r===parseFloat(t[2]).toFixed(3)&&n===a&&(i=!0)}}return{geometryType:o,swapXY:i}}async function Q(t,r,n){return H(r,(await e(t,{responseType:\"text\",query:{SERVICE:\"WFS\",REQUEST:\"DescribeFeatureType\",VERSION:F,TYPENAME:r,TYPENAMES:r,...n?.customParameters},signal:n?.signal})).data)}function H(e,r){const{name:a}=re(e),o=te(r);ae(o);const i=n(y(o.firstElementChild,{element:e=>e}),(e=>e.getAttribute(\"name\")===a));if(null!=i){const e=i.getAttribute(\"type\"),t=e?n(y(o.firstElementChild,{complexType:e=>e}),(t=>t.getAttribute(\"name\")===re(e).name)):n(y(i,{complexType:e=>e}),(()=>!0));if(t)return B(t)}throw new t(C,`Type '${e}' not found in document`,{document:(new XMLSerializer).serializeToString(o)})}const J=new Set([\"objectid\",\"fid\"]);function B(e){const r=[],n=[];let a;const o=y(e,{complexContent:{extension:{sequence:{element:e=>e}}}});for(const i of o){const o=i.getAttribute(\"name\");if(!o)continue;let s,p;if(i.hasAttribute(\"type\")?s=re(i.getAttribute(\"type\")).name:f(i,{simpleType:{restriction:e=>(s=re(e.getAttribute(\"base\")).name,{maxLength:e=>{p=+e.getAttribute(\"value\")}})}}),!s)continue;const u=\"true\"===i.getAttribute(\"nillable\");let l=!1;switch(s.toLowerCase()){case\"integer\":case\"nonpositiveinteger\":case\"negativeinteger\":case\"long\":case\"int\":case\"short\":case\"byte\":case\"nonnegativeinteger\":case\"unsignedlong\":case\"unsignedint\":case\"unsignedshort\":case\"unsignedbyte\":case\"positiveinteger\":n.push(new g({name:o,alias:o,type:\"integer\",nullable:u,length:w(\"integer\")}));break;case\"float\":case\"double\":case\"decimal\":n.push(new g({name:o,alias:o,type:\"double\",nullable:u,length:w(\"double\")}));break;case\"boolean\":case\"string\":case\"gyearmonth\":case\"gyear\":case\"gmonthday\":case\"gday\":case\"gmonth\":case\"anyuri\":case\"qname\":case\"notation\":case\"normalizedstring\":case\"token\":case\"language\":case\"idrefs\":case\"entities\":case\"nmtoken\":case\"nmtokens\":case\"name\":case\"ncname\":case\"id\":case\"idref\":case\"entity\":case\"duration\":case\"time\":n.push(new g({name:o,alias:o,type:\"string\",nullable:u,length:p??w(\"string\")}));break;case\"datetime\":case\"date\":n.push(new g({name:o,alias:o,type:\"date\",nullable:u,length:p??w(\"date\")}));break;case\"pointpropertytype\":a=\"point\",l=!0;break;case\"multipointpropertytype\":a=\"multipoint\",l=!0;break;case\"curvepropertytype\":case\"multicurvepropertytype\":case\"multilinestringpropertytype\":a=\"polyline\",l=!0;break;case\"surfacepropertytype\":case\"multisurfacepropertytype\":case\"multipolygonpropertytype\":a=\"polygon\",l=!0;break;case\"geometrypropertytype\":case\"multigeometrypropertytype\":l=!0,r.push(new t(j,`geometry type '${s}' is not supported`,{type:(new XMLSerializer).serializeToString(e)}));break;default:r.push(new t(A,`Unknown field type '${s}'`,{type:(new XMLSerializer).serializeToString(e)}))}l&&n.push(new g({name:o,alias:o,type:\"geometry\",nullable:u}))}for(const t of n)if(\"integer\"===t.type&&!t.nullable&&J.has(t.name.toLowerCase())){t.type=\"oid\";break}return{geometryType:a,fields:n,errors:r}}async function K(r,n,a,o,i){let{data:s}=await e(r,{responseType:\"text\",query:Z(n,a,o,i),signal:i?.signal});s=s.replaceAll(/\": +(-?\\d+),(\\d+)(,)?/g,'\": $1.$2$3');try{return JSON.parse(s)}catch(p){throw new t(P,\"Error while parsing the response\",{response:s,error:p})}}function Z(e,t,r,n){const a=\"number\"==typeof t?t:t.wkid;return{SERVICE:\"WFS\",REQUEST:\"GetFeature\",VERSION:F,TYPENAMES:e,OUTPUTFORMAT:r,SRSNAME:\"EPSG:\"+a,STARTINDEX:n?.startIndex,COUNT:n?.count,...n?.customParameters}}async function ee(t,r,n){const a=await e(t,{responseType:\"text\",query:{SERVICE:\"WFS\",REQUEST:\"GetFeature\",VERSION:F,TYPENAMES:r,RESULTTYPE:\"hits\",...n?.customParameters},signal:n?.signal}),o=/numberMatched=[\"'](?<numberMatched>\\d+)[\"']/gi.exec(a.data);if(o?.groups)return+o.groups.numberMatched}function te(e){return(new DOMParser).parseFromString(e.trim(),\"text/xml\")}function re(e){const[t,r]=e.split(\":\");return{prefix:r?t:\"\",name:r??t}}function ne(e){const r=e.firstElementChild?.getAttribute(\"version\");if(r&&r!==F)throw new t(N,`Unsupported WFS version ${r}. Supported version: ${F}`)}function ae(e){let r=\"\",n=\"\";if(f(e.firstElementChild,{Exception:e=>(r=e.getAttribute(\"exceptionCode\"),{ExceptionText:e=>{n=e.textContent}})}),r)throw new t(`wfs-layer:${r}`,n)}function oe(e,t,r){const n={wkid:t.defaultSpatialReference},a=null!=r?.wkid?{wkid:r.wkid}:n;return{spatialReference:a,getFeatureSpatialReference:d(e)||a.wkid&&t.supportedSpatialReferences.includes(a.wkid)?{wkid:a.wkid}:{wkid:t.defaultSpatialReference}}}export{Q as describeFeatureType,W as findFeatureType,v as getCapabilities,K as getFeature,ee as getFeatureCount,X as getFeatureTypeInfo,oe as getGetFeatureSpatialReference,Y as getWFSLayerInfo,H as parseDescribeFeatureTypeResponse,U as parseGetCapabilitiesResponse,z as prepareWFSLayerFields,S as wfsOidFieldName};\n"],"names":["T","F","S","x","E","C","R","k","P","j","A","G","N","v","t","r","n","U","e","L","te","ne","ae","a","$","D","I","M","o","f","i","V","y","re","O","u","W","Y","X","oe","s","p","c","q","b","h","l","Q","_","m","z","g","K","Z","H","B","J","w","ee","d"],"mappings":"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","x_google_ignoreList":[0]}