{"version":3,"file":"ElevationSamplerWorker-fRff1Qaw.js","sources":["../../node_modules/@arcgis/core/geometry/support/meshUtils/ElevationSamplerWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport has from\"../../../core/has.js\";import{PooledRBush as e}from\"../../../core/libs/rbush/PooledRBush.js\";import{isRelativeVertexSpace as t}from\"../meshVertexSpaceUtils.js\";import{georeferenceApplyTransform as r}from\"./georeference.js\";class n{async createIndex(t,r){const n=new Array;if(!t.vertexAttributes?.position)return new e;const o=this._createMeshData(t),s=null!=r?await r.invoke(\"createIndexThread\",o,{transferList:n}):this.createIndexThread(o).result;return this._createPooledRBush().fromJSON(s)}createIndexThread(e){const t=new Float64Array(e.position),r=this._createPooledRBush();return e.components?this._createIndexComponentsThread(r,t,e.components.map((e=>new Uint32Array(e)))):this._createIndexAllThread(r,t)}_createIndexAllThread(e,t){const r=new Array(t.length/9);let n=0;for(let s=0;s<t.length;s+=9)r[n++]=o(t,s,s+3,s+6);return e.load(r),{result:e.toJSON()}}_createIndexComponentsThread(e,t,r){let n=0;for(const o of r)n+=o.length/3;const s=new Array(n);let a=0;for(const i of r)for(let e=0;e<i.length;e+=3)s[a++]=o(t,3*i[e],3*i[e+1],3*i[e+2]);return e.load(s),{result:e.toJSON()}}_createMeshData(e){const n=(t(e.vertexSpace)?r({position:e.vertexAttributes.position,normal:null,tangent:null},e.vertexSpace,e.transform,e.spatialReference).position:e.vertexAttributes.position).buffer;return!e.components||e.components.some((e=>!e.faces))?{position:n}:{position:n,components:e.components.map((e=>e.faces))}}_createPooledRBush(){return new e(9,has(\"esri-csp-restrictions\")?e=>e:[\".minX\",\".minY\",\".maxX\",\".maxY\"])}}function o(e,t,r,n){return{minX:Math.min(e[t],e[r],e[n]),maxX:Math.max(e[t],e[r],e[n]),minY:Math.min(e[t+1],e[r+1],e[n+1]),maxY:Math.max(e[t+1],e[r+1],e[n+1]),p0:[e[t],e[t+1],e[t+2]],p1:[e[r],e[r+1],e[r+2]],p2:[e[n],e[n+1],e[n+2]]}}export{n as default};\n"],"names":["n","r","e","o","s","t","a","i","has"],"mappings":";;;;AAI8O,MAAMA,EAAC;AAAA,EAAC,MAAM,YAAY,GAAEC,GAAE;AAAC,UAAMD,IAAE,IAAI;AAAM,QAAG,CAAC,EAAE,kBAAkB,SAAS,QAAO,IAAIE;AAAE,UAAMC,IAAE,KAAK,gBAAgB,CAAC,GAAEC,IAAQH,KAAN,OAAQ,MAAMA,EAAE,OAAO,qBAAoBE,GAAE,EAAC,cAAaH,EAAC,CAAC,IAAE,KAAK,kBAAkBG,CAAC,EAAE;AAAO,WAAO,KAAK,mBAAkB,EAAG,SAASC,CAAC;AAAA,EAAC;AAAA,EAAC,kBAAkBF,GAAE;AAAC,UAAMG,IAAE,IAAI,aAAaH,EAAE,QAAQ,GAAED,IAAE,KAAK,mBAAkB;AAAG,WAAOC,EAAE,aAAW,KAAK,6BAA6BD,GAAEI,GAAEH,EAAE,WAAW,IAAK,CAAAA,MAAG,IAAI,YAAYA,CAAC,CAAG,CAAA,IAAE,KAAK,sBAAsBD,GAAEI,CAAC;AAAA,EAAC;AAAA,EAAC,sBAAsBH,GAAEG,GAAE;AAAC,UAAMJ,IAAE,IAAI,MAAMI,EAAE,SAAO,CAAC;AAAE,QAAIL,IAAE;AAAE,aAAQI,IAAE,GAAEA,IAAEC,EAAE,QAAOD,KAAG,EAAE,CAAAH,EAAED,GAAG,IAAEG,EAAEE,GAAED,GAAEA,IAAE,GAAEA,IAAE,CAAC;AAAE,WAAOF,EAAE,KAAKD,CAAC,GAAE,EAAC,QAAOC,EAAE,OAAM,EAAE;AAAA,EAAC;AAAA,EAAC,6BAA6BA,GAAEG,GAAEJ,GAAE;AAAC,QAAID,IAAE;AAAE,eAAUG,KAAKF,EAAE,CAAAD,KAAGG,EAAE,SAAO;AAAE,UAAMC,IAAE,IAAI,MAAMJ,CAAC;AAAE,QAAIM,IAAE;AAAE,eAAUC,KAAKN,EAAE,UAAQC,IAAE,GAAEA,IAAEK,EAAE,QAAOL,KAAG,EAAE,CAAAE,EAAEE,GAAG,IAAEH,EAAEE,GAAE,IAAEE,EAAEL,CAAC,GAAE,IAAEK,EAAEL,IAAE,CAAC,GAAE,IAAEK,EAAEL,IAAE,CAAC,CAAC;AAAE,WAAOA,EAAE,KAAKE,CAAC,GAAE,EAAC,QAAOF,EAAE,SAAQ;AAAA,EAAC;AAAA,EAAC,gBAAgBA,GAAE;AAAC,UAAM,KAAGG,EAAEH,EAAE,WAAW,IAAED,EAAE,EAAC,UAASC,EAAE,iBAAiB,UAAS,QAAO,MAAK,SAAQ,KAAI,GAAEA,EAAE,aAAYA,EAAE,WAAUA,EAAE,gBAAgB,EAAE,WAASA,EAAE,iBAAiB,UAAU;AAAO,WAAM,CAACA,EAAE,cAAYA,EAAE,WAAW,KAAM,CAAAA,MAAG,CAACA,EAAE,KAAO,IAAC,EAAC,UAAS,EAAC,IAAE,EAAC,UAAS,GAAE,YAAWA,EAAE,WAAW,IAAK,CAAAA,MAAGA,EAAE,KAAK,EAAE;AAAA,EAAC;AAAA,EAAC,qBAAoB;AAAC,WAAO,IAAIA,EAAE,GAAEM,EAAI,uBAAuB,IAAE,CAAAN,MAAGA,IAAE,CAAC,SAAQ,SAAQ,SAAQ,OAAO,CAAC;AAAA,EAAC;AAAC;AAAC,SAASC,EAAE,GAAE,GAAEF,GAAED,GAAE;AAAC,SAAM,EAAC,MAAK,KAAK,IAAI,EAAE,CAAC,GAAE,EAAEC,CAAC,GAAE,EAAED,CAAC,CAAC,GAAE,MAAK,KAAK,IAAI,EAAE,CAAC,GAAE,EAAEC,CAAC,GAAE,EAAED,CAAC,CAAC,GAAE,MAAK,KAAK,IAAI,EAAE,IAAE,CAAC,GAAE,EAAEC,IAAE,CAAC,GAAE,EAAED,IAAE,CAAC,CAAC,GAAE,MAAK,KAAK,IAAI,EAAE,IAAE,CAAC,GAAE,EAAEC,IAAE,CAAC,GAAE,EAAED,IAAE,CAAC,CAAC,GAAE,IAAG,CAAC,EAAE,CAAC,GAAE,EAAE,IAAE,CAAC,GAAE,EAAE,IAAE,CAAC,CAAC,GAAE,IAAG,CAAC,EAAEC,CAAC,GAAE,EAAEA,IAAE,CAAC,GAAE,EAAEA,IAAE,CAAC,CAAC,GAAE,IAAG,CAAC,EAAED,CAAC,GAAE,EAAEA,IAAE,CAAC,GAAE,EAAEA,IAAE,CAAC,CAAC,EAAC;AAAC;","x_google_ignoreList":[0]}