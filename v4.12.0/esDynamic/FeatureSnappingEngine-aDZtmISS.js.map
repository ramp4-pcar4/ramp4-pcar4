{"version":3,"file":"FeatureSnappingEngine-aDZtmISS.js","sources":["../../node_modules/@arcgis/core/views/interactive/snapping/FeatureSnappingSourceInfo.js","../../node_modules/@arcgis/core/views/interactive/snapping/FeatureSnappingEngine.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import has from\"../../../core/has.js\";import r from\"../../../core/Logger.js\";import{watch as i,syncAndInitial as l}from\"../../../core/reactiveUtils.js\";import{sqlAnd as s}from\"../../../core/sql.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/RandomLCG.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../layers/support/FeatureFilter.js\";import{getFloorFilterClause as u}from\"../../../layers/support/floorFilterUtils.js\";import{isSubtypeGroupLayer as p,isFeatureLayer as d}from\"../../../layers/support/layerUtils.js\";import{isUtilityNetworkWebMap as c}from\"./snappingUtils.js\";import{scaleBoundsPredicate as y}from\"../../support/layerViewUtils.js\";let f=class extends t{set attributeRulesEnabled(e){this._set(\"attributeRulesEnabled\",e),e&&this.loadRules()}get layerView(){return this.view?.allLayerViews?.find((e=>e.layer===this.layer))}get valid(){const{_valid:e,snappingSource:t,layer:r}=this;return!(!t||!r)&&e}get subtypeFilter(){const{layer:e,snappingSource:t}=this;if(!p(e)||!e.subtypes?.length||!t)return{mode:\"not-in-use\",filter:null};const r=t.layerSource.sublayerSources.filter((e=>e.enabled&&e.layer.visible&&y(this.view?.scale,e.layer.effectiveScaleRange.minScale,e.layer.effectiveScaleRange.maxScale))).map((e=>e.layer.subtypeCode));if(!r.length)return{mode:\"none-visible\",filter:null};if(r.length===e.subtypes.length)return{mode:\"all-visible\",filter:null};const i=e.fieldsIndex.get(e.subtypeField)?.name??e.subtypeField;return 1===r.length?{mode:\"in-use\",filter:`${i} = ${r.getItemAt(0)}`}:{mode:\"in-use\",filter:`${i} IN (${r.join(\", \")})`}}get floorFilter(){const{view:e,layer:t}=this;return e&&t?u({view:e,layer:t}):null}constructor(e){super(e),this.layer=null,this.snappingSource=null,this.rulesTable=null,this._valid=null}initialize(){if(!this.snappingSource||!this.layer)return void(this._valid=!1);const{layer:e,snappingSource:t}=this;if(\"refresh\"in e){const r=e;this.addHandles(r.on(\"refresh\",(()=>t.refresh())))}this.loadRules(),this.addHandles([i((()=>t.updating),(e=>t.layerSource.updating=e),l),i((()=>t.availability),(e=>t.layerSource.availability=e),l)])}getFetchCandidatesParameters(e,t,r){if(!this.valid)return[];const{layer:i,layerView:l,floorFilter:o,rulesTable:a,subtypeFilter:u}=this,y={distance:r,mode:this.view?.type??\"2d\",point:e,coordinateHelper:t.coordinateHelper,...h(),filter:l&&\"filter\"in l?l.filter:null};if(o&&(y.filter=m(y.filter,o)),\"not-in-use\"!==u.mode&&\"all-visible\"!==u.mode){if(\"none-visible\"===u.mode)return[];y.filter?y.filter.where=s(y.filter.where,u.mode):y.filter=new n({where:u.filter})}if(!this.attributeRulesEnabled)return[y];const f=t.feature,v=\"subtype-sublayer\"===f?.sourceLayer?.type?f.sourceLayer.parent:f?.sourceLayer;if(a&&f&&c(this.view?.map)&&(d(i)||p(i))&&(d(v)||p(v))&&this.view.map.utilityNetworks?.find((e=>e.isUtilityLayer(v)))){if(\"loaded\"!==a.loadStatus)return[];const e=[],t=i.layerId,r=a.getFeatureSQL(v,f)?.[t];if(!r)return[];const l=r.anyVertex;let s=r.endVertex;return s&&l&&s===l&&(s=\"\"),s&&e.push({...y,returnEdge:!1,vertexMode:\"ends\",filter:m(y.filter,s)}),l&&e.push({...y,returnEdge:has(\"snapping-include-edges-when-applying-any-vertex-rule\")??!1,vertexMode:\"all\",filter:m(y.filter,l)}),e}return[y]}async loadRules(){this._valid=null;const{layer:e,view:t,attributeRulesEnabled:i}=this;if(i&&e&&t&&c(t?.map)&&(d(e)||p(e)))try{await Promise.allSettled(t.map.utilityNetworks?.map((e=>e.load()))??[]);const r=t.map.utilityNetworks?.find((t=>t.isUtilityLayer(e)));r&&(this.rulesTable=await r.getRulesTable(),await(this.rulesTable?.load()))}catch(l){return this._valid=!1,void r.getLogger(\"esri.views.interactive.snapping.FeatureSnappingSourceInfo\").error(\"Failed to load rules table for snapping source\",e.title)}this._valid=!0}remove(){this.destroy()}destroy(){this.snappingSource?.destroy()}};function h(){return{returnEdge:!0,vertexMode:\"all\"}}function m(e,t){return null==e?new n({where:t}):e.where?new n({where:s(e.where,t)}):new n({where:t})}e([o({constructOnly:!0})],f.prototype,\"layer\",void 0),e([o({constructOnly:!0})],f.prototype,\"snappingSource\",void 0),e([o({constructOnly:!0})],f.prototype,\"view\",void 0),e([o({value:!1})],f.prototype,\"attributeRulesEnabled\",null),e([o()],f.prototype,\"layerView\",null),e([o()],f.prototype,\"rulesTable\",void 0),e([o()],f.prototype,\"valid\",null),e([o()],f.prototype,\"subtypeFilter\",null),e([o()],f.prototype,\"floorFilter\",null),e([o()],f.prototype,\"_valid\",void 0),f=e([a(\"esri.views.interactive.snapping.FeatureSnappingSourceInfo\")],f);export{f as FeatureSnappingSourceInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import{isSome as r}from\"../../../core/arrayUtils.js\";import{destroyHandle as a}from\"../../../core/handleUtils.js\";import\"../../../core/has.js\";import{allSettledValues as n,throwIfAborted as s}from\"../../../core/promiseUtils.js\";import{mapCollectionAsync as i,watch as o,sync as c}from\"../../../core/reactiveUtils.js\";import{getMetersPerUnitForSR as u,getMetersPerVerticalUnitForSR as l}from\"../../../core/unitUtils.js\";import{property as p}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/Logger.js\";import{subclass as d}from\"../../../core/accessorSupport/decorators/subclass.js\";import{squaredDistance as m}from\"../../../core/libs/gl-matrix-2/math/vec2.js\";import{s as g,c as h}from\"../../../chunks/vec32.js\";import{create as S}from\"../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{getEpsilon as f}from\"../../../core/libs/gl-matrix-2/math/common.js\";import{UpdatingHandles as y}from\"../../../core/support/UpdatingHandles.js\";import{absoluteHeightElevationInfo as _}from\"../../../support/elevationInfoUtils.js\";import{VerticalHalfPlaneConstraint as v}from\"../sketch/constraints.js\";import{fromAnyMapPoint as w,markAsTarget as j,asVec2 as F}from\"../sketch/normalizedPoint.js\";import{FeatureSnappingSourceInfo as b}from\"./FeatureSnappingSourceInfo.js\";import{SnappingDomain as x}from\"./SnappingDomain.js\";import{sortCandidatesInPlace as C,screenDistance as R}from\"./snappingUtils.js\";import{DrapedEdgeSnappingCandidate as E}from\"./candidates/DrapedEdgeSnappingCandidate.js\";import{EdgeSnappingCandidate as M}from\"./candidates/EdgeSnappingCandidate.js\";import{FeatureSnappingCandidate as L}from\"./candidates/FeatureSnappingCandidate.js\";import{RightAngleSnappingCandidate as I,OtherVertexType as G}from\"./candidates/RightAngleSnappingCandidate.js\";import{vectorToScreenPoint as H}from\"../support/viewUtils.js\";let P=class extends t{get updating(){return this._snappingSources.some((e=>null==e?.valid||!0===e.valid&&!0===e.snappingSource?.updating))||this._updatingHandles.updating}constructor(e){super(e),this.options=null,this._domain=x.FEATURE,this._updatingHandles=new y,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){const e=i((()=>this.options?._effectiveFeatureSources),((e,t)=>this._createSourceInfo(e,t)));this._snappingSources=e,this.addHandles([a(e),o((()=>({rulesEnabled:!!this.options?.attributeRulesEnabled,sources:this._snappingSources.filter(r)})),(({rulesEnabled:e,sources:t})=>{for(const r of t)r.attributeRulesEnabled=e}),c)])}destroy(){this._set(\"options\",null),this._updatingHandles.destroy()}async fetchCandidates(e,t,r,a){if(!(t&this._domain&&null!=this.options&&this.options.effectiveFeatureEnabled))return[];const i=[],o=this._computeScreenSizeDistanceParameters(e,r);for(const n of this._snappingSources){if(!n?.valid||!n.snappingSource?.layerSource?.enabled||n.layerView?.suspended)continue;const t=n.getFetchCandidatesParameters(e,r,o);for(const e of t)i.push(n.snappingSource.fetchCandidates(e,a).then((e=>e.filter((e=>!this._candidateIsExcluded(n.snappingSource,e,r.excludeFeature))))))}const c=(await n(i)).flat();return this._addRightAngleCandidates(c,e,o,r),s(a),C(e,c),c}_addRightAngleCandidates(e,t,r,a){const n=null!=a.vertexHandle?a.vertexHandle.rightEdge?.rightVertex?.pos:null!=a.editGeometryOperations&&\"polygon\"===a.editGeometryOperations.data.type?a.editGeometryOperations.data.components[0]?.getFirstVertex()?.pos:null,s=null!=a.vertexHandle?a.vertexHandle.leftEdge?.leftVertex?.pos:null!=a.editGeometryOperations?a.editGeometryOperations.data.components[0]?.getLastVertex()?.pos:null,{view:i}=this,o=w(n,i,a),c=w(s,i,a),u=e.length;for(let l=0;l<u;l++)this._addRightAngleCandidate(e[l],c,t,r,e),this._addRightAngleCandidate(e[l],o,t,r,e)}_addRightAngleCandidate(e,t,r,a,n){if(null==t||!A(e))return;const s=e.constraint.closestTo(t),i=(s[0]-r[0])/a.x,o=(s[1]-r[1])/a.y,{start:c,end:u}=e.constraint;if(i*i+o*o<=1){const r=m(F(s),F(c))>m(F(s),F(u))?c:u,a=new I({targetPoint:j(s),otherVertex:t,otherVertexType:G.NEXT,previousVertex:r,constraint:new v(t,s),objectId:e.objectId,isDraped:e.isDraped,domain:x.FEATURE});n.push(a)}}_computeScreenSizeDistanceParameters(e,t){let r=null!=this.options?this.options.distance*(\"touch\"===t.pointer?this.options.touchSensitivityMultiplier:1):0;return null==this.view?{x:r,y:r,z:r,distance:r}:\"2d\"===this.view.type?(r*=this.view.resolution,{x:r,y:r,z:r,distance:r}):this._computeScreenSizeDistanceParameters3D(e,r,this.view,t)}_computeScreenSizeDistanceParameters3D(e,t,r,a){const{spatialReference:n}=a;r.renderCoordsHelper.toRenderCoords(e,n,D);const s=r.state.camera.computeScreenPixelSizeAt(D),i=s*r.renderCoordsHelper.unitInMeters,o=i/u(n),c=i/l(n),p=t*o,d=t*c,m=H(e,n,_,r),g=m?z(m,e,o,0,0,r,a):0,h=m?z(m,e,0,o,0,r,a):0,S=m?z(m,e,0,0,c,r,a):0;return{x:0===g?0:p/g,y:0===h?0:p/h,z:0===S?0:d/S,distance:s*t}}_candidateIsExcluded(e,t,r){if(null==r)return!1;const a=this._getCandidateObjectId(t);if(null==a)return!1;const n=e.layerSource.layer;return\"graphics\"===n.type?r.uid===a:r.sourceLayer===n&&(!(!r.attributes||!(\"objectIdField\"in n))&&r.attributes[n.objectIdField]===a)}_getCandidateObjectId(e){return e instanceof L?e.objectId:null}async _createSourceInfo(e,t){const r=e.layer;r.loaded||(await r.load(),s(t));const{view:a}=this,n=await this._createFeatureSnappingSourceType(e);return s(t),new b(null==n?{}:{snappingSource:n,view:a,layer:r})}async _createFeatureSnappingSourceType(e){switch(e.layer.type){case\"feature\":case\"geojson\":case\"csv\":case\"oriented-imagery\":case\"subtype-group\":case\"wfs\":return this._createFeatureSnappingSourceFeatureLayer(e);case\"graphics\":return this._createFeatureSnappingSourceGraphicsLayer(e);case\"map-notes\":return this._createFeatureSnappingSourceMapNotesLayer(e);case\"scene\":case\"building-scene\":return this._createFeatureSnappingSourceSceneLayer(e)}return null}async _createFeatureSnappingSourceSceneLayer(e){const{view:t}=this;if(null==t||\"3d\"!==t.type)return null;return new((await this._getSourceModule(\"scene\")).SceneLayerSnappingSource)({layerSource:e,view:t})}async _createFeatureSnappingSourceFeatureLayer(e){switch(e.layer.source?.type){case\"feature-layer\":case\"oriented-imagery\":return new((await this._getSourceModule(\"featureService\")).FeatureServiceSnappingSource)({spatialReference:this.spatialReference,view:this.view,layerSource:e});case\"memory\":case\"csv\":case\"geojson\":case\"wfs\":if(\"mesh\"===e.layer.geometryType)return null;return new((await this._getSourceModule(\"featureCollection\")).FeatureCollectionSnappingSource)({layerSource:e,view:this.view})}return null}async _createFeatureSnappingSourceGraphicsLayer(e){return new((await this._getSourceModule(\"graphics\")).GraphicsSnappingSource)({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}async _createFeatureSnappingSourceMapNotesLayer(e){return new((await this._getSourceModule(\"notes\")).GraphicsSnappingSource)({getGraphicsLayers:()=>e.layer.sublayers?.toArray()??[],spatialReference:this.spatialReference,view:this.view,layerSource:e})}async _getSourceModule(e){const t=this._sourceModules[e];if(null==t.loader){const t=this._loadSourceModule(e),r={module:null,loader:t};this._sourceModules[e]=r;const a=await t,n={module:a,loader:t};return this._sourceModules[e]=n,a}return null==t.module?t.loader:t.module}_loadSourceModule(e){const t=this._updatingHandles;switch(e){case\"featureService\":return t.addPromise(import(\"./featureSources/FeatureServiceSnappingSource.js\"));case\"featureCollection\":return t.addPromise(import(\"./featureSources/FeatureCollectionSnappingSource.js\"));case\"graphics\":case\"notes\":return t.addPromise(import(\"./featureSources/GraphicsSnappingSource.js\"));case\"scene\":return t.addPromise(import(\"./featureSources/SceneLayerSnappingSource.js\"))}}get test(){}};function A(e){return(e instanceof M||e instanceof E)&&!U(e)}function U({constraint:{start:e,end:t}}){const r=g(e,t),a=m(F(e),F(t));return r<f()||a/r<T}function z(e,t,r,a,n,s,{spatialReference:i}){const o=h(O,t);o[0]+=r,o[1]+=a,o[2]+=n;const c=H(o,i,_,s);return c?R(c,e):1/0}e([p({constructOnly:!0})],P.prototype,\"spatialReference\",void 0),e([p({constructOnly:!0})],P.prototype,\"view\",void 0),e([p()],P.prototype,\"options\",void 0),e([p({readOnly:!0})],P.prototype,\"updating\",null),e([p()],P.prototype,\"_snappingSources\",void 0),P=e([d(\"esri.views.interactive.snapping.FeatureSnappingEngine\")],P);const D=S(),O=S(),T=1e-4;export{P as FeatureSnappingEngine};\n"],"names":["f","t","p","e","y","i","u","l","a","h","m","s","n","v","c","d","r","has","o","P","x","C","w","A","F","I","j","G","D","H","_","g","z","S","L","b","M","E","U","T","O","R"],"mappings":"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","x_google_ignoreList":[0,1]}