import{e as O}from"./memoryEstimations-iHVpvWPf.js";import{e as q}from"./OptimizedGeometry-1qDYm3YK.js";function G(t,e){return t?e?4:3:e?3:2}function M(t,e,s,n){if(!e?.lengths.length)return null;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const r=t.coords,i=[],l=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:u,coords:h}=e,f=G(s,n);let m=0;for(const o of u){const I=P(l,h,m,o,s,n);I&&i.push(I),m+=o*f}if(i.sort((o,I)=>{let N=o[2]-I[2];return N===0&&s&&(N=o[4]-I[4]),N}),i.length){let o=6*i[0][2];r[0]=i[0][0]/o,r[1]=i[0][1]/o,s&&(o=6*i[0][4],r[2]=o!==0?i[0][3]/o:0),(r[0]<l[0]||r[0]>l[1]||r[1]<l[2]||r[1]>l[3]||s&&(r[2]<l[4]||r[2]>l[5]))&&(r.length=0)}if(!r.length){const o=e.lengths[0]?S(h,0,u[0],s,n):null;if(!o)return null;r[0]=o[0],r[1]=o[1],s&&o.length>2&&(r[2]=o[2])}return t}function P(t,e,s,n,r,i){const l=G(r,i);let u=s,h=s+l,f=0,m=0,o=0,I=0,N=0;for(let b=0,E=n-1;b<E;b++,u+=l,h+=l){const a=e[u],c=e[u+1],y=e[u+2],d=e[h],g=e[h+1],Y=e[h+2];let p=a*g-d*c;I+=p,f+=(a+d)*p,m+=(c+g)*p,r&&(p=a*Y-d*y,o+=(y+Y)*p,N+=p),a<t[0]&&(t[0]=a),a>t[1]&&(t[1]=a),c<t[2]&&(t[2]=c),c>t[3]&&(t[3]=c),r&&(y<t[4]&&(t[4]=y),y>t[5]&&(t[5]=y))}if(I>0&&(I*=-1),N>0&&(N*=-1),!I)return null;const T=[f,m,.5*I];return r&&(T[3]=o,T[4]=.5*N),T}function S(t,e,s,n,r){const i=G(n,r);let l=e,u=e+i,h=0,f=0,m=0,o=0;for(let I=0,N=s-1;I<N;I++,l+=i,u+=i){const T=t[l],b=t[l+1],E=t[l+2],a=t[u],c=t[u+1],y=t[u+2],d=n?w(T,b,E,a,c,y):j(T,b,a,c);if(d)if(h+=d,n){const g=A(T,b,E,a,c,y);f+=d*g[0],m+=d*g[1],o+=d*g[2]}else{const g=_(T,b,a,c);f+=d*g[0],m+=d*g[1]}}return h>0?n?[f/h,m/h,o/h]:[f/h,m/h]:s>0?n?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function j(t,e,s,n){const r=s-t,i=n-e;return Math.sqrt(r*r+i*i)}function w(t,e,s,n,r,i){const l=n-t,u=r-e,h=i-s;return Math.sqrt(l*l+u*u+h*h)}function _(t,e,s,n){return[t+.5*(s-t),e+.5*(n-e)]}function A(t,e,s,n,r,i){return[t+.5*(n-t),e+.5*(r-e),s+.5*(i-s)]}class F{constructor(e=null,s={},n,r,i=0){this.geometry=e,this.attributes=s,this.centroid=n,this.objectId=r,this.displayId=i}static fromJSON(e){const s=e.geometry?q.fromJSON(e.geometry):null,n=e.centroid?q.fromJSON(e.centroid):null,r=e.objectId;return new F(s,e.attributes,n,r)}weakClone(){const e=new F(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){const e=this.geometry?.clone(),s=new F(e,{...this.attributes},this.centroid?.clone(),this.objectId);return s.displayId=this.displayId,s}ensureCentroid(e){return this.centroid??=M(new q,this.geometry,e.hasZ,e.hasM),this.centroid}get usedMemory(){return 128+O(this.attributes)+(this.geometry?.usedMemory??0)}}function x(t){return!!t.geometry?.coords?.length}class V{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new V;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}export{V as e,M as n,x as o,F as s};
