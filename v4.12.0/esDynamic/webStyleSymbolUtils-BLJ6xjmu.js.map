{"version":3,"file":"webStyleSymbolUtils-BLJ6xjmu.js","sources":["../../node_modules/@arcgis/core/symbols/support/webStyleSymbolUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{isDevEnvironment as t,adjustStaticAGOUrl as e}from\"../../core/devEnvironmentUtils.js\";import r from\"../../core/Error.js\";import{urlToObject as o,removeFile as l}from\"../../core/urlUtils.js\";import n from\"../../portal/Portal.js\";import{f as s}from\"../../chunks/persistableUrlUtils.js\";import{fromJSON as m}from\"./jsonUtils.js\";import a from\"./StyleOrigin.js\";import{fetchStyle as i,requestJSON as p,makeCIMSymbolRef as u,Style2DUrlTemplate as c,symbolUrlFromStyleItem as f}from\"./styleUtils.js\";import{Thumbnail as y}from\"./Thumbnail.js\";import{isSymbol3D as b}from\"./typeUtils.js\";import{defaultAcceptedFormats as d}from\"./webStyleAcceptedFormats.js\";function h(t,e,o){const l=t.name;return null==l?Promise.reject(new r(\"symbolstyleutils:style-symbol-reference-name-missing\",\"Missing name in style symbol reference\")):\"Esri2DPointSymbolsStyle\"===t.styleName?U(l,e,o):i(t,e,o).then((t=>j(t,l,e,f,o)))}function g(t,e){return e.items.find((e=>e.name===t))}async function j(i,c,f,h,j){const U=null!=f?.portal?f.portal:n.getDefault(),w={portal:U,url:o(i.baseUrl),origin:\"portal-item\"},N=g(c,i.data);if(!N)throw new r(\"symbolstyleutils:symbol-name-not-found\",`The symbol name '${c}' could not be found`,{symbolName:c});const S=j?.acceptedFormats??d,D=h(N,S);if(!D)throw new r(\"symbolstyleutils:symbol-reference-no-accepted-format\",`The symbol name '${c}' does not have an accepted format (one of ${S})`,{symbolName:c});const{url:O,format:$}=D;let v=s(O,w),E=N.thumbnail?.href??null;const P=N.thumbnail?.imageData;t()&&(v=e(v)??\"\",E=e(E));const T={portal:U,url:o(l(v)),origin:\"portal-item\"};return p(v,j).then((t=>{const e=\"cim\"===$?u(t.data):t.data,r=m(e,T);if(r&&b(r)){if(E){const t=s(E,w);r.thumbnail=new y({url:t})}else P&&(r.thumbnail=new y({url:`data:image/png;base64,${P}`}));i.styleUrl?r.styleOrigin=new a({portal:f.portal,styleUrl:i.styleUrl,name:c}):i.styleName&&(r.styleOrigin=new a({portal:f.portal,styleName:i.styleName,name:c}))}return r}))}function U(t,e,r){const s=c.replaceAll(/\\{SymbolName\\}/gi,t),a=null!=e.portal?e.portal:n.getDefault();return p(s,r).then((t=>{const e=u(t.data);return m(e,{portal:a,url:o(l(s)),origin:\"portal-item\"})}))}export{j as fetchSymbolFromStyle,g as getStyleItemFromStyle,h as resolveWebStyleSymbol};\n"],"names":["h","o","l","r","U","i","t","j","f","g","e","c","n","w","N","S","d","D","O","$","v","s","E","P","T","p","u","m","b","y","a"],"mappings":";;;;AAIkpB,SAASA,EAAE,GAAE,GAAEC,GAAE;AAAC,QAAMC,IAAE,EAAE;AAAK,SAAaA,KAAN,OAAQ,QAAQ,OAAO,IAAIC,EAAE,wDAAuD,wCAAwC,CAAC,IAA8B,EAAE,cAA9B,4BAAwCC,EAAEF,GAAE,GAAED,CAAC,IAAEI,EAAE,GAAE,GAAEJ,CAAC,EAAE,KAAM,CAAAK,MAAGC,EAAED,GAAEJ,GAAE,GAAEM,GAAEP,CAAC,CAAG;AAAA;AAAC,SAASQ,EAAE,GAAE,GAAE;AAAC,SAAO,EAAE,MAAM,KAAM,CAAAC,MAAGA,EAAE,SAAO,CAAC;AAAE;AAAC,eAAeH,EAAEF,GAAEM,GAAEH,GAAER,GAAEO,GAAE;AAAC,QAAMH,IAAQI,GAAG,UAAT,OAAgBA,EAAE,SAAOI,EAAE,cAAaC,IAAE,EAAC,QAAOT,GAAE,KAAIH,EAAEI,EAAE,OAAO,GAAE,QAAO,cAAa,GAAES,IAAEL,EAAEE,GAAEN,EAAE,IAAI;AAAE,MAAG,CAACS,EAAE,OAAM,IAAIX,EAAE,0CAAyC,oBAAoBQ,CAAC,wBAAuB,EAAC,YAAWA,EAAC,CAAC;AAAE,QAAMI,IAAER,GAAG,mBAAiBS,GAAEC,IAAEjB,EAAEc,GAAEC,CAAC;AAAE,MAAG,CAACE,EAAE,OAAM,IAAId,EAAE,wDAAuD,oBAAoBQ,CAAC,8CAA8CI,CAAC,KAAI,EAAC,YAAWJ,EAAC,CAAC;AAAE,QAAK,EAAC,KAAIO,GAAE,QAAOC,EAAC,IAAEF;AAAE,MAAIG,IAAEC,EAAEH,GAAEL,CAAC,GAAES,IAAER,EAAE,WAAW,QAAM;AAAK,QAAMS,IAAET,EAAE,WAAW;AAAUR,EAAAA,QAAMc,IAAEV,EAAEU,CAAC,KAAG,IAAGE,IAAEZ,EAAEY,CAAC;AAAG,QAAME,IAAE,EAAC,QAAOpB,GAAE,KAAIH,EAAEC,EAAEkB,CAAC,CAAC,GAAE,QAAO,cAAa;AAAE,SAAOK,EAAEL,GAAEb,CAAC,EAAE,KAAM,CAAAD,MAAG;AAAC,UAAMI,IAAUS,MAAR,QAAUO,EAAEpB,EAAE,IAAI,IAAEA,EAAE,MAAKH,IAAEwB,EAAEjB,GAAEc,CAAC;AAAE,QAAGrB,KAAGyB,EAAEzB,CAAC,GAAE;AAAC,UAAGmB,GAAE;AAAC,cAAMhB,IAAEe,EAAEC,GAAET,CAAC;AAAE,QAAAV,EAAE,YAAU,IAAI0B,EAAE,EAAC,KAAIvB,EAAC,CAAC;AAAA,MAAC,MAAM,CAAAiB,MAAIpB,EAAE,YAAU,IAAI0B,EAAE,EAAC,KAAI,yBAAyBN,CAAC,GAAE,CAAC;AAAG,MAAAlB,EAAE,WAASF,EAAE,cAAY,IAAI2B,EAAE,EAAC,QAAOtB,EAAE,QAAO,UAASH,EAAE,UAAS,MAAKM,EAAC,CAAC,IAAEN,EAAE,cAAYF,EAAE,cAAY,IAAI2B,EAAE,EAAC,QAAOtB,EAAE,QAAO,WAAUH,EAAE,WAAU,MAAKM,EAAC,CAAC;AAAA,IAAE;AAAC,WAAOR;AAAA,EAAC,CAAC;AAAE;AAAC,SAASC,EAAE,GAAE,GAAED,GAAE;AAAC,QAAMkB,IAAEV,EAAE,WAAW,oBAAmB,CAAC,GAAEmB,IAAQ,EAAE,UAAR,OAAe,EAAE,SAAOlB,EAAE,WAAY;AAAC,SAAOa,EAAEJ,GAAElB,CAAC,EAAE,KAAM,CAAAG,MAAG;AAAC,UAAMI,IAAEgB,EAAEpB,EAAE,IAAI;AAAE,WAAOqB,EAAEjB,GAAE,EAAC,QAAOoB,GAAE,KAAI7B,EAAEC,EAAEmB,CAAC,CAAC,GAAE,QAAO,cAAa,CAAC;AAAA,EAAC,CAAG;AAAA;","x_google_ignoreList":[0]}