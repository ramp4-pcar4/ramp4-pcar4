import{it as S,a9 as F,fa as Z,x as s,z as r,K as d,a3 as B,iu as W}from"./main-DnzmeE4U.js";import{T as H,U as J,V as N,W as j,X as Q,Y as O,Z as m}from"./SketchViewModel-T2dNp9Tt.js";import{n as E}from"./PointSnappingHint-ClwQ1VNw.js";import{l as I,h as q,s as g,a as x,o as D,U,d as K,i as v}from"./quantityUtils-RaoZoCNH.js";import{l as G,B as h,U as $,C as P,H as tt,w as et,J as it,A as nt,K as T}from"./automaticLengthMeasurementUtils-BcfJmFU0.js";import{n as st}from"./uuid-Dj9mdEVg.js";import{r as at,e as ot}from"./geodesicLengthMeasurementUtils-X1SKKkBz.js";import{e as rt}from"./earcut-XDcq3zAf.js";import{o as X,q as lt,j as ut}from"./vec32-BuqRmYBM.js";import{n as ct}from"./projectVectorToVector-D0K_S4MR.js";import{p as pt,D as ft,O as ht,J as mt}from"./plane-B_adY3_o.js";import{v as dt}from"./triangle-BePBrXJ8.js";import{C as gt}from"./index-CVKk0WAC.js";import{v as vt}from"./geodesicUtils-DV-lFWtb.js";function yt(e){const{spatialReference:i}=e;return at(i,kt,bt,e)}function kt(e){return I(Math.abs(vt([e],"square-meters")[0]),"square-meters")}function bt(e){try{return I(Math.abs(gt(e,"square-meters")),"square-meters")}catch{return null}}function It(e,i=M()){return xt(e,i,!1)}function xt(e,i,t=e.hasZ){const n=G(e.spatialReference),o=S(n);if(o==null)return null;const c=(y,f)=>!(f.length<2)&&(X(y,f[0],f[1],t&&f[2]||0),!0);let l=0;for(const y of e.rings){const f=y.length;if(f<3)continue;const{positionsWorldCoords:p}=i;for(;p.length<f;)p.push(F());const C=At,k=X(wt,0,0,0),Y=1/f;for(let u=0;u<f;u++){if(!c(C,y[u])||!ct(C,e.spatialReference,p[u],n))return null;lt(k,k,p[u],Y)}const R=pt(p[0],p[1],k,ft());if(ut(ht(R))===0)continue;for(let u=0;u<f;u++)mt(R,k,p[u],p[u]);const b=Vt(p);for(let u=0;u<b.length;u+=3)l+=dt(p[b[u]],p[b[u+1]],p[b[u+2]])}return I(l,o)}const At=F(),wt=F();function M(){return{positionsWorldCoords:[]}}function Vt(e){return rt(Lt(e),[],2)}function Lt(e){const i=new Float64Array(2*e.length);for(let t=0;t<e.length;++t){const n=e[t],o=2*t;i[o]=n[0],i[o+1]=n[1]}return i}class Ft{draw(i,t){const n=Ut(i),o=this.sortUniqueHints(n),c=[];for(const l of o)l instanceof H&&c.push(this.visualizeIntersectionPoint(l,t)),l instanceof J&&c.push(this.visualizeLine(l,t)),l instanceof N&&c.push(this.visualizeParallelSign(l,t)),l instanceof j&&c.push(this.visualizeRightAngleQuad(l,t)),l instanceof E&&c.push(this.visualizePoint(l,t));return Z(c)}sortUniqueHints(i){return i}}function Ut(e){const i=[];for(const t of e){let n=!0;for(const o of i)if(t.equals(o)){n=!1;break}n&&i.push(t)}return i}let a=class extends B{constructor(e){super(e),this.actual=null,this.lockable=!0,this.id=st(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(e){this.lockable&&this._set("committed",e)}get dirty(){return this.inputValue!=null}get locked(){return this.lockable&&this.committed!=null}onInput(e){this.inputValue=e,this.invalid=!1}onCommit(e,i,t){this.lockable?this._onCommitLockable(e,t):this._onCommitNonLockable(t),this.invalid&&e==="commit-and-exit"||t.onCommit(i,e)}_onCommitLockable(e,i){const{inputValue:t,locked:n}=this;n&&A(t)?this.unlock():(e==="commit-and-exit"&&!n||t!=null)&&this._parseInputAndLock(i)}_onCommitNonLockable(e){const{inputValue:i}=this;A(i)?this.lockable?this.setActual(null):this.clearInputValue():i!=null&&this._parseInputAndSetActual(e)}applyValue(e){this.lockable?this.lock(e):this.setActual(e)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(e){this.actual=e,this.clearInputValue()}lock(e){this.lockable&&(this.committed=e??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(e){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(e))}getSuffix(e){const{suffix:i}=this;return typeof i=="function"?i(e):i}getFormattedValue(e){const{actual:i,committed:t,format:n}=this;return t!=null?n(t,e):i!=null?n(i,e):null}getRawDisplayValue(e){const{actual:i,committed:t,inputValue:n}=this;return n??(this.lockable&&t!=null?this.formatForInputMode(t,e):i!=null?this.formatForInputMode(i,e):null)}_parseInputAndSetActual(e){const{inputValue:i}=this;if(i==null||A(i))return this.setActual(null);const t=this.parse(i,e);t!=null?this.setActual(t):this.invalid=!0}_parseInputAndLock(e){const{inputValue:i,actual:t}=this;if(A(i))return this.unlock();if(i==null)return this.lock(t);const n=this.parse(i,e);n!=null?this.lock(n):this.invalid=!0}};function A(e){return e!=null&&e.trim()===""}s([r()],a.prototype,"actual",void 0),s([r()],a.prototype,"committed",null),s([r()],a.prototype,"dirty",null),s([r()],a.prototype,"format",void 0),s([r()],a.prototype,"formatForInputMode",void 0),s([r()],a.prototype,"lockable",void 0),s([r()],a.prototype,"locked",null),s([r()],a.prototype,"id",void 0),s([r()],a.prototype,"inputValue",void 0),s([r()],a.prototype,"name",void 0),s([r()],a.prototype,"parse",void 0),s([r()],a.prototype,"readOnly",void 0),s([r()],a.prototype,"suffix",void 0),s([r()],a.prototype,"title",void 0),s([r()],a.prototype,"visible",void 0),s([r()],a.prototype,"invalid",void 0),s([r()],a.prototype,"unlockOnVertexPlacement",void 0),a=s([d("esri.views.interactive.tooltip.fields.TooltipField")],a);let w=class extends a{constructor(e){super(e),this.showAsZ=!1}normalizeCtorArgs(e){const i=t=>t.inputUnitInfos.verticalLength.unit;return{name:"elevation",actual:q,parse:h({createQuantity:(t,n)=>x(t,i(n))}),format:(t,n)=>n.formatters.verticalLength(t),formatForInputMode:(t,n)=>n.formatters.scalar(g(t,i(n))),suffix:t=>t.inputUnitInfos.verticalLength.abbreviation,title:t=>t.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1,...e}}};s([r()],w.prototype,"showAsZ",void 0),w=s([d("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],w);let V=class extends a{constructor(e){super(e),this.precision=1}normalizeCtorArgs(e){const i=t=>t.inputUnitInfos.angle.unit;return{name:"orientation",actual:null,parse:h({createQuantity:(t,n)=>D(t,i(n),"geographic"),sanitize:P}),format:t=>{const n=Q(t);return $(n,"geographic",this.precision)},formatForInputMode:(t,n)=>{const o=Q(t);return n.formatters.scalar(o)},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.orientation,...e}}};s([r()],V.prototype,"precision",void 0),V=s([d("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],V);let L=class extends a{constructor(e){super(e),this.precision=null}normalizeCtorArgs(e){const i=t=>t.inputUnitInfos.length.unit;return{name:"size",actual:null,parse:h({createQuantity:(t,n)=>x(t,i(n))}),format:(t,n)=>n.formatters.length(t),formatForInputMode:(t,n)=>n.formatters.scalar(g(t,i(n))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.size,...e}}};s([r()],L.prototype,"precision",void 0),L=s([d("esri.views.interactive.tooltip.fields.TooltipFieldSize")],L);function Mt(e){const i=n=>n.inputUnitInfos.angle.unit,t=n=>n.sketchOptions.values.effectiveDirectionMode;return new a({name:"direction",actual:U,parse:h({createQuantity:(n,o)=>D(n,i(o),"geographic"),sanitize:P}),format:(n,o)=>{const c=t(o),l=O(n,c);switch(c){case m.Absolute:return o.formatters.direction(l);case m.Relative:return o.formatters.directionRelative(l);case m.RelativeBilateral:return o.formatters.directionRelativeBilateral(l)}},formatForInputMode:(n,o)=>{const c=O(n,t(o));return o.formatters.scalar(g(c,i(o)))},suffix:n=>n.inputUnitInfos.angle.abbreviation,title:n=>{const o=t(n),{absolute:c,relative:l}=n.messages.sketch.direction;switch(o){case m.Absolute:return c;case m.Relative:case m.RelativeBilateral:return l}},...e})}function _(e){const i=t=>t.inputUnitInfos.length.unit;return new a({name:"distance",actual:q,parse:h({createQuantity:(t,n)=>x(Math.max(t,0),i(n))}),format:(t,n)=>n.formatters.length(t),formatForInputMode:(t,n)=>n.formatters.scalar(g(t,i(n))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.distance,...e})}function _t(e){return _({format:(i,t)=>t.formatters.totalLength(i),title:i=>i.messages.sketch.totalLength,readOnly:!0,...e})}function zt(e){return _({...e})}function Ct(e){const i=t=>t.inputUnitInfos.length.unit;return _({...e,parse:h({createQuantity:(t,n)=>x(t,i(n))}),format:(t,n)=>n.formatters.lengthRelative(t)})}function Rt(e){return new w(e)}function Qt(e){return new V(e)}function Ot(e){return new L(e)}function qt(e){return z("scale",{name:"scale",actual:null,parse:h({createQuantity:i=>v(Math.abs(i))}),...e})}function Dt(e){const i=t=>t.inputUnitInfos.area.unit;return new a({name:"area",actual:K,parse:h({createQuantity:(t,n)=>I(t,i(n))}),format:(t,n)=>n.formatters.area(t),formatForInputMode:(t,n)=>n.formatters.scalar(g(t,i(n))),suffix:t=>t.inputUnitInfos.area.abbreviation,title:t=>t.messages.sketch.area,readOnly:!0,...e})}function Pt(e){return new a({name:"x",actual:U,parse:tt,format:(i,t)=>t.formatters.longitudeDecimalDegrees(i),formatForInputMode:i=>et(i),suffix:i=>i.inputUnitInfos.angle.abbreviation,title:i=>i.messages.sketch.longitude,...e})}function Tt(e){return new a({name:"y",actual:U,parse:it,format:(i,t)=>t.formatters.latitudeDecimalDegrees(i),formatForInputMode:i=>nt(i),suffix:i=>i.inputUnitInfos.angle.abbreviation,title:i=>i.messages.sketch.latitude,...e})}function Xt(e){return z("x",{name:"x",...e})}function Yt(e){return z("y",{name:"y",...e})}function z(e,i){return new a({actual:v(0),parse:h({createQuantity:t=>v(t)}),format:(t,n)=>n.formatters.scalar(t),formatForInputMode:(t,n)=>n.formatters.scalar(t),title:t=>t.messages.sketch[e],...i})}const St=e=>{let i=class extends e{constructor(){super(...arguments),this.longitude=Pt(),this.latitude=Tt(),this.x=Xt(),this.y=Yt(),this.elevation=Rt(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(t,n=t?.spatialReference){if(this.geographic=!!n&&ot(n),t==null)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){const o=W(t,Zt);this._setActualLonLat(T(o?.[0]),T(o?.[1]))}else this._setActualXY(v(t.x),v(t.y))}_setActualLonLat(t,n){this.longitude.actual=t,this.latitude.actual=n}_setActualXY(t,n){this.x.actual=t,this.y.actual=n}};return s([r()],i.prototype,"geographic",void 0),s([r()],i.prototype,"effectiveX",null),s([r()],i.prototype,"effectiveY",null),s([r()],i.prototype,"key",null),i=s([d("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],i),i},Zt=[0,0];function Bt(e,i,t=M()){return yt(e)??It(e,t)}function Wt(e,i=M()){return Bt(e,"on-the-ground",i)}export{zt as F,Dt as Q,qt as R,St as h,Ot as j,Qt as k,Ft as r,Wt as u,_t as w,Ct as x,Mt as y};
