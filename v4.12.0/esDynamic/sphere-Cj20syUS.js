import{gg as st,aX as O,a9 as g,gh as ot,c4 as it,c5 as p}from"./main-DnzmeE4U.js";import{p as ct}from"./mat4-BFStKTjU.js";import{s as x,c as f,_ as y,A as j,P as T,u as P,g as M,r as m,o as A,p as I,E as at,j as ut,v as ft,I as ht,q as gt}from"./vec32-BuqRmYBM.js";import{L as N,a as R}from"./vec42-D8CJyqHG.js";import{n as V,r as L}from"./vec4f64-CjUMzAyX.js";import{e as mt}from"./common-CYWrYyJl.js";import"./mat3-DOnW3DjW.js";import"./mat3f64-Dh9_zhFu.js";import{c as u,a as lt,b as _t}from"./plane-B_adY3_o.js";class X{constructor(r){this._allocator=r,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&st(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const r=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*Y);this._items.length=Math.min(r,this._items.length),this._itemsPtr=0}_grow(){for(let r=0;r<Math.max(8,Math.min(this._items.length,Y));r++)this._items.push(this._allocator())}}const Y=1024;function d(t){return t?Z(O(t.origin),O(t.direction)):Z(g(),g())}function Z(t,r){return{origin:t,direction:r}}function Mt(t,r){const n=bt.get();return n.origin=t,n.direction=r,n}function dt(t,r=d()){return pt(t.origin,t.direction,r)}function $(t,r,n=d()){return x(n.origin,t),f(n.direction,r,t),n}function pt(t,r,n=d()){return x(n.origin,t),x(n.direction,r),n}function Pt(t,r){const n=y(u.get(),j(u.get(),t.direction),f(u.get(),r,t.origin));return T(n,n)}function St(t,r,n){const e=T(t.direction,f(n,r,t.origin));return P(n,t.origin,M(n,t.direction,e)),n}const bt=new X(()=>d());function k(t,r){const n=m(t),e=ot(t[2]/n),s=Math.atan2(t[1]/n,t[0]/n);return A(r,n,e,s),r}const z=S();function S(){return V()}const B=N,qt=N;function v(t,r){return R(r,t)}function F(t,r){return L(t[0],t[1],t[2],r)}function H(t){return t}function wt(t){t[0]=t[1]=t[2]=t[3]=0}function xt(t,r){return t[0]=t[1]=t[2]=0,t[3]=r,t}function l(t){return t[3]}function U(t){return t}function D(t,r,n,e){return L(t,r,n,e)}function yt(t,r,n){return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=t[3]+r,n}function At(t,r,n){return t!==n&&v(t,n),n}function Rt(t,r){return r}function b(t,r,n){if(r==null||!J(t,r,q))return!1;let{t0:e,t1:s}=q;if((e<0||s<e&&s>0)&&(e=s),e<0)return!1;if(n){const{origin:o,direction:i}=r;n[0]=o[0]+i[0]*e,n[1]=o[1]+i[1]*e,n[2]=o[2]+i[2]*e}return!0}function G(t,r,n){const e=$(r,n);if(!J(t,e,q))return[];const{origin:s,direction:o}=e,{t0:i,t1:c}=q,a=h=>{const _=g();return gt(_,s,o,h),w(t,_,_)};return Math.abs(i-c)<mt()?[a(i)]:[a(i),a(c)]}const q={t0:0,t1:0};function J(t,r,n){const{origin:e,direction:s}=r,o=vt;o[0]=e[0]-t[0],o[1]=e[1]-t[1],o[2]=e[2]-t[2];const i=s[0]*s[0]+s[1]*s[1]+s[2]*s[2];if(i===0)return!1;const c=2*(s[0]*o[0]+s[1]*o[1]+s[2]*o[2]),a=c*c-4*i*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(a<0)return!1;const h=Math.sqrt(a);return n.t0=(-c-h)/(2*i),n.t1=(-c+h)/(2*i),!0}const vt=g();function K(t,r){return b(t,r,null)}function Ct(t,r,n){if(b(t,r,n))return n;const e=Q(t,r,u.get());return P(n,r.origin,M(u.get(),r.direction,I(r.origin,e)/m(r.direction))),n}function Q(t,r,n){const e=u.get(),s=lt.get();y(e,r.origin,r.direction);const o=l(t);y(n,e,r.origin),M(n,n,1/m(n)*o);const i=W(t,r.origin),c=_t(r.origin,n);return ct(s,c+i,e),at(n,n,s),n}function Et(t,r,n,e){const s=l(t),o=s*s,i=r+.5*Math.PI,c=n*n+o-2*Math.cos(i)*n*s,a=Math.sqrt(c),h=c-o;if(h<=0)return .5;const _=Math.sqrt(h),et=Math.acos(_/a)-Math.asin(s/(a/Math.sin(i)));return Math.min(1,(et+.5*e)/e)}function Ot(t,r,n){return b(t,r,n)?n:(St(r,t,n),w(t,n,n))}function w(t,r,n){const e=f(u.get(),r,t),s=M(u.get(),e,t[3]/m(e));return P(n,s,t)}function jt(t,r){const n=f(u.get(),r,t),e=ut(n),s=t[3]*t[3];return Math.sqrt(Math.abs(e-s))}function W(t,r){const n=f(u.get(),r,t),e=m(n),s=l(t),o=s+Math.abs(s-e);return it(s/o)}const C=g();function tt(t,r,n,e){const s=f(C,r,t);switch(n){case p.X:{const o=k(s,C)[2];return A(e,-Math.sin(o),Math.cos(o),0)}case p.Y:{const o=k(s,C),i=o[1],c=o[2],a=Math.sin(i);return A(e,-a*Math.cos(c),-a*Math.sin(c),Math.cos(i))}case p.Z:return j(e,s);default:return}}function nt(t,r){const n=f(E,r,t);return m(n)-t[3]}function Tt(t,r,n,e){const s=nt(t,r),o=tt(t,r,p.Z,E),i=M(E,o,n-s);return P(e,r,i)}function rt(t,r){const n=ft(t,r),e=l(t);return n<=e*e}function It(t,r,n=V()){const e=I(t,r),s=t[3],o=r[3];return e+o<s?(R(n,t),n):e+s<o?(R(n,r),n):(ht(n,t,r,(e+o-s)/(2*e)),n[3]=(e+s+o)/2,n)}const E=g(),Nt=S(),Vt=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:z,altitudeAt:nt,angleToSilhouette:W,axisAt:tt,cameraFrustumCoverage:Et,clear:wt,closestPoint:Ot,closestPointOnSilhouette:Q,containsPoint:rt,copy:v,create:S,distanceToSilhouette:jt,elevate:yt,equals:qt,exactEquals:B,fromCenterAndRadius:F,fromRadius:xt,fromValues:D,getCenter:U,getExtent:Rt,getRadius:l,intersectLine:G,intersectRay:b,intersectRayClosestSilhouette:Ct,intersectsRay:K,projectPoint:w,setAltitudeAt:Tt,setExtent:At,tmpSphere:Nt,union:It,wrap:H},Symbol.toStringTag,{value:"Module"}));export{w as $,z as C,S as E,K as H,G as I,l as N,F as O,$ as S,H as T,U,D as V,B as _,v as a,d as b,Vt as f,rt as i,Mt as k,X as s,dt as v,Pt as w};
