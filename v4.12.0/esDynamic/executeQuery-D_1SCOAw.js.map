{"version":3,"file":"executeQuery-D_1SCOAw.js","sources":["../../node_modules/@arcgis/core/rest/query/executeQuery.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport t from\"../../core/Error.js\";import has from\"../../core/has.js\";import{whenOrAbort as o}from\"../../core/promiseUtils.js\";import{getGlbFormatId as r,getGltfFormatId as e}from\"../../layers/support/infoFor3D.js\";import{DataLayerSource as n}from\"../../layers/support/source/DataLayerSource.js\";import{executeRawQueryJSON as s}from\"./executeQueryJSON.js\";import{executeRawQueryPBF as a}from\"./executeQueryPBF.js\";import i from\"../support/FeatureSet.js\";import u from\"../support/Query.js\";async function f(t,o,r,e){return m(o,await c(t,o,r,e),r,e)}async function c(t,o,r,e){const n={...e},i=p(o,r),u=null!=o.outStatistics?.[0],f=has(\"featurelayer-pbf-statistics\"),c=!u||f;let m;if(\"pbf\"===r?.format&&c)try{m=await a(t,i,n)}catch(d){if(\"query:parsing-pbf\"!==d.name)throw d;r.format=\"json\"}return\"json\"!==r?.format&&c||(m=await s(t,i,n)),l(r?.fieldsIndex,m.fields),m}function l(t,o){if(null!=t&&null!=o)for(const r of o){const o=t.get(r.name);o&&Object.assign(r,o.toJSON())}}async function m(t,r,e,n){const s=e?.infoFor3D;if(!d(t,s)||null==s||!r.assetMaps||!r.features?.length)return i.fromJSON(r);const{meshFeatureSetFromJSON:a}=await o(import(\"../support/meshFeatureSet.js\"),n);return a(t,s,r)}function p(o,s){let a=u.from(o);a.sourceSpatialReference=a.sourceSpatialReference??s?.sourceSpatialReference??null,(s?.gdbVersion||s?.dynamicDataSource)&&(a=a===o?a.clone():a,a.gdbVersion=o.gdbVersion||s.gdbVersion,a.dynamicDataSource=o.dynamicDataSource?n.from(o.dynamicDataSource):s.dynamicDataSource);const i=s?.infoFor3D;if(null!=i&&d(o,i)){a=a===o?a.clone():a,a.formatOf3DObjects=null;const n=r(i),s=e(i);for(const t of i.queryFormats){if(t===n){a.formatOf3DObjects=t;break}t!==s||a.formatOf3DObjects||(a.formatOf3DObjects=t)}if(!a.formatOf3DObjects)throw new t(\"query:unsupported-3d-query-formats\",\"Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf\");if(null==a.outFields||!a.outFields.includes(\"*\")){a=a===o?a.clone():a,null==a.outFields&&(a.outFields=[]);const{originX:t,originY:r,originZ:e,translationX:n,translationY:s,translationZ:u,scaleX:f,scaleY:c,scaleZ:l,rotationX:m,rotationY:p,rotationZ:d,rotationDeg:y}=i.transformFieldRoles;a.outFields.push(t,r,e,n,s,u,f,c,l,m,p,d,y)}}return a}function d(t,o){return null!=o&&!0===t.returnGeometry&&\"xyFootprint\"!==t.multipatchOption&&!t.outStatistics}export{f as executeQuery,c as executeRawQuery,l as normalizeFields};\n"],"names":["f","t","o","r","e","m","c","n","i","p","u","has","s","l","a"],"mappings":";;;;;;AAIye,eAAeA,EAAEC,GAAEC,GAAEC,GAAEC,GAAE;AAAC,SAAOC,EAAEH,GAAE,MAAMI,EAAEL,GAAEC,GAAEC,GAAEC,CAAC,CAAK;AAAC;AAAC,eAAeE,EAAEL,GAAEC,GAAEC,GAAEC,GAAE;AAAC,QAAMG,IAAE,EAAC,GAAGH,EAAC,GAAEI,IAAEC,EAAEP,GAAEC,CAAC,GAAEO,IAAQR,EAAE,gBAAgB,CAAC,KAAzB,MAA2BF,IAAEW,EAAI,6BAA6B,GAAEL,IAAE,CAACI,KAAGV;AAAE,MAAIK;AAAgH,SAA0BC,MAAID,IAAE,MAAMO,EAAEX,GAAEO,GAAED,CAAC,IAAKJ,GAAG,aAAYE,EAAE,QAAQA;AAAC;AAAC,SAASQ,EAAEZ,GAAEC,GAAE;AAA4F;AAAC,eAAeG,EAAEJ,GAAEE,GAAE,GAAE,GAAE;AAA6E,SAAOK,EAAE,SAASL,CAAC;AAAmG;AAAC,SAASM,EAAEP,GAAEU,GAAE;AAAC,MAAIE,IAAEJ,EAAE,KAAKR,CAAC;AAAEY,SAAAA,EAAE,yBAAuBA,EAAE,0BAAwBF,GAAG,0BAAwB,MAAu6BE;AAAC;","x_google_ignoreList":[0]}