import{b as Bi,aN as J,ip as Gi,aH as qe,iq as je,dc as V,da as U,ir as de,ec as q,aQ as Wi,is as Ki,bC as ir,aI as Xi}from"./main-DnzmeE4U.js";import{i as j,r as Z}from"./TimeOnly-C3SOkmg2.js";var d;(function(a){a.InvalidFunctionParameters="InvalidFunctionParameters",a.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",a.UnsupportedSqlFunction="UnsupportedSqlFunction",a.UnsupportedOperator="UnsupportedOperator",a.UnsupportedSyntax="UnsupportedSyntax",a.UnsupportedIsRhs="UnsupportedIsRhs",a.UnsupportedIsLhs="UnsupportedIsLhs",a.InvalidDataType="InvalidDataType",a.CannotCastValue="CannotCastValue",a.FunctionNotRecognized="FunctionNotRecognized",a.InvalidTime="InvalidTime",a.InvalidParameterCount="InvalidParameterCount",a.InvalidTimeStamp="InvalidTimeStamp",a.InvalidDate="InvalidDate",a.InvalidOperator="InvalidOperator",a.IllegalInterval="IllegalInterval",a.YearMonthIntervals="YearMonthIntervals",a.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",a.MissingStatisticParameters="MissingStatisticParameters"})(d||(d={}));const el={[d.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[d.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.UnsupportedOperator]:"Unsupported operator - {operator}",[d.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.UnsupportedSqlFunction]:"Sql function not found = {function}",[d.InvalidDataType]:"Invalid sql data type",[d.InvalidDate]:"Invalid date encountered",[d.InvalidOperator]:"Invalid operator encountered",[d.InvalidTime]:"Invalid time encountered",[d.IllegalInterval]:"Illegal interval",[d.FunctionNotRecognized]:"Function not recognized",[d.InvalidTimeStamp]:"Invalid timestamp encountered",[d.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[d.YearMonthIntervals]:"Year-Month Intervals not supported",[d.CannotCastValue]:"Cannot cast value to the required data type"};let m=class br extends Error{constructor(o,u){super(Bi(el[o],u)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,br)}};function lr(a){return Number.isNaN(a)||a===0?a:Math.trunc(a)}const cr="esri.core.sql.SqlTimeStampOffset";let Y=class ie{constructor(o){this._timeStampOffset=o,this.declaredRootClass=cr,this._date=null}static isTimestampOffset(o){return typeof o=="object"&&o!=null&&"declaredRootClass"in o&&o.declaredRootClass===cr}toDateTime(){return this._date??=J.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return lr(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return lr(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return ie.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(o){return new ie(J.fromJSDate(o).toISO({includeOffset:!0}))}static fromDateTime(o){return new ie(o.toISO({includeOffset:!0}))}static fromParts(o,u,t=0,l=0,h=0,g=0,y=0,O=!1,S=0,x=0){const D=`${o.toString().padStart(4,"0")}-${u.toString().padStart(2,"0")}-${t.toString().padStart(2,"0")}`;let M="";g<10&&(M="0");let X=`${l.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}:${M+g.toString()}`;y!==0&&(X+="."+y.toString().padStart(3,"0"));const ee=`${O?"-":"+"}${S.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`;return new ie(D+"T"+X+ee)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let o=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return o&&(o=o.replace(".000","")),o}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(o){const u=this.toDateTime().plus(o);return ie.fromDateTime(u)}};function fr(a,o){const u=pr[a.toLowerCase()];if(u==null)throw new m(d.FunctionNotRecognized);if(o.length<u.minParams||o.length>u.maxParams)throw new m(d.InvalidParameterCount,{name:a.toUpperCase()});return u.evaluate(o)}function dr(a,o){const u=pr[a.toLowerCase()];return u!=null&&o>=u.minParams&&o<=u.maxParams}const pr={min:{minParams:1,maxParams:1,evaluate:a=>hr(a[0],"min")},max:{minParams:1,maxParams:1,evaluate:a=>hr(a[0],"max")},avg:{minParams:1,maxParams:1,evaluate:a=>mr(a[0])},sum:{minParams:1,maxParams:1,evaluate:a=>tl(a[0])},stddev:{minParams:1,maxParams:1,evaluate:a=>rl(a[0])},count:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].length},var:{minParams:1,maxParams:1,evaluate:a=>vr(a[0])}};function mr(a){if(a===null)return null;let o=0,u=0;for(let t=0;t<a.length;t++){const l=a[t];if(l!==null){if(!Ye(l))throw new m(d.InvalidValueForAggregateFunction);u++,o+=l}}return u===0?null:o/a.length}function Ye(a){return typeof a=="number"}function hr(a,o){if(a===null)return null;let u=null,t=null;for(const l of a){let h=l;h=j.isDateOnly(l)||Z.isTimeOnly(l)?l.toNumber():J.isDateTime(l)?l.toMillis():Y.isTimestampOffset(l)?l.toMilliseconds():l,(u===null||o==="max"&&t!==null&&h!==null&&t<=h||o==="min"&&t!==null&&h!==null&&t>=h)&&(u=l,t=h)}return u}function tl(a){if(a===null)return null;let o=0;for(let u=0;u<a.length;u++){const t=a[u];if(t!==null){if(!Ye(t))throw new m(d.InvalidValueForAggregateFunction);o+=t}}return o}function rl(a){if(a===null)return null;const o=vr(a);return o===null?null:Math.sqrt(o)}function vr(a){if(a===null||(a=a.filter(t=>t!==null)).length===0)return null;const o=mr(a);if(o===null)return null;let u=0;for(const t of a){if(!Ye(t))throw new m(d.InvalidValueForAggregateFunction);u+=(o-t)**2}return u/(a.length-1)}function Qe(a){if(a.precision!==null||a.secondary!==null)throw new m(d.PrimarySecondaryQualifiers)}function be(a,o){if(o.includes(".")){const u=o.split(".");a.second=parseFloat(u[0]),a.millis=parseInt(u[1],10)}else a.second=parseFloat(o)}const wr="esri.core.sql.SqlInterval";class L{constructor(){this.declaredRootClass=wr,this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static isInterval(o){return typeof o=="object"&&o!=null&&"declaredRootClass"in o&&o.declaredRootClass===wr}static createFromMilliseconds(o){const u=new L;return u.second=o/1e3,u}static createFromValueAndQualifier(o,u,t){let l=null;const h=new L;if(h.op=t==="-"?"-":"+",u.type==="interval-period"){Qe(u);const g=new RegExp("^[0-9]{1,}$");if(u.period==="year"||u.period==="month")throw new m(d.YearMonthIntervals);if(u.period==="second"){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(o))throw new m(d.IllegalInterval);be(h,o)}else{if(!g.test(o))throw new m(d.IllegalInterval);h[u.period]=parseFloat(o)}}else{if(Qe(u.start),Qe(u.end),u.start.period==="year"||u.start.period==="month"||u.end.period==="year"||u.end.period==="month")throw new m(d.YearMonthIntervals);switch(u.start.period){case"day":switch(u.end.period){case"hour":if(l=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!l.test(o))throw new m(d.IllegalInterval);h[u.start.period]=parseFloat(o.split(" ")[0]),h[u.end.period]=parseFloat(o.split(" ")[1]);break;case"minute":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!l.test(o))throw new m(d.IllegalInterval);{h[u.start.period]=parseFloat(o.split(" ")[0]);const g=o.split(" ")[1].split(":");h.hour=parseFloat(g[0]),h.minute=parseFloat(g[1])}break;case"second":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(o))throw new m(d.IllegalInterval);{h[u.start.period]=parseFloat(o.split(" ")[0]);const g=o.split(" ")[1].split(":");h.hour=parseFloat(g[0]),h.minute=parseFloat(g[1]),be(h,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"hour":switch(u.end.period){case"minute":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!l.test(o))throw new m(d.IllegalInterval);h.hour=parseFloat(o.split(":")[0]),h.minute=parseFloat(o.split(":")[1]);break;case"second":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(o))throw new m(d.IllegalInterval);{const g=o.split(":");h.hour=parseFloat(g[0]),h.minute=parseFloat(g[1]),be(h,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"minute":if(u.end.period!=="second")throw new m(d.IllegalInterval);if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(o))throw new m(d.IllegalInterval);{const g=o.split(":");h.minute=parseFloat(g[0]),be(h,g[1])}break;default:throw new m(d.IllegalInterval)}}return h}valueInMilliseconds(){return(this.op==="-"?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}const nl=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,ol=/^(\d{1,2}):(\d{1,2})$/,al=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,Ir=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,sl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,ul=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,il=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,ll=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function Ae(a,o){if(o instanceof Gi)return o===qe.instance?J.fromMillis(a.getTime(),{zone:qe.instance}):J.fromJSDate(a,{zone:o});switch(o){case"system":case"local":case null:return J.fromJSDate(a);default:return o?.toLowerCase()==="unknown"?J.fromMillis(a.getTime(),{zone:qe.instance}):J.fromJSDate(a,{zone:o})}}function K(a){return L.isInterval(a)}function b(a){return J.isDateTime(a)}function A(a){return j.isDateOnly(a)}function P(a){return Z.isTimeOnly(a)}function F(a){return Y.isTimestampOffset(a)}function Be(a){let o=nl.exec(a);if(o!==null){const[,u,t,l]=o,h=Z.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),0);if(h!==null)return h;throw new m(d.InvalidTime)}if(o=ol.exec(a),o!==null){const[,u,t]=o,l=Z.fromParts(parseInt(u,10),parseInt(t,10),0,0);if(l!==null)return l;throw new m(d.InvalidTime)}if(o=al.exec(a),o!==null){const[,u,t,l,h]=o,g=Z.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),parseInt(h,10));if(g!==null)return g;throw new m(d.InvalidTime)}throw new m(d.InvalidTime)}function Fe(a,o,u=!1){let t=sl.exec(a);if(t!==null){const[,l,h,g,y,O,S,x]=t,D=J.fromObject({year:parseInt(l,10),month:parseInt(h,10),day:parseInt(g,10),hour:parseInt(y,10),minute:parseInt(O,10),second:parseInt(S,10),millisecond:x?parseInt(x.replace(".",""),10):0},{zone:je(o)});if(D.isValid===!1)throw new m(d.InvalidTimeStamp);return D}if(t=ul.exec(a),t!==null){const[,l,h,g,y,O,S,x,D,M,X]=t,ee=Y.fromParts(parseInt(l,10),parseInt(h,10),parseInt(g,10),parseInt(y,10),parseInt(O,10),parseInt(S,10),x?parseInt(x.replace(".",""),10):0,D==="-",parseInt(M,10),parseInt(X,10));if(ee.isValid===!1)throw new m(d.InvalidTimeStamp);return ee}if(t=il.exec(a),t!==null){const[,l,h,g,y,O,S,x,D]=t,M=Y.fromParts(parseInt(l,10),parseInt(h,10),parseInt(g,10),parseInt(y,10),parseInt(O,10),0,0,S==="-",parseInt(x,10),parseInt(D,10));if(M.isValid===!1)throw new m(d.InvalidTimeStamp);return M}if(t=ll.exec(a),t!==null){const[,l,h,g,y,O]=t,S=J.fromObject({year:parseInt(l,10),month:parseInt(h,10),day:parseInt(g,10),hour:parseInt(y,10),minute:parseInt(O,10),second:0},{zone:je(o)});if(S.isValid===!1)throw new m(d.InvalidTimeStamp);return S}if(t=Ir.exec(a),t!==null){const[,l,h,g]=t,y=J.fromObject({year:parseInt(l,10),month:parseInt(h,10),day:parseInt(g,10),hour:0,minute:0,second:0},{zone:je(o)});if(y.isValid===!1)throw new m(d.InvalidTimeStamp);return y}throw new m(d.InvalidTimeStamp)}function gr(a,o){const u=Ir.exec(a);if(u===null)try{return Fe(a,o)}catch{throw new m(d.InvalidDate)}const[,t,l,h]=u,g=j.fromParts(parseInt(t,10),parseInt(l,10),parseInt(h,10));if(g===null)throw new m(d.InvalidDate);return g}const cl=321408e5,fl=26784e5,dl=864e5,pl=36e5,ml=6e4;function Ge(a){return!!b(a)||!!F(a)}function We(a){return!!b(a)||!!A(a)||!!F(a)||!!P(a)}function De(a){if(b(a))return a.toMillis();if(A(a))return a.toNumber();if(F(a))return a.toMilliseconds();throw new m(d.InvalidDataType)}function z(a,o,u,t){if(a==null||o==null)return null;if(V(a)){if(V(o))return B(a,o,u);if(U(o))return hl(a,o,u);if(We(o))throw new m(d.InvalidOperator);if(A(o))throw new m(d.InvalidOperator)}else if(U(a)){if(V(o))return vl(a,o,u);if(U(o))return wl(a,o,u);if(b(o))throw new m(d.InvalidOperator);if(A(o))throw new m(d.InvalidOperator);if(P(o))throw new m(d.InvalidOperator);if(F(o))throw new m(d.InvalidOperator)}else if(b(a)){if(Ge(o)){if(de(a.zone)){if(J.isDateTime(o)&&!de(o.zone)||Y.isTimestampOffset(o))return Ke(a,o,u)}else if(J.isDateTime(o)&&de(o.zone)&&(!de(a.zone)||Y.isTimestampOffset(a)))return Ke(a,o,u);return B(De(a),De(o),u)}if(U(o))throw new m(d.InvalidOperator);if(A(o))return Il(a,o,u);if(P(o))throw new m(d.InvalidOperator);if(V(o))throw new m(d.InvalidOperator)}else if(A(a)){if(F(o))return yl(a,o,u);if(b(o))return Tl(a,o,u);if(U(o))throw new m(d.InvalidOperator);if(A(o))return B(a.toNumber(),o.toNumber(),u);if(P(o))throw new m(d.InvalidOperator);if(V(o))throw new m(d.InvalidOperator)}else if(P(a)){if(P(o))return B(a.toNumber(),o.toNumber(),u);if(U(o))throw new m(d.InvalidOperator);if(V(o))throw new m(d.InvalidOperator);if(A(o))throw new m(d.InvalidOperator);if(Ge(o))throw new m(d.InvalidOperator)}else if(F(a)){if(Ge(o))return J.isDateTime(o)&&de(o.zone)?Ke(a,o,u):B(De(a),De(o),u);if(U(o))throw new m(d.InvalidOperator);if(A(o))return gl(a,o,u);if(P(o))throw new m(d.InvalidOperator);if(V(o))throw new m(d.InvalidOperator)}switch(u){case"<>":return a!==o;case"=":return a===o;case">":return a>o;case"<":return a<o;case">=":return a>=o;case"<=":return a<=o}}function B(a,o,u){switch(u){case"<>":return a!==o;case"=":return a===o;case">":return a>o;case"<":return a<o;case">=":return a>=o;case"<=":return a<=o}}function hl(a,o,u){const t=parseFloat(o);if(!isNaN(t))return B(a,t,u);const l=a.toString();switch(u){case"<>":return l!==o;case"=":return l===o;case">":return l>o;case"<":return l<o;case">=":return l>=o;case"<=":return l<=o}}function vl(a,o,u){const t=parseFloat(a);if(!isNaN(t))return B(t,o,u);const l=o.toString();switch(u){case"<>":return a!==l;case"=":return a===l;case">":return a>l;case"<":return a<l;case">=":return a>=l;case"<=":return a<=l}}function wl(a,o,u){switch(u){case"<>":return a!==o;case"=":return a===o;case">":return a>o;case"<":return a<o;case">=":return a>=o;case"<=":return a<=o}}function Il(a,o,u){const t=o.toDateTimeLuxon(a.zone);return B((a=a.startOf("day")).toMillis(),t.toMillis(),u)}function gl(a,o,u){const t=o.toDateTimeLuxon(a.toDateTime().zone);return B((a=a.startOfDay()).toMilliseconds(),t.toMillis(),u)}function Tl(a,o,u){const t=a.toDateTimeLuxon(o.zone);return o=o.startOf("day"),B(t.toMillis(),o.toMillis(),u)}function yl(a,o,u){const t=a.toDateTimeLuxon(o.toDateTime().zone);return o=o.startOfDay(),B(t.toMillis(),o.toMilliseconds(),u)}function Ke(a,o,u){Y.isTimestampOffset(a)&&(a=a.toDateTime()),Y.isTimestampOffset(o)&&(o=o.toDateTime());const t=Tr(a),l=Tr(o);switch(u){case"<>":return t!==l;case"=":return t===l;case">":return t>l;case"<":return t<l;case">=":return t>=l;case"<=":return t<=l}}function Tr(a){return a.year*cl+a.month*fl+a.day*dl+a.hour*pl+a.minute*ml+1e3*a.second+a.millisecond}function Xe(a,o,u){const t=Nr[a.toLowerCase()];if(t==null)throw new m(d.FunctionNotRecognized);if(o.length<t.minParams||o.length>t.maxParams)throw new m(d.InvalidParameterCount,{name:a.toUpperCase()});return t.evaluate(o,u)}function Nl(a,o){const u=Nr[a.toLowerCase()];return u!=null&&o>=u.minParams&&o<=u.maxParams}function et(a){return!q(a)&&!A(a)&&!b(a)&&!P(a)&&!F(a)}function yr(a){return A(a)||P(a)?a.toString():F(a)?a.toSQLValue():b(a)?a.millisecond===0?a.toFormat("yyyy-LL-dd HH:mm:ss"):a.toSQL({includeOffset:!1}):q(a)?yr(J.fromJSDate(a)):a.toString()}function Sl(a){if(q(a))return j.fromDateJS(a);if(b(a))return j.fromParts(a.year,a.month,a.day);if(A(a))return a;if(P(a))throw new m(d.CannotCastValue);if(F(a)&&j.fromParts(a.year,a.month,a.day)===null)throw new m(d.CannotCastValue);if(U(a)){const o=j.fromReader(a);if(o!==null&&o.isValid)return o}throw new m(d.CannotCastValue)}function Ol(a,o,u){if(q(a))return Ae(a,o);if(b(a))return a;if(A(a))return a.toDateTimeLuxon("unknown");if(P(a))throw new m(d.CannotCastValue);if(F(a))return a;if(U(a))return Fe(a,"unknown",u);throw new m(d.CannotCastValue)}function xl(a){if(q(a))return Z.fromDateJS(a);if(b(a))return Z.fromDateTime(a);if(A(a))throw new m(d.CannotCastValue);if(P(a))return a;if(F(a))return Z.fromSqlTimeStampOffset(a);if(U(a))return Be(a);throw new m(d.CannotCastValue)}const Nr={extract:{minParams:2,maxParams:2,evaluate:([a,o])=>{if(o==null)return null;if(q(o))switch(a.toUpperCase()){case"SECOND":return o.getSeconds();case"MINUTE":return o.getMinutes();case"HOUR":return o.getHours();case"DAY":return o.getDate();case"MONTH":return o.getMonth()+1;case"YEAR":return o.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(b(o))switch(a.toUpperCase()){case"SECOND":return o.second;case"MINUTE":return o.minute;case"HOUR":return o.hour;case"DAY":return o.day;case"MONTH":return o.month;case"YEAR":return o.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(A(o))switch(a.toUpperCase()){case"DAY":return o.day;case"MONTH":return o.month;case"YEAR":return o.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(P(o))switch(a.toUpperCase()){case"SECOND":return o.second;case"MINUTE":return o.minute;case"HOUR":return o.hour}else if(F(o))switch(a.toUpperCase()){case"SECOND":return o.second;case"MINUTE":return o.minute;case"HOUR":return o.hour;case"DAY":return o.day;case"MONTH":return o.month;case"YEAR":return o.year;case"TIMEZONE_HOUR":return o.timezoneOffsetHour;case"TIMEZONE_MINUTE":return o.timezoneOffsetMinutes}throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(a.length===2){const[o,u]=a;return o==null||u==null?null:o.toString().substring(u-1)}if(a.length===3){const[o,u,t]=a;return o==null||u==null||t==null?null:t<=0?"":o.toString().substring(u-1,u+t-1)}}},position:{minParams:2,maxParams:2,evaluate:([a,o])=>a==null||o==null?null:o.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:a=>{const o=a.length===3,u=o?a[1]:" ",t=o?a[2]:a[1];if(u==null||t==null)return null;const l=`(${Wi(u)})`;switch(a[0]){case"BOTH":return t.replaceAll(new RegExp(`^${l}*|${l}*$`,"g"),"");case"LEADING":return t.replaceAll(new RegExp(`^${l}*`,"g"),"");case"TRAILING":return t.replaceAll(new RegExp(`${l}*$`,"g"),"")}throw new m(d.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0]>0?1:a[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>a[0]==null||a[1]==null?null:a[0]**a[1]},mod:{minParams:2,maxParams:2,evaluate:a=>a[0]==null||a[1]==null?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const o=a[0],u=a.length===2?10**a[1]:1;return o==null?null:Math.round(o*u)/u}},truncate:{minParams:1,maxParams:2,evaluate:a=>a[0]==null?null:a.length===1||a[1]===0?Math.trunc(a[0]):Ki("trunc",a[0],-Number(a[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>U(a[0])?a[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:a=>{let o="";for(let u=0;u<a.length;u++){if(a[u]==null)return null;o+=a[u].toString()}return o}},lower:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:a=>{for(const o of a)if(o!==null)return o;return null}},cosh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.cosh(a[0])},sinh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.sinh(a[0])},tanh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.tanh(a[0])},nullif:{minParams:2,maxParams:2,evaluate:(a,o)=>z(a[0],a[1],"=")?null:a[0]},cast:{minParams:2,maxParams:2,evaluate:(a,o)=>{const u=a[0],t=a[1];if(u===null)return null;switch(t.type){case"integer":{if(!et(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"smallint":{if(!et(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);if(l>32767||l<-32767)throw new m(d.CannotCastValue);return l}case"float":case"real":{if(!et(u))throw new m(d.CannotCastValue);const l=parseFloat(u);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"time":return xl(u);case"date":return Sl(u);case"timestamp":return Ol(u,o,t.withtimezone===!0);case"varchar":{const l=yr(u);if(l.length>t.size)throw new m(d.CannotCastValue);return l}default:throw new m(d.InvalidDataType)}}}};function Sr(a,o,u,t){if(a==="||")return Xe("concat",[o,u],t);if(o===null||u===null)return null;if(V(o)){if(V(u))return tt(o,u,a);if(K(u))return Pl(o,u,a);if(P(u))return kl();if(A(u))return Hl();if(F(u))return zl();if(b(u))return Vl();if(U(u))return ql(o,u,a);throw new m(d.InvalidOperator)}if(A(o)){if(V(u))return $l(o,u,a);if(K(u))return Ll(o,u,a);if(P(u))return Xl();if(A(u))return Kl(o,u,a);if(F(u))return Wl(o,u,a);if(b(u))return Gl(o,u,a);if(U(u))return dc();throw new m(d.InvalidOperator)}if(P(o)){if(V(u))return Jl(o,u,a);if(K(u))return bl(o,u,a);if(P(u))return uc();if(A(u))return ac();if(F(u))return sc();if(b(u))return oc();if(U(u))return pc();throw new m(d.InvalidOperator)}if(K(o)){if(V(u))return Dl(o,u,a);if(K(u))return Fl(o,u,a);if(P(u))return El(o,u,a);if(A(u))return Ml(o,u,a);if(F(u))return Al(o,u,a);if(b(u))return Cl(o,u,a);if(U(u))return Ql();throw new m(d.InvalidOperator)}if(b(o)){if(V(u))return Ul(o,u,a);if(K(u))return Rl(o,u,a);if(P(u))return fc();if(A(u))return lc(o,u,a);if(F(u))return cc(o,u,a);if(b(u))return ic(o,u,a);if(U(u))return mc();throw new m(d.InvalidOperator)}if(F(o)){if(V(u))return Zl(o,u,a);if(K(u))return _l(o,u,a);if(P(u))return ec();if(A(u))return tc(o,u,a);if(F(u))return nc(o,u,a);if(b(u))return rc(o,u,a);if(U(u))return hc();throw new m(d.InvalidOperator)}if(U(o)){if(V(u))return jl(o,u,a);if(K(u))return Bl();if(P(u))return vc();if(A(u))return wc();if(F(u))return gc();if(b(u))return Ic();if(U(u))return Yl(o,u,a);throw new m(d.InvalidOperator)}throw new m(d.InvalidOperator)}function tt(a,o,u){switch(u){case"+":return a+o;case"-":return a-o;case"*":return a*o;case"/":return a/o}throw new m(d.InvalidOperator)}function Cl(a,o,u){switch(u){case"+":return o.plus({milliseconds:a.valueInMilliseconds()});case"-":return a.valueInMilliseconds()-o.toMillis()}throw new m(d.InvalidOperator)}function El(a,o,u){if(u==="+")return o.plus("milliseconds",a.valueInMilliseconds());throw new m(d.InvalidOperator)}function Ml(a,o,u){if(u==="+")return o.plus("milliseconds",a.valueInMilliseconds());throw new m(d.InvalidOperator)}function bl(a,o,u){switch(u){case"+":return a.plus("milliseconds",o.valueInMilliseconds());case"-":return a.plus("milliseconds",-1*o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Al(a,o,u){if(u==="+")return o.addMilliseconds(a.valueInMilliseconds());throw new m(d.InvalidOperator)}function Fl(a,o,u){switch(u){case"+":return L.createFromMilliseconds(a.valueInMilliseconds()+o.valueInMilliseconds());case"-":return L.createFromMilliseconds(a.valueInMilliseconds()-o.valueInMilliseconds());case"*":return L.createFromMilliseconds(a.valueInMilliseconds()*o.valueInMilliseconds());case"/":return L.createFromMilliseconds(a.valueInMilliseconds()/o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Dl(a,o,u){switch(u){case"+":return L.createFromMilliseconds(a.valueInMilliseconds()+o);case"-":return L.createFromMilliseconds(a.valueInMilliseconds()-o);case"*":return L.createFromMilliseconds(a.valueInMilliseconds()*o);case"/":return L.createFromMilliseconds(a.valueInMilliseconds()/o)}throw new m(d.InvalidOperator)}function Pl(a,o,u){switch(u){case"+":return L.createFromMilliseconds(a+o.valueInMilliseconds());case"-":return L.createFromMilliseconds(a-o.valueInMilliseconds());case"*":return L.createFromMilliseconds(a*o.valueInMilliseconds());case"/":return L.createFromMilliseconds(a/o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Ll(a,o,u){switch(u){case"+":return a.plus("milliseconds",o.valueInMilliseconds());case"-":return a.plus("milliseconds",-1*o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Rl(a,o,u){switch(u){case"+":return a.plus({milliseconds:o.valueInMilliseconds()});case"-":return a.minus({milliseconds:o.valueInMilliseconds()})}throw new m(d.InvalidOperator)}function _l(a,o,u){switch(u){case"+":return a.addMilliseconds(o.valueInMilliseconds());case"-":return a.addMilliseconds(-1*o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Ul(a,o,u){const t=1e3*o*24*60*60;switch(u){case"+":return a.plus({milliseconds:t});case"-":return a.minus({milliseconds:t})}throw new m(d.InvalidOperator)}function $l(a,o,u){const t=1e3*o*24*60*60;switch(u){case"+":return a.plus("milliseconds",t);case"-":return a.plus("milliseconds",-1*t)}throw new m(d.InvalidOperator)}function Jl(a,o,u){const t=1e3*o*24*60*60;switch(u){case"+":return a.plus("milliseconds",t);case"-":return a.plus("milliseconds",-1*t)}throw new m(d.InvalidOperator)}function Vl(a,o,u){throw new m(d.InvalidOperator)}function Zl(a,o,u){const t=1e3*o*24*60*60;switch(u){case"+":return a.addMilliseconds(t);case"-":return a.addMilliseconds(-1*t)}throw new m(d.InvalidOperator)}function zl(a,o,u){throw new m(d.InvalidOperator)}function kl(a,o,u){throw new m(d.InvalidOperator)}function Hl(a,o,u){throw new m(d.InvalidOperator)}function ql(a,o,u){const t=parseFloat(o);if(isNaN(t))throw new m(d.InvalidOperator);return tt(a,t,u)}function jl(a,o,u){const t=parseFloat(a);if(isNaN(t))throw new m(d.InvalidOperator);return tt(t,o,u)}function Yl(a,o,u){if(u==="+")return a+o;throw new m(d.InvalidOperator)}function Ql(a,o,u){throw new m(d.InvalidOperator)}function Bl(a,o,u){throw new m(d.InvalidOperator)}function Gl(a,o,u){if(u==="-")return a.toDateTimeLuxon(o.zone).diff(o).as("days");throw new m(d.InvalidOperator)}function Wl(a,o,u){if(u==="-")return a.toDateTimeLuxon(o.toDateTime().zone).diff(o.toDateTime()).as("days");throw new m(d.InvalidOperator)}function Kl(a,o,u){if(u==="-")return a.toDateTimeLuxon("UTC").diff(o.toDateTimeLuxon("UTC")).as("days");throw new m(d.InvalidOperator)}function Xl(a,o,u){throw new m(d.InvalidOperator)}function ec(a,o,u){throw new m(d.InvalidOperator)}function tc(a,o,u){if(u==="-")return a.toDateTime().diff(o.toDateTimeLuxon(a.toDateTime().zone)).as("days");throw new m(d.InvalidOperator)}function rc(a,o,u){if(u==="-")return a.toDateTime().diff(o).as("days");throw new m(d.InvalidOperator)}function nc(a,o,u){if(u==="-")return a.toDateTime().diff(o.toDateTime()).as("days");throw new m(d.InvalidOperator)}function oc(a,o,u){throw new m(d.InvalidOperator)}function ac(a,o,u){throw new m(d.InvalidOperator)}function sc(a,o,u){throw new m(d.InvalidOperator)}function uc(a,o,u){throw new m(d.InvalidOperator)}function ic(a,o,u){if(u==="-")return a.diff(o).as("days");throw new m(d.InvalidOperator)}function lc(a,o,u){if(u==="-")return a.diff(o.toDateTimeLuxon(a.zone)).as("days");throw new m(d.InvalidOperator)}function cc(a,o,u){if(u==="-")return a.diff(o.toDateTime()).as("days");throw new m(d.InvalidOperator)}function fc(a,o,u){throw new m(d.InvalidOperator)}function dc(a,o,u){throw new m(d.InvalidOperator)}function pc(a,o,u){throw new m(d.InvalidOperator)}function mc(a,o,u){throw new m(d.InvalidOperator)}function hc(a,o,u){throw new m(d.InvalidOperator)}function vc(a,o,u){throw new m(d.InvalidOperator)}function wc(a,o,u){throw new m(d.InvalidOperator)}function Ic(a,o,u){throw new m(d.InvalidOperator)}function gc(a,o,u){throw new m(d.InvalidOperator)}function Tc(a,o){function u(){this.constructor=a}u.prototype=o.prototype,a.prototype=new u}function ae(a,o,u,t){var l=Error.call(this,a);return Object.setPrototypeOf&&Object.setPrototypeOf(l,ae.prototype),l.expected=o,l.found=u,l.location=t,l.name="SyntaxError",l}function rt(a,o,u){return u=u||" ",a.length>o?a:(o-=a.length,a+(u+=u.repeat(o)).slice(0,o))}function yc(a,o){var u,t={},l=(o=o!==void 0?o:{}).grammarSource,h={start:xt},g=xt,y="!",O="=",S=">=",x=">",D="<=",M="<>",X="!=",ee="||",Ar="@",st="'",ut="N'",me="''",Fr=".",Dr="null",Pr="true",Lr="false",Rr="in",_r="is",Ur="like",$r="escape",Jr="not",Vr="and",Zr="or",zr="between",kr="from",Hr="for",qr="substring",jr="extract",Yr="trim",Qr="position",Br="timestamp",Gr="date",Wr="time",Kr="leading",Xr="trailing",en="both",tn="cast",rn="as",nn="integer",on="int",an="smallint",sn="float",un="real",ln="varchar",cn="to",fn="interval",dn="year",pn="timezone_hour",mn="timezone_minute",hn="month",vn="day",wn="hour",In="minute",gn="second",Tn="case",yn="end",Nn="when",Sn="then",On="else",xn=",",Cn="(",En=")",it="`",Mn=/^[<-=]/,he=/^[+\-]/,bn=/^[*\/]/,An=/^[A-Za-z_\x80-\uFFFF]/,Fn=/^[A-Za-z0-9_]/,lt=/^[A-Za-z0-9_.\x80-\uFFFF]/,Dn=/^["]/,ct=/^[^']/,Pn=/^[0-9]/,Ln=/^[eE]/,Rn=/^[ \t\n\r]/,ft=/^[^`]/,_n=T("!",!1),Un=T("=",!1),$n=T(">=",!1),Jn=T(">",!1),Vn=T("<=",!1),Zn=T("<>",!1),zn=k([["<","="]],!1,!1),kn=T("!=",!1),ve=k(["+","-"],!1,!1),Hn=T("||",!1),qn=k(["*","/"],!1,!1),jn=k([["A","Z"],["a","z"],"_",["\x80","\uFFFF"]],!1,!1),Yn=k([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),dt=k([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","\uFFFF"]],!1,!1),Qn=k(['"'],!1,!1),Bn=T("@",!1),pt=T("'",!1),Gn=T("N'",!1),mt=T("''",!1),ht=k(["'"],!0,!1),Wn=T(".",!1),Kn=k([["0","9"]],!1,!1),Xn=k(["e","E"],!1,!1),eo=T("NULL",!0),to=T("TRUE",!0),ro=T("FALSE",!0),no=T("IN",!0),oo=T("IS",!0),ao=T("LIKE",!0),so=T("ESCAPE",!0),uo=T("NOT",!0),io=T("AND",!0),lo=T("OR",!0),co=T("BETWEEN",!0),fo=T("FROM",!0),po=T("FOR",!0),mo=T("SUBSTRING",!0),ho=T("EXTRACT",!0),vo=T("TRIM",!0),wo=T("POSITION",!0),Io=T("TIMESTAMP",!0),go=T("DATE",!0),To=T("TIME",!0),yo=T("LEADING",!0),No=T("TRAILING",!0),So=T("BOTH",!0),Oo=T("CAST",!0),xo=T("AS",!0),Co=T("INTEGER",!0),Eo=T("INT",!0),Mo=T("SMALLINT",!0),bo=T("FLOAT",!0),Ao=T("REAL",!0),Fo=T("VARCHAR",!0),Do=T("TO",!0),Po=T("INTERVAL",!0),Lo=T("YEAR",!0),Ro=T("TIMEZONE_HOUR",!0),_o=T("TIMEZONE_MINUTE",!0),Uo=T("MONTH",!0),$o=T("DAY",!0),Jo=T("HOUR",!0),Vo=T("MINUTE",!0),Zo=T("SECOND",!0),zo=T("CASE",!0),ko=T("END",!0),Ho=T("WHEN",!0),qo=T("THEN",!0),jo=T("ELSE",!0),Yo=T(",",!1),Qo=T("(",!1),Bo=T(")",!1),Go=k([" ","	",`
`,"\r"],!1,!1),vt=T("`",!1),wt=k(["`"],!0,!1),Wo=function(e){return e},Ko=function(e){return{type:"expression-list",location:I(),value:e}},It=function(e,r,s){return{op:r,expr:s,location:I()}},Xo=function(e,r){return fe(e,r)},gt=function(e,r,s){return{op:r,expr:s,location:I()}},ea=function(e,r){return fe(e,r)},ta=function(e){return qi("NOT",e,I())},ra=function(e,r){return r==""||r==null||r==null?e:r.type=="arithmetic"?fe(e,r.tail):sr(r.op,e,r.right,r.escape,I())},Tt=function(e,r){return{op:e,expr:r,location:I()}},na=function(e){return{type:"arithmetic",tail:e}},oa=function(e,r){return{op:e+"NOT",right:r}},aa=function(e,r){return{op:e,right:r}},sa=function(e,r,s){return H(I(),r,s)},ua=function(e,r){return{op:"NOT"+e,right:r}},ia=function(e,r,s){return H(I(),r,s)},la=function(e,r){return{op:e,right:r}},ca=function(e){return e[0]+" "+e[2]},fa=function(e){return e[0]+" "+e[2]},da=function(e,r,s){return{op:e,right:r,escape:s.value}},pa=function(e,r){return{op:e,right:r,escape:""}},ma=function(e,r){return{op:e,right:r}},ha=function(e,r){return{op:e,right:r}},yt=function(e,r,s){return{op:r,expr:s,location:I()}},va=function(e,r){return fe(e,r)},Nt=function(e,r,s){return{op:r,expr:s,location:I()}},wa=function(e,r){return fe(e,r)},Ia=function(e){return e.paren=!0,e},ga=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current-time",location:I(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current-time",location:I(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(e)?{type:"current-time",location:I(),mode:"time"}:/^CURRENT_USER$/i.test(e)?{type:"current-user",location:I()}:{type:"column-reference",location:I(),table:"",column:e}},Ta=function(e){return{type:"column-reference",location:I(),table:"",column:e,delimited:!0}},ya=function(e){return e},Na=function(e,r){return e+r.join("")},Sa=function(e,r){return e+r.join("")},Oa=function(e){return e},xa=function(e){return e.join("")},Ca=function(){return'"'},Ea=function(e){return{type:"parameter",location:I(),value:e[1]}},Ma=function(e,r){return H(I(),e,r)},ba=function(e,r){return H(I(),e,r)},Aa=function(e){return{type:"function",location:I(),name:"extract",args:e}},Fa=function(e,r,s){return H(I(),e,r,...s?[s]:[])},Da=function(e,r,s){return H(I(),e,r,s)},Pa=function(e){return{type:"function",location:I(),name:"substring",args:e}},La=function(e,r){return H(I(),e,r)},Ra=function(e,r){return H(I(),e,r)},_a=function(e){return{type:"function",location:I(),name:"cast",args:e}},Ua=function(){return{type:"data-type",location:I(),value:{type:"integer"}}},$a=function(){return{type:"data-type",location:I(),value:{type:"smallint"}}},Ja=function(){return{type:"data-type",location:I(),value:{type:"float"}}},Va=function(){return{type:"data-type",location:I(),value:{type:"real"}}},Za=function(){return{type:"data-type",location:I(),value:{type:"date"}}},za=function(){return{type:"data-type",location:I(),value:{type:"timestamp"}}},ka=function(){return{type:"data-type",location:I(),value:{type:"time"}}},Ha=function(e){return{type:"data-type",location:I(),value:{type:"varchar",size:parseInt(e)}}},qa=function(e,r,s){return H(I(),e,r,s)},ja=function(e,r){return H(I(),e,r)},Ya=function(e){return{type:"function",location:I(),name:"trim",args:e}},Qa=function(e){return{type:"string",location:I(),value:e??"BOTH"}},Ba=function(e,r){return H(I(),e,r)},Ga=function(e,r){return H(I(),e,r)},Wa=function(e){return{type:"function",location:I(),name:"position",args:e}},Ka=function(e,r){return{type:"function",location:I(),name:e,args:r}},Xa=function(e){return{type:"string",location:I(),value:e}},es=function(e){return e.type==="string"&&ji(e.value),{type:"timestamp",location:I(),value:e.value}},ts=function(e){return e.type==="string"&&Yi(e.value),{type:"time",location:I(),value:e.value}},rs=function(e,r,s){return{type:"interval",location:I(),value:r,qualifier:s,op:e}},ns=function(e,r){return{type:"interval",location:I(),value:e,qualifier:r,op:""}},os=function(e,r){return{type:"interval-qualifier",location:I(),start:e,end:r}},as=function(e,r){return{type:"interval-period",location:I(),period:e.value,precision:r,secondary:null}},ss=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},us=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},is=function(e,r){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:r}},ls=function(e){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:null}},cs=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},fs=function(e,r){return{type:"interval-period",location:I(),period:e.value,precision:r,secondary:null}},ds=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},ps=function(e,r){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:r}},ms=function(e){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:null}},hs=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},vs=function(){return{type:"string",location:I(),value:"day"}},ws=function(){return{type:"string",location:I(),value:"hour"}},Is=function(){return{type:"string",location:I(),value:"minute"}},gs=function(){return{type:"string",location:I(),value:"month"}},Ts=function(){return{type:"string",location:I(),value:"year"}},ys=function(e){return parseFloat(e)},Ns=function(e){return parseFloat(e)},Ss=function(e){return e.type==="string"&&Qi(e.value),{type:"date",location:I(),value:e.value}},Os=function(){return{type:"null",location:I(),value:null}},xs=function(){return{type:"boolean",location:I(),value:!0}},Cs=function(){return{type:"boolean",location:I(),value:!1}},St=function(){return"'"},Es=function(e){return{type:"string",location:I(),value:e.join("")}},Ms=function(e,r){return{type:"case-expression",location:I(),format:"simple",operand:e,clauses:r,else:null,elseLocation:null}},bs=function(e,r,s){return{type:"case-expression",location:I(),format:"simple",operand:e,clauses:r,else:s.value,elseLocation:s.location}},As=function(e){return{type:"case-expression",location:I(),format:"searched",clauses:e,else:null,elseLocation:null}},Fs=function(e,r){return{type:"case-expression",location:I(),format:"searched",clauses:e,else:r.value,elseLocation:r.location}},Ds=function(e,r){return{type:"when-clause",location:I(),operand:e,value:r}},Ps=function(e,r){return{type:"when-clause",location:I(),operand:e,value:r}},Ls=function(e){return{type:"else-clause",location:I(),value:e}},Rs=function(e){return{type:"number",location:I(),value:e}},_s=function(e,r,s){return parseFloat(e+r+s)},Us=function(e,r){return parseFloat(e+r)},$s=function(e,r){return parseFloat(e+r)},Js=function(e){return parseFloat(e)},Vs=function(e,r){return e[0]+r},Zs=function(e){return"."+(e??"")},zs=function(e,r){return e+r},ks=function(e){return e.join("")},Hs=function(e,r){return"e"+(r===null?"":r)},qs=function(){return"IN"},js=function(){return"IS"},Ys=function(){return"LIKE"},Qs=function(){return"ESCAPE"},Bs=function(){return"NOT"},Gs=function(){return"AND"},Ws=function(){return"OR"},Ks=function(){return"BETWEEN"},Xs=function(){return"FROM"},eu=function(){return"FOR"},tu=function(){return"SUBSTRING"},ru=function(){return"EXTRACT"},nu=function(){return"TRIM"},ou=function(){return"POSITION"},au=function(){return"TIMESTAMP"},su=function(){return"DATE"},uu=function(){return"TIME"},iu=function(){return"LEADING"},lu=function(){return"TRAILING"},cu=function(){return"BOTH"},fu=function(){return"CAST"},du=function(){return"AS"},pu=function(){return"INTEGER"},mu=function(){return"INT"},hu=function(){return"SMALLINT"},vu=function(){return"FLOAT"},wu=function(){return"REAL"},Iu=function(){return"VARCHAR"},gu=function(){return"TO"},Tu=function(){return"INTERVAL"},yu=function(){return"YEAR"},Nu=function(){return"TIMEZONE_HOUR"},Su=function(){return"TIMEZONE_MINUTE"},Ou=function(){return"MONTH"},xu=function(){return"DAY"},Cu=function(){return"HOUR"},Eu=function(){return"MINUTE"},Mu=function(){return"SECOND"},bu=function(){return"CASE"},Au=function(){return"END"},Fu=function(){return"WHEN"},Du=function(){return"THEN"},Pu=function(){return"ELSE"},Lu=function(e){return e},Ru=function(e){return e.join("")},n=0|o.peg$currPos,f=n,ue=[{line:1,column:1}],Q=n,we=o.peg$maxFailExpected||[],c=0|o.peg$silentFails;if(o.startRule){if(!(o.startRule in h))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');g=h[o.startRule]}function I(){return Ie(f,n)}function _e(e,r){throw Uu(e,r=r!==void 0?r:Ie(f,n))}function T(e,r){return{type:"literal",text:e,ignoreCase:r}}function k(e,r,s){return{type:"class",parts:e,inverted:r,ignoreCase:s}}function _u(){return{type:"end"}}function Ot(e){var r,s=ue[e];if(s)return s;if(e>=ue.length)r=ue.length-1;else for(r=e;!ue[--r];);for(s={line:(s=ue[r]).line,column:s.column};r<e;)a.charCodeAt(r)===10?(s.line++,s.column=1):s.column++,r++;return ue[e]=s,s}function Ie(e,r,s){var i=Ot(e),v=Ot(r);return{source:l,start:{offset:e,line:i.line,column:i.column},end:{offset:r,line:v.line,column:v.column}}}function w(e){n<Q||(n>Q&&(Q=n,we=[]),we.push(e))}function Uu(e,r){return new ae(e,null,null,r)}function $u(e,r,s){return new ae(ae.buildMessage(e,r),e,r,s)}function xt(){var e,r;return e=n,p(),(r=E())!==t?(p(),f=e,e=Wo(r)):(n=e,e=t),e}function Ct(){var e,r,s,i,v,C;if(e=n,R()!==t){for(p(),r=[],s=E();s!==t;)r.push(s),s=n,i=n,v=p(),(C=W())!==t?i=v=[v,C,p()]:(n=i,i=t),i!==t&&(i=E())===t?(n=s,s=t):s=i;s=p(),(i=_())!==t?(f=e,e=Ko(r)):(n=e,e=t)}else n=e,e=t;return e}function E(){var e,r,s,i,v,C;if(e=n,(r=Ue())!==t){for(s=[],i=n,p(),(v=qt())!==t?(p(),(C=Ue())!==t?(f=i,i=It(r,v,C)):(n=i,i=t)):(n=i,i=t);i!==t;)s.push(i),i=n,p(),(v=qt())!==t?(p(),(C=Ue())!==t?(f=i,i=It(r,v,C)):(n=i,i=t)):(n=i,i=t);f=e,e=Xo(r,s)}else n=e,e=t;return e}function Ue(){var e,r,s,i,v,C;if(e=n,(r=ge())!==t){for(s=[],i=n,p(),(v=Ce())!==t?(p(),(C=ge())!==t?(f=i,i=gt(r,v,C)):(n=i,i=t)):(n=i,i=t);i!==t;)s.push(i),i=n,p(),(v=Ce())!==t?(p(),(C=ge())!==t?(f=i,i=gt(r,v,C)):(n=i,i=t)):(n=i,i=t);f=e,e=ea(r,s)}else n=e,e=t;return e}function ge(){var e,r,s,i,v;return e=n,(r=ce())===t&&(r=n,a.charCodeAt(n)===33?(s=y,n++):(s=t,c===0&&w(_n)),s!==t?(i=n,c++,a.charCodeAt(n)===61?(v=O,n++):(v=t,c===0&&w(Un)),c--,v===t?i=void 0:(n=i,i=t),i!==t?r=s=[s,i]:(n=r,r=t)):(n=r,r=t)),r!==t?(s=p(),(i=ge())!==t?(f=e,e=ta(i)):(n=e,e=t)):(n=e,e=t),e===t&&(e=Ju()),e}function Ju(){var e,r,s,i;return e=n,(r=G())!==t?(s=n,p(),(i=Vu())!==t?s=i:(n=s,s=t),s===t&&(s=null),f=e,e=ra(r,s)):(n=e,e=t),e}function Vu(){var e;return(e=Zu())===t&&(e=qu())===t&&(e=ku())===t&&(e=zu())===t&&(e=Hu()),e}function Zu(){var e,r,s,i,v;if(e=n,r=[],s=n,p(),(i=Et())!==t?(p(),(v=G())!==t?(f=s,s=Tt(i,v)):(n=s,s=t)):(n=s,s=t),s!==t)for(;s!==t;)r.push(s),s=n,p(),(i=Et())!==t?(p(),(v=G())!==t?(f=s,s=Tt(i,v)):(n=s,s=t)):(n=s,s=t);else r=t;return r!==t&&(f=e,r=na(r)),e=r}function Et(){var e;return a.substr(n,2)===S?(e=S,n+=2):(e=t,c===0&&w($n)),e===t&&(a.charCodeAt(n)===62?(e=x,n++):(e=t,c===0&&w(Jn)),e===t&&(a.substr(n,2)===D?(e=D,n+=2):(e=t,c===0&&w(Vn)),e===t&&(a.substr(n,2)===M?(e=M,n+=2):(e=t,c===0&&w(Zn)),e===t&&(e=a.charAt(n),Mn.test(e)?n++:(e=t,c===0&&w(zn)),e===t&&(a.substr(n,2)===X?(e=X,n+=2):(e=t,c===0&&w(kn))))))),e}function zu(){var e,r,s,i;return e=n,(r=kt())!==t?(p(),(s=ce())!==t?(p(),(i=G())!==t?(f=e,e=oa(r,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=kt())!==t?(p(),(s=G())!==t?(f=e,e=aa(r,s)):(n=e,e=t)):(n=e,e=t)),e}function ku(){var e,r,s,i,v,C,oe,ur;return e=n,(r=ce())!==t?(p(),(s=jt())!==t?(i=p(),v=n,(C=G())!==t?(p(),(oe=Ce())!==t?(p(),(ur=G())!==t?(f=v,v=sa(s,C,ur)):(n=v,v=t)):(n=v,v=t)):(n=v,v=t),v!==t?(f=e,e=ua(s,v)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=jt())!==t?(p(),s=n,(i=G())!==t?(v=p(),(C=Ce())!==t?(p(),(oe=G())!==t?(f=s,s=ia(r,i,oe)):(n=s,s=t)):(n=s,s=t)):(n=s,s=t),s!==t?(f=e,e=la(r,s)):(n=e,e=t)):(n=e,e=t)),e}function Mt(){var e,r,s,i,v;return e=n,r=n,(s=ce())!==t?(i=p(),(v=Ht())!==t?r=s=[s,i,v]:(n=r,r=t)):(n=r,r=t),r!==t&&(f=e,r=ca(r)),(e=r)===t&&(e=Ht()),e}function bt(){var e,r,s,i,v;return e=n,r=n,(s=ce())!==t?(i=p(),(v=ke())!==t?r=s=[s,i,v]:(n=r,r=t)):(n=r,r=t),r!==t&&(f=e,r=fa(r)),(e=r)===t&&(e=ke()),e}function Hu(){var e,r,s,i;return e=n,(r=Mt())!==t?(p(),(s=te())!==t?(p(),Oi()!==t?(p(),(i=ze())!==t?(f=e,e=da(r,s,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Mt())!==t?(p(),(s=te())!==t?(f=e,e=pa(r,s)):(n=e,e=t)):(n=e,e=t)),e}function qu(){var e,r,s;return e=n,(r=bt())!==t?(p(),(s=Ct())!==t?(f=e,e=ma(r,s)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=bt())!==t?(p(),(s=Ze())!==t?(f=e,e=ha(r,s)):(n=e,e=t)):(n=e,e=t)),e}function G(){var e,r,s,i,v,C;if(e=n,(r=$e())!==t){for(s=[],i=n,p(),(v=At())!==t?(p(),(C=$e())!==t?(f=i,i=yt(r,v,C)):(n=i,i=t)):(n=i,i=t);i!==t;)s.push(i),i=n,p(),(v=At())!==t?(p(),(C=$e())!==t?(f=i,i=yt(r,v,C)):(n=i,i=t)):(n=i,i=t);f=e,e=va(r,s)}else n=e,e=t;return e}function At(){var e;return e=a.charAt(n),he.test(e)?n++:(e=t,c===0&&w(ve)),e===t&&(a.substr(n,2)===ee?(e=ee,n+=2):(e=t,c===0&&w(Hn))),e}function $e(){var e,r,s,i,v,C;if(e=n,(r=Je())!==t){for(s=[],i=n,p(),(v=Ft())!==t?(p(),(C=Je())!==t?(f=i,i=Nt(r,v,C)):(n=i,i=t)):(n=i,i=t);i!==t;)s.push(i),i=n,p(),(v=Ft())!==t?(p(),(C=Je())!==t?(f=i,i=Nt(r,v,C)):(n=i,i=t)):(n=i,i=t);f=e,e=wa(r,s)}else n=e,e=t;return e}function Ft(){var e;return e=a.charAt(n),bn.test(e)?n++:(e=t,c===0&&w(qn)),e}function Je(){var e,r;return(e=ai())===t&&(e=Xu())===t&&(e=ei())===t&&(e=ri())===t&&(e=ni())===t&&(e=ti())===t&&(e=oi())===t&&(e=hi())===t&&(e=ju())===t&&(e=Ze())===t&&(e=n,R()!==t?(p(),(r=E())!==t?(p(),_()!==t?(f=e,e=Ia(r)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function ju(){var e,r;return e=n,(r=Yu())!==t&&(f=e,r=ga(r)),(e=r)===t&&(e=n,(r=Bu())!==t&&(f=e,r=Ta(r)),e=r),e}function Yu(){var e,r;return e=n,(r=Qu())!==t&&(f=e,r=ya(r)),e=r}function Qu(){var e,r,s,i;if(e=n,(r=Ve())!==t){for(s=[],i=Pt();i!==t;)s.push(i),i=Pt();f=e,e=Na(r,s)}else n=e,e=t;return e}function Dt(){var e,r,s,i;if(e=n,(r=Ve())!==t){for(s=[],i=N();i!==t;)s.push(i),i=N();f=e,e=Sa(r,s)}else n=e,e=t;return e}function Ve(){var e;return e=a.charAt(n),An.test(e)?n++:(e=t,c===0&&w(jn)),e}function N(){var e;return e=a.charAt(n),Fn.test(e)?n++:(e=t,c===0&&w(Yn)),e}function Pt(){var e;return e=a.charAt(n),lt.test(e)?n++:(e=t,c===0&&w(dt)),e}function Bu(){var e,r;return e=n,Te()!==t?(r=Gu(),Te()!==t?(f=e,e=Oa(r)):(n=e,e=t)):(n=e,e=t),e}function Gu(){var e,r,s;for(e=n,r=[],s=Lt();s!==t;)r.push(s),s=Lt();return f=e,e=r=xa(r)}function Lt(){var e;return(e=Ku())===t&&(e=Wu()),e}function Wu(){var e;return e=n,Te()!==t&&Te()!==t?(f=e,e=Ca()):(n=e,e=t),e}function Ku(){var e;return e=a.charAt(n),lt.test(e)?n++:(e=t,c===0&&w(dt)),e}function Te(){var e;return e=a.charAt(n),Dn.test(e)?n++:(e=t,c===0&&w(Qn)),e}function Ze(){var e,r,s,i;return e=n,r=n,a.charCodeAt(n)===64?(s=Ar,n++):(s=t,c===0&&w(Bn)),s!==t&&(i=Dt())!==t?r=s=[s,i]:(n=r,r=t),r!==t&&(f=e,r=Ea(r)),e=r}function Xu(){var e,r,s,i;return e=n,Yt()!==t?(p(),r=n,R()!==t?(p(),(s=Ut())!==t?(p(),He()!==t?(p(),(i=E())!==t?(p(),_()!==t?(f=r,r=Ma(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=Ut())!==t?(p(),W()!==t?(p(),(i=E())!==t?(p(),_()!==t?(f=r,r=ba(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Aa(r)):(n=e,e=t)):(n=e,e=t),e}function ei(){var e,r,s,i,v,C,oe;return e=n,Ci()!==t?(p(),r=n,R()!==t?(p(),(s=E())!==t?(p(),He()!==t?(p(),(i=E())!==t?(p(),v=n,xi()!==t?(C=p(),(oe=E())!==t?(p(),v=oe):(n=v,v=t)):(n=v,v=t),v===t&&(v=null),_()!==t?(f=r,r=Fa(s,i,v)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=E())!==t?(p(),W()!==t?(p(),(i=E())!==t?(p(),(v=W())!==t?(p(),(C=E())!==t&&(oe=_())!==t?(f=r,r=Da(s,i,C)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Pa(r)):(n=e,e=t)):(n=e,e=t),e}function ti(){var e,r,s,i;return e=n,Di()!==t?(p(),r=n,R()!==t?(p(),(s=E())!==t?(p(),Pi()!==t?(p(),(i=Rt())!==t?(p(),_()!==t?(f=r,r=La(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=E())!==t?(p(),W()!==t?(p(),(i=Rt())!==t?(p(),_()!==t?(f=r,r=Ra(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=_a(r)):(n=e,e=t)):(n=e,e=t),e}function Rt(){var e,r,s;return e=n,(r=Li())===t&&(r=Ri()),r!==t&&(f=e,r=Ua()),(e=r)===t&&(e=n,(r=_i())!==t&&(f=e,r=$a()),(e=r)===t&&(e=n,(r=Ui())!==t&&(f=e,r=Ja()),(e=r)===t&&(e=n,(r=$i())!==t&&(f=e,r=Va()),(e=r)===t&&(e=n,(r=Bt())!==t&&(f=e,r=Za()),(e=r)===t&&(e=n,(r=Qt())!==t&&(f=e,r=za()),(e=r)===t&&(e=n,(r=Gt())!==t&&(f=e,r=ka()),(e=r)===t&&(e=n,(r=Ji())!==t?(p(),R()!==t?(p(),(s=re())!==t?(p(),_()!==t?(f=e,e=Ha(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)))))))),e}function ri(){var e,r,s,i,v;return e=n,Ei()!==t?(p(),r=n,R()!==t?(p(),s=_t(),p(),(i=E())!==t?(p(),He()!==t?(p(),(v=E())!==t?(p(),_()!==t?(f=r,r=qa(s,i,v)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),s=_t(),p(),(i=E())!==t?(p(),_()!==t?(f=r,r=ja(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Ya(r)):(n=e,e=t)):(n=e,e=t),e}function _t(){var e,r;return e=n,(r=bi())===t&&(r=Ai())===t&&(r=Fi()),r===t&&(r=null),f=e,e=r=Qa(r)}function ni(){var e,r,s,i;return e=n,Mi()!==t?(p(),r=n,R()!==t?(p(),(s=E())!==t?(p(),ke()!==t?(p(),(i=E())!==t?(p(),_()!==t?(f=r,r=Ba(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=E())!==t?(p(),W()!==t?(p(),(i=E())!==t?(p(),_()!==t?(f=r,r=Ga(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Wa(r)):(n=e,e=t)):(n=e,e=t),e}function oi(){var e,r,s,i;return e=n,r=n,c++,s=Yt(),c--,s===t?r=void 0:(n=r,r=t),r!==t&&(s=Hi())!==t?(p(),(i=Ct())!==t?(f=e,e=Ka(s,i)):(n=e,e=t)):(n=e,e=t),e}function Ut(){var e,r;return e=n,(r=Kt())===t&&(r=Xt())===t&&(r=er())===t&&(r=tr())===t&&(r=rr())===t&&(r=ne())===t&&(r=Zi())===t&&(r=zi()),r!==t&&(f=e,r=Xa(r)),e=r}function ai(){var e;return(e=ze())===t&&(e=Ii())===t&&(e=mi())===t&&(e=pi())===t&&(e=di())===t&&(e=si())===t&&(e=ii())===t&&(e=ui()),e}function si(){var e,r;return e=n,Qt()!==t?(p(),(r=te())!==t?(f=e,e=es(r)):(n=e,e=t)):(n=e,e=t),e}function ui(){var e,r;return e=n,Gt()!==t?(p(),(r=te())!==t?(f=e,e=ts(r)):(n=e,e=t)):(n=e,e=t),e}function ii(){var e,r,s,i;return e=n,Wt()!==t?(p(),r=a.charAt(n),he.test(r)?n++:(r=t,c===0&&w(ve)),r!==t?(p(),(s=te())!==t?(p(),(i=$t())!==t?(f=e,e=rs(r,s,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Wt()!==t?(p(),(r=te())!==t?(p(),(s=$t())!==t?(f=e,e=ns(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function $t(){var e,r,s;return e=n,(r=li())!==t?(p(),Vi()!==t?(p(),(s=ci())!==t?(f=e,e=os(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=fi()),e}function li(){var e,r,s;return e=n,(r=le())!==t?(p(),R()!==t?(p(),(s=Ne())!==t?(p(),_()!==t?(f=e,e=as(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=le())!==t&&(f=e,r=ss(r)),e=r),e}function ci(){var e,r,s,i;return e=n,(r=le())!==t&&(f=e,r=us(r)),(e=r)===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Ne())!==t?(p(),W()!==t?(p(),(i=ye())!==t?(p(),_()!==t?(f=e,e=is(s,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Ne())!==t?(p(),_()!==t?(f=e,e=ls(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t&&(f=e,r=cs()),e=r))),e}function fi(){var e,r,s,i;return e=n,(r=le())!==t?(p(),R()!==t?(p(),(s=ye())!==t?(p(),_()!==t?(f=e,e=fs(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=le())!==t&&(f=e,r=ds(r)),(e=r)===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Ne())!==t?(p(),W()!==t?(p(),(i=ye())!==t?(p(),_()!==t?(f=e,e=ps(s,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=ye())!==t?(p(),_()!==t?(f=e,e=ms(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t&&(f=e,r=hs()),e=r)))),e}function le(){var e,r;return e=n,(r=er())!==t&&(f=e,r=vs()),(e=r)===t&&(e=n,(r=tr())!==t&&(f=e,r=ws()),(e=r)===t&&(e=n,(r=rr())!==t&&(f=e,r=Is()),(e=r)===t&&(e=n,(r=Xt())!==t&&(f=e,r=gs()),(e=r)===t&&(e=n,(r=Kt())!==t&&(f=e,r=Ts()),e=r)))),e}function ye(){var e,r;return e=n,(r=re())!==t&&(f=e,r=ys(r)),e=r}function Ne(){var e,r;return e=n,(r=re())!==t&&(f=e,r=Ns(r)),e=r}function di(){var e,r;return e=n,Bt()!==t?(p(),(r=te())!==t?(f=e,e=Ss(r)):(n=e,e=t)):(n=e,e=t),e}function pi(){var e,r;return e=n,(r=yi())!==t&&(f=e,r=Os()),e=r}function mi(){var e,r;return e=n,(r=Ni())!==t&&(f=e,r=xs()),(e=r)===t&&(e=n,(r=Si())!==t&&(f=e,r=Cs()),e=r),e}function te(){var e;return(e=ze())===t&&(e=Ze()),e}function ze(){var e,r,s,i,v;if(e=n,a.charCodeAt(n)===39?(r=st,n++):(r=t,c===0&&w(pt)),r===t&&(a.substr(n,2)===ut?(r=ut,n+=2):(r=t,c===0&&w(Gn))),r!==t){for(s=[],i=n,a.substr(n,2)===me?(v=me,n+=2):(v=t,c===0&&w(mt)),v!==t&&(f=i,v=St()),(i=v)===t&&(i=a.charAt(n),ct.test(i)?n++:(i=t,c===0&&w(ht)));i!==t;)s.push(i),i=n,a.substr(n,2)===me?(v=me,n+=2):(v=t,c===0&&w(mt)),v!==t&&(f=i,v=St()),(i=v)===t&&(i=a.charAt(n),ct.test(i)?n++:(i=t,c===0&&w(ht)));a.charCodeAt(n)===39?(i=st,n++):(i=t,c===0&&w(pt)),i!==t?(f=e,e=Es(s)):(n=e,e=t)}else n=e,e=t;return e}function hi(){var e;return(e=vi())===t&&(e=wi()),e}function vi(){var e,r,s,i,v;if(e=n,Ee()!==t)if(p(),(r=E())!==t){for(p(),s=[],i=n,(v=Oe())!==t?(p(),i=v):(n=i,i=t);i!==t;)s.push(i),i=n,(v=Oe())!==t?(p(),i=v):(n=i,i=t);(i=Me())!==t?(f=e,e=Ms(r,s)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,Ee()!==t)if(p(),(r=E())!==t){for(p(),s=[],i=n,(v=Oe())!==t?(p(),i=v):(n=i,i=t);i!==t;)s.push(i),i=n,(v=Oe())!==t?(p(),i=v):(n=i,i=t);(i=Jt())!==t?(v=p(),Me()!==t?(f=e,e=bs(r,s,i)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;return e}function wi(){var e,r,s,i;if(e=n,Ee()!==t){for(p(),r=[],s=n,(i=Se())!==t?(p(),s=i):(n=s,s=t);s!==t;)r.push(s),s=n,(i=Se())!==t?(p(),s=i):(n=s,s=t);(s=Me())!==t?(f=e,e=As(r)):(n=e,e=t)}else n=e,e=t;if(e===t)if(e=n,Ee()!==t){for(p(),r=[],s=n,(i=Se())!==t?(p(),s=i):(n=s,s=t);s!==t;)r.push(s),s=n,(i=Se())!==t?(p(),s=i):(n=s,s=t);(s=Jt())!==t?(i=p(),Me()!==t?(f=e,e=Fs(r,s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function Se(){var e,r,s;return e=n,nr()!==t?(p(),(r=E())!==t?(p(),or()!==t?(p(),(s=E())!==t?(f=e,e=Ds(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Oe(){var e,r,s;return e=n,nr()!==t?(p(),(r=E())!==t?(p(),or()!==t?(p(),(s=E())!==t?(f=e,e=Ps(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Jt(){var e,r;return e=n,ki()!==t?(p(),(r=E())!==t?(f=e,e=Ls(r)):(n=e,e=t)):(n=e,e=t),e}function Ii(){var e,r,s,i;return e=n,(r=gi())!==t?(s=n,c++,i=Ve(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Rs(r)):(n=e,e=t)):(n=e,e=t),e}function gi(){var e,r,s,i;return e=n,(r=xe())!==t&&(s=Vt())!==t&&(i=Zt())!==t?(f=e,e=_s(r,s,i)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(s=Vt())!==t?(f=e,e=Us(r,s)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(s=Zt())!==t?(f=e,e=$s(r,s)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(f=e,r=Js(r)),e=r))),e}function xe(){var e,r,s;return(e=re())===t&&(e=n,r=a.charAt(n),he.test(r)?n++:(r=t,c===0&&w(ve)),r!==t&&(s=re())!==t?(f=e,e=Vs(r,s)):(n=e,e=t)),e}function Vt(){var e,r,s;return e=n,a.charCodeAt(n)===46?(r=Fr,n++):(r=t,c===0&&w(Wn)),r!==t?((s=re())===t&&(s=null),f=e,e=Zs(s)):(n=e,e=t),e}function Zt(){var e,r,s;return e=n,(r=Ti())!==t&&(s=re())!==t?(f=e,e=zs(r,s)):(n=e,e=t),e}function re(){var e,r,s;if(e=n,r=[],(s=zt())!==t)for(;s!==t;)r.push(s),s=zt();else r=t;return r!==t&&(f=e,r=ks(r)),e=r}function zt(){var e;return e=a.charAt(n),Pn.test(e)?n++:(e=t,c===0&&w(Kn)),e}function Ti(){var e,r,s;return e=n,r=a.charAt(n),Ln.test(r)?n++:(r=t,c===0&&w(Xn)),r!==t?(s=a.charAt(n),he.test(s)?n++:(s=t,c===0&&w(ve)),s===t&&(s=null),f=e,e=Hs(r,s)):(n=e,e=t),e}function yi(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Dr?n+=4:(r=t,c===0&&w(eo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function Ni(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Pr?n+=4:(r=t,c===0&&w(to)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function Si(){var e,r,s,i;return e=n,(r=a.substr(n,5)).toLowerCase()===Lr?n+=5:(r=t,c===0&&w(ro)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function ke(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===Rr?n+=2:(r=t,c===0&&w(no)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=qs()):(n=e,e=t)):(n=e,e=t),e}function kt(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===_r?n+=2:(r=t,c===0&&w(oo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=js()):(n=e,e=t)):(n=e,e=t),e}function Ht(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Ur?n+=4:(r=t,c===0&&w(ao)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ys()):(n=e,e=t)):(n=e,e=t),e}function Oi(){var e,r,s,i;return e=n,(r=a.substr(n,6)).toLowerCase()===$r?n+=6:(r=t,c===0&&w(so)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Qs()):(n=e,e=t)):(n=e,e=t),e}function ce(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===Jr?n+=3:(r=t,c===0&&w(uo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Bs()):(n=e,e=t)):(n=e,e=t),e}function Ce(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===Vr?n+=3:(r=t,c===0&&w(io)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Gs()):(n=e,e=t)):(n=e,e=t),e}function qt(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===Zr?n+=2:(r=t,c===0&&w(lo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ws()):(n=e,e=t)):(n=e,e=t),e}function jt(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===zr?n+=7:(r=t,c===0&&w(co)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ks()):(n=e,e=t)):(n=e,e=t),e}function He(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===kr?n+=4:(r=t,c===0&&w(fo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Xs()):(n=e,e=t)):(n=e,e=t),e}function xi(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===Hr?n+=3:(r=t,c===0&&w(po)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=eu()):(n=e,e=t)):(n=e,e=t),e}function Ci(){var e,r,s,i;return e=n,(r=a.substr(n,9)).toLowerCase()===qr?n+=9:(r=t,c===0&&w(mo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=tu()):(n=e,e=t)):(n=e,e=t),e}function Yt(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===jr?n+=7:(r=t,c===0&&w(ho)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=ru()):(n=e,e=t)):(n=e,e=t),e}function Ei(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Yr?n+=4:(r=t,c===0&&w(vo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=nu()):(n=e,e=t)):(n=e,e=t),e}function Mi(){var e,r,s,i;return e=n,(r=a.substr(n,8)).toLowerCase()===Qr?n+=8:(r=t,c===0&&w(wo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=ou()):(n=e,e=t)):(n=e,e=t),e}function Qt(){var e,r,s,i;return e=n,(r=a.substr(n,9)).toLowerCase()===Br?n+=9:(r=t,c===0&&w(Io)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=au()):(n=e,e=t)):(n=e,e=t),e}function Bt(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Gr?n+=4:(r=t,c===0&&w(go)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=su()):(n=e,e=t)):(n=e,e=t),e}function Gt(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Wr?n+=4:(r=t,c===0&&w(To)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=uu()):(n=e,e=t)):(n=e,e=t),e}function bi(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===Kr?n+=7:(r=t,c===0&&w(yo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=iu()):(n=e,e=t)):(n=e,e=t),e}function Ai(){var e,r,s,i;return e=n,(r=a.substr(n,8)).toLowerCase()===Xr?n+=8:(r=t,c===0&&w(No)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=lu()):(n=e,e=t)):(n=e,e=t),e}function Fi(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===en?n+=4:(r=t,c===0&&w(So)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=cu()):(n=e,e=t)):(n=e,e=t),e}function Di(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===tn?n+=4:(r=t,c===0&&w(Oo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=fu()):(n=e,e=t)):(n=e,e=t),e}function Pi(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===rn?n+=2:(r=t,c===0&&w(xo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=du()):(n=e,e=t)):(n=e,e=t),e}function Li(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===nn?n+=7:(r=t,c===0&&w(Co)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=pu()):(n=e,e=t)):(n=e,e=t),e}function Ri(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===on?n+=3:(r=t,c===0&&w(Eo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=mu()):(n=e,e=t)):(n=e,e=t),e}function _i(){var e,r,s,i;return e=n,(r=a.substr(n,8)).toLowerCase()===an?n+=8:(r=t,c===0&&w(Mo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=hu()):(n=e,e=t)):(n=e,e=t),e}function Ui(){var e,r,s,i;return e=n,(r=a.substr(n,5)).toLowerCase()===sn?n+=5:(r=t,c===0&&w(bo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=vu()):(n=e,e=t)):(n=e,e=t),e}function $i(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===un?n+=4:(r=t,c===0&&w(Ao)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=wu()):(n=e,e=t)):(n=e,e=t),e}function Ji(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===ln?n+=7:(r=t,c===0&&w(Fo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Iu()):(n=e,e=t)):(n=e,e=t),e}function Vi(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===cn?n+=2:(r=t,c===0&&w(Do)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=gu()):(n=e,e=t)):(n=e,e=t),e}function Wt(){var e,r,s,i;return e=n,(r=a.substr(n,8)).toLowerCase()===fn?n+=8:(r=t,c===0&&w(Po)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Tu()):(n=e,e=t)):(n=e,e=t),e}function Kt(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===dn?n+=4:(r=t,c===0&&w(Lo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=yu()):(n=e,e=t)):(n=e,e=t),e}function Zi(){var e,r,s,i;return e=n,(r=a.substr(n,13)).toLowerCase()===pn?n+=13:(r=t,c===0&&w(Ro)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Nu()):(n=e,e=t)):(n=e,e=t),e}function zi(){var e,r,s,i;return e=n,(r=a.substr(n,15)).toLowerCase()===mn?n+=15:(r=t,c===0&&w(_o)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Su()):(n=e,e=t)):(n=e,e=t),e}function Xt(){var e,r,s,i;return e=n,(r=a.substr(n,5)).toLowerCase()===hn?n+=5:(r=t,c===0&&w(Uo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ou()):(n=e,e=t)):(n=e,e=t),e}function er(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===vn?n+=3:(r=t,c===0&&w($o)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=xu()):(n=e,e=t)):(n=e,e=t),e}function tr(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===wn?n+=4:(r=t,c===0&&w(Jo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Cu()):(n=e,e=t)):(n=e,e=t),e}function rr(){var e,r,s,i;return e=n,(r=a.substr(n,6)).toLowerCase()===In?n+=6:(r=t,c===0&&w(Vo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Eu()):(n=e,e=t)):(n=e,e=t),e}function ne(){var e,r,s,i;return e=n,(r=a.substr(n,6)).toLowerCase()===gn?n+=6:(r=t,c===0&&w(Zo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Mu()):(n=e,e=t)):(n=e,e=t),e}function Ee(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Tn?n+=4:(r=t,c===0&&w(zo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=bu()):(n=e,e=t)):(n=e,e=t),e}function Me(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===yn?n+=3:(r=t,c===0&&w(ko)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Au()):(n=e,e=t)):(n=e,e=t),e}function nr(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Nn?n+=4:(r=t,c===0&&w(Ho)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Fu()):(n=e,e=t)):(n=e,e=t),e}function or(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Sn?n+=4:(r=t,c===0&&w(qo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Du()):(n=e,e=t)):(n=e,e=t),e}function ki(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===On?n+=4:(r=t,c===0&&w(jo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Pu()):(n=e,e=t)):(n=e,e=t),e}function W(){var e;return a.charCodeAt(n)===44?(e=xn,n++):(e=t,c===0&&w(Yo)),e}function R(){var e;return a.charCodeAt(n)===40?(e=Cn,n++):(e=t,c===0&&w(Qo)),e}function _(){var e;return a.charCodeAt(n)===41?(e=En,n++):(e=t,c===0&&w(Bo)),e}function p(){var e,r;for(e=[],r=ar();r!==t;)e.push(r),r=ar();return e}function ar(){var e;return e=a.charAt(n),Rn.test(e)?n++:(e=t,c===0&&w(Go)),e}function Hi(){var e,r,s,i;if(e=n,(r=Dt())!==t&&(f=e,r=Lu(r)),(e=r)===t)if(e=n,a.charCodeAt(n)===96?(r=it,n++):(r=t,c===0&&w(vt)),r!==t){if(s=[],i=a.charAt(n),ft.test(i)?n++:(i=t,c===0&&w(wt)),i!==t)for(;i!==t;)s.push(i),i=a.charAt(n),ft.test(i)?n++:(i=t,c===0&&w(wt));else s=t;s!==t?(a.charCodeAt(n)===96?(i=it,n++):(i=t,c===0&&w(vt)),i!==t?(f=e,e=Ru(s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function qi(e,r,s){return{type:"unary-expression",location:s,operator:e,expr:r}}function sr(e,r,s,i,v){const C={type:"binary-expression",location:v,operator:e,left:r,right:s};return i!==void 0&&(C.escape=i),C}function H(e,...r){return{type:"expression-list",location:e,value:r}}function fe(e,r){let s=e;for(const{op:i,expr:v,location:{end:C}}of r)s=sr(i,s,v,void 0,{...s.location,end:C});return s}function ji(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&_e("Timestamp literal is invalid")}function Yi(e){/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(e)!==!0&&_e("Time literal is invalid")}function Qi(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&_e("Date literal is invalid")}if(u=g(),o.peg$library)return{peg$result:u,peg$currPos:n,peg$FAILED:t,peg$maxFailExpected:we,peg$maxFailPos:Q};if(u!==t&&n===a.length)return u;throw u!==t&&n<a.length&&w(_u()),$u(we,Q<a.length?a.charAt(Q):null,Q<a.length?Ie(Q,Q+1):Ie(Q,Q))}Tc(ae,Error),ae.prototype.format=function(a){var o="Error: "+this.message;if(this.location){var u,t=null;for(u=0;u<a.length;u++)if(a[u].source===this.location.source){t=a[u].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,h=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,g=this.location.source+":"+h.line+":"+h.column;if(t){var y=this.location.end,O=rt("",h.line.toString().length," "),S=t[l.line-1],x=(l.line===y.line?y.column:S.length+1)-l.column||1;o+=`
 --> `+g+`
`+O+` |
`+h.line+" | "+S+`
`+O+" | "+rt("",l.column-1," ")+rt("",x,"^")}else o+=`
 at `+g}return o},ae.buildMessage=function(a,o){var u={literal:function(S){return'"'+l(S.text)+'"'},class:function(S){var x=S.parts.map(function(D){return Array.isArray(D)?h(D[0])+"-"+h(D[1]):h(D)});return"["+(S.inverted?"^":"")+x.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(S){return S.description}};function t(S){return S.charCodeAt(0).toString(16).toUpperCase()}function l(S){return S.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+t(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+t(x)})}function h(S){return S.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+t(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+t(x)})}function g(S){return u[S.type](S)}function y(S){var x,D,M=S.map(g);if(M.sort(),M.length>0){for(x=1,D=1;x<M.length;x++)M[x-1]!==M[x]&&(M[D]=M[x],D++);M.length=D}switch(M.length){case 1:return M[0];case 2:return M[0]+" or "+M[1];default:return M.slice(0,-1).join(", ")+", or "+M[M.length-1]}}function O(S){return S?'"'+l(S)+'"':"end of input"}return"Expected "+y(a)+" but "+O(o)+" found."};class Nc{static parse(o){return yc(o)}}function $(a,o){if(a!=null)switch(o(a),a.type){case"when-clause":$(a.operand,o),$(a.value,o);break;case"case-expression":for(const u of a.clauses)$(u,o);a.format==="simple"&&$(a.operand,o),a.else!==null&&$(a.else,o);break;case"expression-list":for(const u of a.value)$(u,o);break;case"unary-expression":$(a.expr,o);break;case"binary-expression":$(a.left,o),$(a.right,o);break;case"function":$(a.args,o);break;case"interval":$(a.value,o),$(a.qualifier,o);break;case"interval-qualifier":$(a.start,o),$(a.end,o)}}const Sc=new Set(["current_timestamp","current_date","current_time"]);class Pe{static makeBool(o){return Or(o)}static featureValue(o,u,t,l){return Mr(o,u,t,l)}static equalsNull(o){return o===null}static applyLike(o,u,t){return at(o,u,t)}static ensureArray(o){return nt(o)}static applyIn(o,u,t){return ot(o,u)}static currentTimestamp(o){return Ae(new Date,o)}static currentDate(o){return j.fromNow(o)}static currentTime(o){const u=Ae(new Date,o);return Z.fromDateTime(u)}static makeSqlInterval(o,u,t){return L.createFromValueAndQualifier(o,u,t)}static convertInterval(o){return L.isInterval(o)?o.valueInMilliseconds():o}static compare(o,u,t,l){return z(u,t,o)}static calculate(o,u,t,l){return Sr(o,u,t,l)}static evaluateTime(o){return Be(o)}static evaluateTimestamp(o,u,t){return Fe(o,u,t)}static evaluateDate(o,u){return gr(o,u)}static evaluateFunction(o,u,t){return Xe(o,u,t)}static lookup(o,u){const t=u[o];return t===void 0?null:t}static between(o,u,t){return o==null||u[0]==null||u[1]==null?null:z(o,u[0],">=")&&z(o,u[1],"<=")}static notbetween(o,u,t){return o==null||u[0]==null||u[1]==null?null:z(o,u[0],"<")||z(o,u[1],">")}static ternaryNot(o){return Le(o)}static ternaryAnd(o,u){return xr(o,u)}static ternaryOr(o,u){return Cr(o,u)}}class Re{constructor(o,u,t="UTC",l=null){this.fieldsIndex=u,this.timeZone=t,this.currentUser=l,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=Nc.parse(o);const{isStandardized:h,isAggregate:g,currentUserRequired:y,referencedFieldNames:O}=this._extractExpressionInfo(u);this._referencedFieldNames=O,this.isStandardized=h,this.isAggregate=g,this.currentUserRequired=y}static convertValueToStorageFormat(o,u=null){if(u===null)return q(o)?o.getTime():b(o)?o.toMillis():F(o)?o.toStorageFormat():P(o)?o.toStorageString():A(o)?o.toStorageFormat():o;switch(u){case"date":return q(o)?o.getTime():b(o)?o.toMillis():F(o)?o.toMilliseconds():A(o)?o.toNumber():o;case"date-only":return q(o)?j.fromDateJS(o).toString():F(o)?j.fromSqlTimeStampOffset(o).toString():b(o)?j.fromDateTime(o).toString():o;case"time-only":return q(o)?Z.fromDateJS(o).toStorageString():b(o)?Z.fromDateTime(o).toStorageString():F(o)?Z.fromSqlTimeStampOffset(o).toStorageString():P(o)?o.toStorageString():o;case"timestamp-offset":if(q(o))return Y.fromJSDate(o).toStorageFormat();if(b(o))return Y.fromDateTime(o).toStorageFormat();if(F(o))return o.toStorageFormat()}return o}static create(o,u={}){return new Re(o,u.fieldsIndex,u.timeZone??void 0,u.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(o,u=pe,t=this.currentUser){return!!this._evaluateNode(this.parseTree,null,u,o,t)}calculateValue(o,u=pe,t=this.currentUser){const l=this._evaluateNode(this.parseTree,o,u,null,t);return L.isInterval(l)?l.valueInMilliseconds()/864e5:l}calculateValueCompiled(o,u=pe,t=this.currentUser){return this.parseTree._compiledVersion!=null?this.parseTree._compiledVersion(o,this.parameters,u,this.fieldsIndex,this.timeZone,t??null):ir("esri-csp-restrictions")?this.calculateValue(o,u):(this._compileMe(),this.parseTree._compiledVersion(o,this.parameters,u,this.fieldsIndex,this.timeZone,t??null))}testFeature(o,u=pe,t=this.currentUser){return!!this._evaluateNode(this.parseTree,o,u,null,t)}testFeatureCompiled(o,u=pe,t=this.currentUser){return this.parseTree._compiledVersion!=null?!!this.parseTree._compiledVersion(o,this.parameters,u,this.fieldsIndex,this.timeZone,t??null):ir("esri-csp-restrictions")?this.testFeature(o,u):(this._compileMe(),!!this.parseTree._compiledVersion(o,this.parameters,u,this.fieldsIndex,this.timeZone,t??null))}get hasDateFunctions(){return this._hasDateFunctions!=null||(this._hasDateFunctions=!1,$(this.parseTree,o=>{o.type==="current-time"?this._hasDateFunctions=!0:o.type==="function"&&(this._hasDateFunctions=this._hasDateFunctions||Sc.has(o.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const o=new Set;return $(this.parseTree,u=>{u.type==="function"&&o.add(u.name.toLowerCase())}),Array.from(o)}getExpressions(){const o=new Map;return $(this.parseTree,u=>{if(u.type==="function"){const t=u.name.toLowerCase(),l=u.args.value[0];if(l.type==="column-reference"){const h=l.column,g=`${t}-${h}`;o.has(g)||o.set(g,{aggregateType:t,field:h})}}}),[...o.values()]}getVariables(){const o=new Set;return $(this.parseTree,u=>{u.type==="parameter"&&o.add(u.value.toLowerCase())}),Array.from(o)}_compileMe(){const o="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone","currentUser",o).bind(Pe)}_extractExpressionInfo(o){const u=[],t=new Set;let l=!0,h=!1,g=!1;return $(this.parseTree,y=>{switch(y.type){case"column-reference":{const O=o?.get(y.column);let S,x;O?S=x=O.name??"":(x=y.column,S=x.toLowerCase()),t.has(S)||(t.add(S),u.push(x)),y.column=x;break}case"current-user":g=!0;break;case"function":{const{name:O,args:S}=y,x=S.value.length;l&&(l=Nl(O,x)),h===!1&&(h=dr(O,x));break}}}),{referencedFieldNames:Array.from(u),isStandardized:l,isAggregate:h,currentUserRequired:g}}evaluateNodeToJavaScript(o){switch(o.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(o.value)+", "+JSON.stringify(o.qualifier)+","+JSON.stringify(o.op)+")";case"case-expression":{let u="";if(o.format==="simple"){const t=this.evaluateNodeToJavaScript(o.operand);u="( ";for(let l=0;l<o.clauses.length;l++)u+=" (this.compare('=',"+t+","+this.evaluateNodeToJavaScript(o.clauses[l].operand)+") ? ("+this.evaluateNodeToJavaScript(o.clauses[l].value)+") : ";o.else!==null?u+=this.evaluateNodeToJavaScript(o.else):u+="null",u+=" )"}else{u="( ";for(let t=0;t<o.clauses.length;t++)u+=" this.makeBool("+this.evaluateNodeToJavaScript(o.clauses[t].operand)+")===true ? ("+this.evaluateNodeToJavaScript(o.clauses[t].value)+") : ";o.else!==null?u+=this.evaluateNodeToJavaScript(o.else):u+="null",u+=" )"}return u}case"parameter":return"this.lookup("+JSON.stringify(o.value.toLowerCase())+",lookups)";case"expression-list":{let u="[";for(const t of o.value)u!=="["&&(u+=","),u+=this.evaluateNodeToJavaScript(t);return u+="]",u}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(o.expr)+")";case"binary-expression":switch(o.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+" )";case"IS":if(o.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(o.left)+")";case"ISNOT":if(o.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(o.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(o.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(o.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(o.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(o.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+","+JSON.stringify(o.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+","+JSON.stringify(o.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(o.operator)+","+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(o.operator)+","+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+", timeZone)";default:throw new m(d.UnsupportedOperator,{operator:o.operator})}case"null":case"boolean":case"string":case"number":return JSON.stringify(o.value);case"time":return"this.evaluateTime("+JSON.stringify(o.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(o.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(o.value)+", 'unknown')";case"current-time":return o.mode==="date"?"this.currentDate(timeZone)":o.mode==="time"?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case"current-user":return"currentUser";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(o.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(o.name)+","+this.evaluateNodeToJavaScript(o.args)+", timeZone)"}throw new m(d.UnsupportedSyntax,{node:o.type})}_evaluateNode(o,u,t,l,h){let g;switch(o.type){case"interval":{const y=this._evaluateNode(o.value,u,t,l,h);return L.createFromValueAndQualifier(y,o.qualifier,o.op)}case"case-expression":if(o.format==="simple"){const y=this._evaluateNode(o.operand,u,t,l,h);for(let O=0;O<o.clauses.length;O++)if(z(y,this._evaluateNode(o.clauses[O].operand,u,t,l,h),"=",this.timeZone))return this._evaluateNode(o.clauses[O].value,u,t,l,h);if(o.else!==null)return this._evaluateNode(o.else,u,t,l,h)}else{for(let y=0;y<o.clauses.length;y++)if(Or(this._evaluateNode(o.clauses[y].operand,u,t,l,h)))return this._evaluateNode(o.clauses[y].value,u,t,l,h);if(o.else!==null)return this._evaluateNode(o.else,u,t,l,h)}return null;case"parameter":return g=this.parameters[o.value.toLowerCase()],q(g)?J.fromJSDate(g):g!=null&&typeof g=="object"&&"toDateTime"in g?g.toDateTime():g;case"expression-list":{const y=[];for(const O of o.value)y.push(this._evaluateNode(O,u,t,l,h));return y}case"unary-expression":return Le(this._evaluateNode(o.expr,u,t,l,h));case"binary-expression":switch(o.operator){case"AND":return xr(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h));case"OR":return Cr(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h));case"IS":if(o.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(o.left,u,t,l,h)===null;case"ISNOT":if(o.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(o.left,u,t,l,h)!==null;case"IN":{const y=nt(this._evaluateNode(o.right,u,t,l,h));return ot(this._evaluateNode(o.left,u,t,l,h),y,this.timeZone)}case"NOT IN":{const y=nt(this._evaluateNode(o.right,u,t,l,h));return Le(ot(this._evaluateNode(o.left,u,t,l,h),y,this.timeZone))}case"BETWEEN":{const y=this._evaluateNode(o.left,u,t,l,h),O=this._evaluateNode(o.right,u,t,l,h);return y==null||O[0]==null||O[1]==null?null:z(y,O[0],">=",this.timeZone)&&z(y,O[1],"<=",this.timeZone)}case"NOTBETWEEN":{const y=this._evaluateNode(o.left,u,t,l,h),O=this._evaluateNode(o.right,u,t,l,h);return y==null||O[0]==null||O[1]==null?null:z(y,O[0],"<",this.timeZone)||z(y,O[1],">",this.timeZone)}case"LIKE":return at(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h),o.escape);case"NOT LIKE":return Le(at(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h),o.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return z(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h),o.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return Sr(o.operator,this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h),this.timeZone)}case"null":case"boolean":case"string":case"number":return o.value;case"date":return o.parsedValue??=gr(o.value,"unknown"),o.parsedValue;case"timestamp":return o.parsedValue??=Fe(o.value,"unknown"),o.parsedValue;case"time":return Be(o.value);case"current-time":return o.mode==="date"?Pe.currentDate(this.timeZone):o.mode==="time"?Pe.currentTime(this.timeZone):Pe.currentTimestamp(this.timeZone);case"current-user":return h??null;case"column-reference":return Mr(u,o.column,this.fieldsIndex,t);case"data-type":return o.value;case"function":{if(this.isAggregate&&dr(o.name,o.args.value.length)){const O=[];for(const S of o.args?.value||[]){const x=[];for(const D of l||[])x.push(this._evaluateNode(S,D,t,null,h));O.push(x)}return fr(o.name,O)}const y=this._evaluateNode(o.args,u,t,l,h);return Xe(o.name,y,this.timeZone)}}throw new m(d.UnsupportedSyntax,{node:o.type})}}function Or(a){return a===!0}function nt(a){return Array.isArray(a)?a:[a]}function Le(a){return a!==null?a!==!0:null}function xr(a,o){return a!=null&&o!=null?a===!0&&o===!0:a!==!1&&o!==!1&&null}function Cr(a,o){return a!=null&&o!=null?a===!0||o===!0:a===!0||o===!0||null}function ot(a,o,u){if(a==null)return null;let t=!1;for(const l of o)if(l==null)t=null;else{if(a===l){t=!0;break}if(We(a)&&We(l)&&(t=z(a,l,"="),t))break}return t}const Er="-[]/{}()*+?.\\^$|";var se;function Oc(a,o){const u=o;let t="",l=se.Normal;for(let h=0;h<a.length;h++){const g=a.charAt(h);switch(l){case se.Normal:g===u?l=se.Escaped:Er.includes(g)?t+="\\"+g:t+=g==="%"?".*":g==="_"?".":g;break;case se.Escaped:Er.includes(g)?t+="\\"+g:t+=g,l=se.Normal}}return new RegExp("^"+t+"$","m")}function at(a,o,u){return a==null?null:Oc(o,u).test(a)}function xc(a){return a&&typeof a.attributes=="object"}function Mr(a,o,u,t){if("getAttributeSQL"in t)return t.getAttributeSQL(a,o);const l=t.getAttribute(a,o),h=u?.get(o);return l==null||h?.type!=="esriFieldTypeDate"&&h?.type!=="date"?l==null||h?.type!=="esriFieldTypeDateOnly"&&h?.type!=="date-only"?l==null||h?.type!=="esriFieldTypeTimeOnly"&&h?.type!=="time-only"?l==null||h?.type!=="esriFieldTypeTimestampOffset"&&h?.type!=="timestamp-offset"?l:new Y(l):Z.fromReader(l):j.fromReader(l):Ae(new Date(l),u?.getLuxonTimeZone(h.name)??Xi.utcInstance)}(function(a){a[a.Normal=0]="Normal",a[a.Escaped=1]="Escaped"})(se||(se={}));const pe={getAttribute:(a,o)=>(xc(a)?a.attributes:a)[o]},Cc=Object.freeze(Object.defineProperty({__proto__:null,default:Re},Symbol.toStringTag,{value:"Module"}));export{Re as D,Cc as W,d as a,Y as i,m as n,fr as u};
