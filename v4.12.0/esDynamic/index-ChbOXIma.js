import{c_ as _,d1 as n,c$ as c,dO as $,dP as k,e1 as z,iF as I,dT as O,ea as y,dX as A,d0 as m,d$ as d,ff as h,eb as f,dS as C,e0 as w,dY as E,dW as b,iD as T,dZ as N,fh as x,r as P,e6 as V,e7 as B,dU as M,dV as Y,e9 as S,F as j,dG as D}from"./main-DnzmeE4U.js";import{u as W}from"./draw-store-C1_quxsr.js";const q={},G={class:"border-b p-0 self-center w-2/3"};function U(g,a){return n(),c("span",G)}const L=_(q,[["render",U]]),X=$({__name:"zoom-nav",setup(g){const{t:a}=k(),t=z("iApi"),e=I(400,!0,()=>t.geo.map.zoomIn()),o=I(400,!0,()=>t.geo.map.zoomOut());return(s,r)=>{const l=O("mapnav-button");return n(),c("div",null,[y(l,{onClickFunction:d(e),tooltip:d(a)("mapnav.zoomIn")},{default:A(()=>r[0]||(r[0]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),y(L),y(l,{onClickFunction:d(o),tooltip:d(a)("mapnav.zoomOut")},{default:A(()=>r[1]||(r[1]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13H5v-2h14v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),J={class:"mapnav-section bg-white-75 hover:bg-white"},K=$({__name:"draw-nav-section",setup(g){const a=z("iApi"),{t}=k(),e=W(),o=[{type:"point",icon:h(f(()=>import("./point-icon-BSJft8AI.js")))},{type:"polyline",icon:h(f(()=>import("./polyline-icon-CqjafPK0.js")))},{type:"polygon",icon:h(f(()=>import("./polygon-icon-BrXtjiJl.js")))},{type:"circle",icon:h(f(()=>import("./circle-icon-DrE2wWqh.js")))},{type:"rectangle",icon:h(f(()=>import("./rectangle-icon-D8mTZj4O.js")))}],s=C(()=>{const p=o.filter(i=>e.supportedTypes.some(v=>v.type===i.type));return p.push({type:"edit",icon:h(f(()=>import("./edit-icon-C_tqZ1EG.js")))}),p}),r=p=>{e.activeTool===p?e.setActiveTool(null):e.setActiveTool(p)},l=()=>{a.geo.map.setMouseFocus()};return(p,i)=>{const v=O("mapnav-button");return n(),c("div",J,[(n(!0),c(w,null,E(s.value,u=>(n(),b(v,{key:u.type,onMousedown:l,onClickFunction:()=>r(u.type),tooltip:d(t)(`draw.${u.type}.tooltip`),class:N({"active-tool":d(e).activeTool===u.type})},{default:A(()=>[(n(),b(T(u.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","class"]))),128))])}}}),Q=_(K,[["__scopeId","data-v-033c1fd2"]]),R={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},ee=["content"],te={class:"mapnav-section bg-white-75 hover:bg-white"},oe=$({__name:"mapnav",setup(g){const a=z("iApi"),t=x(),{t:e}=k(),o=P(),s=C(()=>a.getConfig().fixtures.mapnav.items.some(i=>i==="draw")),r=()=>{o.value._tippy.hide()},l=i=>{i.key==="Tab"&&o.value?.matches(":focus")&&o.value._tippy.show()};V(()=>{o.value?.addEventListener("blur",r),o.value?.addEventListener("keyup",l)}),B(()=>{o.value?.removeEventListener("blur",r),o.value?.removeEventListener("keyup",l)});const p=C(()=>t.order.map(i=>t.items[i]).filter(i=>i.componentId&&i.id!=="draw"));return(i,v)=>{const u=M("focus-list"),H=M("tippy");return n(),c("div",R,[Y((n(),c("div",{class:"flex flex-col",content:d(e)("panels.controls.items"),ref_key:"el",ref:o},[s.value?(n(),c(w,{key:0},[y(Q),v[0]||(v[0]=m("span",{class:"py-1"},null,-1))],64)):S("",!0),y(X,{class:"mapnav-section bg-white-75 hover:bg-white"}),v[1]||(v[1]=m("span",{class:"py-1"},null,-1)),m("div",te,[(n(!0),c(w,null,E(p.value,(F,Z)=>(n(),c(w,{key:F.id+"button"},[(n(),b(T(F.id+"-nav-button"))),Z!==p.value.length-1?(n(),b(L,{key:0,class:"mapnav-divider"})):S("",!0)],64))),128))])],8,ee)),[[u],[H,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]])])}}}),ae=_(oe,[["__scopeId","data-v-96b1b7dc"]]);class ne extends j{mapnavStore=x(this.$vApp.$pinia);get config(){return super.config}_parseConfig(a){if(!a)return;const t=a.items.map(e=>({id:e}));this.mapnavStore.items=t.reduce((e,o)=>(e[o.id]=o,e),{}),this.mapnavStore.order=t.map(e=>e.id),this._validateItems()}_validateItems(){const a=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(t=>{(this.$iApi.fixture.exists(t)||a.includes(t))&&(this.mapnavStore.items[t].componentId=`${t}-nav-button`)})}}const se={en:{"mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arri\xE8re","mapnav.home":"Accueil","mapnav.fullscreen":"Plein \xC9cran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refus\xE9e. Veuillez v\xE9rifier les param\xE8tres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu \xEAtre trouv\xE9."}};class ie extends ne{async added(){Object.entries(se).forEach(s=>this.$iApi.$i18n.mergeLocaleMessage(...s));const{destroy:a,el:t}=this.mount(ae,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(t.childNodes[0]),this._parseConfig(this.config);const e=this.$vApp.$watch(()=>this.config,s=>this._parseConfig(s)),o=this.$iApi.event.on(D.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{e(),this.$iApi.event.off(o);const s=x(this.$vApp.$pinia),r={...s.items};Object.keys(r).forEach(l=>s.removeItem(l)),s.$reset(),a()}}}export{ie as default};
