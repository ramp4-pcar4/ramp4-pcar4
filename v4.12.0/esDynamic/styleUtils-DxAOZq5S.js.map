{"version":3,"file":"styleUtils-DxAOZq5S.js","sources":["../../node_modules/@arcgis/core/symbols/support/styleCache.js","../../node_modules/@arcgis/core/symbols/support/styleUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nconst e=new Map;export{e as cachedStyles};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import r from\"../../core/Error.js\";import has from\"../../core/has.js\";import{throwIfAbortError as t}from\"../../core/promiseUtils.js\";import{normalize as o,removeFile as s}from\"../../core/urlUtils.js\";import n from\"../../portal/Portal.js\";import l from\"../../portal/PortalQueryParams.js\";import{cachedStyles as a}from\"./styleCache.js\";async function f(e,r){try{return{data:(await p(e,r)).data,baseUrl:s(e),styleUrl:e}}catch(o){return t(o),null}}function u(e,r,t){const o=null!=r.portal?r.portal:n.getDefault();let s;const l=`${o.url} - ${o.user?.username} - ${e}`,f=a.get(l);if(f)return f;const u=c(e,o,t).then((e=>(s=e,e.fetchData()))).then((r=>({data:r,baseUrl:s.itemUrl??\"\",styleName:e})));return a.set(l,u),u}function c(e,t,o){return t.load(o).then((()=>{const r=new l({disableExtraQuery:!0,query:`owner:${d} AND type:${w} AND typekeywords:\"${e}\"`});return t.queryItems(r,o)})).then((({results:t})=>{let s=null;const n=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t){const r=e.typeKeywords?.some((e=>e.toLowerCase()===n));if(r&&e.type===w&&e.owner===d){s=e;break}}if(!s)throw new r(\"symbolstyleutils:style-not-found\",`The style '${e}' could not be found`,{styleName:e});return s.load(o)}))}function i(e,t,o){return null!=e?.styleUrl?f(e.styleUrl,o):null!=e?.styleName?u(e.styleName,t,o):Promise.reject(new r(\"symbolstyleutils:style-url-and-name-missing\",\"Either styleUrl or styleName is required to resolve a style\"))}function m(e){return null===e||\"CIMSymbolReference\"===e.type?e:{type:\"CIMSymbolReference\",symbol:e}}function y(e,r){for(const t of r)switch(t){case\"cim\":if(e.cimRef)return{format:t,url:encodeURI(e.cimRef)};break;case\"web-gltf-basisu\":{const r=b(e,\"gltf_basisu\");if(r)return{format:t,url:r};break}case\"web-gltf\":{const r=b(e,\"gltf\");if(r)return{format:t,url:r};break}case\"web\":{const r=b(e,\"gltf\");if(r)return{format:\"web-gltf\",url:r};if(e.webRef)return{format:t,url:encodeURI(e.webRef)};break}}}function b(e,r){if(!has(\"enable-feature:force-wosr\"))return e.formatInfos?.find((e=>e.type===r))?.href}function p(r,t){const s={responseType:\"json\",query:{f:\"json\"},...t};return e(o(r),s)}const d=\"esri_en\",w=\"Style\",h=\"https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json\";export{h as Style2DUrlTemplate,i as fetchStyle,m as makeCIMSymbolRef,p as requestJSON,y as symbolUrlFromStyleItem};\n"],"names":["e","f","r","p","s","o","t","u","n","l","a","c","d","w","i","m","y","b","has","h"],"mappings":"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","x_google_ignoreList":[0,1]}