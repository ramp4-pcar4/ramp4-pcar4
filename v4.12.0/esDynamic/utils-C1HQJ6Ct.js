import{bp as He,bx as z,bC as P,az as Q,bd as Ke,b7 as Xe,s as H,bo as I,n as Ye,cY as ce,iX as Je,iY as _e,c3 as et,cA as tt,aL as at,bZ as nt,iZ as lt,aJ as ot}from"./main-DnzmeE4U.js";import{e as it}from"./globalCss-CFN4F315.js";import{n as x,v as st,b as rt}from"./jsxFactory-C5LxVioS.js";import{g as ct,M as ue,b as ut,a as ht,w as he,p as pt,f as mt,y as ft,c as K,D as dt,J as yt,h as N}from"./utils-C_9ghOVk.js";import{B as X,U as pe}from"./colorUtils-DxUhbS7D.js";import{n as me}from"./mat2df32-BCnkwMW8.js";import{e as B,i as gt,a as Y,c as bt,s as Lt}from"./mat2d-BQA-1WB-.js";import{resolveWebStyleSymbol as vt}from"./webStyleSymbolUtils-BLJ6xjmu.js";import{l as wt}from"./intl-DLmy-Li5.js";import"./ColorStop-DoHCvOqO.js";import"./mat4f32-CiZjBg9k.js";import"./mat4-BFStKTjU.js";import{r as xt}from"./TimeExtent-gZaEUVeW.js";import{$ as At,N as Mt}from"./utils-BG7WTOnW.js";import{l as kt}from"./typeUtils-I5iG5ZKA.js";function St({level:e,class:t,...a},n){const l=fe(e);return x(`h${l}`,{...a,"aria-level":String(l),class:st(it.heading,t),role:"heading"},n)}function fe(e){return He(Math.ceil(e),1,6)}function zt(e,t=1){return fe(e+t)}var k;(function(e){e[e.size=22]="size",e[e.lineWidth=50]="lineWidth",e[e.maxSize=120]="maxSize",e[e.maxOutlineSize=80]="maxOutlineSize",e[e.tallSymbolWidth=20]="tallSymbolWidth"})(k||(k={}));const O={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function Ct(e,t,a){const n=k.size;let l=n,o=n;e<1?l*=.75:e>1&&(o*=1.25);const i=0,s=0;let r=n,u=n;return t&&a&&(l=o=r=u=0),[{type:"path",path:[{command:"M",values:[r,i]},{command:"L",values:[a?r:.875*r,i]},{command:"L",values:[a?l-.5*r:s,o-.5*u]},{command:"L",values:[l-.5*r,o-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r,i]},{command:"L",values:[r,t?i:.125*u]},{command:"L",values:[l-.5*r,t?o-.5*u:u]},{command:"L",values:[l-.5*r,o-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l-.5*r,o-.5*u]},{command:"L",values:[a?l-.5*r:s,o-.5*u]},{command:"L",values:[a?l-.5*r:s,t?o-.5*u:u]},{command:"L",values:[l-.5*r,t?o-.5*u:u]},{command:"Z",values:[]}]}]}function Zt(e){const t=k.size,a=.5*e,n=0,l=0;return[{type:"path",path:[{command:"M",values:[l,.7*t*.5]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+a]},{command:"L",values:[l,.7*t+a-.7*t*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+a]},{command:"L",values:[t,a]},{command:"L",values:[t,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,n]},{command:"L",values:[t,n]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[l,.7*t*.5]},{command:"Z",values:[]}]}]}function It(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function Vt(e,t){let a=t?k.tallSymbolWidth:e;const n=e,l=t?4:6;a<=k.size?a-=.5*l:a-=l;const o=0,i=0,s=t?.35*a:.5*a;return[{type:"path",path:[{command:"M",values:[.5*a,o]},{command:"L",values:[a,.5*s]},{command:"L",values:[.5*a,s]},{command:"L",values:[i,.5*s]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,.5*s]},{command:"L",values:[.5*a,s]},{command:"L",values:[.5*a,n]},{command:"L",values:[i,n-.5*s]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*a,s]},{command:"L",values:[.5*a,n]},{command:"L",values:[a,n-.5*s]},{command:"L",values:[a,.5*s]},{command:"Z",values:[]}]}]}function jt(e,t){let a=t?k.tallSymbolWidth:e;const n=e,l=t?4:6;a<=k.size?a-=.5*l:a-=l;const o=.5*a,i=.15*a,s=0,r=n-i;return[{type:"ellipse",cx:.5*a,cy:r,rx:o,ry:i},{type:"path",path:[{command:"M",values:[s,i]},{command:"L",values:[s,r]},{command:"L",values:[a,r]},{command:"L",values:[a,i]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*a,cy:i,rx:o,ry:i}]}function Rt(e,t){let a=t?k.tallSymbolWidth:e;const n=e,l=t?4:6;a<=k.size?a-=.5*l:a-=l;const o=.15*a,i=n-o;return[{type:"ellipse",cx:.5*a,cy:i,rx:.5*a,ry:o},{type:"path",path:[{command:"M",values:[.5*a,0]},{command:"L",values:[a,i]},{command:"L",values:[0,i]},{command:"Z",values:[]}]}]}function Et(e){let t=e;const a=e,n=6;t<k.size?t-=.5*n:t-=n;const l=.15*t,o=0;return[{type:"path",path:[{command:"M",values:[0,o]},{command:"L",values:[t,o]},{command:"L",values:[.5*t,a-l]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:o,rx:.5*t,ry:l}]}function Nt(e){let t=e;const a=e,n=4;t<k.size?t-=.5*n:t-=n;const l=0,o=0,i=t,s=a,r=Math.floor(e/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*i,l]},{command:"L",values:[i,.5*s-r]},{command:"L",values:[.45*i-r,.5*s+r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*i,l]},{command:"L",values:[.45*i-r,.5*s+r]},{command:"L",values:[o,.5*s-r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,.5*s-r]},{command:"L",values:[.45*i-r,.5*s+r]},{command:"L",values:[.45*i,a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*i,a]},{command:"L",values:[i,.5*s-r]},{command:"L",values:[.45*i-r,.5*s+r]},{command:"Z",values:[]}]}]}function Ot(e){const t=e,a=2;let n=e;n<k.size?n-=.5*a:n-=a;const l=0,o=0;return[{type:"path",path:[{command:"M",values:[.45*t,l]},{command:"L",values:[t,n]},{command:"L",values:[.45*t,.6*n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*t,l]},{command:"L",values:[.45*t,.6*n]},{command:"L",values:[o,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[o,n]},{command:"L",values:[.45*t,.6*n]},{command:"L",values:[t,n]},{command:"Z",values:[]}]}]}function V(e,t){return Math.round(Math.min(Math.max(e+255*t*.75,0),255))}function $t(e,t){if(e==null)return new z;if("type"in e&&(e.type==="linear"||e.type==="pattern"))return e;const a=new z(e);return new z([V(a.r,t),V(a.g,t),V(a.b,t),a.a])}let Ut=0;function Bt(){return Ut++}let Dt=0;function Ft(){return Dt++}let Gt=0;function qt(){return Gt++}const Tt="http://www.w3.org/2000/svg",de=P("android"),Wt=P("chrome")||de&&de>=4?"auto":"optimizeLegibility",Pt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},Qt=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let A={},w={};const Ht=Math.PI;function j(e,t){const a=e*(Ht/180);return Math.abs(t*Math.sin(a))+Math.abs(t*Math.cos(a))}function ye(e){return e.map(t=>`${t.command} ${t.values.join(" ")}`).join(" ").trim()}function J(e,t,a,n,l){if(e){if(e.type==="circle")return x("circle",{cx:e.cx,cy:e.cy,fill:t,"fill-rule":"evenodd",r:e.r,stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-dashoffset":a.dashOffset,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width});if(e.type==="ellipse")return x("ellipse",{cx:e.cx,cy:e.cy,fill:t,"fill-rule":"evenodd",rx:e.rx,ry:e.ry,stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width});if(e.type==="rect")return x("rect",{fill:t,"fill-rule":"evenodd",height:e.height,stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width,width:e.width,x:e.x,y:e.y});if(e.type==="image")return x("image",{alt:l||"image",height:e.height,href:e.src,preserveAspectRatio:"none",width:e.width,x:e.x,y:e.y});if(e.type==="path"){const o=typeof e.path!="string"?ye(e.path):e.path;return x("path",{d:o,fill:t,"fill-rule":"evenodd",stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width})}if(e.type==="text")return Q(n),x("text",{"dominant-baseline":n.dominantBaseline,fill:t,"fill-rule":"evenodd","font-family":n.font.family,"font-size":n.font.size,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,kerning:n.kerning,rotate:n.rotate,stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width,"text-anchor":n.align,"text-decoration":n.decoration,"text-rendering":Wt,x:e.x,y:e.y},e.text)}return null}function _(e){if(!e)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in e))return{fill:new z(e).toString(),pattern:null,linearGradient:null};if(e.type==="pattern"){const a=`patternId-${Bt()}`;return{fill:`url(#${a})`,pattern:{id:a,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}},linearGradient:null}}const t=`linearGradientId-${Ft()}`;return{fill:`url(#${t})`,pattern:null,linearGradient:{id:t,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map(a=>({offset:a.offset,color:a.color&&new z(a.color).toString()}))}}}function ee(e){const t={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return e&&(e.width!=null&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=new z(e.color).toString()),e.dashArray&&(t.dashArray=e.dashArray),e.dashoffset&&(t.dashOffset=e.dashoffset),e.style&&!e.dashArray&&(t.dashArray=ct(e).join(",")||"none")),t}function ge(e,t){const a={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(e){const n=e.alignBaseline,l=n==="baseline"?"auto":n==="top"?"text-top":n==="bottom"?"hanging":n;a.align=e.align,a.dominantBaseline=l,a.decoration=e.decoration,a.kerning=e.kerning?"auto":"0",a.rotate=e.rotated?"90":"0",Q(t),a.font.style=t.style||"normal",a.font.variant=t.variant||"normal",a.font.weight=t.weight||"normal",a.font.size=t.size&&t.size.toString()||"10pt",a.font.family=t.family||"serif"}return a}function be(e){const{pattern:t,linearGradient:a}=e;if(t)return x("pattern",{height:t.height,id:t.id,patternUnits:"userSpaceOnUse",width:t.width,x:t.x,y:t.y},x("image",{height:t.image.height,href:t.image.href,width:t.image.width,x:t.image.x,y:t.image.y}));if(a){const n=a.stops.map((l,o)=>x("stop",{key:`${o}-stop`,offset:l.offset,"stop-color":l.color}));return x("linearGradient",{gradientUnits:"userSpaceOnUse",id:a.id,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2},n)}return null}function Kt(e,t){if(!e||e.length===0)return null;const a=[];for(const n of e){const{shape:l,fill:o,stroke:i,font:s}=n,r=_(o),u=ee(i),m=l.type==="text"?ge(l,s):null,p=J(l,r.fill,u,m);p&&a.push(p)}return x("mask",{id:t,maskUnits:"userSpaceOnUse"},x("g",null,a))}function Le(e,t,a){return gt(e,Y(e),[t,a])}function ve(e,t,a,n,l){return bt(e,Y(e),[t,a]),e[4]=e[4]*t-n*t+n,e[5]=e[5]*a-l*a+l,e}function Xt(e,t,a,n){const l=t%360*Math.PI/180;Lt(e,Y(e),l);const o=Math.cos(l),i=Math.sin(l),s=e[4],r=e[5];return e[4]=s*o-r*i+n*i-a*o+a,e[5]=r*o+s*i-a*i-n*o+n,e}function C(e,t){A&&"left"in A?(A.left!=null&&A.left>e&&(A.left=e),(A.right==null||A.right<e)&&(A.right=e),(A.top==null||A.top>t)&&(A.top=t),(A.bottom==null||A.bottom<t)&&(A.bottom=t)):A={left:e,bottom:t,right:e,top:t}}function we(e){const t=e.args,a=t.length;let n;switch(e.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(n=0;n<a;n+=2)C(t[n],t[n+1]);w.x=t[a-2],w.y=t[a-1];break;case"H":for(n=0;n<a;++n)C(t[n],w.y);w.x=t[a-1];break;case"V":for(n=0;n<a;++n)C(w.x,t[n]);w.y=t[a-1];break;case"m":{let l=0;for(("x"in w)||(C(w.x=t[0],w.y=t[1]),l=2),n=l;n<a;n+=2)C(w.x+=t[n],w.y+=t[n+1]);break}case"l":case"t":for(n=0;n<a;n+=2)C(w.x+=t[n],w.y+=t[n+1]);break;case"h":for(n=0;n<a;++n)C(w.x+=t[n],w.y);break;case"v":for(n=0;n<a;++n)C(w.x,w.y+=t[n]);break;case"c":for(n=0;n<a;n+=6)C(w.x+t[n],w.y+t[n+1]),C(w.x+t[n+2],w.y+t[n+3]),C(w.x+=t[n+4],w.y+=t[n+5]);break;case"s":case"q":for(n=0;n<a;n+=4)C(w.x+t[n],w.y+t[n+1]),C(w.x+=t[n+2],w.y+=t[n+3]);break;case"A":for(n=0;n<a;n+=7)C(t[n+5],t[n+6]);w.x=t[a-2],w.y=t[a-1];break;case"a":for(n=0;n<a;n+=7)C(w.x+=t[n+5],w.y+=t[n+6])}}function xe(e,t,a){const n=Pt[e.toLowerCase()];let l;typeof n=="number"&&(n?t.length>=n&&(l={action:e,args:t.slice(0,t.length-t.length%n)},a.push(l),we(l)):(l={action:e,args:[]},a.push(l),we(l)))}function Yt(e){const t=(typeof e.path!="string"?ye(e.path):e.path).match(Qt),a=[];if(A={},w={},!t)return null;let n="",l=[];const o=t.length;for(let s=0;s<o;++s){const r=t[s],u=parseFloat(r);isNaN(u)?(n&&xe(n,l,a),l=[],n=r):l.push(u)}xe(n,l,a);const i={x:0,y:0,width:0,height:0};return A&&"left"in A&&(i.x=A.left,i.y=A.top,i.width=A.right-A.left,i.height=A.bottom-A.top),i}function Ae(e){const t={x:0,y:0,width:0,height:0};if(e.type==="circle")t.x=e.cx-e.r,t.y=e.cy-e.r,t.width=2*e.r,t.height=2*e.r;else if(e.type==="ellipse")t.x=e.cx-e.rx,t.y=e.cy-e.ry,t.width=2*e.rx,t.height=2*e.ry;else if(e.type==="image"||e.type==="rect")t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else if(e.type==="path"){const a=Yt(e);t.x=a.x,t.y=a.y,t.width=a.width,t.height=a.height}return t}function Me(e){const t={x:0,y:0,width:0,height:0};let a=null,n=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(const o of e)a?(a.x=Math.min(a.x,o.x),a.y=Math.min(a.y,o.y),n=Math.max(n,o.x+o.width),l=Math.max(l,o.y+o.height)):(a=t,a.x=o.x,a.y=o.y,n=o.x+o.width,l=o.y+o.height);return a&&(a.width=n-a.x,a.height=l-a.y),a}function ke(e,t,a,n,l,o,i,s,r){let u=(i&&o?j(o,t):t)/2,m=(i&&o?j(o,a):a)/2;if(r){const g=r[0],f=r[1];u=(i&&o?j(o,g):g)/2,m=(i&&o?j(o,f):f)/2}const p=e.width+n,h=e.height+n,y=me(),c=me();let d=!1;if(l&&p!==0&&h!==0){const g=t!==a?t/a:p/h,f=t>a?t:a;let M=1,S=1;isNaN(f)||(g>1?(M=f/p,S=f/g/h):(S=f/h,M=f*g/p)),B(c,c,ve(y,M,S,u,m)),d=!0}const b=e.x+(p-n)/2,L=e.y+(h-n)/2;if(B(c,c,Le(y,u-b,m-L)),!d&&(p>t||h>a)){const g=p/t>h/a,f=(g?t:a)/(g?p:h);B(c,c,ve(y,f,f,b,L))}return s&&B(c,c,Le(y,s[0],s[1])),o&&B(c,c,Xt(y,o,b,L)),`matrix(${c[0]},${c[1]},${c[2]},${c[3]},${c[4]},${c[5]})`}function Jt(e,t,a){const n=e?.effects.find(u=>u.type==="bloom");if(!n)return null;const{strength:l,radius:o}=n,i=l>0?o:0,s=(l+i)*t,r=4*l+1;return x("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${a}`,width:"300%",x:"-100%",y:"-100%"},x("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(l+.5*i)*(5**(t/100)*(.4+t/100)),result:"dilate"}),x("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:s/25}),x("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:s/50}),x("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},x("feFuncR",{slope:r,type:"linear"}),x("feFuncG",{slope:r,type:"linear"}),x("feFuncB",{slope:r,type:"linear"})),x("feMerge",null,x("feMergeNode",{in:"intensityBlur"}),x("feMergeNode",{in:"intensityBrightness"}),x("feGaussianBlur",{stdDeviation:l/10})))}function Se(e,t,a,n={}){const l=[],o=[],i=qt(),s=Jt(n.effectView,t,i);let r=null;if(s){const p=n.effectView?.effects.find(d=>d.type==="bloom"),h=(p.strength?p.strength+p.radius/2:0)/3,y=t+t*h,c=a+a*h;r=[Math.max(y,10),Math.max(c,10)]}let u=t,m=a;if(n.useRotationSize)for(let p=0;p<e.length;p++){const h=n.rotations?.[p]??0;u=Math.max(j(h,t),u),m=Math.max(j(h,a),m)}for(let p=0;p<e.length;p++){const h=e[p],y=[],c=[];let d=0,b=0,L=0;for(const S of h){const{shape:R,fill:Te,stroke:se,font:We,offset:W}=S;n.ignoreStrokeWidth||R.type==="text"||(d+=se?.width||0);const re=_(Te),Pe=ee(se),Qe=R.type==="text"?ge(R,We):null;l.push(be(re)),y.push(J(R,re.fill,Pe,Qe,n.ariaLabel)),c.push(Ae(R)),W&&(b+=W[0],L+=W[1])}const g=n.rotations?.[p]??0;n.useRotationSize&&(b+=(u-j(g,t))/2,L+=(m-j(g,a))/2);const f=ke(Me(c),t,a,d,n.scale??!1,g,n.useRotationSize??!1,[b,L],r);let M=null;if(n.masking){const S=`mask-${p}`,R=n.masking[p];l.push(Kt(R,S)),M=`url(#${S})`}o.push(M?x("g",{mask:M},x("g",{transform:f},y)):x("g",{transform:f},y))}return s&&(Q(r),u=r[0],m=r[1]),x("svg",{"aria-label":n.ariaLabel,focusable:!1,height:m,role:"img",style:"display: block;",width:u,xmlns:Tt},s,x("defs",null,l),s?x("g",{filter:`url(#bloom${i})`},o):o)}const ze=rt();function _t(e,t){ze.append(e,t),ze.detach(t)}function D(e,t,a){const n=Math.ceil(t[0]),l=Math.ceil(t[1]);if(!e.some(i=>!!i.length))return null;const o=a?.node||document.createElement("div");return a.opacity!=null&&(o.style.opacity=a.opacity.toString()),a.effectView!=null&&(o.style.filter=ue(a.effectView)),_t(o,()=>Se(e,n,l,a)),o}function ea(e,t){e=Math.ceil(e),t=Math.ceil(t);const a=document.createElement("canvas");a.width=e,a.height=t,a.style.width=e+"px",a.style.height=t+"px";const n=a.getContext("2d");return n.clearRect(0,0,e,t),n}function ta(e,t,a){return e?Xe(e,{responseType:"image"}).then(n=>{const l=n.data,o=l.width,i=l.height,s=o/i;let r=t;if(a){const u=Math.max(o,i);r=Math.min(r,u)}return{image:l,width:s<=1?Math.ceil(r*s):r,height:s<=1?r:Math.ceil(r/s)}}):Promise.reject(new H("renderUtils: imageDataSize","href not provided."))}function aa(e,t){return!(!e||t==="ignore")&&(t!=="multiply"||e.r!==255||e.g!==255||e.b!==255||e.a!==1)}function na(e,t,a,n,l){switch(l){case"multiply":e[t]*=a[0],e[t+1]*=a[1],e[t+2]*=a[2],e[t+3]*=a[3];break;default:{const o=X({r:e[t],g:e[t+1],b:e[t+2]});o.h=n.h,o.s=n.s,o.v=o.v/100*n.v;const i=pe(o);e[t]=i.r,e[t+1]=i.g,e[t+2]=i.b,e[t+3]*=a[3];break}}}function la(e,t,a,n,l){return ta(e,t,l).then(o=>{const i=o.width??t,s=o.height??t;if(o.image&&aa(a,n)){let r=o.image.width,u=o.image.height;P("edge")&&/\.svg$/i.test(e)&&(r-=1,u-=1);const m=ea(i,s);m.drawImage(o.image,0,0,r,u,0,0,i,s);const p=m.getImageData(0,0,i,s),h=[a.r/255,a.g/255,a.b/255,a.a],y=X(a);for(let c=0;c<p.data.length;c+=4)na(p.data,c,h,y,n);m.putImageData(p,0,0),e=m.canvas.toDataURL("image/png")}else{const r=Ke?.findCredential(e);if(r?.token){const u=e.includes("?")?"&":"?";e=`${e}${u}token=${r.token}`}}return{url:e,width:i,height:s}}).catch(()=>({url:e,width:t,height:t}))}const E=k.size,F=k.maxSize,te=k.maxOutlineSize,Ce=k.lineWidth,ae=k.tallSymbolWidth;function $(e){const t=e.outline,a=e.material!=null?e.material.color:null,n=a!=null?a.toHex():null;if(t==null||"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none")return e.type==="fill"&&n==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const l=I(t.size)||0;return{color:"rgba("+(t.color!=null?t.color.toRgba():"255,255,255,1")+")",width:Math.min(l,te),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?he(t.pattern.style):null,join:"butt",cap:"patternCap"in t?t.patternCap:"butt"}}async function oa(e,t){if(e.thumbnail?.url)return e.thumbnail.url;if(t.type==="icon"&&t?.resource?.href)return pt(t);const a=ce("esri/images/Legend/legend3dsymboldefault.png");if(e.styleOrigin&&(e.styleOrigin.styleName||e.styleOrigin.styleUrl)){const n=await vt(e.styleOrigin,{portal:e.styleOrigin.portal}).catch(()=>null);if(n&&"thumbnail"in n&&n.thumbnail?.url)return n.thumbnail.url}return a}function ne(e,t=1){const a=e.a,n=X(e),l=n.h,o=n.s/t,i=100-(100-n.v)/t,{r:s,g:r,b:u}=pe({h:l,s:o,v:i});return[s,r,u,a]}function G(e){return e.type==="water"?e.color==null?null:e.color:e.material?.color==null?null:e.material.color}function v(e,t=0){const a=G(e);if(!a){if(e.type==="fill")return null;const l=ut.r,o=V(l,t);return[o,o,o,100]}const n=a.toRgba();for(let l=0;l<3;l++)n[l]=V(n[l],t);return n}async function Ze(e,t){const a=e.style;return a==="none"?null:{type:"pattern",x:0,y:0,src:await mt(ce(`esri/symbols/patterns/${a}.png`),t.toCss(!0)),width:5,height:5}}function Ie(e){return e.outline?$(e):{color:"rgba(0, 0, 0, 1)",width:1.5}}function le(e,t){const a=G(e);if(!a)return null;let n="rgba(";return n+=V(a.r,t)+",",n+=V(a.g,t)+",",n+=V(a.b,t)+",",n+a.a+");"}function oe(e,t){const a=le(e,t);return a?"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none"?null:{color:a,width:Math.min(e.size?I(e.size):.75,te),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?he(e.pattern.style):null,cap:"cap"in e?e.cap:null,join:"join"in e?e.join==="miter"?I(2):e.join:null}:{}}function q(e,t,a){const n=a!=null?.75*a:0;return{type:"linear",x1:n?.25*n:0,y1:n?.5*n:0,x2:n||4,y2:n?.5*n:4,colors:[{color:e,offset:0},{color:t,offset:1}]}}function ia(e){const t=e.depth,a=e.height,n=e.width;return n!==0&&t!==0&&a!==0&&n===t&&n!=null&&a!=null&&n<a}function sa(e,t,a){const n=[];if(!e)return n;switch(e.type){case"icon":{const l=t,o=t;switch(e.resource?.primitive??_e){case"circle":n.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:v(e,0),stroke:$(e)});break;case"square":n.push({shape:{type:"path",path:[{command:"M",values:[0,o]},{command:"L",values:[0,0]},{command:"L",values:[l,0]},{command:"L",values:[l,o]},{command:"Z",values:[]}]},fill:v(e,0),stroke:$(e)});break;case"triangle":n.push({shape:{type:"path",path:[{command:"M",values:[0,o]},{command:"L",values:[.5*l,0]},{command:"L",values:[l,o]},{command:"Z",values:[]}]},fill:v(e,0),stroke:$(e)});break;case"cross":n.push({shape:{type:"path",path:[{command:"M",values:[.5*l,0]},{command:"L",values:[.5*l,o]},{command:"M",values:[0,.5*o]},{command:"L",values:[l,.5*o]}]},stroke:Ie(e)});break;case"x":n.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[l,o]},{command:"M",values:[l,0]},{command:"L",values:[0,o]}]},stroke:Ie(e)});break;case"kite":n.push({shape:{type:"path",path:[{command:"M",values:[0,.5*o]},{command:"L",values:[.5*l,0]},{command:"L",values:[l,.5*o]},{command:"L",values:[.5*l,o]},{command:"Z",values:[]}]},fill:v(e,0),stroke:$(e)})}break}case"object":switch(e.resource?.primitive??Je){case"cone":{const l=q(v(e,0),v(e,-.6),a?ae:t),o=Rt(t,a);n.push({shape:o[0],fill:l},{shape:o[1],fill:l});break}case"inverted-cone":{const l=v(e,0),o=q(l,v(e,-.6),t),i=Et(t);n.push({shape:i[0],fill:o},{shape:i[1],fill:l});break}case"cube":{const l=Vt(t,a);n.push({shape:l[0],fill:v(e,0)},{shape:l[1],fill:v(e,-.3)},{shape:l[2],fill:v(e,-.5)});break}case"cylinder":{const l=q(v(e,0),v(e,-.6),a?ae:t),o=jt(t,a);n.push({shape:o[0],fill:l},{shape:o[1],fill:l},{shape:o[2],fill:v(e,0)});break}case"diamond":{const l=Nt(t);n.push({shape:l[0],fill:v(e,-.3)},{shape:l[1],fill:v(e,0)},{shape:l[2],fill:v(e,-.3)},{shape:l[3],fill:v(e,-.7)});break}case"sphere":{const l=q(v(e,0),v(e,-.6));l.x1=0,l.y1=0,l.x2=.25*t,l.y2=.25*t,n.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:l});break}case"tetrahedron":{const l=Ot(t);n.push({shape:l[0],fill:v(e,-.3)},{shape:l[1],fill:v(e,0)},{shape:l[2],fill:v(e,-.6)});break}}break}return n}function T(e){const t=typeof e?.size=="number"?e?.size:null;return t?I(t):null}function ra(e){return e.type==="icon"?"multiply":"tint"}async function ca(e,t){const a=T(t),n=t?.maxSize?I(t.maxSize):null,l=t?.disableUpsampling??!1,o=e.symbolLayers,i=[],s=[];let r=!1,u=0,m=0,p=0;o.forEach(c=>{if(c.type!=="icon"&&c.type!=="object")return;c&&c.type==="icon"&&(p=Math.max(c.size&&I(c.size),p));const d=c.type==="icon"?c.size&&I(c.size):0,b=a||d?Math.ceil(Math.min(a||d,n||F)):E;let L=c.type==="icon"?c.angle:null;if(t?.rotation!=null&&(L=(L??0)+t.rotation),s.push(L),c?.resource?.href){const g=oa(e,c).then(f=>{const M=c?.material?.color,S=ra(c);return la(f,b,M,S,l)}).then(f=>{const M=f.width,S=f.height;return u=Math.max(u,M),m=Math.max(m,S),L&&(r=!0),[{shape:{type:"image",x:0,y:0,width:M,height:S,src:f.url},fill:null,stroke:null}]});i.push(g)}else{let g=b;c.type==="icon"&&a&&(g=b*(d/p));const f=t?.symbolConfig==="tall"||t?.symbolConfig?.isTall||c.type==="object"&&ia(c);u=Math.max(u,f?ae:g),m=Math.max(m,g),L&&c.resource?.primitive&&["square","triangle","x"].includes(c.resource?.primitive)&&(r=!0),i.push(Promise.resolve(sa(c,g,f)))}});const h=await Promise.allSettled(i),y=[];return h.forEach(c=>{c.status==="fulfilled"?y.push(c.value):c.reason&&Ye.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",c.reason)}),D(y,[u,m],{node:t?.node,scale:!1,opacity:t?.opacity,ariaLabel:t?.ariaLabel,rotations:s,useRotationSize:r})}function ua(e,t){const a=e.symbolLayers,n=[],l=ht(e),o=T(t),i=(t?.maxSize?I(t.maxSize):null)||te;let s,r=0,u=0;return a.forEach((m,p)=>{if(!m||m.type!=="line"&&m.type!=="path")return;const h=[];switch(m.type){case"line":{const y=oe(m,0);if(y==null)break;const c=y?.width||0;p===0&&(s=c);const d=Math.min(o||c,i),b=p===0?d:o?d*(c/s):d,L=b>Ce/2?2*b:Ce;u=Math.max(u,b),r=Math.max(r,L),y.width=b,h.push({shape:{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[r,.5*u]}]},stroke:y});break}case"path":{const y=Math.min(o||E,i),c=v(m,0),d=v(m,-.2),b=le(m,-.4),L=b?{color:b,width:1}:{};if(m.profile==="quad"){const g=m.width,f=m.height,M=Ct(g&&f?g/f:1,f===0,g===0),S={...L,join:"bevel"};h.push({shape:M[0],fill:d,stroke:S},{shape:M[1],fill:d,stroke:S},{shape:M[2],fill:c,stroke:S})}else h.push({shape:O.pathSymbol3DLayer[0],fill:d,stroke:L},{shape:O.pathSymbol3DLayer[1],fill:c,stroke:L});u=Math.max(u,y),r=u}}n.push(h)}),Promise.resolve(D(n,[r,u],{node:t?.node,scale:l,opacity:t?.opacity,ariaLabel:t?.ariaLabel}))}async function ha(e,t){const a=e.type==="mesh-3d",n=e.symbolLayers,l=T(t),o=t?.maxSize?I(t.maxSize):null,i=l||E,s=[];let r=0,u=0,m=!1;for(let p=0;p<n.length;p++){const h=n.at(p),y=[];if(!a||h.type==="fill"){switch(h.type){case"fill":{const c=Math.min(i,o||F);if(r=Math.max(r,c),u=Math.max(u,c),m=!0,a){const d=O.meshSymbol3DFill,b=le(h,-.4),L=b?{color:b,width:1,join:"round"}:{};y.push({shape:d[0],fill:v(h,0),stroke:L},{shape:d[1],fill:v(h,-.2),stroke:L},{shape:d[2],fill:v(h,-.6),stroke:L})}else{let d=v(h,0);const b="pattern"in h?h.pattern:null,L=$(h),g=G(h);b!=null&&b.type==="style"&&b.style!=="solid"&&g&&(d=await Ze(b,g)),y.push({shape:O.fill[0],fill:d,stroke:L})}break}case"line":{const c=oe(h,0);if(c==null)break;const d={stroke:c,shape:O.fill[0]};r=Math.max(r,E),u=Math.max(u,E),y.push(d);break}case"extrude":{const c={join:"round",width:1,...oe(h,-.4)},d=v(h,0),b=v(h,-.2),L=Math.min(i,o||F),g=Zt(L);c.width=1,y.push({shape:g[0],fill:b,stroke:c},{shape:g[1],fill:b,stroke:c},{shape:g[2],fill:d,stroke:c});const f=E,M=.7*E+.5*L;r=Math.max(r,f),u=Math.max(u,M);break}case"water":{const c=G(h),d=ne(c),b=ne(c,2),L=ne(c,3),g=It();m=!0,y.push({shape:g[0],fill:d},{shape:g[1],fill:b},{shape:g[2],fill:L});const f=Math.min(i,o||F);r=Math.max(r,f),u=Math.max(u,f);break}}s.push(y)}}return D(s,[r,u],{node:t?.node,scale:m,opacity:t?.opacity,ariaLabel:t?.ariaLabel})}function pa(e,t){if(e.symbolLayers.length===0)return Promise.reject(new H("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(e.type){case"point-3d":return ca(e,t);case"line-3d":return ua(e,t);case"polygon-3d":case"mesh-3d":return ha(e,t)}return Promise.reject(new H("symbolPreview: swatchInfo3D","symbol not supported."))}const ma=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:Ze,getSizeFromOptions:T,getSymbolLayerFill:v,previewSymbol3D:pa},Symbol.toStringTag,{value:"Module"}));let U=null;const Ve=[255,255,255];function je(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function fa(e,t,a){const{backgroundColor:n,outline:l,dotSize:o}=e,i=a?.swatchSize||k.size,s=.8,r=Math.round(i*i/Math.max(o,.5)**2*s),u=window.devicePixelRatio,m=document.createElement("canvas"),p=i*u;m.width=p,m.height=p,m.style.width=m.width/u+"px",m.style.height=m.height/u+"px";const h=m.getContext("2d");if(n&&(h.fillStyle=n.toCss(!0),h.fillRect(0,0,p,p),h.fill()),h.fillStyle=t?.toCss(!0)??"",U&&U.length/2===r)for(let c=0;c<2*r;c+=2){const d=U[c],b=U[c+1];h.fillRect(d,b,o*u,o*u),h.fill()}else{U=[];for(let c=0;c<2*r;c+=2){const d=je(0,p),b=je(0,p);U.push(d,b),h.fillRect(d,b,o*u,o*u),h.fill()}}l&&(l.color&&(h.strokeStyle=l.color.toCss(!0)),h.lineWidth=l.width,h.strokeRect(0,0,p,p));const y=new Image(i,i);return y.src=m.toDataURL(),y.ariaLabel=a?.ariaLabel??null,y.alt=a?.ariaLabel??"",y}function da(e,t={}){const a=t.radius||40,n=2*Math.PI*a,l=e.length,o=n/l,i=[],s=ft(t.outline);s?.width!=null&&(s.width*=2),(s||t.backgroundColor)&&i.push({shape:{type:"circle",cx:a,cy:a,r:a},fill:t.backgroundColor,stroke:s,offset:[0,0]});const r=t.values,u=r&&r.length===l&&r.reduce((c,d)=>c+d,0)===100,m=[0];for(let c=0;c<l;c++){let d=null;u&&(d=r[c]*n/100,m.push(d+m[c])),i.push({shape:{type:"circle",cx:a,cy:a,r:a/2},fill:[0,0,0,0],stroke:{width:a,dashArray:`${(d??o)/2} ${n}`,dashoffset:"-"+(u?m[c]/2:c*(o/2)),color:e[c]},offset:[0,0]})}let p=null;const h=2*a+(s?.width||0),y=t.holePercentage;if(y){s&&i.push({shape:{type:"circle",cx:a,cy:a,r:a*y},fill:null,stroke:s,offset:[0,0]});const c=h/2;p=[[{shape:{type:"circle",cx:c,cy:c,r:c},fill:Ve,stroke:s?{...s,color:Ve}:null,offset:[0,0]},{shape:{type:"circle",cx:c,cy:c,r:a*y},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return D([i],[h,h],{effectView:t.effectList,ignoreStrokeWidth:!0,masking:p,rotations:[-90],ariaLabel:t.ariaLabel})}function ya(e,t={}){const a=t.align==="horizontal",n=a?75:24,l=a?24:75,o=t.width??n,i=t.height??l,s=t.gradient??!0,r=window.devicePixelRatio,u=o*r,m=i*r,p=document.createElement("canvas");p.width=u,p.height=m,p.ariaLabel=t.ariaLabel??null,p.style.width=`${o}px`,p.style.height=`${i}px`;const h=p.getContext("2d"),y=a?u:0,c=a?0:m;if(s){const b=h.createLinearGradient(0,0,y,c),L=e.length,g=L===1?0:1/(L-1);e.forEach((f,M)=>b.addColorStop(M*g,f.toString())),h.fillStyle=b,h.fillRect(0,0,u,m)}else{const b=a?u/e.length:u,L=a?m:m/e.length;let g=0,f=0;for(const M of e)h.fillStyle=M.toString(),h.fillRect(g,f,b,L),g=a?g+b:0,f=a?0:f+L}const d=document.createElement("div");return d.style.width=`${o}px`,d.style.height=`${i}px`,ga(d,t?.effectList),d.appendChild(p),d}function ga(e,t){if(!t)return;e.style.filter=ue(t);const a=t.effects;if(a){for(const n of a)if(n?.type==="drop-shadow"){n.offsetX<0?e.style.marginLeft=`${Math.abs(n.offsetX)}px`:e.style.marginRight=`${n.offsetX}px`;break}}}async function Re(e,t){switch(e.type){case"web-style":{const{previewWebStyleSymbol:a}=await import("./previewWebStyleSymbol-DR9_l-qc.js");return a(e,Re,t)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:a}=await Promise.resolve().then(()=>ma);return a(e,t)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:a}=await import("./previewSymbol2D-5k-1dpmM.js");return a(e,t)}case"cim":{const{previewCIMSymbol:a}=await import("./previewCIMSymbol-BBpXdm5e.js");return a(e,t)}default:return}}function Ee(e){return e&&"opacity"in e?e.opacity*Ee(e.parent):1}async function ba(e,t){if(!e)return;const a=e.sourceLayer,n=(t!=null&&t.useSourceLayer?a:e.layer)??a,l=t?.ignoreOpacity?1:Ee(n);if(e.symbol!=null&&(t==null||t.ignoreGraphicSymbol!==!0)){const f=e.symbol.type==="web-style"?await e.symbol.fetchSymbol({...t,acceptedFormats:["web","cim"],cache:t!=null?t.webStyleCache:null}):e.symbol.clone();return K(f,null,l),f}const o=t?.renderer??La(n);let i=o&&"getSymbolAsync"in o?await o.getSymbolAsync(e,t):null;if(!i)return;if(i=i.type==="web-style"?await i.fetchSymbol({...t,cache:t!=null?t.webStyleCache:null}):i.clone(),!o||!("visualVariables"in o)||!o.visualVariables?.length)return K(i,null,l),i;if("arcadeRequiredForVisualVariables"in o&&o.arcadeRequiredForVisualVariables&&t?.arcade==null){const f={...t};f.arcade=await et(),t=f}const{getColor:s,getOpacity:r,getAllSizes:u,getRotationAngle:m}=await import("./visualVariableUtils-BO-_wo28.js").then(f=>f.b),p=[],h=[],y=[],c=[];for(const f of o.visualVariables)switch(f.type){case"color":p.push(f);break;case"opacity":h.push(f);break;case"rotation":c.push(f);break;case"size":f.target||y.push(f)}const d=!!p.length&&p[p.length-1],b=d?s(d,e,t):null,L=!!h.length&&h[h.length-1];let g=L?r(L,e,t):null;if(l!=null&&(g=g!=null?g*l:l),t?.ignoreOpacity&&(g=1),K(i,b,g),y.length&&t?.ignoreSizeVariables!==!0){const f=u(y,e,t);await dt(i,f)}if(t?.ignoreRotationVariables!==!0)for(const f of c)yt(i,m(f,e,t),f.axis);return i}function La(e){if(e)return"renderer"in e?e.renderer:void 0}const va=/^-?(\d+)(\.(\d+))?$/i;function wa(e,t){return e-t}function xa(e,t){let a,n;return a=Number(e.toFixed(t)),a<e?n=a+1/10**t:(n=a,a-=1/10**t),a=Number(a.toFixed(t)),n=Number(n.toFixed(t)),[a,n]}function Aa(e,t,a,n,l){const o=Ne(e,t,a,n),i=o.previous==null||o.previous<=l,s=o.next==null||o.next<=l;return i&&s||o.previous+o.next<=2*l}function ie(e){const t=String(e),a=t.match(va);if(a?.[1])return{integer:a[1].split("").length,fractional:a[3]?a[3].split("").length:0};if(t.toLowerCase().includes("e")){const n=t.split("e"),l=n[0],o=n[1];if(l&&o){const i=Number(l);let s=Number(o);const r=s>0;r||(s=Math.abs(s));const u=ie(i);return r?(u.integer+=s,s>u.fractional?u.fractional=0:u.fractional-=s):(u.fractional+=s,s>u.integer?u.integer=1:u.integer-=s),u}}return{integer:0,fractional:0}}function Ne(e,t,a,n){const l={previous:null,next:null};if(a!=null){const o=e-a,i=t-a-o;l.previous=Math.floor(Math.abs(100*i/o))}if(n!=null){const o=n-e,i=n-t-o;l.next=Math.floor(Math.abs(100*i/o))}return l}function Ma(e,t={}){const a=e.slice(),{tolerance:n=2,strictBounds:l=!1,indexes:o=a.map((i,s)=>s)}=t;o.sort(wa);for(let i=0;i<o.length;i++){const s=o[i],r=a[s],u=s===0?null:a[s-1],m=s===a.length-1?null:a[s+1],p=ie(r).fractional;if(p){let h,y=0,c=!1;for(;y<=p&&!c;){const d=xa(r,y);h=l&&i===0?d[1]:d[0],c=Aa(r,h,u,m,n),y++}c&&(a[s]=h)}}return a}const ka={maximumFractionDigits:20};function Sa(e){return wt(e,ka)}const Oe="<",$e=">";function Ue(e,t,a,n){let l="";return t===0?l=`${Oe} `:t===a&&(l=`${$e} `),l+(n?Mt(e,n):Sa(e))}const za=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function Be(e){if(!("visualVariables"in e)||!e.visualVariables)return null;const t=e.visualVariables.find(i=>i.type==="color");if(!t)return null;let a=null,n=null;if(t.stops){if(t.stops.length===1)return t.stops[0].color;a=t.stops[0].value,n=t.stops[t.stops.length-1].value}const l=a!=null&&n!=null?a+(n-a)/2:0,{getColor:o}=await import("./visualVariableUtils-BO-_wo28.js").then(i=>i.b);return o(t,l)??null}async function Ca(e,t){const a=e.trailCap,n=e.trailWidth||1,l=t||await Be(e)||e.color;return new tt({cap:a,color:l,width:n})}function Za(e,t){if(!t.field)return null;if("featureReduction"in e)switch(e.featureReduction?.type){case"cluster":case"binning":{const a=e.featureReduction.fields.find(({name:n})=>n.toLowerCase()===t.field.toLowerCase());return a&&"getField"in e?e.getField(a.onStatisticField):null}}return"getField"in e?e.getField?.(t.field):null}function Ia(e,t){const a="popupTemplate"in e?e.popupTemplate?.fieldInfos:null;if(a?.length&&t)return a.find(n=>n.fieldName?.toLowerCase()===t.toLowerCase())?.format?.dateFormat}function Va(e,t,a){const n=Za(e,t);if(!n||!At(n)&&!at(n))return null;let l=Ia(e,n.name);if(!l&&n.type==="date"){let o=0,i=0;t.stops?(o=t.stops?.at(0)?.value??o,i=t.stops?.at(-1)?.value??i):"minDataValue"in t&&"maxDataValue"in t&&(o=t.minDataValue??o,i=t.maxDataValue??i),l=i-o>2*xt.days?"short-date":"short-date-short-time"}return{fieldType:n.type,format:l,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in e?e.preferredTimeZone:null,viewTimeZone:a,datesInUnknownTimezone:"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone}}}function ja(e){if("authoringInfo"in e)return e.authoringInfo?.visualVariables?.find(({theme:t})=>t==="reference-size")}const Ra=new z([64,64,64]);function De(e,t){const a=[],n=e.length-1;return e.length===5?a.push(0,2,4):a.push(0,n),e.map((l,o)=>a.includes(o)?Ue(l,o,n,t):null)}async function Fe(e,t,a){let n=!1,l=[],o=[];if(e.stops){const u=e.stops;l=u.map(m=>m.value),n=u.some(m=>!!m.label),n&&(o=u.map(m=>m.label))}const i=l[0],s=l[l.length-1];if(i==null&&s==null)return null;const r=n?null:De(l,a);return(await Promise.all(l.map(async(u,m)=>({value:u,color:e.type==="opacity"?await Ea(u,e,t):(await import("./visualVariableUtils-BO-_wo28.js").then(p=>p.b)).getColor(e,u),label:n?o[m]:r?.[m]??""})))).reverse()}async function Ea(e,t,a){const n=new z(a??Ra),l=(await import("./visualVariableUtils-BO-_wo28.js").then(o=>o.b)).getOpacity(t,e);return l!=null&&(n.a=l),n}function Na(e){let t=!1,a=[],n=[];a=e.map(s=>s.value),t=e.some(s=>!!s.label),t&&(n=e.map(s=>s.label??""));const l=a[0],o=a[a.length-1];if(l==null&&o==null)return null;const i=t?null:De(a);return a.map((s,r)=>({value:s,color:Ge(s,e),label:t?n[r]:i?.[r]??""})).reverse()}function Ge(e,t){const{startIndex:a,endIndex:n,weight:l}=Oa(e,t);if(a===n)return t[a].color;const o=z.blendColors(t[a].color,t[n].color,l);return new z(o)}function Oa(e,t){let a=0,n=t.length-1;return t.some((l,o)=>e<l.value?(n=o,!0):(a=o,!1)),{startIndex:a,endIndex:n,weight:(e-t[a].value)/(t[n].value-t[a].value)}}function $a(e,t){let a=[];if(e&&e.type==="multipart")e.colorRamps.reverse().forEach((n,l)=>{l===0?a.push({value:t.max,color:new z(n.toColor),label:"high"}):a.push({value:null,color:new z(n.toColor),label:""}),l===e.colorRamps.length-1?a.push({value:t.min,color:new z(n.fromColor),label:"low"}):a.push({value:null,color:new z(n.fromColor),label:""})});else{let n,l;e&&e.type==="algorithmic"?(n=e.fromColor,l=e.toColor):(n=[0,0,0,1],l=[255,255,255,1]),a=[{value:t.max,color:new z(l),label:"high"},{value:t.min,color:new z(n),label:"low"}]}return a}function qe(e){if(!e.colorStops)return[];const t=[...e.colorStops].filter(n=>n.color?.a>0);let a=t.length-1;if(t[0]){const n=t[a];n&&n.ratio!==1&&(t.push(new kt({ratio:1,color:n.color})),a++)}return t.map((n,l)=>{let o="";return l===0?o=e.legendOptions?.minLabel||"low":l===a&&(o=e.legendOptions?.maxLabel||"high"),{color:n.color,label:o,ratio:n.ratio}}).reverse()}nt("short-date");async function Z(e,t,a){ot(e,t,()=>[]).push(...a)}async function Ua(e){const t=new Map;if(!e)return t;if("visualVariables"in e&&e.visualVariables){for(const a of e.visualVariables)if(Ba(a)){const n=(await Fe(a)??[]).map(l=>l.color);await Z(t,a.field||a.valueExpression,n)}}if(e.type==="heatmap"){const a=qe(e).map(n=>n.color);await Z(t,e.field||e.valueExpression,a)}else if(e.type==="pie-chart"){for(const a of e.attributes)await Z(t,a.field||a.valueExpression,[a.color]);await Z(t,"default",[e?.othersCategory?.color,N(e.backgroundFillSymbol,null)])}else if(e.type==="dot-density"){for(const a of e.attributes)await Z(t,a.field||a.valueExpression,[a.color]);await Z(t,"default",[e.backgroundColor])}else if(e.type==="unique-value")if(e.authoringInfo?.type==="predominance")for(const a of e.uniqueValueInfos??[])await Z(t,a.value.toString(),[N(a.symbol,null)]);else{const a=(e.uniqueValueInfos??[]).map(s=>N(s.symbol,null)),{field:n,field2:l,field3:o,valueExpression:i}=e;(n||i)&&await Z(t,n||i,a),l&&await Z(t,l,a),o&&await Z(t,o,a)}else if(e.type==="class-breaks"){const a=e.classBreakInfos.map(o=>N(o.symbol,null)),{field:n,valueExpression:l}=e;await Z(t,n??l,a)}else e.type==="simple"&&await Z(t,"default",[N(e.symbol,null)]);return"defaultSymbol"in e&&e.defaultSymbol&&await Z(t,"default",[N(e.defaultSymbol,null)]),t.forEach((a,n)=>{const l=lt(a.filter(Boolean),(o,i)=>JSON.stringify(o)===JSON.stringify(i));t.set(n,l)}),t}function Ba(e){return e.type==="color"}export{be as A,zt as B,Ua as C,Me as E,ke as L,J as M,ba as R,ee as S,Ae as T,ya as V,v as Z,Ne as a,$e as b,ja as c,$t as d,O as e,Ge as f,Na as g,da as h,ie as i,qe as j,$a as k,D as l,Be as m,Re as n,Oe as o,Ca as p,Va as q,Ue as r,za as s,k as t,Ma as u,_ as v,fa as w,Fe as x,Se as y,St as z};
