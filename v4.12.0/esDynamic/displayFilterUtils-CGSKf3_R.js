import{bs as m,bt as N,bu as s,bv as l,bw as S}from"./main-DnzmeE4U.js";function b(t,e){return{...e,filterMode:t.mode}}function x(t,e){return I(t,e).next().value??null}function T(t,e,n){const r=h(t);if(r&&(s(e,r[0])||l(n,r[1])))return"";const u=Array.from(I(t,e,n)),i=p(u,e,n)?"1=1":u.map(o=>o.where||"1=1").reduce((o,f)=>S(o,f),"");return i&&i!=="1=1"?i:""}function h(t){if(d(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:n,maxScale:r}of t.filters)e[0]=Math.max(e[0],a(n)),e[1]=Math.min(e[1],c(r));return e}function*I(t,e,n){if(d(t)==="manual"){const r=t.filters.find(u=>u.id===t.activeFilterId);r&&(yield r)}else{typeof e=="object"&&(e=e.scale);for(const r of t.filters)v(r.minScale,r.maxScale,e,n)&&(yield r)}}function p(t,e,n){if(t.length===0)return!0;const r=a(t.at(0)?.minScale),u=c(t.at(-1)?.maxScale);if(l(r,e)||s(u,n))return!0;for(let i=0;i<t.length-1;i++){const o=t[i],f=t[i+1];if(l(a(f.minScale),c(o.maxScale)))return!0}return!1}function v(t,e,n,r){return t=a(t),n=a(n),e=c(e),!(!m(n,t)&&(r??n)>t)&&!N(e,n)&&(r===void 0||!m(r,t))}function d(t){return"mode"in t?t.mode:t.filterMode}function a(t){return t||Number.POSITIVE_INFINITY}function c(t){return t||0}export{T as c,b as i,x as u};
