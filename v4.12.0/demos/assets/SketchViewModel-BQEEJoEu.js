const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SelfSnappingEngine-Dp6YoUyD.js","./main-D6UWMbWJ.js","./preload-helper-ExcqyqRp.js","./main-DCJluy1C.css","./globalCss-geu-g-r4.js","./Queue-Bp8J9hIN.js","./signal-_szBxGG7.js","./Version-DeyywoNs.js","./quantityUtils-B7WFJP6j.js","./vec2-maR1OrZI.js","./common-DQOJ18NT.js","./geodesicLengthMeasurementUtils-JxSmg9AU.js","./index-BNk7091c.js","./dynamic-import-helper-BheWnx7M.js","./draw-store-BaFsNOTl.js","./GraphicsLayer-dZfMZHiC.js","./GraphicsCollection-B4inrSzy.js","./Layer-CrpAg4i7.js","./TimeExtent-CVFHym4n.js","./ScaleRangeLayer-CANL8iBb.js","./layerContainerType-C5CzMsLd.js","./jsonUtils-BVTTU8XA.js","./parser-BOplPg1_.js","./mat4f32-DcsiF_Rp.js","./mat4-mplESjCB.js","./ElevationInfo-DLPjeENV.js","./lengthUtils-B1iOgQDj.js","./intl-D8pxRaLS.js","./jsxFactory-HPYy2V_L.js","./uuid-Cl5lrJ4c.js","./layerViewUtils-eEg1cHt4.js","./widget-GoJNk-6R.js","./diffUtils-BMpoATJS.js","./UpdatingHandles-CLyw9aof.js","./ViewingMode-HRfKv6NR.js","./vec2f64-DohEyf3f.js","./vec32-DvB22h0L.js","./vec42-CKs01hkn.js","./vec4f64-o2zAXfmz.js","./projection-F5U3p10J.js","./meshVertexSpaceUtils-DurlDegv.js","./MeshLocalVertexSpace-DKI2cxe_.js","./hydratedFeatures-CzW8xS0g.js","./projectVectorToVector-2U_T6yxL.js","./projectPointToVector-CP3mj71q.js","./plane-DXyNbfXV.js","./mat3f64-q3fE-ZOt.js","./mat4f64-Dk4dwAN8.js","./quatf64-aQ5IuZRd.js","./geodesicUtils-CINGW30v.js","./Scheduler-BTF2H21O.js","./geometryEngineBase-8g0RzW7z.js","./_commonjsHelpers-DCkdB7M8.js","./hydrated-C5WzuFt9.js","./mat2d-D9DBP-jx.js","./quat-DOvbuK1U.js","./drapedUtils-gb-eeqgf.js","./utils-BQBvadb7.js","./substitute-CUVC4DC3.js","./Query-VeA4-Qk_.js","./Field-BRKBBmM6.js","./fieldType-B-0DY-YK.js","./sphere-MYAntte_.js","./mat3-CruJiiUv.js","./GridSnappingEngine-DjLy8DAh.js","./normalizeUtils-DSf_eBlh.js","./utils-BIJX9DmY.js","./utils-C6WKisvz.js","./scaleUtils-CNZGIFij.js","./gridUtils-Bk4mKE8P.js","./FeatureSnappingEngine-NML9-Ssr.js","./FeatureFilter-D3D8iaSa.js","./floorFilterUtils-DKzVzLpH.js","./editingTools-6TF3N_Zf.js","./SnappingVisualizer2D-COUVXXCK.js","./enums-BJSSbDkD.js","./automaticAreaMeasurementUtils-DaO87GCA.js","./PointSnappingHint-JorhXB6u.js","./automaticLengthMeasurementUtils-ByRZj4YK.js","./MeshTransform-CchhgBFB.js","./axisAngleDegrees-CXVOOF0w.js","./themeUtils-C3zvZbsE.js","./a11yUtils-m_nLVpnt.js","./unitFormatUtils-P02smIEo.js","./ByteSizeUnit-BsxeN7wM.js","./spatialReferenceEllipsoidUtils-DMIJhMZm.js","./earcut-Lltz9D9k.js","./triangle-C_fuLIxe.js","./lineSegment-o0iVtp8N.js","./editPlaneUtils-__eTupE3.js","./boundedPlane-DFud_aWw.js","./cimSymbolUtils-cqAw9W-o.js","./utils-BRg6PM3S.js","./defaultCIMValues-DII_GG3u.js","./GraphicManipulator-B4yi6CRG.js","./colorUtils-B_grc-3o.js","./drawUtils-cqcDF6ev.js","./editingTools-DGCORr0k.js","./glsl-BH37Aalp.js","./BindType-BBwFZqyN.js","./interfaces-BTl0w-aS.js","./VerticalOffset.glsl-D5YuYROR.js","./Indices-BMQOyMkI.js","./InterleavedLayout-C4yDe4a4.js","./BufferView-xZDqj2K3.js","./renderState-fiZ8Gckm.js","./enums-Dk3osxpS.js","./VertexAttribute-Cq4MnHjR.js","./ShaderOutput-DnYY5J1_.js","./requestImageUtils-BM7ey9Ox.js","./TextureFormat-1mYWTFa-.js","./Texture-pu6CNJho.js","./getDataTypeBytes-DflDeYgv.js","./orientedBoundingBox-CVUzj9sI.js","./computeTranslationToOriginAndRotation-GlDVXUFs.js","./ShaderBuilder-B-d5zQ91.js","./triangulationUtils-BoCFzS-d.js","./deduplicate-CRYsIiZs.js","./RibbonLine.glsl-Cvq4ViYf.js","./HUDVisibility.glsl-C6snQe9Y.js","./doublePrecisionUtils-B0owpBza.js","./vec3f32-nZdmKIgz.js","./Octree-BR9T6Bw4.js","./floatRGBA-DHIIkMjz.js","./HUDMaterial.glsl-Dxe8kmGJ.js","./VertexArrayObject-C1HMYs89.js","./memoryEstimations-bvdrNroi.js","./HighlightDefaults-DUnhEm8s.js","./VertexElementDescriptor-BOD-G50G.js","./NestedMap-CImDozOA.js","./TextOverlayItem-C7eWGZlN.js","./glUtil-BuljoYCz.js","./SelectedVertexTooltipInfo-lLyZrYlB.js","./TranslateTooltipInfo-Bv84G18f.js","./utils-D87Sd27W.js","./LRUCache-CnC3D6GO.js","./MemCache-DvK30feT.js","./IViewEvents-Bci6PjlS.js","./MD5-C9MwAd2G.js","./multiOriginJSONSupportUtils-C0wm8_Yw.js","./ExtentScaleTooltipInfo-BaGan7TU.js","./LineCallout.glsl-BQhPWrO7.js","./heightModelInfoUtils-CUA_JpH_.js","./HeightModelInfo-B3hkwDlh.js","./visualVariableUtils-DqFvxVwV.js","./dehydratedFeatures-Bq9miozI.js","./UniqueValueRenderer-Brw1oZd3.js","./commonProperties-CuupewPf.js","./colorRamps-BUZNTJmj.js","./ColorStop-B1JrXuif.js","./RendererLegendOptions-CGuARK8S.js","./styleUtils-CtFhGPW_.js","./rendererConversion-Bslz-4vn.js","./RealisticTree.glsl-CSD4NU-A.js","./DefaultMaterial-Bw-awx1D.js","./NormalAttribute.glsl-eKv2y2ed.js","./edgeUtils-DufbKcnh.js","./OptimizedFeatureSet-7J4kTonF.js","./OptimizedGeometry-7XEw-Hai.js","./optimizedFeatureQueryEngineAdapter-CfMQcnIF.js","./vec2f32-BbH2jxlN.js","./featureConversionUtils-BOo8MNJa.js","./webStyleAcceptedFormats-CG7ZQ6BV.js","./PooledRBush-bKHZ8Esg.js","./quickselect-QQC62dOK.js","./popupUtils-BDhtPeMe.js","./geometryServiceUtils-CotVVk_3.js","./project-CHAP4FT8.js","./LayerView-BS4FWKIk.js","./GraphicMover-DzheW6kz.js","./featureUtils-B-E6NFqW.js","./utils-Dn8cinQn.js","./timeZoneUtils-BNp2mfEj.js","./Box-CaU6Aepb.js","./settings-BTA9rcUy.js","./Reshape-BVXMlzf1.js"])))=>i.map(i=>d[i]);
import{_ as N}from"./preload-helper-ExcqyqRp.js";import{jW as kn,Z as ft,ab as v,aL as Cn,Q as Nn,T as Dn,fd as Hn,ao as nt,v as c,x as h,J as k,bz as ot,D as Hi,bu as Un,aZ as ve,bR as Vn,b8 as Fn,gd as jn,aW as zn,bG as Ui,a5 as se,cb as qn,ha as Zn,a6 as _e,f7 as Ne,V as Ee,n as Vi,dj as Yn,fL as Bn,eT as Wn,d7 as qt,cZ as Kn,a9 as Jn,U as $t,gR as Qn,eF as Xn,cB as di,f6 as eo,cC as to,ky as io,kz as no,a8 as ui,d8 as Be,a7 as oo,fW as Pt,u as yi,kA as so,fw as ro,kB as Q,cD as gi,s as ao,hc as fi,bF as po,iY as xe,et as vi}from"./main-D6UWMbWJ.js";import{h as lo}from"./UpdatingHandles-CLyw9aof.js";import{i as co,O as Ct,Q as ho,L as uo,k as yo,K as go}from"./projection-F5U3p10J.js";import fo from"./GraphicsLayer-dZfMZHiC.js";import{n as vo}from"./ElevationInfo-DLPjeENV.js";import{t as mo,_ as R,a as _o,b as Eo,c as bo,n as mi}from"./globalCss-geu-g-r4.js";import{o as He,m as Zt}from"./quantityUtils-B7WFJP6j.js";import{e as D,u as wo,q as Fi,d as ie,j as Ge,p as we,l as To,B as So,_ as Oo,o as ji,b as zi,E as _i,L as $o,m as Po}from"./vec2-maR1OrZI.js";import{n as z,t as Xe,l as Ro,m as Go}from"./vec2f64-DohEyf3f.js";import{s as vt,H as O,p as qi,R as V,P as U,q as x,o as ne,c as mt,_ as st,Z as Nt,v as Dt,j as Mo,A as Ao,J as Lo,u as xo,I as Io}from"./vec32-DvB22h0L.js";import{e as Ve,a as Zi,n as rt}from"./projectVectorToVector-2U_T6yxL.js";import{j as at,q as Yt,b as Bt,N as Ht}from"./geodesicUtils-CINGW30v.js";import{g as ko}from"./TimeExtent-CVFHym4n.js";import{b as Co}from"./Query-VeA4-Qk_.js";import{s as No,j as Do}from"./vec42-CKs01hkn.js";import{n as Ho}from"./vec4f64-o2zAXfmz.js";import{M as q,z as Uo,l as _t,Q as Ut,d as Yi,k as Bi,V as Vo,H as Wi,O as Ki,p as Fo}from"./plane-DXyNbfXV.js";import{I as jo,O as zo,_ as qo,$ as Zo,U as Yo}from"./sphere-MYAntte_.js";import{e as Ue}from"./common-DQOJ18NT.js";function Ji(e){return e?Te:os}function Bo(e,t){return t?.mode?t.mode:Ji(e).mode}function Wo(e,t){return t??Ji(e)}function Qi(e,t){return Bo(e==null||(e.hasZ??!1),t)}function Yr(e,t){return Wo(e==null||(e.hasZ??!1),t)}function Ko(e){const t=Xi(e);return Qi(e.geometry,t)}function Jo(e){const t=Xi(e),i=Qi(e.geometry,t),n=t!=null&&i!=="on-the-ground"?ns(t):0,o=t?.featureExpressionInfo;return{mode:i,offset:n,featureExpressionInfo:o}}function Qo(e){return Et(Jo(e))}function Br(e){return Et(e)||Xo(e)}function Xo(e){return e?.featureExpressionInfo?.expression==="0"}function Et(e){if(!e||e.mode==="on-the-ground")return!1;const t=e?.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||t==="0")}function Xi(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function Wt(e,t){if(!e?.offset)return 0;const{offset:i,unit:n}=e;if(n==="decimal-degrees")return 0;const o=n!=="unknown"&&n?n:"meters",s=kn(t);return s?ft(i,o,s):0}function Wr(e,t,i){if(!i?.mode)return;const n=e.hasZ?e.z:0,o=Wt(i,e.spatialReference);switch(i.mode){case"absolute-height":return n-o;case"on-the-ground":return 0;case"relative-to-ground":return n-((t.elevationProvider.getElevation(e.x,e.y,n,e.spatialReference,"ground")??0)+o);case"relative-to-scene":return n-((t.elevationProvider.getElevation(e.x,e.y,n,e.spatialReference,"scene")??0)+o)}}function es(e,t,i,n=null){return Kt(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,i,n)}function en(e,t,i,n,o=null){return Kt(e,t[0],t[1],t.length>2?t[2]:0,i,n,o)}function Kt(e,t,i,n,o,s,a=null){if(s==null)return;const r=a!=null?a.mode:"absolute-height";if(r==="on-the-ground")return 0;const{absoluteZ:l}=ts(t,i,n,o,e,s);return is(l,t,i,n,o,e,a,r)}function ts(e,t,i,n,o,s){const a=Wt(s,n);switch(s.mode){case"absolute-height":return{absoluteZ:i+a,elevation:0};case"on-the-ground":{const r=o.elevationProvider.getElevation(e,t,0,n,"ground")??0;return{absoluteZ:r,elevation:r}}case"relative-to-ground":{const r=o.elevationProvider.getElevation(e,t,i,n,"ground")??0;return{absoluteZ:i+r+a,elevation:r}}case"relative-to-scene":{const r=o.elevationProvider.getElevation(e,t,i,n,"scene")??0;return{absoluteZ:i+r+a,elevation:r}}}}function is(e,t,i,n,o,s,a,r){const l=Wt(a,o);switch(r){case"absolute-height":return e-l;case"relative-to-ground":return e-((s.elevationProvider.getElevation(t,i,n,o,"ground")??0)+l);case"relative-to-scene":return e-((s.elevationProvider.getElevation(t,i,n,o,"scene")??0)+l)}}function Kr(e,t){if(t==null)return!1;const{mode:i}=t;return i!=null&&(e==="scene"&&i==="relative-to-scene"||e==="ground"&&i!=="absolute-height")}function Jr(e,t,i){return i&&i.mode!==t?`${e} only support ${t} elevation mode`:null}function Qr(e,t,i){return i?.mode===t?`${e} do not support ${t} elevation mode`:null}function Xr(e,t){return t?.featureExpressionInfo!=null&&t.featureExpressionInfo.expression!=="0"?`${e} do not support featureExpressionInfo`:null}function ea(e,t){t&&e.warn(".elevationInfo=",t)}function ns(e){return(e?.offset??0)*vo(e?.unit)}const Te={mode:"absolute-height",offset:0},os={mode:"on-the-ground",offset:null};function Rt(e,t){return e[0]*t[1]-e[1]*t[0]}function ss(e,t,i){const n=Ge(i,t)/we(i);return To(e,i,n)}function ta(e,t,i,n,o=i){return D(be,n,i),D(pt,t,o),ss(Pe,pt,be),wo(e,o,Pe)}function ia(e,t,i,n){D(be,t,i);const o=n/Fi(be);return ie(e,i,be,o)}function na(e,t){const i=e.start,n=e.end,o=t.start,s=t.end,a=D(be,n,i),r=D(tn,s,o),l=Rt(a,r);if(Math.abs(l)<=as)return[];const p=D(pt,i,o),d=Rt(r,p)/l,u=Rt(a,p)/l;if(d>=0){if(u>=0||t.type===$.LINE)return[ie(Pe,i,a,d)]}else if(e.type===$.LINE&&(u>=0||t.type===$.LINE))return[ie(Pe,i,a,d)];return[]}function rs(e,t,i){const n=[],o=D(be,e.end,e.start),s=D(tn,e.start,t),a=we(o),r=2*Ge(o,s),l=r*r-4*a*(we(s)-i*i);if(l===0){const p=-r/(2*a);(e.type===$.LINE||p>=0)&&n.push(ie(Pe,e.start,o,p))}else if(l>0){const p=Math.sqrt(l),d=(-r+p)/(2*a);(e.type===$.LINE||d>=0)&&n.push(ie(Pe,e.start,o,d));const u=(-r-p)/(2*a);(e.type===$.LINE||u>=0)&&n.push(ie(pt,e.start,o,u))}return n}var $;(function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"})($||($={}));const as=1e-6,be=z(),tn=z(),pt=z(),Pe=z();function ps(e,t,i,n,o=v()){const s=vt(ls,e);return s[2]=en(n,s,t,i)||0,n.renderCoordsHelper.toRenderCoords(s,t,o),o}const ls=v(),nn="z",on="r",P={redo:on,undo:nn,center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},Ei={toggle:"Control"},oa={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},sa={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:mo,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},editSourcePoints:{key:"Alt",continuePropagation:!0},undo:nn,redo:on};let ra=class{constructor(){this._bindings=new Map}add(t,i){return this.addToggle(t,n=>{n.type==="key-down"&&i(n)})}addToggle(t,i){const n=cs.fromDefinition(t,i),o=Cn(this._bindings,n.key,()=>[]);return o.push(n),Nn(()=>Dn(o,n))}register(t,i=R.WIDGET){return Hn([t.on("key-down",n=>this.dispatch(t.inputManager,n),i),t.on("key-up",n=>this.dispatch(t.inputManager,n),i)])}dispatch(t,i){const n=i.key,o=this._bindings.get(n);if(o)for(const s of o)s.process(t,i)}},cs=class Vt{constructor(t,i,n,o,s){this.key=t,this.modifiers=i,this.repeats=n,this.continuePropagation=o,this.callback=s}process(t,i){if(!(i.key!==this.key||"repeat"in i&&i.repeat&&!this.repeats)){for(const n of this.modifiers)if(!t.isModifierKeyDown(n))return;this.continuePropagation||i.stopPropagation(),this.callback(i)}}static fromDefinition(t,i){if(typeof t=="string")return new Vt(t,[],!1,!1,i);const{key:n,modifier:o,repeats:s,continuePropagation:a}=t;return new Vt(n,o?Array.isArray(o)?o:[o]:[],!!s,!!a,i)}};var Se;function sn(e,t,i){return j(e,t,i)}function j(e=0,t=0,i=0){return nt(e,t,i)}function pa(e){return e}function la(e){return e}function me(e,t,i){return nt(e,t,i)}function Re(e){const[t,i,n]=e;return e.length>3?[t,i,n,e[3]]:[t,i,n]}function Gt(e){return e[3]=((e.length>3?e[3]:void 0)??Se.NONE)|Se.TARGET,e}function ca(e){return!!(((e.length>3?e[3]:void 0)??Se.NONE)&Se.TARGET)}function bi(e,t,{coordinateHelper:i,elevationInfo:n},o){return e?Ce(i.vectorToDehydratedPoint(e,hs),t,n,o):null}function Ce(e,t,i,n=j()){return n[0]=e.x,n[1]=e.y,n[2]=e.z??0,t==null||(t.type==="2d"?n[2]=0:n[2]=es(t,e,i,Te)??0),n}function ha(e,t,i){return i?(Zi(i,e[0],e[1],e[2],t),i):Ve(e[0],e[1],e[2],t)}function wi(e,t,{z:i,m:n},o,s){const{spatialReference:a,elevationInfo:r}=o;let l;i==null&&n==null?l=void 0:t==null||t.type==="2d"?l=i??void 0:l=en(t,e,a,Te,r)??0;const[p,d]=e;return s?Zi(s,p,d,l,a):s=Ve(p,d,l,a),n!=null&&(s.m=n,s.hasM=!0),s}function da(e,t,i,n,o=j()){const[s,a]=e;return o[0]=s,o[1]=a,e.length>3&&(o[3]=e[3]??Se.NONE),i?.type!=="3d"?(o[2]=t.value,o):(o[2]=Kt(i,s,a,t.value,n,t.elevationInfo,Te)??0,o)}(function(e){e[e.NONE=0]="NONE",e[e.TARGET=1]="TARGET"})(Se||(Se={}));const hs=Ve(0,0,0,null);let K=class extends Hi{constructor(){super(...arguments),this.enabled=!0}};c([h({type:Boolean})],K.prototype,"enabled",void 0),K=c([k("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],K);let S=class extends Hi{constructor(t){super(t),this.lineSnapper=new K,this.parallelLineSnapper=new K,this.rightAngleSnapper=new K,this.rightAngleTriangleSnapper=new K,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new ot([255,127,0]),this.orangeTransparent=new ot([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};c([h({type:K,constructOnly:!0,nonNullable:!0,json:{write:!0}})],S.prototype,"lineSnapper",void 0),c([h({type:K,constructOnly:!0,nonNullable:!0,json:{write:!0}})],S.prototype,"parallelLineSnapper",void 0),c([h({type:K,constructOnly:!0,nonNullable:!0,json:{write:!0}})],S.prototype,"rightAngleSnapper",void 0),c([h({type:K,constructOnly:!0,nonNullable:!0,json:{write:!0}})],S.prototype,"rightAngleTriangleSnapper",void 0),c([h({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],S.prototype,"shortLineThreshold",void 0),c([h({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],S.prototype,"distance",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],S.prototype,"pointThreshold",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],S.prototype,"intersectionParallelLineThreshold",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],S.prototype,"parallelLineThreshold",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],S.prototype,"verticalLineThresholdMeters",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],S.prototype,"touchSensitivityMultiplier",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],S.prototype,"pointOnLineThreshold",void 0),c([h({type:ot,nonNullable:!0})],S.prototype,"orange",void 0),c([h({type:ot,nonNullable:!0})],S.prototype,"orangeTransparent",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],S.prototype,"lineHintWidthReference",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],S.prototype,"lineHintWidthTarget",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],S.prototype,"lineHintFadedExtensions",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],S.prototype,"parallelLineHintWidth",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],S.prototype,"parallelLineHintLength",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],S.prototype,"parallelLineHintOffset",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],S.prototype,"rightAngleHintSize",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],S.prototype,"rightAngleHintOutlineSize",void 0),c([h({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],S.prototype,"satisfiesConstraintScreenThreshold",void 0),S=c([k("esri.views.interactive.snapping.Settings.Defaults")],S);const lt=new S;var I;(function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"})(I||(I={}));let bt=class{constructor(t,i){this.isDraped=t,this.domain=i}},ds=class rn extends bt{constructor(t,i,n=I.ALL){super(i,n),this.intersectionPoint=t}equals(t){return t instanceof rn&&O(this.intersectionPoint,t.intersectionPoint)}},oe=class an extends bt{constructor(t,i,n,o,s=I.ALL,a=!0,r=!0){super(o,s),this.type=t,this.lineStart=i,this.lineEnd=n,this.fadeLeft=a,this.fadeRight=r}equals(t){return t instanceof an&&this.type===t.type&&O(this.lineStart,t.lineStart)&&O(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return qi(this.lineStart,this.lineEnd)}},us=class pn extends bt{constructor(t,i,n,o=I.ALL){super(n,o),this.lineStart=t,this.lineEnd=i}equals(t){return t instanceof pn&&O(this.lineStart,t.lineStart)&&O(this.lineEnd,t.lineEnd)}},ln=class cn extends bt{constructor(t,i,n,o,s=I.ALL){super(o,s),this.previousVertex=t,this.centerVertex=i,this.nextVertex=n}equals(t){return t instanceof cn&&O(this.previousVertex,t.previousVertex)&&O(this.centerVertex,t.centerVertex)&&O(this.nextVertex,t.nextVertex)}};function Jt({start:e,end:t,type:i},n,o){const s=[],a=D(Fe,t,e),r=D(wt,e,n),l=we(a),p=2*Ge(a,r),d=p*p-4*l*(we(r)-o*o);if(d===0){const u=-p/(2*l);(i===F.PLANE||u>=0)&&s.push(ie(z(),e,a,u))}else if(d>0){const u=Math.sqrt(d),f=(-p+u)/(2*l);(i===F.PLANE||f>=0)&&s.push(ie(z(),e,a,f));const y=(-p-u)/(2*l);(i===F.PLANE||y>=0)&&s.push(ie(z(),e,a,y))}return s}function hn(e,t){const i=e.start,n=e.end,o=D(Fe,n,i),s=ne(St,-o[1],o[0],0),a=t.start,r=t.end,l=V(Xt,r,a),p=U(l,s),d=ne(_n,i[0],i[1],0),u=V(En,d,a),f=U(u,s),y=Ue();if(Math.abs(p)<y)return[];const g=x(bn,a,l,f/p);if(t.type===$.RAY){const _=V(Ft,g,a);if(U(_,l)<-y)return[]}if(e.type===F.HALF_PLANE){const _=So(wt,g,i);if(Ge(_,o)<-y)return[]}return[ve(g)]}function ys(e,t){return fs(ct(ei,t[2],e),t)}function dn(e,t){return vn(ct(ei,0,e),ct(Es,0,t)).map(([n,o])=>Xe(n,o))}function un(e,t,i){return gn(e,ct(ei,e[2],t),i)}function yn(e,t,i,n=v()){const o=D(Fe,e,t),s=Fi(o);return ie(n,t,o,s===0?1:i/s),n[2]=e[2],n}function gn(e,{start:t,end:i,type:n},o=v()){const s=V(Tt,e,t),a=V(St,i,t),r=U(s,a)/U(a,a);return x(o,t,a,n===$.RAY?Math.max(r,0):r)}const gs=(()=>{const e=v(),t=v(),i=v();return({start:n,end:o},{center:s,radius:a,normal:r,slicePlane:l})=>{const p=_t(s,r,_s);if(w(Ut(p,n),0)&&w(Ut(p,o),0)){Yi(r,e,t);const u=(g,_)=>(mt(i,_,s),ji(g,U(i,e),U(i,t)),g),f=rs({start:u(Fe,n),end:u(wt,o),type:$.LINE},Ro,a),y=[];for(const[g,_]of f){const T=vt(v(),s);x(T,T,e,g),x(T,T,t,_),l&&!fe(l,T)||y.push(T)}return y}const d=v();return Bi(p,n,o,d)?!w(qi(d,s),a)||l&&!fe(l,d)?[]:[d]:[]}})();function fn({start:e,end:t,type:i},n,o){const s=[],a=mt(Tt,t,e),r=D(wt,e,n),l=we(a),p=2*Ge(a,r),d=p*p-4*l*(we(r)-o*o);if(d===0){const u=-p/(2*l);(i===$.LINE||u>=0)&&s.push(x(v(),e,a,u))}else if(d>0){const u=Math.sqrt(d),f=(-p+u)/(2*l);(i===$.LINE||f>=0)&&s.push(x(v(),e,a,f));const y=(-p-u)/(2*l);(i===$.LINE||y>=0)&&s.push(x(v(),e,a,y))}return s}function vn(e,t){const i=e.start,n=e.end,o=t.start,s=t.end,a=V(Tt,n,i),r=V(St,s,o),l=V(Xt,o,i),p=st(_n,a,r);if(!w(U(l,p),0))return[];const d=Nt(p);if(w(d,0))return[];const u=st(En,l,r),f=U(u,p)/d,y=x(bn,i,a,f);if(e.type===$.RAY){const g=V(Ft,y,i);if(U(a,g)<-Ue())return[]}if(t.type===$.RAY){const g=V(Ft,y,o);if(U(r,g)<-Ue())return[]}return[ve(y)]}function fs({start:e,end:t,type:i},n){const o=V(Tt,n,e),s=V(St,t,e),a=st(Xt,s,o),r=Nt(a)/Nt(s),l=Ue();if(r<l)switch(i){case $.LINE:return[ve(n)];case $.RAY:return U(s,o)<-l?[]:[ve(n)]}return[]}function Qt(e,t,i,n){const[o,s]=e,[a,r]=i,l=a-o,p=r-s,d=l*l+p*p,u=Math.sqrt(d);if(u>t+n)return[];if(u<Math.abs(t-n))return[];if(w(u,0)&&w(t,n))return[];const f=(t*t-n*n+d)/(2*u),y=Math.sqrt(t*t-f*f),g=y*p/u,_=y*l/u,[T,E]=Oo(Fe,e,i,f/u);return w(g,_)?[Xe(T,E)]:[Xe(T+g,E-_),Xe(T-g,E+_)]}function ct(e,t,{start:i,end:n,type:o}){return ne(e.start,i[0],i[1],t),ne(e.end,n[0],n[1],t),e.type=ms[o],e}function mn(e,t){return w(e[2],t[2])}function w(e,t){return Un(Math.abs(e-t),0,Ue())}function vs(e,t){return t.filter(i=>fe(e,i))}function fe(e,t){return Uo(e,t)}var F;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})(F||(F={}));const ms={[F.PLANE]:$.LINE,[F.HALF_PLANE]:$.RAY},Fe=z(),wt=z(),Tt=v(),St=v(),Xt=v(),_n=v(),En=v(),bn=v(),Ft=v(),_s=q(),ei={start:v(),end:v(),type:$.LINE},Es={start:v(),end:v(),type:$.LINE};class Y{intersect(t){return re(this,t)}closestPoints(t){return[this.closestTo(t)]}}class Me extends Y{constructor(t){super(),this.point=t}equals(t){return this===t||B(t)&&O(this.point,t.point)}closestTo(){return Re(this.point)}}class ti extends Y{constructor(t,i,n){super(),this.start=t,this.end=i,this.lineLike={start:t,end:i,type:n}}equals(t){return this===t||X(t)&&this.lineLike.type===t.lineLike.type&&O(this.start,t.start)&&O(this.end,t.end)}closestTo(t){const i=j();return gn(t,this.lineLike,i),i}}class ii extends ti{constructor(t,i){super(t,i,$.LINE)}}class bs extends ti{constructor(t,i){super(t,i,$.RAY)}}class wn extends Y{constructor(t){super(),this.constraints=t}equals(t){return this===t||jt(t)&&Fn(this.constraints,t.constraints,(i,n)=>i.equals(n))}closestTo(t){let i,n=1/0;for(const o of this.constraints){const s=o.closestTo(t),a=Dt(t,s);a<n&&(n=a,i=s)}return Re(i??t)}closestPoints(t){return this.constraints.flatMap(i=>i===this?[]:i.closestPoints(t))}}class Tn extends Y{constructor(t,i){super(),this.center=t,this.radius=i}equals(t){return this===t||te(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const i=j();return yn(t,this.center,this.radius,i),i}}class ni extends Y{constructor(t,i){super(),this.center=t,this.radius=i}equals(t){return this===t||pe(t)&&O(this.center,t.center)&&this.radius===t.radius}closestTo(t){const i=j();return yn(t,this.center,this.radius,i),i[2]=this.center[2],i}asCircle(){return new oi(Re(this.center),this.radius,me(0,0,1))}}class oi extends Y{constructor(t,i,n,o=void 0){super(),this.center=t,this.radius=i,this.normal=n,this.slicePlane=o}equals(t){return this===t||ue(t)&&O(this.center,t.center)&&O(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){const{center:i,radius:n}=this;Wi(this.getPlane(ws),t,Mt);const o=V(Mt,Mt,i),s=Mo(o);if(w(s,0))return Re(t);const a=n/Math.sqrt(s),r=j();x(r,i,o,a);const{slicePlane:l}=this;return l&&!fe(l,r)?ri(l,this)?.closestTo(t)??Re(t):r}getPlane(t=q()){return _t(this.center,this.normal,t)}}const Mt=v(),ws=q();class Ts extends Y{constructor(t){super(),this.z=t}equals(t){return this===t||ae(t)&&this.z===t.z}closestTo(t){return me(t[0],t[1],this.z)}getPlane(t=q()){return ne(Ti,0,0,this.z),_t(Ti,zn,t)}}const Ti=v();class si extends Y{constructor(t,i,n){super(),this.start=t,this.end=i,this.planeLike={start:t,end:i,type:n}}equals(t){return this===t||ee(t)&&this.planeLike.type===t.planeLike.type&&O(this.start,t.start)&&O(this.end,t.end)}closestTo(t){const i=j();return un(t,this.planeLike,i),i}closestEndTo(t){const{start:i,end:n}=this.planeLike;return Math.sign(Ge(D(Ss,n,i),D(Os,t,i)))>0?this.end:this.start}getPlane(t=q()){const i=vt(Si,this.end);return i[2]+=1,Fo(this.start,this.end,i,t)}getSlicePlane(t=q()){const{start:i,end:n,type:o}=this.planeLike;if(o===F.PLANE)return;const s=ne(Si,i[0],i[1],0),a=ne(Oi,n[0],n[1],0),r=mt(Oi,a,s);return _t(s,r,t),t}}const Ss=z(),Os=z(),Si=v(),Oi=v();class fa extends si{constructor(t,i){super(t,i,F.HALF_PLANE)}}class Sn extends si{constructor(t,i){super(t,i,F.PLANE)}}class $s extends Y{constructor(t,i){super(),this.sphere=zo(t,i)}equals(t){return this===t||le(t)&&qo(this.sphere,t.sphere)}closestTo(t){const i=j();return Zo(this.sphere,t,i),i}get center(){return Yo(this.sphere)}get radius(){return this.sphere[3]}}class On extends Y{constructor(t,i,n){super(),this.start=t,this.end=i,this.getZ=n,this.planeLike={start:t,end:i,type:F.PLANE}}equals(t){return this===t||ht(t)&&O(this.start,t.start)&&O(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return Ls(this,t)}addIfOnTheGround(t,i){for(const n of i){const o=this.getZ(n[0],n[1])??0;w(n[2],o)&&(n[2]=o,t.push(n))}}}class Ps extends Y{constructor(t,i,n){super(),this._x=t,this._y=i,this._z=n}equals(t){return this===t||Bs(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo([t,i,n]){return sn(this._x??t,this._y??i,this._z??n)}}class Rs extends Y{constructor(t,i,n,o,s){super(),this._origin=t,this._spatialReference=i,this._distanceMeters=n,this._z=o,this._directionDegrees=s}equals(t){return this===t||Ys(t)&&_i(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._z===t._z&&this._directionDegrees===t._directionDegrees}closestTo([t,i,n]){return ji(Ie,t,i),_i(Ie,this._origin)||this._applyDirectionAndDistance(Ie),sn(Ie[0],Ie[1],this._z??n)}_applyDirectionAndDistance(t){if(this._directionDegrees!=null&&this._distanceMeters!=null)at(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Ms(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:i}=Yt(Gs,this._origin,t,this._spatialReference);at(t,this._origin,i??0,this._distanceMeters,this._spatialReference)}}}const Ie=[0,0],Gs=new Bt;function Ms(e,t,i,n,o){let{azimuth:s,distance:a}=Yt(As,t,n,o);s??=0;let r=a*Math.cos((s-i)*co);r=Math.max(0,r),at(e,t,i,r,o)}const As=new Bt;function Ls(e,t){const i=j();return un(t,e.planeLike,i),i[2]=e.getZ(i[0],i[1])??Pn,i}function re(e,t){if(jt(e)){const i=[];for(const n of e.constraints){const o=n.intersect(t);o&&i.push(o)}return ai(i)}if(jt(t))return re(t,e);if(ht(e))return $i(e,t);if(ht(t))return $i(t,e);if(B(e)){const{point:i}=e;if(B(t))return O(i,t.point)?e:void 0;const n=t.closestTo(i);return Lo(n,i)?e:void 0}if(X(e)){if(B(t))return re(t,e);if(X(t))return J(vn(e.lineLike,t.lineLike));if(ae(t))return xs(e,t);if(ee(t))return J(hn(t.planeLike,e.lineLike));if(te(t))return J(fn(e.lineLike,t.center,t.radius));if(ue(t))return J(gs(e.lineLike,t));if(pe(t))return Is(e,t);if(le(t))return ks(e,t)}else if(ae(e)){if(B(t)||X(t))return re(t,e);if(ae(t))return Cs(e,t);if(ee(t))return Ns(e,t);if(te(t))return Ds(e,t);if(ue(t))return Us(e,t);if(pe(t))return Hs(e,t);if(le(t))return Vs(e,t)}else if(ee(e)){if(B(t)||X(t)||ae(t))return re(t,e);if(ee(t))return At(dn(e.planeLike,t.planeLike));if(te(t))return At(Jt(e.planeLike,t.center,t.radius));if(ue(t))return js(e,t);if(pe(t))return Fs(e,t);if(le(t))return zs(e,t)}else if(te(e)){if(B(t)||X(t)||ae(t)||ee(t))return re(t,e);if(te(t))return At(Qt(e.center,e.radius,t.center,t.radius));if(ue(t))return void 0;if(pe(t))return qs(e,t);if(le(t))return void 0}else if(ue(e)){if(B(t)||X(t)||ae(t)||ee(t)||te(t))return re(t,e);if(ue(t))return void 0;if(pe(t))return t.asCircle(),void 0;if(le(t))return void 0}else if(pe(e)){if(B(t)||X(t)||ae(t)||ee(t)||te(t)||ue(t))return re(t,e);if(pe(t))return Zs(t,e);if(le(t))return void 0}else if(le(e)){if(B(t)||X(t)||ae(t)||ee(t)||te(t)||pe(t))return re(t,e);if(le(t))return void 0}}const xs=(()=>{const e=q();return(t,i)=>{const{start:n,end:o}=t;if(mn(n,o)&&w(n[2],i.z))return t;const s=j();return Bi(i.getPlane(e),n,o,s)?new Me(s):void 0}})();function Is({lineLike:e},{center:t,radius:i}){const n=t[2];return J(fn(e,t,i).filter(o=>w(o[2],n)))}function ks({lineLike:e},{sphere:t}){return J(jo(t,e.start,e.end))}const ri=(()=>{const e=Ho(),t=v(),i=v();return(n,o,s)=>{const{normal:a,center:r,radius:l}=o;Yi(a,t,i);const p=Ki(n),d=l*U(p,t),u=l*U(p,i);No(e,r[0],r[1],r[2],1);const f=Do(n,e),y=Math.hypot(d,u),g=w(y,0);if(w(Ut(n,r),0)){if(g)return o;if(w(l,0))return!s||fe(s,r)?new Me(Re(r)):void 0;st(t,p,a),Ao(t,t);const Ot=new Array,Ze=ve(r);x(Ze,Ze,t,l),s&&!fe(s,Ze)||Ot.push(Ze);const Ye=ve(r);return x(Ye,Ye,t,-l),s&&!fe(s,Ye)||Ot.push(Ye),J(Ot)}if(g)return;const _=-f/y;if(Math.abs(_)>1||w(_,1))return;const T=Math.atan(d/u),E=jn(_)-T,Le=Math.PI-E,je=new Array,ze=v();x(ze,r,t,l*Math.cos(E)),x(ze,ze,i,l*Math.sin(E)),je.push(ze);const qe=v();return x(qe,r,t,l*Math.cos(Le)),x(qe,qe,i,l*Math.sin(Le)),je.push(qe),J(s?vs(s,je):je)}})();function Cs(e,t){return w(e.z,t.z)?e:void 0}function Ns({z:e},{planeLike:t}){const[i,n]=t.start,[o,s]=t.end,a=me(i,n,e),r=me(o,s,e);return t.type===F.PLANE?new ii(a,r):new bs(a,r)}function Ds(e,t){const[i,n]=t.center;return new ni(me(i,n,e.z),t.radius)}function Hs(e,t){return w(t.center[2],e.z)?t:void 0}const Us=(()=>{const e=q();return(t,i)=>ri(t.getPlane(e),i,i.slicePlane)})();function Vs(e,{center:t,radius:i}){const n=Math.abs(t[2]-e.z);if(n>i&&!w(n,i))return;const o=me(t[0],t[1],e.z),s=Math.sqrt(i**2-n**2);return w(s,0)?void 0:new ni(o,s)}const Fs=(()=>{const e=q();return(t,{center:i,radius:n})=>{const o=Jt(t.planeLike,i,n),s=i[2];t.getSlicePlane(e);const a=new Array;for(const[r,l]of o){const p=[r,l,s];fe(e,p)&&a.push(p)}return J(a)}})(),js=(()=>{const e=q(),t=q();return(i,n)=>ri(i.getPlane(e),n,i.getSlicePlane(t))})(),zs=(()=>{const e=q();return(t,{center:i,radius:n})=>{const o=t.getPlane(e),s=Vo(o,i),a=Math.abs(s);if(a>n&&!w(a,n))return;const r=Math.sqrt(n**2-s**2);if(w(r,0)){const d=j();return Wi(o,i,d),new Me(d)}const l=j(),p=ve(Ki(o));return x(l,i,p,s),new oi(l,r,p,t.getSlicePlane())}})();function qs(e,t){const i=zi(e.center,t.center);return w(i,0)&&w(e.radius,t.radius)?t:$n(Qt(e.center,e.radius,t.center,t.radius),t.center[2])}function Zs(e,t){if(!mn(e.center,t.center))return;const i=zi(e.center,t.center);return w(i,0)&&w(e.radius,t.radius)?e:$n(Qt(e.center,e.radius,t.center,t.radius),e.center[2])}function $i(e,t){const{planeLike:i,getZ:n}=e,o=new Array;if(B(t))e.addIfOnTheGround(o,ys(i,t.point));else if(X(t))e.addIfOnTheGround(o,hn(i,t.lineLike));else if(te(t))for(const[s,a]of Jt(i,t.center,t.radius)){const r=n(s,a);r!=null&&o.push(nt(s,a,r))}else if(ee(t)||ht(t))for(const[s,a]of dn(i,t.planeLike)){const r=n(s,a)??Pn;o.push(nt(s,a,r))}return J(o)}function At(e){return ai(e.map(([t,i])=>{const n=me(t,i,0),o=me(t,i,1);return new ii(n,o)}))}function J(e){return ai(e.map(t=>t?new Me(t):void 0))}function $n(e,t){return J(e.map(([i,n])=>[i,n,t]))}function ai(e){if(e.length!==0)return e.length===1?e[0]??void 0:new wn(e.filter(Vn))}function jt(e){return e instanceof wn}function B(e){return e instanceof Me}function X(e){return e instanceof ti}function ae(e){return e instanceof Ts}function ee(e){return e instanceof si}function te(e){return e instanceof Tn}function pe(e){return e instanceof ni}function ue(e){return e instanceof oi}function le(e){return e instanceof $s}function ht(e){return e instanceof On}function Ys(e){return e instanceof Rs}function Bs(e){return e instanceof Ps}const Pn=0;var H;function Ws(e,t){if(e==null||t==null)return;const i=zt(e,t);return i!=null?He(i,"radians","geographic"):void 0}(function(e){e.Absolute="absolute",e.Relative="relative",e.RelativeBilateral="relative-bilateral"})(H||(H={}));const zt=(()=>{const e=v(),t=v();return(i,n)=>(ne(e,i.x,i.y,i.z??0),ne(t,n.x,n.y,n.z??0),Ks(e,t,i.spatialReference,n.spatialReference))})(),Ks=(()=>{const e=z(),t=v(),i=v();return(n,o,s,a)=>{if(O(n,o))return;const r=Ht(s),l=Ht(a);if(r&&l&&Ui(r,l)&&rt(n,s,t,r)&&rt(o,a,i,l)){const{azimuth:d}=Yt(Qs,t,i,r);return d!=null?ft(d,"degrees","radians"):void 0}e[0]=o[0]-n[0],e[1]=o[1]-n[1];let p=$o(Go,e);return e[0]<0&&(p=Xs-p),p}})();function va(e,t,i,n=H.Absolute){if(t&&i)switch(n){case H.Absolute:return Ws(t,i);case H.Relative:return Ri(Pi(e,t,i),H.Relative);case H.RelativeBilateral:return Ri(Pi(e,t,i),H.RelativeBilateral)}}function Pi(e,t,i){if(!e||!t||!i)return;const n=zt(e,t),o=zt(t,i);return n!=null&&o!=null?He(o-n,"radians","geographic"):void 0}function Ri(e,t){if(e!=null)switch(t){case H.Absolute:return Js(e);case H.Relative:{const i=dt(e);let n=Gi.normalize(i,0,!0);return n===-180&&(n=180),He(n,"degrees","geographic")}case H.RelativeBilateral:{const i=dt(e),n=Math.abs(Gi.normalize(i,0,!0));return He(n,"degrees","geographic")}}}function Js(e){const t=dt(e),i=er.normalize(t,0,!0);return He(i,"degrees","geographic")}const ma=(()=>{const e=v();return(t,i,n,o,s,a="geodesic")=>{vt(e,i);const r=dt(s);if(a==="geodesic"){const y=Ht(n);if(y&&rt(e,n,e,y))return at(t,e,r,o,y),t[2]=i[2],!!rt(t,y,t,n)}const l=Zt(r,"geographic","arithmetic"),p=ft(l,"degrees","radians"),d=i[0]+o*Math.cos(p),u=i[1]+o*Math.sin(p),f=i[2];return ne(t,d,u,f),!0}})();function dt(e){if(e!=null)return Zt(Rn(e),e.rotationType,"geographic")}function _a(e){if(e!=null)return Zt(Rn(e),e.rotationType,"arithmetic")}function Rn(e){return ft(e.value,e.unit,"degrees")}const Qs=new Bt,Xs=2*Math.PI,er=_o,Gi=new Eo(-180,180);let et=class extends se{constructor(t){super(t),this.enabled=!1}};c([h({type:Boolean,nonNullable:!0})],et.prototype,"enabled",void 0),et=c([k("esri.views.interactive.sketch.SketchLabelOptions")],et);const pi=et,ba=Symbol("grid-placement-graphic");function Gn(e,t){const i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function wa(e,t){return Math.sqrt(Gn(e,t))}function tr(e,t){t.sort((i,n)=>Dt(i.targetPoint,e)-Dt(n.targetPoint,e))}var Z;function Ta({point:e,distance:t,returnEdge:i,vertexMode:n,coordinateHelper:{spatialReference:o},filter:s},a,r){return r=r!=null?r.clone():new Co({where:"1=1"}),s&&(r.geometry=s.geometry,r.distance=s.distance,r.spatialRelationship=s.spatialRelationship,r.where=qn(r.where,s.where),r.timeExtent=ko(r.timeExtent,s.timeExtent),r.objectIds=ir(r.objectIds,s.objectIds)),{point:Ve(e[0],e[1],e[2],o.toJSON()),mode:a,distance:t,returnEdge:i,vertexMode:n,query:r.toJSON()}}function ir(e,t){return e||t?t?e?Array.from(Zn(new Set(e),new Set(t))):t:e:null}function Sa(e,t,i){return{left:bi(e.leftVertex.pos,t,i),right:bi(e.rightVertex.pos,t,i)}}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(Z||(Z={}));const Mi=Symbol("snapping-toggle");function nr(e,t=()=>{}){const i=_e(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:n,snappingOptions:o})=>{if(e.removeHandles(Mi),!n||!o)return;const s=R.TOOL,a=[n.on("key-down",r=>{r.key!==Ei.toggle||r.repeat||(o.enabledToggled=!0,t())},s),n.on("key-up",r=>{r.key===Ei.toggle&&(o.enabledToggled=!1,t())},s),n.on("pointer-move",r=>{const l=r.native.ctrlKey;o.enabledToggled!==l&&(o.enabledToggled=l,t())},s)];e.addHandles(a,Mi)},Ne);e.addHandles(i)}function Oa(e){return bo(e)&&"utilityNetworks"in e&&!!e.utilityNetworks?.length}let De=class extends se{constructor(t){super(t),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};c([h({type:String,nonNullable:!0})],De.prototype,"mode",void 0),De=c([k("esri.views.interactive.sketch.SketchTooltipElevationOptions")],De);let L=class extends se{constructor(t){super(t),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};c([h({type:Boolean,nonNullable:!0})],L.prototype,"area",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"coordinates",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"direction",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"distance",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"elevation",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"header",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"helpMessage",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"orientation",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"radius",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"rotation",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"scale",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"size",void 0),c([h({type:Boolean,nonNullable:!0})],L.prototype,"totalLength",void 0),L=c([k("esri.views.interactive.sketch.SketchTooltipVisibleElements")],L);const Mn=L;let C=class extends se{constructor(t){super(t),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new De,this.placement="auto",this.offset=null,this.visibleElements=new Mn,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};c([h({type:Boolean,nonNullable:!0})],C.prototype,"enabled",void 0),c([h()],C.prototype,"forceEnabled",void 0),c([h()],C.prototype,"effectiveEnabled",null),c([h()],C.prototype,"helpMessage",void 0),c([h()],C.prototype,"helpMessageIcon",void 0),c([h({type:Boolean,nonNullable:!0})],C.prototype,"inputEnabled",void 0),c([h({type:De,nonNullable:!0})],C.prototype,"elevation",void 0),c([h()],C.prototype,"placement",void 0),c([h()],C.prototype,"offset",void 0),c([h({type:Mn,nonNullable:!0})],C.prototype,"visibleElements",void 0),c([h()],C.prototype,"visualVariables",void 0),c([h()],C.prototype,"xyMode",void 0),C=c([k("esri.views.interactive.sketch.SketchTooltipOptions")],C);const li=C;let Oe=class extends se{constructor(t){super(t),this.length=null,this.verticalLength=null,this.area=null}};c([h()],Oe.prototype,"length",void 0),c([h()],Oe.prototype,"verticalLength",void 0),c([h()],Oe.prototype,"area",void 0),Oe=c([k("esri.views.interactive.sketch.Units")],Oe);const ut=Oe;let ye=class extends se{constructor(t){super(t),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?H.RelativeBilateral:H.Relative;case"absolute":return H.Absolute}}get displayUnits(){return this._get("displayUnits")??new ut}set displayUnits(t){this._set("displayUnits",t)}get inputUnits(){return this._get("inputUnits")??new ut}set inputUnits(t){this._set("inputUnits",t)}};c([h({type:String,nonNullable:!0})],ye.prototype,"directionMode",void 0),c([h({type:Boolean,nonNullable:!0})],ye.prototype,"relativeDirectionIsBilateral",void 0),c([h()],ye.prototype,"effectiveDirectionMode",null),c([h({type:ut,nonNullable:!0})],ye.prototype,"displayUnits",null),c([h({type:ut,nonNullable:!0})],ye.prototype,"inputUnits",null),ye=c([k("esri.views.interactive.sketch.SketchValueOptions")],ye);const ci=ye;let ge=class extends se{constructor(t){super(t),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new Ee}};c([h({constructOnly:!0})],ge.prototype,"layer",void 0),c([h()],ge.prototype,"enabled",void 0),c([h()],ge.prototype,"updating",void 0),c([h()],ge.prototype,"availability",void 0),c([h()],ge.prototype,"sublayerSources",void 0),ge=c([k("esri.views.interactive.snapping.FeatureSnappingLayerSource")],ge);const An=ge;let M=class extends se{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new Ee,this.distance=lt.distance,this.touchSensitivityMultiplier=lt.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){const e=this.featureSources;e.some(Ai)&&Vi.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const t=e.filter(sr),i=this._get("_effectiveFeatureSources")?.filter(Ai)??new Ee;for(const r of t){const l=i.find(p=>p.layer===r.layer.parent);if(l)l.sublayerSources.includes(r)||l.sublayerSources.add(r);else if(r.layer.parent){const p=new An({layer:r.layer.parent});p.sublayerSources.add(r),i.add(p)}}for(const r of i){const l=r.sublayerSources.filter(p=>!t.includes(p));r.sublayerSources.removeMany(l)}i.removeMany(i.filter(r=>r.sublayerSources.length===0));const n=e.filter(or),o=this._get("_effectiveFeatureSources")??new Ee,{added:s,removed:a}=Yn(o.toArray(),[...n,...i]);return o.removeMany(a),o.addMany(s),o}};c([h()],M.prototype,"enabled",void 0),c([h()],M.prototype,"enabledToggled",void 0),c([h()],M.prototype,"forceDisabled",void 0),c([h()],M.prototype,"selfEnabled",void 0),c([h()],M.prototype,"featureEnabled",void 0),c([h()],M.prototype,"gridEnabled",void 0),c([h()],M.prototype,"attributeRulesEnabled",void 0),c([h({type:Ee.ofType(An)})],M.prototype,"featureSources",void 0),c([h()],M.prototype,"distance",void 0),c([h()],M.prototype,"touchSensitivityMultiplier",void 0),c([h({readOnly:!0})],M.prototype,"effectiveEnabled",null),c([h({readOnly:!0})],M.prototype,"effectiveGridEnabled",null),c([h({readOnly:!0})],M.prototype,"effectiveSelfEnabled",null),c([h({readOnly:!0})],M.prototype,"effectiveFeatureEnabled",null),c([h({readOnly:!0})],M.prototype,"_effectiveFeatureSources",null),M=c([k("esri.views.interactive.snapping.SnappingOptions")],M);const hi=M;function Ai(e){return e.layer.type==="subtype-group"}function or(e){return e.layer.type!=="subtype-group"}function sr(e){return e.layer.type==="subtype-sublayer"}function rr(e){return e?.type==="graphic"}function ar(e){return e.find(rr)??null}class Ae{constructor(t,i,n,o){this.targetPoint=t,this.constraint=i,this.isDraped=n,this.domain=o}}let Ln=class extends Ae{constructor({targetPoint:t,objectId:i,constraint:n,isDraped:o}){super(t,n,o,I.FEATURE),this.objectId=i}},pr=class extends Ln{constructor(t){super({...t,isDraped:!0,constraint:new On(t.edgeStart,t.edgeEnd,t.getGroundElevation)})}get hints(){return[new oe(Z.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},lr=class extends Ln{constructor(t){super({...t,constraint:new ii(t.edgeStart,t.edgeEnd)})}get hints(){return[new oe(Z.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},tt=class extends Ae{constructor(t,i,n,o){super(t,new Me(t),o,I.ALL),this.first=i,this.second=n}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new ds(this.targetPoint,this.isDraped,this.domain)]}},cr=class extends Ae{constructor({lineStart:t,lineEnd:i,targetPoint:n,isDraped:o}){super(n,new Sn(t,i),o,I.SELF),this._referenceLineHint=new oe(Z.REFERENCE_EXTENSION,t,i,o,this.domain)}get hints(){return[this._referenceLineHint,new oe(Z.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}},hr=class extends Ae{constructor({referenceLine:t,lineStart:i,targetPoint:n,isDraped:o}){const s=ve(i),{left:a,right:r}=t;mt(s,xo(s,s,r),a),super(n,new Sn(i,s),o,I.SELF),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new oe(Z.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new us(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(t=>new oe(Z.REFERENCE,t.edge.left,t.edge.right,this.isDraped,this.domain,t.fadeLeft,t.fadeRight))]}addReferenceLine(t){const i={edge:t,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(n=>{O(t.right,n.edge.left)&&(n.fadeLeft=!1,i.fadeRight=!1),O(t.right,n.edge.right)&&(n.fadeRight=!1,i.fadeRight=!1),O(t.left,n.edge.right)&&(n.fadeRight=!1,i.fadeLeft=!1),O(t.left,n.edge.left)&&(n.fadeLeft=!1,i.fadeLeft=!1)}),this._referenceLines.push(i)}},dr=class extends Ae{constructor({targetPoint:t,constraint:i,previousVertex:n,otherVertex:o,otherVertexType:s,isDraped:a,selfSnappingType:r,objectId:l,domain:p}){super(t,i,a,p??I.SELF),this.previousVertex=n,this.otherVertex=o,this.otherVertexType=s,this.selfSnappingType=r??gt.None,this.objectId=l??null}get hints(){const t=this.previousVertex,i=this.otherVertexType===yt.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===yt.CENTER?this.targetPoint:this.otherVertex;return[new oe(Z.TARGET,i,n,this.isDraped,this.domain),new oe(Z.REFERENCE,t,i,this.isDraped,this.domain),new ln(this.previousVertex,i,n,this.isDraped,this.domain)]}};var yt,gt;(function(e){e[e.NEXT=0]="NEXT",e[e.CENTER=1]="CENTER"})(yt||(yt={})),function(e){e[e.None=0]="None",e[e.LastVertex=1]="LastVertex",e[e.FirstVertex=2]="FirstVertex",e[e.ExistingEdge=3]="ExistingEdge"}(gt||(gt={}));class ur extends Ae{constructor({targetPoint:t,point1:i,point2:n,isDraped:o}){super(t,new Tn(Io(v(),i,n,.5),.5*Po(i,n)),o,I.SELF),this._p1=i,this._p2=n}get hints(){return[new oe(Z.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new oe(Z.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new ln(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}function yr(e,t,i,n){return n.type==="2d"?(We.x=e[0],We.y=e[1],We.spatialReference=t,n.toScreen(We)):(ps(e,t,i,n,Li),n.state.camera.projectToScreen(Li,Lt),Bn(Lt[0],Lt[1]))}const We=Ve(0,0,0,null),Li=v(),Lt=Wn();let W=class extends qt.EventedMixin(se){constructor(e){super(e),this.options=new hi,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=ce.MAIN}initialize(){this.addHandles([_e(()=>{const{distance:e,touchSensitivityMultiplier:t,effectiveSelfEnabled:i,effectiveFeatureEnabled:n,effectiveGridEnabled:o}=this.options;return{selfEnabled:i,featureEnabled:n,gridEnabled:this.view.type==="2d"&&o,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:e,touchSensitivityMultiplier:t}},(e,t)=>{t&&(this.doneSnapping(),this.emit("changed")),this._loadTask?.abort(),this._loadTask=Kn(i=>this._updateEngines(e,t,i))},Ne),_e(()=>this.options,e=>{for(const t of this._engines)t.options=e},Jn)])}destroy(){this._loadTask?.abort(),this._destroyEngines()}get updating(){return this._engines.some(e=>e.updating)||!this._loadTask?.finished}_destroyEngines(){this._engineCache.forEach(e=>e.destroy()),this._engineCache.clear(),this._engines=[]}async _updateEngines(e,t,i){if(!e.viewReady)return void this._destroyEngines();t?.viewSpatialReference!==e.viewSpatialReference&&this._destroyEngines();const n=this._engineCache,o=await Promise.allSettled([e.featureEnabled&&!n.has("feature")?this._createFeatureSnappingEngine(i):void 0,e.selfEnabled&&!n.has("self")?this._createSelfSnappingEngine(i):void 0,e.gridEnabled&&!n.has("grid")?this._createGridSnappingEngine(i):void 0]);if(i.aborted)for(const s of o)s.status==="fulfilled"&&s.value?.engine.destroy();else{for(const s of o)s.status==="fulfilled"&&s.value&&n.set(s.value.type,s.value.engine);this._engines=Array.from(n.values())}}async _createSelfSnappingEngine(e){const{SelfSnappingEngine:t}=await N(()=>import("./SelfSnappingEngine-Dp6YoUyD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63]),import.meta.url);return $t(e),{type:"self",engine:new t({view:this.view,options:this.options})}}async _createGridSnappingEngine(e){const{view:t}=this;if(t.type!=="2d")return;const{GridSnappingEngine:i}=await N(()=>import("./GridSnappingEngine-DjLy8DAh.js"),__vite__mapDeps([64,1,2,3,36,10,39,65,66,67,68,69,49,33,15,16,17,18,19,20,21,22,23,24,25,26,4,5,6,7,8,9,35,43,44,59,60,61,37,38,45,46,47,48,62,63]),import.meta.url);return $t(e),{type:"grid",engine:new i({view:t,options:this.options})}}async _createFeatureSnappingEngine(e){const{FeatureSnappingEngine:t}=await N(()=>import("./FeatureSnappingEngine-NML9-Ssr.js"),__vite__mapDeps([70,2,1,3,9,10,36,33,71,59,60,61,18,72,30,39,15,16,17,19,20,21,22,23,24,25,26,4,5,6,7,8,35,43,44,49,37,38,45,46,47,48,62,63]),import.meta.url);$t(e);const{view:i,options:n}=this,{spatialReference:o}=i;return{type:"feature",engine:new t({view:i,options:n,spatialReference:o})}}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}snap(e){return vr(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:i}=e;this._removeVisualization();const n=this._currentMainCandidate;if(n==null)return t;const o=this._selectUpdateInput(e);if(o==null)return t;const{spatialReference:s}=i,a=Ct(o,s);if(a==null)return t;const{view:r}=this,{elevationInfo:l,visualizer:p}=i,d=[],u=Ce(a,r,l),f=n.constraint.closestTo(u);if(!this._arePointsWithinScreenThreshold(u,f,i)||!It(n,i.drawConstraints))return this._resetSnappingState(),t;n.targetPoint=Gt(f),d.push(...n.hints);for(const y of this._currentOtherActiveCandidates)It(y,i.drawConstraints)&&(y.targetPoint=Gt(f),d.push(...y.hints));return p!=null&&this.addHandles(p.draw(d,{spatialReference:s,elevationInfo:mr(i),view:r,selfSnappingZ:i.selfSnappingZ}),xt),wi(f,r,t,i)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:t}){switch(this._currentSnappedType){case ce.MAIN:return e;case ce.SCENE:return t}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=ce.MAIN}_removeVisualization(){this.removeHandles(xt)}async _snapSinglePoint({point:e,context:t,signal:i}){const{view:n}=this,{elevationInfo:o}=t,s=Ce(e,n,o),a=await this._fetchCandidates(s,I.ALL,t,i);return this._createSnapResult(s,ce.MAIN,a,n,e,t,i)}async _snapMultiPoint({point:e,scenePoint:t,context:i,signal:n}){const{view:o}=this,{coordinateHelper:s,elevationInfo:a,spatialReference:r}=i;await ho(t.spatialReference,r);const l=Ct(t,r),p=Ce(l,o,a),d=await this._fetchCandidates(p,I.FEATURE,i,n);if(d.length>0){const y=await this._fetchCandidates(p,I.SELF,i,n);return this._createSnapResult(p,ce.SCENE,[...d,...y],o,l,i,n)}const u=Ce(e,o,a),f=await this._fetchCandidates(u,I.SELF,i,n);return this._createSnapResult(u,ce.MAIN,f,o,{z:s.hasZ()&&e.hasZ?e.z??0:void 0,m:s.hasM()&&e.hasM?e.m??0:void 0},i,n)}async _fetchCandidates(e,t,i,n){return(await Promise.all(this._engines.map(o=>o.fetchCandidates(e,t,i,n)))).flat()}_createSnapResult(e,t,i,n,o,s,a){return{get valid(){return!Qn(a)},apply:()=>{const{spatialReference:r}=s,{snappedPoint:l,hints:p}=this._processCandidates(e,t,i,s);return this._removeVisualization(),s.visualizer!=null&&this.addHandles(s.visualizer.draw(p,{spatialReference:r,elevationInfo:Te,view:n,selfSnappingZ:s.selfSnappingZ}),xt),wi(l,n,o,s)}}}_processCandidates(e,t,i,n){if(i.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),tr(e,i);const o=this._currentMainCandidate;if(o!=null){const s=fr(o,i);if(s>=0){if(!(i[s]instanceof tt))return this._intersectWithOtherCandidates(s,i,e,t,n);if(this._arePointsWithinScreenThreshold(e,o.targetPoint,n))return this._updateSnappingCandidate(o,t,i,n)}}return this._intersectWithOtherCandidates(0,i,e,t,n)}_intersectWithOtherCandidates(e,t,i,n,o){const{coordinateHelper:s}=o,a=t[e],r=[];for(let l=0;l<t.length;++l){if(l===e)continue;const p=t[l],d=a.constraint.intersect(p.constraint);if(d)for(const u of d.closestPoints(a.targetPoint))r.push([new tt(Gt(u),a,p,p.isDraped),this._squaredScreenDistance(i,u,s)])}return r.length>0&&(r.sort((l,p)=>l[1]-p[1]),r[0][1]<this._squaredPointProximityThreshold(o.pointer))?this._updateSnappingCandidate(r[0][0],n,t,o):It(a,o.drawConstraints)?this._updateSnappingCandidate(a,n,t,o):{snappedPoint:i,hints:[]}}_updateSnappingCandidate(e,t,i,n){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const o=this._currentMainCandidate.targetPoint,s=[];s.push(...e.hints);for(const a of i){if(e instanceof tt){if(a.constraint.equals(e.first.constraint)||a.constraint.equals(e.second.constraint))continue}else if(a.constraint.equals(e.constraint))continue;const r=a.constraint.closestTo(o);this._squaredScreenDistance(r,o,n.coordinateHelper)<gr()&&(a.targetPoint=o,this._currentOtherActiveCandidates.push(a),s.push(...a.hints))}return{snappedPoint:o,hints:s}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,t,i){return this._squaredScreenDistance(e,t,i.coordinateHelper)<this._squaredPointProximityThreshold(i.pointer)}_squaredScreenDistance(e,t,i){return Gn(this._toScreen(e,i),this._toScreen(t,i))}_toScreen(e,t){return yr(e,t.spatialReference,Te,this.view)}get test(){}};var ce;c([h({constructOnly:!0})],W.prototype,"view",void 0),c([h()],W.prototype,"options",void 0),c([h({readOnly:!0})],W.prototype,"updating",null),c([h()],W.prototype,"_loadTask",void 0),c([h()],W.prototype,"_engines",void 0),c([h()],W.prototype,"_squaredMouseProximityThreshold",null),c([h()],W.prototype,"_squaredTouchProximityThreshold",null),W=c([k("esri.views.interactive.snapping.SnappingManager")],W),function(e){e[e.MAIN=0]="MAIN",e[e.SCENE=1]="SCENE"}(ce||(ce={}));const xt="visualization-handle";function gr(){return lt.satisfiesConstraintScreenThreshold*lt.satisfiesConstraintScreenThreshold}function It(e,t){return!t||t.direction==null&&t.distance==null||!(e instanceof pr||e instanceof lr||e instanceof cr||e instanceof hr||e instanceof ur)&&(!(e instanceof dr)||t.direction==null&&e.selfSnappingType===gt.LastVertex)}function fr(e,t){return e instanceof tt?kt(t,e.first)>=0&&kt(t,e.second)>=0?0:-1:kt(t,e)}function kt(e,t){let i=-1;for(let n=0;n<e.length;++n)if(t.constraint.equals(e[n].constraint)){i=n;break}return i}function vr(e){return e.scenePoint!=null}function mr({coordinateHelper:e,elevationInfo:t}){return e.hasZ()?Te:t}let $e=class extends se{constructor(e){super(e),this.labels=new pi,this.tooltips=new li,this.values=new ci}};c([h({nonNullable:!0,type:pi})],$e.prototype,"labels",void 0),c([h({nonNullable:!0,type:li})],$e.prototype,"tooltips",void 0),c([h({nonNullable:!0,type:ci})],$e.prototype,"values",void 0),$e=c([k("esri.views.interactive.sketch.SketchOptions")],$e);const xn=$e;function xi(e,t,i){if(!t||!e?.map)return;const{map:n}=e,o=n.layers.find(s=>s===t);o||n.add(t,i),o&&i!=null&&n.layers.reorder(o,i)}function Ha(e,t){const i=t?.type==="subtype-sublayer"?t.parent:t;return e.allLayerViews.find(n=>{const o=n.layer;return o===i||"sublayers"in o&&o.sublayers!=null&&o.sublayers.includes(i)})}function _r(e,t){return t==="freehandPolygon"||t==="freehandPolyline"?"freehand":e??(t==="rectangle"||t==="circle"?"hybrid":"click")}function Er(e){switch(e){case"freehandPolygon":return"polygon";case"freehandPolyline":return"polyline";default:return e}}var Ii;(function(e){e[e.ForceCollapse=-1]="ForceCollapse",e[e.Low=0]="Low",e[e.Medium=10]="Medium",e[e.High=100]="High",e[e.Max=1e3]="Max"})(Ii||(Ii={}));function ki(e){switch(e){case b.SUPPORTED:break;case b.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case b.GEOMETRY_MISSING:return"no geometry";case b.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case b.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case b.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var b;(function(e){e[e.SUPPORTED=0]="SUPPORTED",e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(b||(b={}));function br(e){if(e.graphic&&e.graphic.layer?.type!=="graphics")return b.GRAPHICS_LAYER_MISSING;const t=e.operations?.data.type;if(!t)return b.GEOMETRY_TYPE_UNSUPPORTED;switch(t){case"polygon":case"point":case"polyline":case"mesh":break;default:return b.GEOMETRY_TYPE_UNSUPPORTED}const i=e.elevationInfo;return Et(i)?b.ELEVATION_MODE_UNSUPPORTED:b.SUPPORTED}function wr(e){return Tr(e).result}function Tr(e){if(e.graphic&&e.graphic.layer?.type!=="graphics")return{result:b.GRAPHICS_LAYER_MISSING};if(!e.operations)return{result:b.GEOMETRY_MISSING};if(Et(e.elevationInfo))return{result:b.ELEVATION_MODE_UNSUPPORTED};const t=e.operations.data.type,i=e.operations.data.geometry;return t==="point"||t==="mesh"||t==="polyline"||t==="polygon"?{result:b.SUPPORTED,geometry:i}:{result:b.GEOMETRY_TYPE_UNSUPPORTED}}function Sr(e){if(e.layer?.type!=="graphics")return b.GRAPHICS_LAYER_MISSING;if(e.geometry==null)return b.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return b.SUPPORTED;default:return b.GEOMETRY_TYPE_UNSUPPORTED}const t=e.symbol!=null&&e.symbol.type==="point-3d"&&e.symbol.symbolLayers;return!t||!t.some(i=>i.type==="object")?b.SYMBOL_TYPE_UNSUPPORTED:Ko(e)!=="on-the-ground"&&Qo(e)?b.ELEVATION_MODE_UNSUPPORTED:b.SUPPORTED}let A=class extends qt.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:Xn(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};c([h()],A.prototype,"activeComponent",void 0),c([h()],A.prototype,"cancelled",void 0),c([h()],A.prototype,"history",void 0),c([h()],A.prototype,"tool",null),c([h()],A.prototype,"type",void 0),c([h()],A.prototype,"canUndo",null),c([h()],A.prototype,"canRedo",null),c([h()],A.prototype,"onEnd",void 0),c([h()],A.prototype,"undo",null),c([h()],A.prototype,"redo",null),c([h()],A.prototype,"toggleTool",void 0),c([h()],A.prototype,"addToSelection",void 0),c([h()],A.prototype,"removeFromSelection",void 0),A=c([k("esri.widgets.Sketch.support.OperationHandle")],A);let it=class extends A{};c([h()],it.prototype,"activeComponent",void 0),it=c([k("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],it);let he=class extends A{};c([h()],he.prototype,"activeComponent",void 0),he=c([k("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],he);const Ci={defaultZ:0},ke={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let m=class extends qt.EventedAccessor{constructor(e){super(e),this._defaultSnappingManager=null,this._updatingHandles=new lo,this._internalGraphicsLayer=new fo({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new di({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new eo({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new to({color:[130,130,130,1],width:2}),this.meshSymbol=new io({symbolLayers:new Ee([new no])}),this.updateGraphics=new Ee,this.updateOnGraphicClick=!0,this.creationMode="single",this.vertexSymbol=new di({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new xn,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._sketchContinuationFlag=!1,this._originalPopupEnabled=null,this.defaultCreateOptions=Ci,this.defaultUpdateOptions=ke,this.snappingOptions=e?.snappingManager?.options??e?.snappingOptions??new hi}initialize(){this.addHandles([ui(()=>this.view?.map?.layers,"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),ui(()=>this.layer?.graphics,"change",e=>{if(this._operationHandle!=null)for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())}),_e(()=>this.layer?.elevationInfo??null,e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},Ne),_e(()=>this.view,e=>{this._defaultSnappingManager=Be(this._defaultSnappingManager),e&&(this.snappingManager||(this._defaultSnappingManager=new W({view:e,options:this.snappingOptions})),e.type==="2d"?N(()=>import("./editingTools-6TF3N_Zf.js"),__vite__mapDeps([73,1,2,3,74,9,10,35,75,76,77,36,8,78,27,79,24,47,55,46,48,37,80,40,41,81,28,29,82,12,13,14,15,16,17,18,19,20,21,22,23,25,26,4,5,6,7,30,31,32,33,34,38,39,42,43,44,45,49,50,51,52,53,54,56,57,58,83,84,85,11,86,87,62,63,88,89,90,91,92,93,94,95,96,59,60,61]),import.meta.url):e.type==="3d"&&(N(()=>import("./editingTools-DGCORr0k.js").then(t=>t.e),__vite__mapDeps([97,9,10,35,98,99,1,2,3,100,38,39,101,47,36,102,103,104,37,87,62,24,63,46,45,48,88,105,106,107,108,26,90,34,109,110,111,6,112,113,55,85,114,115,116,86,117,118,119,120,121,40,41,43,44,42,122,25,123,124,125,126,80,127,128,129,50,95,27,78,8,79,81,28,29,82,12,13,14,15,16,17,18,19,20,21,22,23,4,5,7,30,31,32,33,49,51,52,53,54,56,57,58,83,84,11,130,131,76,77,89,132,133,134,91,92,93,75,135,136,137,138,139,140,94]),import.meta.url),N(()=>import("./LineCallout.glsl-BQhPWrO7.js").then(t=>t.G),__vite__mapDeps([141,1,2,3,142,143,44,39,43,118,36,10,38,113,63,46,47,55,48,37,85,114,24,45,35,34,101,102,103,104,9,87,62,88,105,106,107,108,99,98,26,90,109,110,111,6,112,119,120,121,40,41,42,122,25,123,115,32,33,17,18,144,59,60,61,136,145,126,50,146,147,148,149,150,151,152,23,27,153,154,155,156,157,158,159,160,161,162,163,164,165,4,5,7,30,166,167,66,67,168,127]),import.meta.url)))},Ne),_e(()=>this.view?.spatialReference,(e,t)=>{e&&t&&!e.equals(t)&&this.cancel()})]),nr(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=Be(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this._updatingHandles.destroy(),this.emit("destroy")}get updating(){return this._updatingHandles.updating||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeCreateToolDrawMode(){return this._operationHandle?.type==="create"&&this._operationHandle.activeComponent&&"mode"in this._operationHandle.activeComponent?this._operationHandle.activeComponent.mode:null}get activeTooltip(){const{activeComponent:e,destroyed:t}=this,i=!t&&e&&"tooltip"in e?e.tooltip:null;return i?.visible?i:null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...Ci,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...ke,...e,reshapeOptions:{...ke.reshapeOptions,...e?.reshapeOptions},highlightOptions:{...ke.highlightOptions,...e?.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get snappingOptions(){return this.snappingManager?.options??this._get("snappingOptions")}set snappingOptions(e){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=e),this._set("snappingOptions",e)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(e){if(e)this._isOverridden("snappingManager")||(this._defaultSnappingManager=Be(this._defaultSnappingManager)),this._override("snappingManager",e);else{const{view:t}=this;!this._defaultSnappingManager&&t&&(this._defaultSnappingManager=new W({options:this.snappingOptions,view:t})),this._clearOverride("snappingManager")}}get state(){const e=!(!this.view?.ready||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:n,map:o}=t;n&&(t.cursor=null),o?.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const i="view-ready";this.removeHandles(i),e&&this.addHandles(oo(()=>e.ready,n=>{this.removeHandles(this._viewHandlesKey),n&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},Ne),i),this._set("view",e)}cancel(){this._moduleLoaderAbortController=Pt(this._moduleLoaderAbortController),this._viewReadyAbortController=Pt(this._viewReadyAbortController),this._sketchContinuationFlag=!0,this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if(e==="active"&&t.length){const{activeTool:i,layer:n}=this,o=t.toArray();n.removeMany(o),this.cancel(),this._emitDeleteEvent({graphics:o,tool:i})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(t=>t.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,t){this.cancel(),await this._waitViewReady();const{view:i,layer:n}=this;if(!i||this.state==="disabled")throw n||this._logMissingLayer(),yi();if(i.activeTool!=null&&(i.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");xi(i,this._internalGraphicsLayer);const o=await this._updatingHandles.addPromise(this._setupCreateOperation(e,t));if(o==null||this.destroyed)return void i.map.remove(this._internalGraphicsLayer);const s=()=>{if(o===this._operationHandle){const a=this.createGraphic,r=this._operationHandle.cancelled;if(this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view?.map&&this.view.map.remove(this._internalGraphicsLayer),o.cancelled||a==null||n.add(a),this._sketchContinuationFlag=!1,this.emit("create",{graphic:a,state:r?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"}),r||this._sketchContinuationFlag)return;const{creationMode:l}=this;if(l==="continuous"){if(t?.geometryToPlace)return;this._updatingHandles.addPromise(vi(this.create(e,t)))}else l==="update"&&a&&this._updatingHandles.addPromise(vi(this.update([a])))}};o.on("complete",s),this._operationHandle=o,i.ready&&i.focus()}async place(e,t){return this.create("mesh",{mode:"click",hasZ:e.hasZ,geometryToPlace:e,...t})}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:i,view:n,state:o}=this;if(!n||o==="disabled")throw i||this._logMissingLayer(),yi();n.activeTool!=null&&(n.activeTool=null);const s=Array.isArray(e)?e:[e];if(e==null||!s?.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(s.some(r=>r.layer!==i?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):r.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const a=await this._updatingHandles.addPromise(this._setupUpdateOperation(s,t));this.destroyed||a==null||G(a)||(xi(n,this._internalGraphicsLayer),this._setUpdateOperationHandle(a,t),this.emit("update",{graphics:s,state:"start",aborted:!1,tool:a.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const t=this.view;if(t){e=Array.isArray(e)?e:[e];for(const i of e)i.geometry==null||i.geometry.type==="mesh"||Ui(i.geometry.spatialReference,t.spatialReference)||(uo(i.geometry.spatialReference,t.spatialReference)||yo()||await go(),i.geometry=Ct(i.geometry,t.spatialReference))}else this._logMissingView()}undo(){this.canUndo()&&this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!!this._operationHandle?.canUndo()}canRedo(){return!!this._operationHandle?.canRedo()}toggleUpdateTool(){this._operationHandle?.toggleTool()}async _getFirstHit(e){const t=this.view;if(!t)return this._logMissingView(),null;if(t.type==="2d"){const o=[];t.map.allLayers.forEach(a=>{a.type!=="vector-tile"&&a.type!=="imagery"||o.push(a)});const s=await t.hitTest(e,{exclude:o});return ar(s.results)}const i=[t.map.ground];t.map.allLayers.forEach(o=>{so(o.type)&&i.push(o)});const n=await t.hitTest(e,{exclude:i});if(n.results.length>0){const o=n.results[0];if(o!=null&&o.type==="graphic"&&o.graphic&&(!n.ground.mapPoint||t.map.ground.opacity<1||n.ground.distance-(o.distance??0)>-Math.min(3*n.ground.distance,t.viewingMode==="global"?ro(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return o}return null}_generateViewHandles(e){return[e.on("immediate-click",async t=>{const i=this.state==="active"&&this._operationHandle?.type==="create";this.state!=="disabled"&&!i&&this.updateOnGraphicClick&&await this._updatingHandles.addPromise(this._handleImmediateClick(t))},R.WIDGET)]}async _handleImmediateClick(e){const t=await e.async(()=>this._getFirstHit(mi(e)));let i=null;if(t!=null){const n=t.graphic;this.updateGraphics.includes(n)||n.layer===this.layer?(e.stopPropagation(),i=n):this.view?.type!=="2d"||this._isComponentGraphic(n)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();i==null||this.updateGraphics.includes(i)||await this.update([i],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}})}async _setupCreateOperation(e,t){const i=this.view;if(!i)return this._logMissingView(),null;const n={hasZ:i.type==="3d",...this.defaultCreateOptions,...t},o=await this._setupDrawGraphicTool(e,i,n);return o==null?null:(i.tools.add(o),i.activeTool=o,this._setupCreateOperationHandle(o))}async _setupDrawGraphicTool(e,t,i){if(e==="multipoint"&&t.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;const{cursor:n,defaultZ:o,hasZ:s,geometryToPlace:a,graphicProperties:r,mode:l,preserveAspectRatio:p}=i,d=_r(l,e),u=Er(e),f=i?.optionsPerTool?.has(e)?i.optionsPerTool.get(e):{},y=f?.preserveAspectRatio??p??e!=="rectangle",g={centered:e!=="rectangle"&&!(e==="circle"&&!y),cursor:n,defaultZ:o,forceUniformSize:y,graphicProperties:{...r,attributes:{...r?.attributes}},geometryToPlace:a,geometryType:u,mode:d,graphicSymbol:this._getGraphicSymbolFromTool(e),hasZ:s,snappingManager:this.snappingManager,snapToScene:!1,view:t,...f};return t.type==="2d"?this._makeDrawGraphicTool2D(g):this._makeDrawGraphicTool3D(g)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(N(()=>import("./editingTools-6TF3N_Zf.js"),__vite__mapDeps([73,1,2,3,74,9,10,35,75,76,77,36,8,78,27,79,24,47,55,46,48,37,80,40,41,81,28,29,82,12,13,14,15,16,17,18,19,20,21,22,23,25,26,4,5,6,7,30,31,32,33,34,38,39,42,43,44,45,49,50,51,52,53,54,56,57,58,83,84,85,11,86,87,62,63,88,89,90,91,92,93,94,95,96,59,60,61]),import.meta.url));return G(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:$r(e.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(N(()=>import("./editingTools-DGCORr0k.js").then(n=>n.e),__vite__mapDeps([97,9,10,35,98,99,1,2,3,100,38,39,101,47,36,102,103,104,37,87,62,24,63,46,45,48,88,105,106,107,108,26,90,34,109,110,111,6,112,113,55,85,114,115,116,86,117,118,119,120,121,40,41,43,44,42,122,25,123,124,125,126,80,127,128,129,50,95,27,78,8,79,81,28,29,82,12,13,14,15,16,17,18,19,20,21,22,23,4,5,7,30,31,32,33,49,51,52,53,54,56,57,58,83,84,11,130,131,76,77,89,132,133,134,91,92,93,75,135,136,137,138,139,140,94]),import.meta.url));if(G(t)||this.destroyed)return null;const{elevationInfo:i}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:i,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(e){const t=this.view;if(!t)return this._logMissingView(),null;let i=null;const n=e.forceUniformSize,o=e.centered,s=[t.on("key-down",r=>{if(r.key===P.pan)r.stopPropagation(),r.repeat||(e.enabled=!1);else if(r.key===P.complete)r.stopPropagation(),e.completeCreateOperation();else if(r.key!==P.vertexAdd||r.repeat)r.key===P.undo?(r.stopPropagation(),a.undo()):r.key===P.redo?(r.stopPropagation(),a.redo()):r.key!==P.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||r.repeat?r.key===P.center&&(r.repeat||(e.centered=!o,r.stopPropagation())):(e.forceUniformSize=!n,r.stopPropagation());else{const l=e.drawOperation.geometryType;l!=="polyline"&&l!=="polygon"&&l!=="multipoint"||(r.stopPropagation(),e.drawOperation.commitStagedVertex())}},R.WIDGET),t.on("key-up",r=>{r.key===P.pan?e.enabled=!0:r.key!==P.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?r.key===P.center&&(e.centered=o,r.stopPropagation()):(e.forceUniformSize=n,r.stopPropagation())},R.WIDGET),e.on("vertex-add",r=>{switch(i=i==null?"start":"active",r.operation){case"apply":this.emit("create",{graphic:e.graphic,state:i,tool:this.activeTool,toolEventInfo:r,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",r=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:r.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",r=>{switch(r.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:r,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",r=>{this._set("createGraphic",r.graphic),i="complete",r.aborted?a&&a.cancel():a&&a.complete()}),_e(()=>this._getGraphicSymbolFromTool(e.geometryType),r=>{e.graphicSymbol=r})],a=new it({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{Q(s),t.tools?.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return a}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":case"freehandPolyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":case"freehandPolygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,t){const{layer:i,view:n}=this;if(!n)return this._logMissingView(),null;const o={...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...t?.highlightOptions}};let s=o.tool??ke.tool;for(const a of e)i.remove(a),i.add(a);if(n.type==="3d"){if(e.length===0)return null;switch(s){case"move":return this._setupMove3DOperation(e,o,n,s);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(e[0],o,n);case"transform":return this._setupGraphicTransform3DOperation(e,o,n)}}switch(s){case"move":return this._setupMove2DOperation(e,o,n);case"reshape":return e.length>1?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(e,s,o,n);case"transform":if(e.length===1){const a=e[0].geometry?.type;a!=="point"&&a!=="multipoint"||(s="reshape")}return this._setupTransformOrReshape2DOperation(e,s,o,n)}}async _setupMove3DOperation(e,t,i,n,o=!1){const s=await this._requireModule(N(()=>import("./editingTools-DGCORr0k.js").then(y=>y.e),__vite__mapDeps([97,9,10,35,98,99,1,2,3,100,38,39,101,47,36,102,103,104,37,87,62,24,63,46,45,48,88,105,106,107,108,26,90,34,109,110,111,6,112,113,55,85,114,115,116,86,117,118,119,120,121,40,41,43,44,42,122,25,123,124,125,126,80,127,128,129,50,95,27,78,8,79,81,28,29,82,12,13,14,15,16,17,18,19,20,21,22,23,4,5,7,30,31,32,33,49,51,52,53,54,56,57,58,83,84,11,130,131,76,77,89,132,133,134,91,92,93,75,135,136,137,138,139,140,94]),import.meta.url));if(G(s))return s;const{ManipulatedObject3DGraphic:a,MoveTool3D:r}=s.module,l=new Map,p=()=>{l.forEach(y=>y.destroy()),l.clear()};for(const y of e){const g=new a({view:i,graphic:y}),_=br(g);if(_!==b.SUPPORTED)return p(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${ki(_)}).`),null;l.set(y,g)}const d=new r({view:i,enableZ:t.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(d),d.objects.addMany(Array.from(l.values())),o||this.updateGraphics.addMany(e);const u=[],f=new he({activeComponent:d,tool:n,type:"update",onEnd:()=>{Q(u),Qe(i,d),p()},undo:()=>{Di(this.view,d),Ke(f,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{Je(f,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:y=>{this.updateGraphics.push(y);const g=new a({view:i,graphic:y});l.set(y,g),d.objects.push(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[y],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:y=>{const g=this.updateGraphics.indexOf(y);if(f.history.undo.forEach(T=>T.updates.splice(g,1)),f.history.redo.forEach(T=>T.updates.splice(g,1)),this.updateGraphics.remove(y),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[y],type:"selection-change"},type:"update"}),this.updateGraphics.length===0)return void f.complete();const _=l.get(y);_&&(d.objects.remove(_),_.destroy(),l.delete(y))},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1||n!=="transform")return;const y=this.updateGraphics.at(0),g=await this._setupReshape3DOperation(y,t,i,!0);g&&!G(g)&&(f.onEnd(),f.destroy(),this._setUpdateOperationHandle(g,t))}});return u.push(...this._getHandlesForComponent(f,t),i.on("immediate-click",y=>this._getCommonUpdateOperationClickHandlers(f,y,t),R.WIDGET),i.on("key-down",y=>{this._getCommonUpdateOperationKeyDownHandlers(f,y)},R.WIDGET)),f}_setupGraphicTransform3DOperation(e,t,i,n=!1){if(e.length===1&&Sr(e[0])===b.SUPPORTED){const o=e[0],s=o.geometry;if(s!=null&&(s.type==="point"||s.type==="mesh"))return this._setupPointTransform3DOperation(o,t,i);if(s!=null&&(s.type==="polygon"||s.type==="polyline"))return this._setupPolyTransform3DOperation(o,t,i,n)}return this._setupMove3DOperation(e,t,i,"transform",n)}async _setupPointTransform3DOperation(e,t,i){const n="transform",{enableRotation:o,enableScaling:s,enableZ:a}=t,r=await this._requireModule(N(()=>import("./editingTools-DGCORr0k.js").then(g=>g.e),__vite__mapDeps([97,9,10,35,98,99,1,2,3,100,38,39,101,47,36,102,103,104,37,87,62,24,63,46,45,48,88,105,106,107,108,26,90,34,109,110,111,6,112,113,55,85,114,115,116,86,117,118,119,120,121,40,41,43,44,42,122,25,123,124,125,126,80,127,128,129,50,95,27,78,8,79,81,28,29,82,12,13,14,15,16,17,18,19,20,21,22,23,4,5,7,30,31,32,33,49,51,52,53,54,56,57,58,83,84,11,130,131,76,77,89,132,133,134,91,92,93,75,135,136,137,138,139,140,94]),import.meta.url));if(G(r))return r;const{TransformTool3D:l,ManipulatedObject3DGraphic:p}=r.module,d=new p({graphic:e,view:i}),u=new l({object:d,view:i,enableRotation:o,enableScaling:s,enableZ:a,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(u),this.updateGraphics.add(e);const f=[],y=new he({activeComponent:u,tool:n,type:"update",onEnd:()=>{Q(f),Qe(i,u),d.destroy()},undo:()=>{Di(this.view,u),Ke(y,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{Je(y,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),y.onEnd(),y.destroy();const _=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);G(_)||this._setUpdateOperationHandle(_,t)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),y.complete()},toggleTool:()=>{}});return f.push(...this._getHandlesForComponent(y,t),i.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(y,g,t),R.WIDGET),i.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(y,g)},R.WIDGET)),y}async _setupPolyTransform3DOperation(e,t,i,n=!1){const o="transform",{enableRotation:s,enableScaling:a,enableZ:r,preserveAspectRatio:l}=t,p=await this._requireModule(N(()=>import("./editingTools-DGCORr0k.js").then(E=>E.e),__vite__mapDeps([97,9,10,35,98,99,1,2,3,100,38,39,101,47,36,102,103,104,37,87,62,24,63,46,45,48,88,105,106,107,108,26,90,34,109,110,111,6,112,113,55,85,114,115,116,86,117,118,119,120,121,40,41,43,44,42,122,25,123,124,125,126,80,127,128,129,50,95,27,78,8,79,81,28,29,82,12,13,14,15,16,17,18,19,20,21,22,23,4,5,7,30,31,32,33,49,51,52,53,54,56,57,58,83,84,11,130,131,76,77,89,132,133,134,91,92,93,75,135,136,137,138,139,140,94]),import.meta.url));if(G(p))return p;const{ManipulatedObject3DGraphic:d,ExtentTransformTool:u}=p.module,f=this.view?.inputManager?.isModifierKeyDown(P.constraint),y=new d({view:i,graphic:e}),g=new u({object:y,view:i,enableRotation:s,enableScaling:a,enableZ:r,preserveAspectRatio:!!l!=!!f,sketchOptions:this.sketchOptions});i.tools.add(g),n||this.updateGraphics.add(e);const _=[],T=new he({activeComponent:g,tool:o,type:"update",onEnd:()=>{Q(_),Qe(i,g),y.destroy()},canUndo:()=>!g.destroyed&&g.canUndo,undo:()=>{g.destroyed||(g.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},canRedo:()=>!g.destroyed&&g.canRedo,redo:()=>{g.destroyed||(g.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},addToSelection:async E=>{this.updateGraphics.add(E),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[E],removed:[],type:"selection-change"},type:"update"}),T.onEnd(),T.destroy();const Le=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);G(Le)||this._setUpdateOperationHandle(Le,t)},removeFromSelection:E=>{this.updateGraphics.remove(E),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[E],type:"selection-change"},type:"update"}),T.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1)return;const E=await this._setupReshape3DOperation(e,t,i,!0);E&&!G(E)&&(T.onEnd(),T.destroy(),this._setUpdateOperationHandle(E,t))}});return _.push(...this._getHandlesForComponent(T,t),i.on("immediate-click",E=>this._getCommonUpdateOperationClickHandlers(T,E,t),R.WIDGET),i.on("key-down",E=>this._getCommonUpdateOperationKeyDownHandlers(T,E),R.WIDGET),i.on("key-down",E=>{E.key!==P.constraint||E.repeat||(g.preserveAspectRatio=!g.preserveAspectRatio,E.stopPropagation())},R.WIDGET),i.on("key-up",E=>{E.key===P.constraint&&(g.preserveAspectRatio=!g.preserveAspectRatio,E.stopPropagation())},R.WIDGET)),T}async _setupMove2DOperation(e,t,i){const n="move";this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=await this._getGraphicMover(e,t,i);if(G(o))return o;const s=new he({activeComponent:o,tool:n,type:"update",onEnd:()=>{this._displayDefaultCursor(),Q(l),Q(r),o.destroy(),this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const p=this.updateGraphics.toArray();Ke(s,p),s.refreshComponent(),this._emitUndoEvent({graphics:p,tool:n})},redo:()=>{const p=this.updateGraphics.toArray();Je(s,p),s.refreshComponent(),this._emitRedoEvent({graphics:p,tool:n})},addToSelection:async p=>{await this._updatingHandles.addPromise(this._updateSpatialReference(p)),this.updateGraphics.push(p),o.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[p],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:p=>{const d=this.updateGraphics.indexOf(p);s.history.undo.forEach(f=>f.updates.splice(d,1)),s.history.redo.forEach(f=>f.updates.splice(d,1)),this.updateGraphics.remove(p);const u=this.updateGraphics.toArray();this.emit("update",{graphics:u,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[p],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?o.graphics=u:s.complete()}});let a=!1;const r=[i.on("immediate-click",p=>this._getCommonUpdateOperationClickHandlers(s,p,t),R.WIDGET),i.on("key-down",p=>{this._getCommonUpdateOperationKeyDownHandlers(s,p),p.key!==P.constraint||p.repeat||(a=!0,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},R.WIDGET),i.on("key-up",p=>{p.key===P.constraint&&a&&(a=!1,o.enableMoveAllGraphics=!o.enableMoveAllGraphics)},R.WIDGET)],l=this._getHandlesForComponent(s,t);return s}async _setupReshape3DOperation(e,t,i,n=!1){const o="reshape",s=await this._requireModule(N(()=>import("./editingTools-DGCORr0k.js").then(g=>g.e),__vite__mapDeps([97,9,10,35,98,99,1,2,3,100,38,39,101,47,36,102,103,104,37,87,62,24,63,46,45,48,88,105,106,107,108,26,90,34,109,110,111,6,112,113,55,85,114,115,116,86,117,118,119,120,121,40,41,43,44,42,122,25,123,124,125,126,80,127,128,129,50,95,27,78,8,79,81,28,29,82,12,13,14,15,16,17,18,19,20,21,22,23,4,5,7,30,31,32,33,49,51,52,53,54,56,57,58,83,84,11,130,131,76,77,89,132,133,134,91,92,93,75,135,136,137,138,139,140,94]),import.meta.url));if(G(s))return s;const{ManipulatedObject3DGraphic:a,ReshapeTool3D:r}=s.module,l=new a({view:i,graphic:e}),p=wr(l);if(p!==b.SUPPORTED)return l.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${ki(p)}).`),null;const d=t.reshapeOptions,u=new r({view:i,object:l,enableZVertex:t.enableZ&&d?.vertexOperation==="move",enableZShape:t.enableZ&&d?.shapeOperation==="move",enableMoveObject:d?.shapeOperation==="move"||d?.shapeOperation==="move-xy",enableMidpoints:d?.edgeOperation==="split",enableEdgeOffset:d?.edgeOperation==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});i.tools.add(u),n||this.updateGraphics.add(l.graphic);const f=[],y=new he({activeComponent:u,tool:o,type:"update",onEnd:()=>{Q(f),Qe(i,u),l.destroy()},canUndo:()=>!u.destroyed&&u.canUndo,undo:()=>{u.destroyed||(u.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},canRedo:()=>!u.destroyed&&u.canRedo,redo:()=>{u.destroyed||(u.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o}))},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),y.onEnd(),y.destroy();const _=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);G(_)||this._setUpdateOperationHandle(_,t)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),y.complete()},toggleTool:async()=>{if(t.toggleToolOnClick===!1)return;y.onEnd(),y.destroy();const g=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,i,!0);G(g)||this._setUpdateOperationHandle(g,t)}});return f.push(...this._getHandlesForComponent(y,t),i.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(y,g,t),R.WIDGET),i.on("key-down",g=>{this._getCommonUpdateOperationKeyDownHandlers(y,g)},R.WIDGET)),y}async _setupTransformOrReshape2DOperation(e,t,i,n){this.updateGraphics.addMany(e),await this._updatingHandles.addPromise(this._updateSpatialReference(e));const o=t==="transform"?await this._getBox(e,i,n):await this._getReshape(e,i,n);if(G(o))return o;const s=new he({activeComponent:o,type:"update",onEnd:()=>{Q(r),Q(a),s.activeComponent&&!s.activeComponent.destroyed&&s.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{Ke(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},redo:()=>{Je(s,this.updateGraphics.toArray()),s.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s.tool})},addToSelection:async l=>{let p=s.activeComponent;if(p?.type==="reshape"){const d=[...this.updateGraphics,l];this.updateGraphics.removeAll(),s.onEnd(),s.destroy();const u=await this._setupTransformOrReshape2DOperation(d,"transform",i,n);if(G(u))return;this._setUpdateOperationHandle(u,i)}else this.updateGraphics.add(l),p.graphics=this.updateGraphics.toArray(),p.refresh(),s.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[l],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async l=>{const p=this.updateGraphics.indexOf(l);s.history.undo.forEach(u=>u.updates.splice(p,1)),s.history.redo.forEach(u=>u.updates.splice(p,1)),this.updateGraphics.remove(l);const d=this.updateGraphics.toArray();if(d.length===0)s.complete();else{const u=d[0].geometry;d.length!==1||u==null||u.type!=="point"&&u.type!=="multipoint"?s.activeComponent.graphics=d:s.toggleTool()}this.emit("update",{graphics:d,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[l],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(this.updateGraphics.length>1)return;const l=this.updateGraphics.at(0),p=l.geometry;if(p!=null&&(s.tool==="reshape"&&(p.type==="point"||p.type==="multipoint")||s.tool==="transform"&&p.type==="extent"))return;let d=null;s.tool==="transform"?d=await this._getReshape([l],i,n):s.tool==="reshape"&&(d=await this._getBox([l],i,n)),G(d)||(s.activeComponent?.destroy(),s.activeComponent=d,s.activeComponent&&(Q(r),r=this._getHandlesForComponent(s,i)))}}),a=[n.on("immediate-click",l=>this._getCommonUpdateOperationClickHandlers(s,l,i),R.WIDGET),n.on("key-down",l=>{if(this._getCommonUpdateOperationKeyDownHandlers(s,l),l.key===P.constraint&&!l.repeat&&s){const p=s.activeComponent;p&&p.type==="box"&&(p.preserveAspectRatio=!p.preserveAspectRatio)}},R.WIDGET),n.on("key-up",l=>{if(l.key===P.constraint&&s){const p=s.activeComponent;p&&p.type==="box"&&(p.preserveAspectRatio=!p.preserveAspectRatio)}},R.WIDGET)];let r=this._getHandlesForComponent(s,i);return s}async _getGraphicMover(e,t,i){const{enableMoveAllGraphics:n,highlightOptions:o}=t,s=await this._requireModule(N(()=>import("./GraphicMover-DzheW6kz.js").then(a=>a.G),__vite__mapDeps([169,1,2,3,15,16,17,18,19,20,21,22,23,24,10,25,26,96,127,30,170,27,171,172,4,5,6,7,94,9,36,39,44,56]),import.meta.url));return G(s)?s:new s.module.default({enableMoveAllGraphics:n,highlightsEnabled:!!o?.enabled,indicatorsEnabled:!1,graphics:e,view:i,callbacks:{onGraphicMoveStart:({dx:a,dy:r,graphic:l})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:r,mover:l,type:"move-start"},type:"update"})},onGraphicMove:({dx:a,dy:r,graphic:l})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:r,mover:l,type:"move"},type:"update"}),onGraphicMoveStop:({dx:a,dy:r,graphic:l})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:r,mover:l,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,i){const{enableRotation:n,enableScaling:o,highlightOptions:s,preserveAspectRatio:a}=t,r=await this._requireModule(N(()=>import("./Box-CaU6Aepb.js"),__vite__mapDeps([173,1,2,3,8,96,169,15,16,17,18,19,20,21,22,23,24,10,25,26,127,30,170,27,171,172,4,5,6,7,94,9,36,39,44,56,174,78,79,47,55,46,48,37,80,40,41,81,28,29,82,12,13,14,31,32,33,34,35,38,42,43,45,49,50,51,52,53,54,57,58,83,84,85,11,140,133,59,60,61,62,63]),import.meta.url));if(G(r))return r;const l=this.view?.inputManager?.isModifierKeyDown(P.constraint);return new r.module.default({graphics:e,enableRotation:n,enableScaling:o,highlightsEnabled:!!s?.enabled,preserveAspectRatio:!!a!=!!l,layer:this._internalGraphicsLayer,view:i,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onMove:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onMoveStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScaleStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScale:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onScaleStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotateStart:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotate:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"}),onRotateStop:p=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...p},type:"update"})}})}async _getReshape(e,t,i){const n=t.reshapeOptions?.edgeOperation==="split",o=t.reshapeOptions?.shapeOperation==="move",s=!!t.highlightOptions?.enabled,a=await this._requireModule(N(()=>import("./Reshape-BVXMlzf1.js"),__vite__mapDeps([175,1,2,3,15,16,17,18,19,20,21,22,23,24,10,25,26,34,74,9,35,75,76,77,36,8,78,27,79,47,55,46,48,37,80,40,41,81,28,29,82,12,13,14,4,5,6,7,30,31,32,33,38,39,42,43,44,45,49,50,51,52,53,54,56,57,58,83,84,85,11,86,87,62,63,88,96,169,127,170,171,172,94,132,133,174,59,60,61]),import.meta.url));return G(a)?a:new a.module.default({enableMidpoints:n,enableMovement:o,graphic:e[0],highlightsEnabled:s,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:i,callbacks:{onReshapeStart:r=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...r},type:"update"}),onReshape:r=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...r},type:"update"}),onReshapeStop:({mover:r,type:l})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r,type:l},type:"update"}),onMoveStart:({dx:r,dy:l,mover:p,type:d})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:r,dy:l,mover:p,type:d},type:"update"}),onMove:({dx:r,dy:l,mover:p,type:d})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:r,dy:l,mover:p,type:d},type:"update"}),onMoveStop:({dx:r,dy:l,mover:p,type:d})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:r,dy:l,mover:p,type:d},type:"update"}),onVertexAdd:({added:r,type:l,vertices:p})=>{const d=r.map(u=>gi(u.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:d,vertices:p,type:l},type:"update"})},onVertexRemove:({removed:r,type:l,vertices:p})=>{const d=r.map(u=>gi(u.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:d,vertices:p,type:l},type:"update"})}}})}_getHandlesForComponent(e,t){const i=e.activeComponent;if(!i)return[];switch(i.type){case"graphic-mover":return[i.on("graphic-click",({graphic:n,viewEvent:o})=>{o.native?.shiftKey&&(o.stopPropagation(),e.removeFromSelection(n))}),i.on("graphic-move-start",n=>e.addToHistory(de(n.allGraphics)))];case"box":return[i.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,t,n)),i.on("move-start",n=>e.addToHistory(de(n.graphics))),i.on("rotate-start",n=>e.addToHistory(de(n.graphics))),i.on("scale-start",n=>e.addToHistory(de(n.graphics)))];case"reshape":return[i.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,t,n)),i.on("move-start",n=>e.addToHistory(de([n.mover]))),i.on("reshape-start",n=>e.addToHistory(de([n.graphic]))),i.on("vertex-add",n=>e.addToHistory(de([n.oldGraphic]))),i.on("vertex-remove",n=>e.addToHistory(de([n.oldGraphic])))];case"move-3d":return[i.events.on("record-undo",({updates:n})=>{e.addToHistory({updates:n})}),i.events.on("move-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move-start"},type:"update"})}),i.events.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:n.dx,dy:n.dy,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move"},type:"update"})}),i.events.on("move-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.objects.length>0?n.objects[0].graphic:null,type:"move-stop"},type:"update"})}),i.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,t):e.toggleTool()})];case"transform-3d":return[i.events.on("record-undo",({updates:n})=>{e.addToHistory({updates:n})}),i.events.on("translate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-start"},type:"update"})}),i.events.on("translate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-stop"},type:"update"})}),i.events.on("rotate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate-start"},type:"update"})}),i.events.on("rotate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate-stop"},type:"update"})}),i.events.on("scale-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-start"},type:"update"})}),i.events.on("scale-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-stop"},type:"update"})}),i.events.on("translate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move"},type:"update"})}),i.events.on("rotate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,angle:n.angle,type:"rotate"},type:"update"})}),i.events.on("scale",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.object.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale"},type:"update"})}),i.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,t):e.toggleTool()})];case"reshape-3d":return[i.events.on("reshape",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...n,mover:n.object.graphic},type:"update"})}),i.events.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...n,mover:n.object.graphic},type:"update"})}),i.events.on("vertex-add",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),i.events.on("vertex-remove",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),i.events.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.object.graphic],e,t):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,t,i){const{graphic:n,viewEvent:o}=i;return o.native?.shiftKey&&n.layer===this.layer?(o.stopPropagation(),e.removeFromSelection(n)):t.toggleToolOnClick?(o.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){this._operationHandle=e;const i=this.view?.map;this._disablePopup(t);const n=()=>{if(e===this._operationHandle){const o=this.updateGraphics.toArray(),s=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),i&&i.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:o,state:"complete",aborted:e.cancelled,tool:s,toolEventInfo:null,type:"update"})}};e.on("complete",n)}async _getCommonUpdateOperationClickHandlers(e,t,i){const n=mi(t),o=await t.async(()=>this._getFirstHit(n));if(o==null)return void e.complete();if(t.native.shiftKey&&this._toggleSelection([o.graphic],e,i))return void t.stopPropagation();this.updateGraphics.includes(o.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,i){const n=!!i.multipleSelectionEnabled;return e.some(o=>o!=null&&!(!n||o.layer!==this.layer)&&(this.updateGraphics.includes(o)?t.removeFromSelection(o):t.addToSelection(o),!0))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const i=t.key;i===P.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):i===P.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):i===P.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&P.delete.includes(i)&&this._onDeleteKey(t)}_onDeleteKey(e){if(!this._operationHandle||this._operationHandle.type!=="update")return;const t=this.activeComponent,i=this.updateGraphics.toArray();t!=null&&(t.type!=="reshape"||i.length===1&&i[0].geometry?.type==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=Be(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:t}=this;return!(!e||t==null)&&(e.attributes?.esriSketchTool||t.type==="draw-2d"&&t.graphic===e||(t.type==="box"||t.type==="reshape")&&t.isUIGraphic(e))}_displayPointerCursor(){this.view?.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view?.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view?.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,t,i){Vi.getLogger(this).error(new ao(e,t,i))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const i=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:i}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){}wait(){return fi(()=>!this.updating)}_disablePopupEnabled(e){return this.view?.type!=="3d"||this.updateOnGraphicClick||(e?.toggleToolOnClick??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(Pt(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await po(fi(()=>e?.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",Ni("view"))}_logMissingLayer(){this._logError(Or,Ni("layer"))}};c([h()],m.prototype,"_defaultSnappingManager",void 0),c([h()],m.prototype,"updating",null),c([h({readOnly:!0})],m.prototype,"_updatingHandles",void 0),c([h()],m.prototype,"_operationHandle",void 0),c([h({readOnly:!0})],m.prototype,"activeTool",null),c([h({readOnly:!0})],m.prototype,"activeCreateToolDrawMode",null),c([h()],m.prototype,"activeTooltip",null),c([h({types:xe})],m.prototype,"activeFillSymbol",void 0),c([h()],m.prototype,"activeLineSymbol",void 0),c([h()],m.prototype,"activeVertexSymbol",void 0),c([h()],m.prototype,"allowDeleteKey",void 0),c([h({readOnly:!0})],m.prototype,"createGraphic",null),c([h()],m.prototype,"defaultCreateOptions",null),c([h()],m.prototype,"defaultUpdateOptions",null),c([h({type:pi,nonNullable:!0})],m.prototype,"labelOptions",null),c([h()],m.prototype,"layer",void 0),c([h({types:xe})],m.prototype,"pointSymbol",void 0),c([h({types:xe})],m.prototype,"polygonSymbol",void 0),c([h({types:xe})],m.prototype,"polylineSymbol",void 0),c([h()],m.prototype,"meshSymbol",void 0),c([h({type:hi,nonNullable:!0})],m.prototype,"snappingOptions",null),c([h()],m.prototype,"snappingManager",null),c([h({readOnly:!0})],m.prototype,"state",null),c([h({type:li,nonNullable:!0})],m.prototype,"tooltipOptions",null),c([h({readOnly:!0})],m.prototype,"updateGraphics",void 0),c([h()],m.prototype,"updateOnGraphicClick",void 0),c([h()],m.prototype,"creationMode",void 0),c([h({type:ci,nonNullable:!0})],m.prototype,"valueOptions",null),c([h({types:xe})],m.prototype,"vertexSymbol",void 0),c([h({value:null})],m.prototype,"view",null),c([h({constructOnly:!0,type:xn})],m.prototype,"sketchOptions",void 0),m=c([k("esri.widgets.Sketch.SketchViewModel")],m);const Or="sketch:missing-property",Ni=e=>`Property '${e}' is missing on SketchViewModel.`;function $r(e){return e==="polygon"||e==="rectangle"||e==="circle"}function Ke(e,t){In("undo",e.history.undo,e.history.redo,t)}function Je(e,t){In("redo",e.history.redo,e.history.undo,t)}function In(e,t,i,n){const o=t.pop();if(!o)return;const s=o.updates,a=[];n.forEach((r,l)=>{const p=s[l];p!=null&&("geometry"in p&&p.geometry!=null&&(a.push({geometry:r.geometry}),r.geometry=p.geometry),"symbol"in p&&p.symbol!=null&&(a.push({symbol:r.symbol}),r.symbol=p.symbol),"undo"in p&&(a.push(p),p[e](r)))}),i.push({updates:a})}function Di(e,t){e!=null&&t.hasGrabbedManipulators&&(e.activeTool=null)}function de(e){return{updates:e.map(({geometry:t})=>t?.type==="mesh"?{geometry:t.cloneShallow()}:{geometry:t})}}function Qe(e,t){e.tools?.remove(t),t.destroyed||t.destroy()}function G(e){return"requireError"in e&&e.requireError==="aborted"}const Ua=m;export{ts as $,wa as A,Te as B,Ha as C,P as D,tr as E,pa as F,Gn as G,Sa as H,Ks as I,gn as J,$ as K,ta as L,ma as M,bi as N,hr as O,gt as P,ia as Q,ur as R,hi as S,ds as T,oe as U,us as V,ln as W,Js as X,Ri as Y,H as Z,Jo as _,bt as a,va as a0,Kt as a1,dt as a2,oa as a3,_a as a4,na as a5,Wr as a6,Ce as a7,wi as a8,Ps as a9,ca as aA,da as aB,Z as aC,ps as aD,en as aE,Bo as aF,Xo as aG,br as aH,b as aI,Tn as aa,ai as ab,Ts as ac,Ws as ad,Rs as ae,pi as af,Wo as ag,B as ah,nr as ai,es as aj,An as ak,ci as al,Ii as am,Qi as an,ea as ao,Jr as ap,Xr as aq,Qr as ar,ar as as,sa as at,ra as au,Yr as av,Wt as aw,Br as ax,ha as ay,os as az,tt as b,j as c,ba as d,Gt as e,sn as f,pr as g,lr as h,me as i,Me as j,Ta as k,Ua as l,Ko as m,Ln as n,xn as o,lt as p,xi as q,cr as r,la as s,Oa as t,I as u,dr as v,yt as w,fa as x,Kr as y,yr as z};
