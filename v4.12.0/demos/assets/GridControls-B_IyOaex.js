const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BaHSXQSf.js","./index-B8m1QqH5.js","./jsxFactory-HPYy2V_L.js","./main-D6UWMbWJ.js","./preload-helper-ExcqyqRp.js","./main-DCJluy1C.css","./intl-D8pxRaLS.js","./uuid-Cl5lrJ4c.js","./guid-ejniuQmw.js","./useT9n-BQVknhIP.js","./index-Dsw0xHWV.js","./dom-31sk8mer.js","./observers-DFHTnWgF.js","./keyed-Dl-8XVqE.js","./ref-DwVaJuBu.js","./interactive-C_4tCeN_.js","./loadable-gcxx8e1i.js","./component-B-AXDmr-.js","./index-BszAqEfC.js","./index-CUpY7mOl.js","./floating-ui-qvGEVxmA.js","./debounce-DbkufipY.js","./openCloseComponent-BkUCaXBK.js","./static-DnJyBfOT.js","./FloatingArrow-BcvQyJmZ.js","./key-CZcQa38B.js","./index-BpWojg0l.js","./array-BbE1dLa5.js","./index-B2R0-Hjc.js","./ExpandToggle-5vKMqDSS.js","./index-DFQUiqV8.js","./label-CvvO9w-_.js","./index-N2wu9FVr.js","./index-D6Oux7Jv.js","./_commonjsHelpers-DqlTr81k.js","./repeat-COk-hRsL.js","./index-D4HK4ICI.js","./customElement-C94Ooq5N.js","./input-2zl_QGmu.js","./form-CB-kMzAL.js","./Validation-B0E2iPw7.js","./index-DpBSpE1C.js","./index-B0nBjw24.js"])))=>i.map(i=>d[i]);
import{_ as S}from"./preload-helper-ExcqyqRp.js";import{ap as R,O as k,v as n,x as s,J as M,a5 as K,s as G,bG as le,dM as ce,bl as pe,D as de,bz as g,ip as Q,d7 as he,a7 as ue,a6 as E,d8 as A,Z as U,n as me,cC as X,cB as ge,aT as ve,dt as _e}from"./main-D6UWMbWJ.js";import"./intl-D8pxRaLS.js";import{g as ye}from"./unitFormatUtils-P02smIEo.js";import{n as l,e as W,O as fe,c as be,v as we}from"./jsxFactory-HPYy2V_L.js";import{e as B}from"./globalCss-geu-g-r4.js";import{r as Y,b as Se,o as I}from"./index-BNk7091c.js";import{k as Ce,O as ee,U as $e}from"./projection-F5U3p10J.js";import{u as Me}from"./scaleUtils-CNZGIFij.js";import{e as N}from"./projectVectorToVector-2U_T6yxL.js";import{e as xe,P as Pe,b as Ie,T as Te,E as Ee,v as Re,M as ke,p as Oe,k as Le}from"./automaticLengthMeasurementUtils-ByRZj4YK.js";import{t as Ge,l as Ae,f as De,u as Ve}from"./gridUtils-Bk4mKE8P.js";import{DrawGraphicTool2D as je}from"./editingTools-6TF3N_Zf.js";import{d as F,S as Ue}from"./SketchViewModel-BQEEJoEu.js";import{x as We}from"./TextOverlayItem-C7eWGZlN.js";import{r as Be}from"./number-yo9J8KAb.js";import{s as Ne}from"./substitute-CUVC4DC3.js";import"./ByteSizeUnit-BsxeN7wM.js";import"./quantityUtils-B7WFJP6j.js";import"./uuid-Cl5lrJ4c.js";import"./Queue-Bp8J9hIN.js";import"./signal-_szBxGG7.js";import"./Version-DeyywoNs.js";import"./dynamic-import-helper-BheWnx7M.js";import"./draw-store-BaFsNOTl.js";import"./GraphicsLayer-dZfMZHiC.js";import"./GraphicsCollection-B4inrSzy.js";import"./Layer-CrpAg4i7.js";import"./TimeExtent-CVFHym4n.js";import"./ScaleRangeLayer-CANL8iBb.js";import"./layerContainerType-C5CzMsLd.js";import"./jsonUtils-BVTTU8XA.js";import"./parser-BOplPg1_.js";import"./mat4f32-DcsiF_Rp.js";import"./mat4-mplESjCB.js";import"./common-DQOJ18NT.js";import"./ElevationInfo-DLPjeENV.js";import"./lengthUtils-B1iOgQDj.js";import"./layerViewUtils-eEg1cHt4.js";import"./widget-GoJNk-6R.js";import"./diffUtils-BMpoATJS.js";import"./UpdatingHandles-CLyw9aof.js";import"./ViewingMode-HRfKv6NR.js";import"./vec2-maR1OrZI.js";import"./vec2f64-DohEyf3f.js";import"./vec32-DvB22h0L.js";import"./vec42-CKs01hkn.js";import"./vec4f64-o2zAXfmz.js";import"./meshVertexSpaceUtils-DurlDegv.js";import"./MeshLocalVertexSpace-DKI2cxe_.js";import"./hydratedFeatures-CzW8xS0g.js";import"./plane-DXyNbfXV.js";import"./mat3f64-q3fE-ZOt.js";import"./mat4f64-Dk4dwAN8.js";import"./quatf64-aQ5IuZRd.js";import"./geodesicUtils-CINGW30v.js";import"./Scheduler-BTF2H21O.js";import"./geometryEngineBase-8g0RzW7z.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./hydrated-C5WzuFt9.js";import"./mat2d-D9DBP-jx.js";import"./quat-DOvbuK1U.js";import"./drapedUtils-gb-eeqgf.js";import"./utils-BQBvadb7.js";import"./projectPointToVector-CP3mj71q.js";import"./MeshTransform-CchhgBFB.js";import"./axisAngleDegrees-CXVOOF0w.js";import"./themeUtils-C3zvZbsE.js";import"./a11yUtils-m_nLVpnt.js";import"./spatialReferenceEllipsoidUtils-DMIJhMZm.js";import"./geodesicLengthMeasurementUtils-JxSmg9AU.js";import"./normalizeUtils-DSf_eBlh.js";import"./utils-BIJX9DmY.js";import"./utils-C6WKisvz.js";import"./SnappingVisualizer2D-COUVXXCK.js";import"./enums-BJSSbDkD.js";import"./automaticAreaMeasurementUtils-DaO87GCA.js";import"./PointSnappingHint-JorhXB6u.js";import"./earcut-Lltz9D9k.js";import"./triangle-C_fuLIxe.js";import"./sphere-MYAntte_.js";import"./mat3-CruJiiUv.js";import"./lineSegment-o0iVtp8N.js";import"./editPlaneUtils-__eTupE3.js";import"./boundedPlane-DFud_aWw.js";import"./cimSymbolUtils-cqAw9W-o.js";import"./utils-BRg6PM3S.js";import"./defaultCIMValues-DII_GG3u.js";import"./GraphicManipulator-B4yi6CRG.js";import"./colorUtils-B_grc-3o.js";import"./drawUtils-cqcDF6ev.js";import"./Query-VeA4-Qk_.js";import"./Field-BRKBBmM6.js";import"./fieldType-B-0DY-YK.js";const Fe={readOnly:!0,get(){return xe(this.view)}};function ze(t,e){const i=te(e);return[t[0].toFixed(i),t[1].toFixed(i)]}function te(t){return t>=500?6:t<500&&t>=50?7:t<50&&t>=5?8:9}function He(t,e){const i=t.includes(",")?",":" ",[r,o,a]=t.split(i).map(d=>{const h=d.trim();return h?Number(h):null});if(!O(r)||!O(o))return null;const p=new R({x:r,y:o,spatialReference:e||k.WGS84});return a&&(p.z=a,p.hasZ=!0),p}function O(t){return typeof t=="number"&&isFinite(t)}function z(t){return!!t&&O(t.x)&&O(t.y)}function H(t,e){if(t.spatialReference.isGeographic&&e){const[i,r]=ze([t.x,t.y],e);return`${i}, ${r}`}return`${t.x.toFixed(3)}, ${t.y.toFixed(3)}`}let u=class extends K{constructor(t){super(t),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return(this._currentPattern||this.defaultPattern)??""}set currentPattern(t){this._currentPattern=t}get label(){return this.name??""}set label(t){this._overrideIfSome("label",t)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){return this.name==="basemap"?this._viewSpatialReference:this.conversionInfo?.spatialReference??k.WGS84}set spatialReference(t){this._overrideIfSome("spatialReference",t)}get _viewSpatialReference(){return this.viewModel?.view?.spatialReference??k.WGS84}get _additionalCharactersPattern(){const t=this.coordinateSegments;if(!t)return null;const e=t.map(r=>r.alias),i=this.currentPattern.replaceAll(new RegExp(`["nsew${e.join()}]`,"gi"),"").replaceAll(" ","");return new RegExp(`[${i}]`,"g")}get test(){}async convert(t){if(!z(t))throw new G("format:invalid-point","Could not convert invalid point.",{point:t});const e=this.conversionInfo?.convert;if(e)return Promise.resolve().then(()=>e(t));const i=await this._project(t,this.spatialReference);return{location:i,coordinate:await this._getCoordinate(i)}}getConversionStrategy(){const t=this._viewSpatialReference;return this.conversionInfo?.convert||this.viewModel?.formatterAvailable||this.name==="xy"&&(t.isWebMercator||t.isWGS84)||this.name==="basemap"?"client":"server"}getDisplayCoordinate(t){if(!t)return null;if(!this.coordinateSegments||!this.currentPattern)return t;let e=this.currentPattern;const i=this._getSegmentMatches(t,!1);for(let r=this.coordinateSegments.length-1;r>=0;r--){const o=this.coordinateSegments[r];e=e.replace(o.alias,i[r])}return e}_parseUserInput(t){const{defaultPattern:e,_additionalCharactersPattern:i,coordinateSegments:r}=this;if(!e||!i)return"";let o=e.replace(i,"");t=t.replace(i,"");const a=this._getSegmentMatches(t,!0);if(r)for(let p=r.length-1;p>=0;p--){const d=r[p];o=o.replace(d.alias,a[p])}return o}_getSegmentMatches(t,e){const i=new Array,{coordinateSegments:r}=this;if(!r)return i;for(let o=0;o<r.length;o++){const a=r[o],p=t.match(a.searchPattern);if(!p){i.push("");continue}let d=p[0];if(t=t.replace(d,"").trim(),a.substitution){const h=e?a.substitution.input(d):a.substitution.output(d);h&&(d=`${h}`)}i.push(d)}return i}async reverseConvert(t){const e=this._parseUserInput(t),i=this.conversionInfo?.reverseConvert;let r;if(i)r=i(e);else if(this.name==="xy"||this.name==="basemap")r=He(e,this.spatialReference);else if(this.viewModel?.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":r=Ee(e,this.spatialReference);break;case"mgrs":{r=Te(e,this.spatialReference,"automatic");break}case"utm":{r=Ie(e,this.spatialReference,"latitude-band-indicators");break}case"usng":r=Pe(e,this.spatialReference);break;default:r=null}if(!r)throw new G("format:invalid-input","Could not parse input into point.",{userInput:t});return this._project(r,this._viewSpatialReference)}async _getCoordinate(t){const e=this.viewModel?.view?.scale??0;if(!z(t))throw new G("format:invalid-point","Could not transform invalid point into coordinate.",{point:t});if(this.viewModel?.formatterAvailable||this.name==="basemap"||this.name==="xy")switch(this.name){case"dd":case"ddm":case"dms":{const i=te(e);return Le(t,this.name,i)}case"mgrs":return Oe(t,"automatic",5,!1);case"usng":return ke(t,5,!1);case"utm":return Re(t,"latitude-band-indicators",!0);default:return H(t,e)}return H(t,e)}async _project(t,e){if(le(t.spatialReference,e)||!e)return t;if(this.viewModel?.formatterAvailable&&Ce())return ee(t,e);if(!this.viewModel?.formatterAvailable){const i=ce(t,e);if(i!=null)return i}return null}};n([s()],u.prototype,"conversionInfo",void 0),n([s()],u.prototype,"coordinateSegments",void 0),n([s()],u.prototype,"currentPattern",null),n([s()],u.prototype,"_currentPattern",void 0),n([s()],u.prototype,"label",null),n([s()],u.prototype,"defaultPattern",void 0),n([s({readOnly:!0})],u.prototype,"hasDisplayProperties",null),n([s()],u.prototype,"name",void 0),n([s({type:k})],u.prototype,"spatialReference",null),n([s()],u.prototype,"viewModel",void 0),n([s({readOnly:!0})],u.prototype,"_viewSpatialReference",null),n([s({readOnly:!0})],u.prototype,"_additionalCharactersPattern",null),u=n([M("esri.widgets.CoordinateConversion.support.Format")],u);Be().decimal;const qe="°‎";let v=class extends de{constructor(t){super(t),this.center=new R,this.dynamicScaling=!0,this.majorLineColor=g.fromArray([115,115,115,1]),this.majorLineInterval=10,this.minorLineColor=g.fromArray([165,165,165,1]),this.rotateWithMap=!1,this.rotation=0,this.spacing=1,this.type="measured",this.units="miles"}};n([s()],v.prototype,"center",void 0),n([s()],v.prototype,"dynamicScaling",void 0),n([s()],v.prototype,"majorLineColor",void 0),n([s()],v.prototype,"majorLineInterval",void 0),n([s()],v.prototype,"minorLineColor",void 0),n([s()],v.prototype,"rotateWithMap",void 0),n([s()],v.prototype,"rotation",void 0),n([s()],v.prototype,"spacing",void 0),n([pe({measured:"measured"})],v.prototype,"type",void 0),n([s()],v.prototype,"units",void 0),v=n([M("esri.grids.MeasuredGrid")],v);let _=class extends K{constructor(t){super(t),this.color=new g([255,127,0,1]),this.isDecoration=!0,this.length=34,this.rotation=0,this.thickness=2,this.visible=!0}get _strokeStyle(){return this.color.toCss(!0)}render(){const{x:t,y:e,length:i,thickness:r,rotation:o}=this,a=i/2,p=`0 0 ${i} ${i}`,d=`M${a} 0 V${i} M0 ${a} H${i}`;return l("div",{classes:{"esri-box-overlay-item":!0},dir:"ltr",styles:{left:`${(t??0)-a}px`,top:`${(e??0)-a}px`,width:`${i}px`,height:`${i}px`,transform:`rotate(${o}deg)`,visibility:this.visible?"visible":"hidden"}},l("svg",{styles:{overflow:"visible"},viewbox:p},l("path",{d,stroke:this._strokeStyle,"stroke-width":r})))}renderCanvas(){}};n([s()],_.prototype,"color",void 0),n([s()],_.prototype,"isDecoration",void 0),n([s()],_.prototype,"length",void 0),n([s()],_.prototype,"rotation",void 0),n([s()],_.prototype,"thickness",void 0),n([s()],_.prototype,"visible",void 0),n([s()],_.prototype,"x",void 0),n([s()],_.prototype,"y",void 0),n([s({readOnly:!0})],_.prototype,"_strokeStyle",null),_=n([M("esri.views.overlay.CrosshairOverlayItem")],_);const Ze=_,ie=t=>{if(t==null||isNaN(t))return 0;const e=t+180;return Math.trunc(Q(e,360))},Je=t=>{let e=t;return e==null?0:(typeof e=="string"&&(e=parseInt(e,10)),isNaN(e)?0:Q(Math.trunc(e),360)-180)},q=(t,e)=>{if(!t||e.length<3)return;const[i,r,o,a]=e,[p,d]=a===void 0?[1,.25]:[a,.25*a];t.majorLineColor=g.fromArray([i,r,o,p]),t.minorLineColor=g.fromArray([i,r,o,d])},Z=Symbol("grid-interactivity");let c=class extends he.EventedAccessor{constructor(e){super(e),this._drawGraphicTool=null,this._crosshairLabel=null,this._crosshairItem=null,this.snappingManager=null,this.snappingOptions=null,this.view=null,this.placementDisabled=!1,this._mostRecentlyShownGrid=null,this._sketchedVertexCount=0}initialize(){this.addHandles([ue(()=>!this.displayEnabled,()=>{this.interactivePlacementState=null}),E(()=>this.view?.viewpoint,()=>{this._renderOverlays()}),E(()=>this.snappingOptions?.gridEnabled,e=>{e!=null&&this.trySetDisplayEnabled(e)}),E(()=>this.view?.grid,(e,i)=>{this._mostRecentlyShownGrid=!e&&i?i:null})])}destroy(){this._resetGridPlacementState(),this._crosshairItem&&(this.view?.overlay?.removeItem(this._crosshairItem),this._crosshairItem=A(this._crosshairItem)),this._crosshairLabel&&(this.view?.overlay?.removeItem(this._crosshairLabel),this._crosshairLabel=A(this._crosshairLabel))}get displayEnabled(){return!!this.view?.grid}get dynamicScaling(){return this.grid?.dynamicScaling??!1}set dynamicScaling(e){this.grid&&(this.grid.dynamicScaling=e)}get grid(){return this.view?.grid??this._mostRecentlyShownGrid}set gridColor(e){this._set("gridColor",e);const[i,r,o,a]=e.toArray();q(this.grid,[i,r,o,a/255])}get gridControlsEnabled(){return this.displayEnabled&&!this.interactivePlacementState}set interactivePlacementState(e){this._set("interactivePlacementState",e),this._resetGridPlacementState(),e&&this._startGridManipulation(e)}get majorLineInterval(){return this.grid?.majorLineInterval??10}set majorLineInterval(e){this.grid&&(this.grid.majorLineInterval=e<1?1:e>15?15:e)}get rotateWithMap(){return this.grid?.rotateWithMap??!1}set rotateWithMap(e){this.grid&&(this.grid.rotateWithMap=e)}get rotation(){return this.grid?.rotation??-180}set rotation(e){this.grid&&(this.grid.rotation=e)}get snappingEnabled(){return(this.grid&&this.snappingOptions?.gridEnabled)??!1}set snappingEnabled(e){const{snappingOptions:i}=this;i&&(i.gridEnabled=e)}get spacing(){return this.grid?.spacing??1}set spacing(e){this.grid&&e>0&&(this.grid.spacing=e)}get unit(){return this.grid?.units}set unit(e){this.grid&&(this.grid.units=e)}get gridOutOfScale(){return!this.dynamicScaling&&this._pixelsPerStride!=null&&this._pixelsPerStride<Ge}get effectiveSpacingAfterDynamicScaling(){return this.majorLineInterval<1||!this.dynamicScaling||!this.view||this._pixelsPerStride==null||!this.grid?.spacing?null:this.grid.spacing*Ae(this.majorLineInterval,this._pixelsPerStride,this.dynamicScaling)}get numericSpacingInputShouldBeVisible(){return!!this.view?.spatialReference&&De(this.view.spatialReference)}get _metersPerSRUnit(){if(!(this.view&&this.displayEnabled&&this.grid&&$e(this.grid.center.spatialReference,this.view.spatialReference)))return null;const e=ee(this.grid.center,this.view.spatialReference);return Ve(e)}get _pixelsPerStride(){if(!this.view?.scale||!this.displayEnabled||!this.grid||this._metersPerSRUnit==null)return null;const e=this.grid,{scale:i,spatialReference:r}=this.view;return U(e.spacing,e.units,"meters")/(this._metersPerSRUnit*Me(i,r))}get _isPlacing(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return e==="place"||e==="interactive"&&this._sketchedVertexCount===0}get _isRotating(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return e==="rotate"||e==="interactive"&&this._sketchedVertexCount===1}get _isScaling(){return this._drawGraphicTool?this.interactivePlacementState==="interactive"&&this._sketchedVertexCount===1:!1}togglePlacementState(e){this.interactivePlacementState=this.interactivePlacementState===e?null:e}trySetDisplayEnabled(e){const{view:i}=this;if(i?.ready)if(!i.grid&&e)if(this._mostRecentlyShownGrid)i.grid=this._mostRecentlyShownGrid;else{const r=this.defaultUnit==="imperial"?"feet":"meters";i.grid=new v({units:r,center:i.center??new R,rotateWithMap:!0}),q(this.grid,[115,115,115])}else e||(i.grid=null);else me.getLogger(this).warn("Attempting to enable grid display while view is not ready")}startPlacement(e){const{view:i,snappingManager:r}=this;if(!i)return;this._set("interactivePlacementState",e),this._sketchedVertexCount=0;const o=new je({view:i,graphicProperties:{attributes:{[F]:F}},sketchOptions:{tooltips:{enabled:!0,visibleElements:{direction:!1,rotation:!1,totalLength:!1,elevation:!1,distance:!1,area:!1}}},geometryType:"polyline",mode:"click",snapToScene:!1,snappingManager:r,forceUniformSize:!0,centered:!1,cursor:this.interactivePlacementState==="interactive"||this.interactivePlacementState==="place"?"none":null,regularVerticesSymbol:void 0,activeVertexSymbol:Ke,activeLineSymbol:J,graphicSymbol:J});this._drawGraphicTool=o,i.addAndActivateTool(o),this._renderOverlays(),this.addHandles([o.on("cursor-update",a=>this._onCursorUpdate(a)),o.on("complete",()=>this._onDrawComplete()),o.on("vertex-add",a=>this._onVertexAdd(a,e))],Z)}async _startGridManipulation(e){const{view:i}=this;if(!i)return void(this.interactivePlacementState=null);const r=new CustomEvent("before-placement",{cancelable:!0});this.emit("before-placement",r),r.defaultPrevented||this.startPlacement(e)}_onCursorUpdate(e){try{if(this._isPlacing){const i=e.vertices[0].coordinates;return void this._handlePlace(i)}if(this._drawGraphicTool.cursor=null,this._isRotating&&this._handleRotate(e.vertices[0].coordinates),this._isScaling){const i=this._drawGraphicTool?.drawOperation.cursorVertex;this._handleScale(i)}}finally{this._renderOverlays()}}_onDrawComplete(){this._drawGraphicTool.cursor=null,this.interactivePlacementState=null}_onVertexAdd(e,i){const r=e.vertices[0].coordinates;this._isPlacing&&this._handlePlace(r),this._isRotating&&this._sketchedVertexCount>0&&this._handleRotate(r),this._isScaling&&this._sketchedVertexCount>0&&this._handleScale(N(r[0],r[1],void 0,this.view.spatialReference)),this._sketchedVertexCount++,this._drawGraphicTool.cursor=null,this._sketchedVertexCount!==2&&i==="interactive"||(this.interactivePlacementState=null),this._renderOverlays()}_handlePlace(e){const{grid:i,view:r}=this;i&&r&&(i.center=new R({x:e[0],y:e[1],spatialReference:r.spatialReference}))}_handleRotate(e){const{grid:i,view:r}=this;if(!i||!r)return;this._drawGraphicTool?.sketchOptions.tooltips.set("enabled",!1);const{x:o,y:a}=i.center,[p,d]=e,h=r.toScreen(i.center,{pickClosestTarget:!0}),y=h&&r.toMap(h),w=r.toScreen(N(p,d,void 0,r.spatialReference),{pickClosestTarget:!0}),C=w&&r.toMap(w),x=y?y.x:o,L=y?y.y:a,P=x-(C?C.x:p),V=L-(C?C.y:d);if(P===0&&V===0)return;const ne=Math.atan2(V,P),j=ve(ne),se=i.rotateWithMap,oe=r.viewpoint.rotation??0,ae=se?j:j-oe;i.rotation=Math.fround(ae)%360}_handleScale(e){const{view:i,grid:r,_drawGraphicTool:o,interactivePlacementState:a,_metersPerSRUnit:p}=this;if(!(e&&i&&r&&o&&p))return;o.sketchOptions.tooltips.enabled=!1;const d=a==="interactive"?r.center:o.drawOperation.firstVertex;if(!d||!e)return;const h=i?.toScreen(d),y=h&&i.toMap(h),w=i?.toScreen(e),C=y??d,x=(w&&i.toMap(w))??e,L=Math.sqrt((C.x-x.x)**2+(C.y-x.y)**2),P=U(L*p,"meters",r.units);this.spacing=P}_renderOverlays(){this._renderCrosshairOverlay(),this._renderTextOverlay()}_renderTextOverlay(){const{grid:e,view:i,_drawGraphicTool:r}=this,o=this._getCrosshairLabel();if(!(e&&i?.overlay&&r&&o))return;const a=i.toScreen(e.center,{pickClosestTarget:!0});a&&(o.position=[a.x+12,a.y+12]),this._isRotating?(o.text=`${ie(e.rotation)}${qe}`,o.visible=!0):o.visible=!1}_renderCrosshairOverlay(){const{grid:e,view:i,_drawGraphicTool:r}=this;if(!e||!i?.overlay||!r)return;const o=this._getCrosshair();if(!o)return;const a=i.toScreen(e.center);a&&(o.x=a.x,o.y=a.y,o.rotation=e.rotateWithMap?i.viewpoint.rotation-e.rotation:-e.rotation,o.visible=!!r)}_getCrosshairLabel(){if(this._crosshairLabel)return this._crosshairLabel;const{grid:e,view:i,_drawGraphicTool:r}=this;if(!e||!i?.overlay||!r)return null;const o=new We({anchor:"top-left",fontSize:10,textColor:new g([21,21,21]),backgroundColor:new g([248,248,248]),padding:8,borderRadius:20});return i.overlay.addItem(o),this._crosshairLabel=o,o}_getCrosshair(){const{_crosshairItem:e,view:i}=this;return i?.overlay?e&&i.overlay.items.includes(e)?e:(this._crosshairItem=new Ze({color:i.effectiveTheme.accentColor,thickness:4,length:36,visible:!0}),i.overlay?.addItem(this._crosshairItem),this._crosshairItem):null}_resetGridPlacementState(){this.removeHandles(Z),this._crosshairItem&&(this._crosshairItem.visible=!1),this._crosshairLabel&&(this._crosshairLabel.visible=!1),this._drawGraphicTool&&(this.view?.activeTool===this._drawGraphicTool&&(this.view.activeTool=null),this.view?.tools.remove(this._drawGraphicTool)),this._drawGraphicTool=A(this._drawGraphicTool)}};n([s(Fe)],c.prototype,"defaultUnit",void 0),n([s({readOnly:!0})],c.prototype,"displayEnabled",null),n([s()],c.prototype,"dynamicScaling",null),n([s()],c.prototype,"grid",null),n([s({type:g})],c.prototype,"gridColor",null),n([s({readOnly:!0})],c.prototype,"gridControlsEnabled",null),n([s()],c.prototype,"interactivePlacementState",null),n([s()],c.prototype,"majorLineInterval",null),n([s()],c.prototype,"rotateWithMap",null),n([s()],c.prototype,"rotation",null),n([s()],c.prototype,"snappingEnabled",null),n([s()],c.prototype,"snappingManager",void 0),n([s({type:Ue})],c.prototype,"snappingOptions",void 0),n([s()],c.prototype,"spacing",null),n([s()],c.prototype,"unit",null),n([s()],c.prototype,"view",void 0),n([s({readOnly:!0})],c.prototype,"gridOutOfScale",null),n([s({readOnly:!0})],c.prototype,"effectiveSpacingAfterDynamicScaling",null),n([s({readOnly:!0})],c.prototype,"numericSpacingInputShouldBeVisible",null),n([s()],c.prototype,"placementDisabled",void 0),n([s()],c.prototype,"_metersPerSRUnit",null),n([s()],c.prototype,"_pixelsPerStride",null),n([s()],c.prototype,"_isPlacing",null),n([s()],c.prototype,"_isRotating",null),n([s()],c.prototype,"_isScaling",null),n([s()],c.prototype,"_mostRecentlyShownGrid",void 0),n([s()],c.prototype,"_sketchedVertexCount",void 0),c=n([M("esri.widgets.support.GridControls.GridControlsViewModel")],c);const re=c,J=new X({width:0}),Ke=new ge({color:g.fromArray([0,0,0,0]),outline:new X({color:g.fromArray([0,0,0,0])})}),f="esri-grid-controls",b={base:f,borderedSwitch:`${f}__switch--bordered`,container:`${f}__container`,numericInputsContainer:`${f}__numeric-inputs__container`,tilegroup:`${f}__tilegroup`,tile:`${f}__tile`,tileDisabled:`${f}__tile--disabled`,tileContent:`${f}__tile__content`,suffixedInputContainer:`${f}__input-with-suffix__container`,inputSuffix:`${f}__input-with-suffix__suffix-part`,inlineIcon:`${f}__inline-icon`},$={widgetIcon:"grid-unit",gridTheme:{light:"circle",dark:"circle-area",custom:"palette"},placementState:{interactive:"maximum-territory-distance",place:"move",rotate:"rotate"},warning:"exclamation-mark-triangle"},T=g.fromArray([115,115,115]),D=g.fromArray([200,200,200]),Qe=["interactive","place","rotate"];let m=class extends fe{constructor(t,e){super(t,e),this.customColor=null,this.messages=null,this.messagesUnits=null,this.viewModel=new re,this.visibleElements=new Y}initialize(){this.addHandles([E(()=>this.view?.grid?.majorLineColor,t=>{!t||T.equals(t)||D.equals(t)||(this.customColor=t)},_e)])}loadDependencies(){return Promise.all([be({action:()=>S(()=>import("./index-BaHSXQSf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]),import.meta.url),"action-bar":()=>S(()=>import("./index-BszAqEfC.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,17,19,20,21,22,23,24,25,26,27,28,29]),import.meta.url),label:()=>S(()=>import("./index-DFQUiqV8.js"),__vite__mapDeps([30,2,3,4,5,6,7,31,11]),import.meta.url),icon:()=>S(()=>import("./index-Dsw0xHWV.js").then(t=>t.i),__vite__mapDeps([10,2,3,4,5,6,7,11,12]),import.meta.url),popover:()=>S(()=>import("./index-CUpY7mOl.js").then(t=>t.i),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10,11,12,0,13,14,15,16,17,20,21,22,23,24,25]),import.meta.url),tooltip:()=>S(()=>import("./index-N2wu9FVr.js"),__vite__mapDeps([32,2,3,4,5,6,7,14,20,11,21,8,22,24,13]),import.meta.url),"color-picker":()=>S(()=>import("./index-D6Oux7Jv.js"),__vite__mapDeps([33,2,3,4,5,6,7,13,14,34,35,11,10,12,36,37,38,25,39,15,31,16,17,40,9,41,1,8,42,23,21]),import.meta.url),"input-number":()=>S(()=>import("./index-DpBSpE1C.js"),__vite__mapDeps([41,10,2,3,4,5,6,7,11,12,36,37,38,14,25,13,39,15,31,16,17,40,9]),import.meta.url)}),Se()])}get icon(){return $.widgetIcon}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages.widgetLabel}set label(t){this._overrideIfSome("label",t)}get snappingManager(){return this.viewModel.snappingManager}set snappingManager(t){this.viewModel.snappingManager=t}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(t){this.viewModel.snappingOptions=t}get theme(){const t=this.viewModel.grid?.majorLineColor;return t?T.equals(t)?"dark":D.equals(t)?"light":"custom":null}set theme(t){const{viewModel:e,customColor:i,view:r}=this;switch(t){case"light":e.gridColor=D;break;case"dark":e.gridColor=T;break;case"custom":e.gridColor=i??r?.effectiveTheme.accentColor??T}}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){return l("div",{"aria-label":this.label,class:this.classes(b.base,B.widget,B.panel)},l("div",{class:b.container},this._renderContent()))}_renderContent(){const{visibleElements:t}=this;return[t.gridEnabledToggle?this._renderEnabledToggle():null,t.placementButtons?this._renderGridPlacementButtons():null,t.numericInputs?this._renderNumericInputs():null,t.lineIntervalInput?this._renderIntervalInput():null,t.gridSnapEnabledToggle&&this.viewModel.snappingOptions?this._renderSnappingToggle():null,t.dynamicScaleToggle?this._renderDynamicScaleToggle():null,t.rotateWithMapToggle?this._renderRotateToggle():null,t.colorSelection?this._renderColorSelection():null]}_renderGridPlacementButtons(){const{interactivePlacementState:t,placementDisabled:e,gridControlsEnabled:i}=this.viewModel,r=e||!i;return l("calcite-label",{key:"grid-placement-buttons",scale:"s"},this.messages.placementOptions,l("calcite-action-bar",{expandDisabled:!0,layout:"horizontal"},Qe.map(o=>this._renderPlacementModeButton(o,r,t))))}_renderPlacementModeButton(t,e,i){const r=this.messages.placementState[t],o=`__placement-action-${t}`;return l("div",null,l("calcite-action",{active:i===t,alignment:"center",disabled:e,icon:$.placementState[t],id:o,onclick:()=>this.viewModel.togglePlacementState(t),text:r}),l("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:o},r))}_renderNumericInputs(){const{rotation:t,spacing:e,effectiveSpacingAfterDynamicScaling:i,numericSpacingInputShouldBeVisible:r,unit:o="meters"}=this.viewModel,a=this.messagesUnits.units[o].abbr,p=this.viewModel.gridControlsEnabled,d=i!=null&&i!==this.viewModel.spacing,h=`__spacing_input_scaled-${this.id}`;return l("div",{class:this.classes(b.numericInputsContainer)},[r?l("calcite-label",{key:"spacing-label",scale:"s"},l("span",null,this.messages.inputLabel.spacing,d?l("calcite-icon",{class:this.classes(b.inlineIcon),icon:$.warning,id:h,scale:"s",tabIndex:0}):void 0),l("div",{class:b.suffixedInputContainer},l("calcite-input-number",{disabled:!p,numberButtonType:"none",suffixText:a,value:`${e?.toFixed(2)}`,onCalciteInputNumberChange:({currentTarget:y})=>{const w=parseFloat(y.value);this.viewModel.spacing=w,w!==this.viewModel.spacing&&(y.value=`${this.viewModel.spacing}`)}}),d?l("calcite-tooltip",{overlayPositioning:"fixed",placement:"leading",referenceElement:h},Ne(this.messages.warnings.dynamicSpacing,{actualSpacingIncludingUnit:ye(this.messagesUnits,i,o,2,"plural")})):void 0)):void 0,l("calcite-label",{key:"angle-label",scale:"s"},this.messages.inputLabel.angle,l("calcite-input-number",{disabled:!p,integer:!0,numberButtonType:"none",suffixText:this.messagesUnits.units.degrees.abbr,value:`${ie(t)}`,onCalciteInputNumberChange:({currentTarget:y})=>this.viewModel.rotation=Je(y.value)}))])}_renderIntervalInput(){const{majorLineInterval:t,gridControlsEnabled:e}=this.viewModel;return l("div",{class:this.classes(b.numericInputsContainer)},l("calcite-label",{scale:"s"},this.messages.inputLabel.interval,l("calcite-input-number",{disabled:!e,integer:!0,max:15,min:1,numberButtonType:"vertical",value:`${t}`,onCalciteInputNumberChange:({currentTarget:i})=>{const r=Number.parseInt(i.value,10);this.viewModel.majorLineInterval=r,r!==this.viewModel.majorLineInterval&&(i.value=`${this.viewModel.majorLineInterval}`)}})))}_renderSnappingToggle(){const{snappingOptions:t,gridControlsEnabled:e}=this.viewModel;return l(I,{checked:!!(t?.gridEnabled??!1),disabled:!(e&&t),key:"grid-snap-enabled-toggle",label:this.messages.switchLabel.snap,onChange:i=>this.viewModel.snappingOptions?.set("gridEnabled",i)})}_renderDynamicScaleToggle(){const{viewModel:t,messages:e}=this,i=this.visibleElements.outOfScaleWarning&&t.gridOutOfScale;return l(I,{checked:t.dynamicScaling,disabled:!t.gridControlsEnabled,hint:i?e.warnings.outOfScale:void 0,hintIcon:$.warning,hintKind:"warning",key:`grid-dynamic-scale-toggle-${this.id}`,label:e.switchLabel.scaling,onChange:r=>t.dynamicScaling=r})}_renderRotateToggle(){const{gridControlsEnabled:t,rotateWithMap:e}=this.viewModel;return l(I,{checked:e,disabled:!t,key:"grid-rotate-map-toggle",label:this.messages.switchLabel.rotateWithMap,onChange:i=>this.viewModel.rotateWithMap=i})}_renderEnabledToggle(){return l("div",{class:b.borderedSwitch},l(I,{checked:this.viewModel.displayEnabled,disabled:!!this.viewModel.interactivePlacementState,key:"grid-enabled-toggle",label:this.messages.switchLabel.display,onChange:t=>this.viewModel.trySetDisplayEnabled(t)}))}_renderColorSelection(){const{customColor:t}=this,e=`${this.id}--custom-grid-color-button`;return l("calcite-label",{scale:"s"},this.messages.inputLabel.theme,l("div",{class:b.tilegroup},[this._renderThemeTile({value:"dark"}),this._renderThemeTile({value:"light"}),this._renderThemeTile({value:"custom",id:e}),l("calcite-popover",{autoClose:!0,label:this.messages.gridLineColorPopoverLabel,overlayPositioning:"fixed",referenceElement:e},l("calcite-color-picker",{alphaChannel:!0,savedDisabled:!0,value:t?.toHex({digits:8})??"#000000ff",onCalciteColorPickerChange:i=>{const r=g.fromHex(i.currentTarget.value);r&&(this.customColor=r,this.theme="custom")}}))]))}_renderThemeTile(t){const{theme:e}=this,{value:i}=t,r=this.messages.gridTheme[i],o=`${this.id}--theme_tile_${i}`,a=`${o}__label`,p=$.gridTheme[i],d=this.viewModel.gridControlsEnabled;return l("div",{class:we({[b.tile]:!0,[b.tileDisabled]:!d}),id:t.id,role:"button"},l("input",{"aria-labelledby":a,checked:e===i,disabled:!d,id:o,name:`${this.id}--theme`,onchange:h=>{this.theme=i,h.target?.focus()},tabIndex:0,type:"radio"}),l("div",{class:b.tileContent},l("calcite-icon",{icon:p,scale:"l"}),l("calcite-label",{for:o,id:a},r)))}};n([s({type:g})],m.prototype,"customColor",void 0),n([s()],m.prototype,"icon",null),n([s()],m.prototype,"label",null),n([s(),W("esri/widgets/support/GridControls/t9n/GridControls")],m.prototype,"messages",void 0),n([s(),W("esri/core/t9n/Units")],m.prototype,"messagesUnits",void 0),n([s()],m.prototype,"snappingManager",null),n([s()],m.prototype,"snappingOptions",null),n([s()],m.prototype,"theme",null),n([s()],m.prototype,"view",null),n([s({type:re})],m.prototype,"viewModel",void 0),n([s({type:Y,nonNullable:!0})],m.prototype,"visibleElements",void 0),m=n([M("esri.widgets.support.GridControls")],m);const ji=m;export{ji as default};
