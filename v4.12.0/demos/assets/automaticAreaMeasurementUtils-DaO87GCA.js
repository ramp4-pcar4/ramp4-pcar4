import{ix as B,ab as V,fd as X,v as s,x as r,J as g,a5 as Y,iy as S}from"./main-D6UWMbWJ.js";import{T as Z,U as J,V as W,W as H,X as z,Y as O,Z as m}from"./SketchViewModel-BQEEJoEu.js";import{n as N}from"./PointSnappingHint-JorhXB6u.js";import{l as w,h as q,s as v,a as U,o as P,U as L,d as E,i as d}from"./quantityUtils-B7WFJP6j.js";import{l as K,B as h,U as G,C as T,H as tt,w as et,J as it,A as nt,K as Q}from"./automaticLengthMeasurementUtils-ByRZj4YK.js";import{n as ot}from"./uuid-Cl5lrJ4c.js";import{r as st,e as at}from"./geodesicLengthMeasurementUtils-JxSmg9AU.js";import{e as rt}from"./earcut-Lltz9D9k.js";import{o as D,q as lt,j as ut}from"./vec32-DvB22h0L.js";import{n as ct}from"./projectVectorToVector-2U_T6yxL.js";import{p as ft,D as pt,O as ht,J as mt}from"./plane-DXyNbfXV.js";import{v as dt}from"./triangle-C_fuLIxe.js";import{C as gt}from"./index-BNk7091c.js";import{v as vt}from"./geodesicUtils-CINGW30v.js";function yt(e){const{spatialReference:i}=e;return st(i,kt,$t,e)}function kt(e){return w(Math.abs(vt([e],"square-meters")[0]),"square-meters")}function $t(e){try{return w(Math.abs(gt(e,"square-meters")),"square-meters")}catch{return null}}function bt(e,i=F()){return It(e,i,!1)}function It(e,i,t=e.hasZ){const n=K(e.spatialReference),o=B(n);if(o==null)return null;const c=(y,p)=>!(p.length<2)&&(D(y,p[0],p[1],t&&p[2]||0),!0);let l=0;for(const y of e.rings){const p=y.length;if(p<3)continue;const{positionsWorldCoords:f}=i;for(;f.length<p;)f.push(V());const C=xt,k=D(At,0,0,0),j=1/p;for(let u=0;u<p;u++){if(!c(C,y[u])||!ct(C,e.spatialReference,f[u],n))return null;lt(k,k,f[u],j)}const R=ft(f[0],f[1],k,pt());if(ut(ht(R))===0)continue;for(let u=0;u<p;u++)mt(R,k,f[u],f[u]);const $=wt(f);for(let u=0;u<$.length;u+=3)l+=dt(f[$[u]],f[$[u+1]],f[$[u+2]])}return w(l,o)}const xt=V(),At=V();function F(){return{positionsWorldCoords:[]}}function wt(e){return rt(Ut(e),[],2)}function Ut(e){const i=new Float64Array(2*e.length);for(let t=0;t<e.length;++t){const n=e[t],o=2*t;i[o]=n[0],i[o+1]=n[1]}return i}class Ht{draw(i,t){const n=Vt(i),o=this.sortUniqueHints(n),c=[];for(const l of o)l instanceof Z&&c.push(this.visualizeIntersectionPoint(l,t)),l instanceof J&&c.push(this.visualizeLine(l,t)),l instanceof W&&c.push(this.visualizeParallelSign(l,t)),l instanceof H&&c.push(this.visualizeRightAngleQuad(l,t)),l instanceof N&&c.push(this.visualizePoint(l,t));return X(c)}sortUniqueHints(i){return i}}function Vt(e){const i=[];for(const t of e){let n=!0;for(const o of i)if(t.equals(o)){n=!1;break}n&&i.push(t)}return i}let a=class extends Y{constructor(e){super(e),this.actual=null,this.lockable=!0,this.id=ot(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(e){this.lockable&&this._set("committed",e)}get dirty(){return this.inputValue!=null}get locked(){return this.lockable&&this.committed!=null}onInput(e){this.inputValue=e,this.invalid=!1}onCommit(e,i,t){this.lockable?this._onCommitLockable(e,t):this._onCommitNonLockable(t),this.invalid&&e==="commit-and-exit"||t.onCommit(i,e)}_onCommitLockable(e,i){const{inputValue:t,locked:n}=this;n&&b(t)?this.unlock():(e==="commit-and-exit"&&!n||t!=null)&&this._parseInputAndLock(i)}_onCommitNonLockable(e){const{inputValue:i}=this;b(i)?this.lockable?this.setActual(null):this.clearInputValue():i!=null&&this._parseInputAndSetActual(e)}applyValue(e){this.lockable?this.lock(e):this.setActual(e)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(e){this.actual=e,this.clearInputValue()}lock(e){this.lockable&&(this.committed=e??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(e){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(e))}getSuffix(e){const{suffix:i}=this;return typeof i=="function"?i(e):i}getFormattedValue(e){const{actual:i,committed:t,format:n}=this;return t!=null?n(t,e):i!=null?n(i,e):null}getRawDisplayValue(e){const{actual:i,committed:t,inputValue:n}=this;return n??(this.lockable&&t!=null?this.formatForInputMode(t,e):i!=null?this.formatForInputMode(i,e):null)}_parseInputAndSetActual(e){const{inputValue:i}=this;if(i==null||b(i))return this.setActual(null);const t=this.parse(i,e);t!=null?this.setActual(t):this.invalid=!0}_parseInputAndLock(e){const{inputValue:i,actual:t}=this;if(b(i))return this.unlock();if(i==null)return this.lock(t);const n=this.parse(i,e);n!=null?this.lock(n):this.invalid=!0}};function b(e){return e!=null&&e.trim()===""}s([r()],a.prototype,"actual",void 0),s([r()],a.prototype,"committed",null),s([r()],a.prototype,"dirty",null),s([r()],a.prototype,"format",void 0),s([r()],a.prototype,"formatForInputMode",void 0),s([r()],a.prototype,"lockable",void 0),s([r()],a.prototype,"locked",null),s([r()],a.prototype,"id",void 0),s([r()],a.prototype,"inputValue",void 0),s([r()],a.prototype,"name",void 0),s([r()],a.prototype,"parse",void 0),s([r()],a.prototype,"readOnly",void 0),s([r()],a.prototype,"suffix",void 0),s([r()],a.prototype,"title",void 0),s([r()],a.prototype,"visible",void 0),s([r()],a.prototype,"invalid",void 0),s([r()],a.prototype,"unlockOnVertexPlacement",void 0),a=s([g("esri.views.interactive.tooltip.fields.TooltipField")],a);let I=class extends a{constructor(i){super(i),this.showAsZ=!1}normalizeCtorArgs(i){const t=n=>n.inputUnitInfos.verticalLength.unit;return{name:"elevation",actual:q,parse:h({createQuantity:(n,o)=>U(n,t(o))}),format:(n,o)=>o.formatters.verticalLength(n),formatForInputMode:(n,o)=>o.formatters.scalar(v(n,t(o))),suffix:n=>n.inputUnitInfos.verticalLength.abbreviation,title:n=>n.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1,...i}}};s([r()],I.prototype,"showAsZ",void 0),I=s([g("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],I);let x=class extends a{constructor(e){super(e),this.precision=1}normalizeCtorArgs(e){const i=t=>t.inputUnitInfos.angle.unit;return{name:"orientation",actual:null,parse:h({createQuantity:(t,n)=>P(t,i(n),"geographic"),sanitize:T}),format:t=>{const n=z(t);return G(n,"geographic",this.precision)},formatForInputMode:(t,n)=>{const o=z(t);return n.formatters.scalar(o)},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.orientation,...e}}};s([r()],x.prototype,"precision",void 0),x=s([g("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],x);let A=class extends a{constructor(e){super(e),this.precision=null}normalizeCtorArgs(e){const i=t=>t.inputUnitInfos.length.unit;return{name:"size",actual:null,parse:h({createQuantity:(t,n)=>U(t,i(n))}),format:(t,n)=>n.formatters.length(t),formatForInputMode:(t,n)=>n.formatters.scalar(v(t,i(n))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.size,...e}}};s([r()],A.prototype,"precision",void 0),A=s([g("esri.views.interactive.tooltip.fields.TooltipFieldSize")],A);function Et(e){const i=n=>n.inputUnitInfos.angle.unit,t=n=>n.sketchOptions.values.effectiveDirectionMode;return new a({name:"direction",actual:L,parse:h({createQuantity:(n,o)=>P(n,i(o),"geographic"),sanitize:T}),format:(n,o)=>{const c=t(o),l=O(n,c);switch(c){case m.Absolute:return o.formatters.direction(l);case m.Relative:return o.formatters.directionRelative(l);case m.RelativeBilateral:return o.formatters.directionRelativeBilateral(l)}},formatForInputMode:(n,o)=>{const c=O(n,t(o));return o.formatters.scalar(v(c,i(o)))},suffix:n=>n.inputUnitInfos.angle.abbreviation,title:n=>{const o=t(n),{absolute:c,relative:l}=n.messages.sketch.direction;switch(o){case m.Absolute:return c;case m.Relative:case m.RelativeBilateral:return l}},...e})}function M(e){const i=t=>t.inputUnitInfos.length.unit;return new a({name:"distance",actual:q,parse:h({createQuantity:(t,n)=>U(Math.max(t,0),i(n))}),format:(t,n)=>n.formatters.length(t),formatForInputMode:(t,n)=>n.formatters.scalar(v(t,i(n))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.distance,...e})}function Kt(e){return M({format:(i,t)=>t.formatters.totalLength(i),title:i=>i.messages.sketch.totalLength,readOnly:!0,...e})}function Gt(e){return M({...e})}function te(e){const i=t=>t.inputUnitInfos.length.unit;return M({...e,parse:h({createQuantity:(t,n)=>U(t,i(n))}),format:(t,n)=>n.formatters.lengthRelative(t)})}function Lt(e){return new I(e)}function ee(e){return new x(e)}function ie(e){return new A(e)}function ne(e){return _("scale",{name:"scale",actual:null,parse:h({createQuantity:i=>d(Math.abs(i))}),...e})}function oe(e){const i=t=>t.inputUnitInfos.area.unit;return new a({name:"area",actual:E,parse:h({createQuantity:(t,n)=>w(t,i(n))}),format:(t,n)=>n.formatters.area(t),formatForInputMode:(t,n)=>n.formatters.scalar(v(t,i(n))),suffix:t=>t.inputUnitInfos.area.abbreviation,title:t=>t.messages.sketch.area,readOnly:!0,...e})}function Ft(e){return new a({name:"x",actual:L,parse:tt,format:(i,t)=>t.formatters.longitudeDecimalDegrees(i),formatForInputMode:i=>et(i),suffix:i=>i.inputUnitInfos.angle.abbreviation,title:i=>i.messages.sketch.longitude,...e})}function Mt(e){return new a({name:"y",actual:L,parse:it,format:(i,t)=>t.formatters.latitudeDecimalDegrees(i),formatForInputMode:i=>nt(i),suffix:i=>i.inputUnitInfos.angle.abbreviation,title:i=>i.messages.sketch.latitude,...e})}function _t(e){return _("x",{name:"x",...e})}function Ct(e){return _("y",{name:"y",...e})}function _(e,i){return new a({actual:d(0),parse:h({createQuantity:t=>d(t)}),format:(t,n)=>n.formatters.scalar(t),formatForInputMode:(t,n)=>n.formatters.scalar(t),title:t=>t.messages.sketch[e],...i})}const se=e=>{let i=class extends e{constructor(){super(...arguments),this.longitude=Ft(),this.latitude=Mt(),this.x=_t(),this.y=Ct(),this.elevation=Lt(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(t,n=t?.spatialReference){if(this.geographic=!!n&&at(n),t==null)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){const o=S(t,Rt);this._setActualLonLat(Q(o?.[0]),Q(o?.[1]))}else this._setActualXY(d(t.x),d(t.y))}_setActualLonLat(t,n){this.longitude.actual=t,this.latitude.actual=n}_setActualXY(t,n){this.x.actual=t,this.y.actual=n}};return s([r()],i.prototype,"geographic",void 0),s([r()],i.prototype,"effectiveX",null),s([r()],i.prototype,"effectiveY",null),s([r()],i.prototype,"key",null),i=s([g("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],i),i},Rt=[0,0];function zt(e,i,t=F()){{const n=yt(e);return n??bt(e,t)}}function ae(e,i=F()){return zt(e,"on-the-ground",i)}export{Gt as F,oe as Q,ne as R,se as h,ie as j,ee as k,Ht as r,ae as u,Kt as w,te as x,Et as y};
