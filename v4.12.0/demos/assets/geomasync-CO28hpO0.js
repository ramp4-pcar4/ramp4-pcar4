const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./unitConversion-BKOFNkqQ.js","./main-D6UWMbWJ.js","./preload-helper-ExcqyqRp.js","./main-DCJluy1C.css"])))=>i.map(i=>d[i]);
import{_ as X}from"./preload-helper-ExcqyqRp.js";import{F as c,ac as S,o as h,X as Z,ad as k,ae as B,j as C,h as v,A as q,w as F,af as _,ag as E,ah as G,ai as M,d as J,aj as Q,J as b,ak as Y,al as T,am as $,an as z,c as R,K as j}from"./arcade-DNrIe9TT.js";import{a as o,r as s}from"./unitConversion-BKOFNkqQ.js";import{o as O}from"./TimeOnly-DxJjRuWE.js";import{l as V}from"./portalUtils-CITmgiGi.js";import{a as f}from"./operatorsWorkerConnection-1zgl8jqA.js";import{bf as nn,b9 as H,dg as w,al as y,de as P,ar as x,af as U,ap as I,ag as L,aq as tn,C as K}from"./main-D6UWMbWJ.js";import"./ImmutableArray-BPVd6ESQ.js";import"./shared-Dq8KPrAL.js";import"./Field-BRKBBmM6.js";import"./fieldType-B-0DY-YK.js";import"./number-yo9J8KAb.js";import"./featureConversionUtils-BOo8MNJa.js";import"./OptimizedFeatureSet-7J4kTonF.js";import"./memoryEstimations-bvdrNroi.js";import"./OptimizedGeometry-7XEw-Hai.js";import"./FieldsIndex-C0Zyp4KO.js";import"./timeZoneUtils-BNp2mfEj.js";import"./WhereClause-BVZx_Mm8.js";import"./uuid-Cl5lrJ4c.js";import"./workers-DADVStUK.js";import"./Queue-Bp8J9hIN.js";import"./intl-D8pxRaLS.js";async function W(a,t,e){if(!nn?.findCredential(a.restUrl))return null;if(a.loadStatus==="loaded"&&t===""&&a.user?.sourceJSON&&e===!1)return a.user.sourceJSON;const u={responseType:"json",query:{f:"json"}};if(e&&(u.query.returnUserLicenseTypeExtensions=!0),t===""){const r=await H(a.restUrl+"/community/self",u);if(r.data){const i=r.data;if(i?.username)return i}return null}const n=await H(a.restUrl+"/community/users/"+t,u);if(n.data){const r=n.data;return r.error?null:r}return null}function N(a){if(a==null)return a;switch(typeof a){case"string":case"number":return a;default:throw new o(null,s.InvalidParameter,null)}}function In(a){a.mode==="async"&&(a.functions.disjoint=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>(n=c(n),S(n,t,e),n[0]===null||n[1]===null||f("disjoint",[n[0].toJSON(),n[1].toJSON()])))},a.functions.intersects=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>(n=c(n),S(n,t,e),n[0]!==null&&n[1]!==null&&f("intersects",[n[0].toJSON(),n[1].toJSON()])))},a.functions.touches=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>(n=c(n),S(n,t,e),n[0]!==null&&n[1]!==null&&f("touches",[n[0].toJSON(),n[1].toJSON()])))},a.functions.crosses=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>(n=c(n),S(n,t,e),n[0]!==null&&n[1]!==null&&f("crosses",[n[0].toJSON(),n[1].toJSON()])))},a.functions.within=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>(n=c(n),S(n,t,e),n[0]!==null&&n[1]!==null&&f("within",[n[0].toJSON(),n[1].toJSON()])))},a.functions.contains=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>(n=c(n),S(n,t,e),n[0]!==null&&n[1]!==null&&f("contains",[n[0].toJSON(),n[1].toJSON()])))},a.functions.overlaps=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>(n=c(n),S(n,t,e),n[0]!==null&&n[1]!==null&&f("overlaps",[n[0].toJSON(),n[1].toJSON()])))},a.functions.equals=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>(h(n,2,2,t,e),n[0]===n[1]||(n[0]instanceof w&&n[1]instanceof w?f("equals",[n[0].toJSON(),n[1].toJSON()]):(Z(n[0])&&Z(n[1])||!!(k(n[0])&&k(n[1])||B(n[0])&&B(n[1])))&&n[0].equals(n[1]))))},a.functions.relate=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>{if(n=c(n),h(n,3,3,t,e),n[0]instanceof w&&n[1]instanceof w)return f("relate",[n[0].toJSON(),n[1].toJSON(),C(n[2])]);if(n[0]instanceof w&&n[1]===null||n[1]instanceof w&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new o(t,s.InvalidParameter,e)})},a.functions.intersection=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>(n=c(n),S(n,t,e),n[0]===null||n[1]===null?null:y(await f("intersection",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.union=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if((n=c(n)).length===0)throw new o(t,s.WrongNumberOfParameters,e);const r=[];if(n.length===1)if(P(n[0])){for(const i of c(n[0]))if(i!==null){if(!(i instanceof w))throw new o(t,s.InvalidParameter,e);r.push(i.toJSON())}}else{if(!v(n[0])){if(n[0]instanceof w)return q(O(n[0]),t.spatialReference);if(n[0]===null)return null;throw new o(t,s.InvalidParameter,e)}for(const i of c(n[0].toArray()))if(i!==null){if(!(i instanceof w))throw new o(t,s.InvalidParameter,e);r.push(i.toJSON())}}else for(const i of n)if(i!==null){if(!(i instanceof w))throw new o(t,s.InvalidParameter,e);r.push(i.toJSON())}return r.length===0?null:y(await f("union",[r]))})},a.functions.difference=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>(n=c(n),S(n,t,e),n[0]===null?null:n[1]===null?O(n[0]):y(await f("difference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.symmetricdifference=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>(n=c(n),S(n,t,e),n[0]===null&&n[1]===null?null:n[0]===null?O(n[1]):n[1]===null?O(n[0]):y(await f("symmetricDifference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.clip=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,2,t,e),!(n[1]instanceof x)&&n[1]!==null)throw new o(t,s.InvalidParameter,e);if(n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);return n[1]===null?null:y(await f("clip",[n[0].toJSON(),n[1].toJSON()]))})},a.functions.cut=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,2,t,e),!(n[1]instanceof U)&&n[1]!==null)throw new o(t,s.InvalidParameter,e);if(n[0]===null)return[];if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);return n[1]===null?[O(n[0])]:(await f("cut",[n[0].toJSON(),n[1].toJSON()])).map(r=>y(r))})},a.functions.area=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(h(n,1,2,t,e),n=c(n),F(n[0])){const i=await n[0].sumArea(N(n[1]),!1,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,s.Cancelled,e);return i}let r=n[0];if((P(r)||v(r))&&(r=_(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,s.InvalidParameter,e);return f("area",[r.toJSON(),N(n[1])])})},a.functions.areageodetic=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(h(n,1,2,t,e),n=c(n),F(n[0])){const i=await n[0].sumArea(N(n[1]),!0,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,s.Cancelled,e);return i}let r=n[0];if((P(n[0])||v(n[0]))&&(r=_(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,s.InvalidParameter,e);return f("geodeticArea",[r.toJSON(),N(n[1])])})},a.functions.length=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(h(n,1,2,t,e),n=c(n),F(n[0])){const i=await n[0].sumLength(N(n[1]),!1,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,s.Cancelled,e);return i}let r=n[0];if((P(n[0])||v(n[0]))&&(r=E(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,s.InvalidParameter,e);return f("length",[r.toJSON(),N(n[1])])})},a.functions.length3d=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(h(n,1,2,t,e),(n=c(n))[0]===null)return 0;let r=n[0];if((P(n[0])||v(n[0]))&&(r=E(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,s.InvalidParameter,e);if(r.hasZ===!0){const{convertFromSpatialReferenceUnit:i,toLengthUnit:m}=await X(()=>import("./unitConversion-BKOFNkqQ.js").then(p=>p.e),__vite__mapDeps([0,1,2,3]),import.meta.url),d=G(r);return i(r.spatialReference,m(n[1]),d)}return f("length",[r.toJSON(),N(n[1])])})},a.functions.lengthgeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(h(n,1,2,t,e),n=c(n),F(n[0])){const i=await n[0].sumLength(N(n[1]),!0,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,s.Cancelled,e);return i}let r=n[0];if((P(n[0])||v(n[0]))&&(r=E(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,s.InvalidParameter,e);return f("geodeticLength",[r.toJSON(),N(n[1])])})},a.functions.distance=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{n=c(n),h(n,2,3,t,e);let r=n[0];if((P(n[0])||v(n[0]))&&(r=M(n[0],t.spatialReference)),!(r instanceof w))throw new o(t,s.InvalidParameter,e);let i=n[1];if((P(n[1])||v(n[1]))&&(i=M(n[1],t.spatialReference)),!(i instanceof w))throw new o(t,s.InvalidParameter,e);return f("distance",[r.toJSON(),i.toJSON(),N(n[2])])})},a.functions.distancegeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{n=c(n),h(n,2,3,t,e);const r=n[0];if(!(r instanceof I))throw new o(t,s.InvalidParameter,e);const i=n[1];if(!(i instanceof I))throw new o(t,s.InvalidParameter,e);const m=new U({paths:[],spatialReference:r.spatialReference});return m.addPath([r,i]),f("geodeticLength",[m.toJSON(),N(n[2])])})},a.functions.densify=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);const r=J(n[1]);if(isNaN(r))throw new o(t,s.InvalidParameter,e);if(r<=0)throw new o(t,s.InvalidParameter,e);switch(n[0].type){case"polygon":case"polyline":case"extent":return y(await f("densify",[n[0].toJSON(),r,N(n[2])]));default:return n[0]}})},a.functions.densifygeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);const r=J(n[1]);if(isNaN(r))throw new o(t,s.InvalidParameter,e);if(r<=0)throw new o(t,s.InvalidParameter,e);switch(n[0].type){case"polygon":case"polyline":case"extent":return y(await f("geodeticDensify",[n[0].toJSON(),r,N(n[2])]));default:return n[0]}})},a.functions.generalize=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,4,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);const r=J(n[1]);if(isNaN(r))throw new o(t,s.InvalidParameter,e);const i=Q(b(n[2],!0));return y(await f("generalize",[n[0].toJSON(),r,N(n[3]),{removeDegenerateParts:i}]))})},a.functions.buffer=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);const r=J(n[1]);if(isNaN(r))throw new o(t,s.InvalidParameter,e);return r===0?O(n[0]):y(await f("buffer",[n[0].toJSON(),r,N(n[2])]))})},a.functions.buffergeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);const r=J(n[1]);if(isNaN(r))throw new o(t,s.InvalidParameter,e);return r===0?O(n[0]):y(await f("geodesicBuffer",[n[0].toJSON(),r,N(n[2])]))})},a.functions.offset=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,6,t,e),n[0]===null)return null;if(!(n[0]instanceof L||n[0]instanceof U))throw new o(t,s.InvalidParameter,e);const r=J(n[1]);if(isNaN(r))throw new o(t,s.InvalidParameter,e);const i=C(n[3]??"round").toLowerCase();let m;switch(i){case"round":case"bevel":case"miter":case"square":m=i;break;default:m="round"}const d=J(b(n[4],10));if(isNaN(d))throw new o(t,s.InvalidParameter,e);const p=J(b(n[5],0));if(isNaN(p))throw new o(t,s.InvalidParameter,e);return y(await f("offset",[n[0].toJSON(),r,N(n[2]),{joins:m,miterLimit:d,flattenError:p}]))})},a.functions.rotate=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);const r=n[0]instanceof x?L.fromExtent(n[0]):n[0],i=J(n[1]);if(isNaN(i))throw new o(t,s.InvalidParameter,e);const m=b(n[2],null);if(m===null){const d=r.type==="point"?r:r.extent?.center;return y(await f("rotate",[r.toJSON(),i,d?.x,d?.y]))}if(m instanceof I)return y(await f("rotate",[r.toJSON(),i,m.x,m.y]));throw new o(t,s.InvalidParameter,e)})},a.functions.centroid=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,1,2,t,e),n[0]===null)return null;const r=C(n[1]??"geometric").toLowerCase();if(r!=="geometric"&&r!=="labelpoint")throw new o(t,s.InvalidParameter,e);let i=n[0];if((P(n[0])||v(n[0]))&&(i=r==="geometric"?M(n[0],t.spatialReference):_(n[0],t.spatialReference),i===null))return null;if(!(i instanceof w))throw new o(t,s.InvalidParameter,e);return y(r==="geometric"?await f("centroid",[i.toJSON()]):await f("labelPoint",[i.toJSON()]))})},a.functions.measuretocoordinate=function(t,e){return a.standardFunctionAsync(t,e,Y)},a.functions.pointtocoordinate=function(t,e){return a.standardFunctionAsync(t,e,T)},a.functions.distancetocoordinate=function(t,e){return a.standardFunctionAsync(t,e,$)},a.functions.multiparttosinglepart=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);if(n[0]instanceof I)return[q(O(n[0]),t.spatialReference)];if(n[0]instanceof x)return[q(O(n[0]),t.spatialReference)];const r=y(await f("simplify",[n[0].toJSON()]));if(r instanceof L){const i=[],m=[];for(let d=0;d<r.rings.length;d++)if(r.isClockwise(r.rings[d])){const p=y({rings:[r.rings[d]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(p)}else m.push({ring:r.rings[d],pt:r.getPoint(d,0)});for(let d=0;d<m.length;d++)for(let p=0;p<i.length;p++)if(i[p].contains(m[d].pt)){i[p].addRing(m[d].ring);break}return i}if(r instanceof U){const i=[];for(let m=0;m<r.paths.length;m++){const d=y({paths:[r.paths[m]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(d)}return i}if(n[0]instanceof tn){const i=[],m=q(O(n[0]),t.spatialReference);for(let d=0;d<m.points.length;d++)i.push(m.getPoint(d));return i}return null})},a.functions.issimple=function(t,e){return a.standardFunctionAsync(t,e,(l,u,n)=>{if(n=c(n),h(n,1,1,t,e),n[0]===null)return!0;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);return f("isSimple",[n[0].toJSON()])})},a.functions.simplify=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);return y(await f("simplify",[n[0].toJSON()]))})},a.functions.convexhull=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,s.InvalidParameter,e);return y(await f("convexHull",[n[0].toJSON()]))})},a.functions.getuser=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{h(n,0,2,t,e);let r=b(n[1],""),i=r===!0;if(r=r===!0||r===!1?"":C(r),n.length===0||n[0]instanceof z){let d;d=t.services?.portal?t.services.portal:K.getDefault(),n.length>0&&(d=V(n[0],d));const p=await W(d,r,i);if(p){const A=JSON.parse(JSON.stringify(p));for(const g of["lastLogin","created","modified"])A[g]!==void 0&&A[g]!==null&&(A[g]=new Date(A[g]));return R.convertObjectToArcadeDictionary(A,j(t))}return null}let m=null;if(F(n[0])&&(m=n[0]),m){if(i=!1,r)return null;await m.load();const d=await m.getOwningSystemUrl();if(!d){if(!r){const g=await m.getIdentityUser();return g?R.convertObjectToArcadeDictionary({username:g},j(t)):null}return null}let p;p=t.services?.portal?t.services.portal:K.getDefault(),p=V(new z(d),p);const A=await W(p,r,i);if(A){const g=JSON.parse(JSON.stringify(A));for(const D of["lastLogin","created","modified"])g[D]!==void 0&&g[D]!==null&&(g[D]=new Date(g[D]));return R.convertObjectToArcadeDictionary(g,j(t))}return null}throw new o(t,s.InvalidParameter,e)})},a.functions.nearestcoordinate=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,2,t,e),!(n[0]instanceof w||n[0]===null))throw new o(t,s.InvalidParameter,e);if(!(n[1]instanceof I||n[1]===null))throw new o(t,s.InvalidParameter,e);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof x?L.fromExtent(n[0]):n[0],i=await f("getNearestCoordinate",[r.toJSON(),n[1].toJSON(),{calculateLeftRightSide:!0}]);return i===null?null:R.convertObjectToArcadeDictionary({coordinate:y(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.rightSide?"right":"left"},j(t),!1,!0)})},a.functions.nearestvertex=function(t,e){return a.standardFunctionAsync(t,e,async(l,u,n)=>{if(n=c(n),h(n,2,2,t,e),!(n[0]instanceof w||n[0]===null))throw new o(t,s.InvalidParameter,e);if(!(n[1]instanceof I||n[1]===null))throw new o(t,s.InvalidParameter,e);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof x?L.fromExtent(n[0]):n[0],i=await f("getNearestVertex",[r.toJSON(),n[1].toJSON()]);return i===null?null:R.convertObjectToArcadeDictionary({coordinate:y(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.rightSide?"right":"left"},j(t),!1,!0)})})}export{In as registerFunctions};
