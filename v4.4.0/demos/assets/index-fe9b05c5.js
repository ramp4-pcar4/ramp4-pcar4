import{bZ as ve,lg as W,c3 as Y,lh as fe,c4 as J,c5 as ee,b$ as ye,fl as _e,fp as I,c6 as y,hT as be,hO as de,fr as ie,hs as j,fs as le,c7 as ae,c8 as Q,c9 as a,ca as X,cb as Z,cc as G,cd as b,ce as v,ch as n,fo as f,ci as ne,cj as oe,cg as q,hF as N,cf as ue,li as xe,lj as ce,lk as we,k9 as $e,h_ as Le,ll as ke,gG as te,gH as Ae}from"./main-8eb577c9.js";import{H as Te}from"./hilight-defs-1101779f.js";import{T as me}from"./toggle-switch-control-a31c49c3.js";import"./preload-helper-388ac9d5.js";class Ie{id;name;template;fields;componentId;constructor(e){const s={...typeof e=="string"?{id:e,template:"",name:""}:e};({template:this.template,id:this.id,name:this.name,fields:this.fields}=s)}}const se="details";class He extends ve{detailsStore=W(this.$vApp.$pinia);get config(){return super.config}openDetails(e){this.detailsStore.payload=e,e.forEach(t=>{const c=this.$iApi.useStore("layer").getLayerByUid(t.uid);this._loadDetailsConfig(c)}),this.$iApi.panel.get("details-layers").isOpen||this.$iApi.panel.open({id:"details-layers"})}toggleFeature(e,s){const t=this.$iApi.panel.get("details-layers");t.isOpen&&this.$iApi.panel.close(t);const c=this.$iApi.panel.get("details-items"),r={result:{items:[{data:e.data,format:e.format,loaded:!0,loading:Promise.resolve()}],uid:e.uid,loading:Promise.resolve(),loaded:!0}},p=this.$iApi.geo.layer.getLayer(e.uid),A=this.detailsStore.currentFeatureId,u=`${e.uid}-${p?.supportsFeatures?e.data[p?.oidField??""]:JSON.stringify(e.data)}`;this.detailsStore.currentFeatureId=e.data?u:void 0,this._loadDetailsConfig(p),s===!1?this.$iApi.panel.close(c):c.isOpen?A!==u||s===!0?c.show({screen:"item-screen",props:r}):this.$iApi.panel.close(c):this.$iApi.panel.open({id:"details-items",screen:"item-screen",props:r})}_parseConfig(e){e&&e.templates&&(this.detailsStore.defaultTemplates=e.templates),this.handlePanelWidths(["details-items","details-layers"]),this.handlePanelTeleports(["details-items","details-layers"]);const s=this.getLayerFixtureConfigs(),t=[];Object.keys(s).forEach(r=>{t.push({id:r,name:s[r].name,template:s[r].template,fields:s[r].fields})});const c=t.map(r=>new Ie(r));this.detailsStore.properties=c.reduce((r,p)=>(r[p.id]=p,r),{}),this._validateItems()}_loadDetailsConfig(e){if(e&&this.detailsStore.properties[e.id]===void 0){const t=this.getLayerFixtureConfigs();t[e.id]!==void 0&&this.detailsStore.addConfigProperty({id:e.id,name:t[e.id].name,template:t[e.id].template,fields:t[e.id].fields})}}_validateItems(){Object.values(this.detailsStore.properties).forEach(e=>{e.template in this.$vApp.$options.components&&(this.detailsStore.properties[e.id].componentId=e.template)})}async hilightDetailsItems(e,s){const t=e instanceof Array?e:[e],c=this.$iApi.fixture.get("hilight");if(c){const r=await c.getGraphicsByKey(se);await c.removeHilight(r);const p=Date.now();this.detailsStore.lastHilight=p;const A=await this.getHilightGraphics(t,s);this.detailsStore.lastHilight===p&&await c.addHilight(A)}}async removeDetailsHilight(){const e=this.$iApi.fixture.get("hilight");if(e){this.detailsStore.lastHilight=Date.now();const s=await e.getGraphicsByKey(se);await e.removeHilight(s)}}async reloadDetailsHilight(e,s){const t=e instanceof Array?e:[e],c=this.$iApi.fixture.get("hilight");if(c){const r=await this.getHilightGraphics(t,s);c.reloadHilight(r)}}async getHilightGraphics(e,s){const t=this.$iApi.geo.layer.getLayer(s),c=this.$iApi.fixture.get("hilight"),r=[];return t&&await Promise.all(e.map(async p=>{const A=p.data[t.oidField],u=await t.getGraphic(A,{getGeom:!0,getAttribs:!0,getStyle:!0});u.id=c.constructGraphicKey(se,s,A),r.push(u)})),r}onHilightToggle(e,s,t){e?(this.hilightDetailsItems(s,t),this.detailsStore.hilightToggle=!0):(this.removeDetailsHilight(),this.detailsStore.hilightToggle=!1)}hasHilighter(){const e=this.$iApi.fixture.get("hilight");return e&&e.hilightMode.mode!==Te.NONE}}const Fe={key:0},ze={class:"p-5"},De=["onClick","disabled"],Se=f("div",{class:"flex-auto"},null,-1),Me={key:0,class:"px-5"},Ce={key:1,class:"px-5"},Ee={key:2,class:"animate-spin spinner h-20 w-20 px-5"},Ne={key:1,class:"flex justify-center py-10 items-center"},Oe=f("span",{class:"animate-spin spinner h-20 w-20 px-5 mr-8"},null,-1),je={key:2},Ge=Y({__name:"layers-screen",props:{panel:fe},setup(_){const{t:e}=J(),s=ee("iApi"),t=ye(),c=_e(),r=W(),p=I([]),A=I(""),u=I([]),m=I([]),o=y(()=>r.activeGreedy),H=y(()=>r.slowLoadingFlag),x=y(()=>r.payload),w=y(()=>r.properties),D=y(()=>c.mobileView),V=y(()=>c.getRemainingWidth),R=y(()=>p.value.map(l=>l.items.length).reduce((l,h)=>l+h,0)),U=l=>{if(l===void 0)return;const h=s.panel.get("details-items"),g=h?.width||350,$=!h||D.value||V.value<g&&!h.isOpen||l.length===0?0:l[0].requestTime;r.activeGreedy=$,r.slowLoadingFlag=!1,p.value=l,d(l),B(l)},B=l=>{const h=s.panel.get("details-items");if(A.value&&h?.isOpen){const g=p.value.findIndex($=>$.uid===A.value);if(g!==-1){const $=p.value[g];$.loading.then(()=>{$.requestTime===o.value&&($.items.length>0?(r.activeGreedy=0,F(g)):T(l))})}else T(l)}else T(l);setTimeout(()=>{o.value!==0&&l[0].requestTime===o.value&&(r.slowLoadingFlag=!0)},500)},T=l=>{const h=l.map($=>$.loading.then(()=>$.items.length>0?Promise.resolve($):Promise.reject())),g=l.length===0?0:l[0].requestTime;Promise.any(h).then($=>{if($.requestTime!==o.value)return;const k=p.value.findIndex(M=>M.uid===$.uid);r.activeGreedy=0,k!==-1&&F(k)}).catch(()=>{g===o.value&&(A.value="",r.activeGreedy=0,S())})},d=l=>{Promise.all(l.map(h=>h.loading)).then(()=>{s.updateAlert(s.$i18n.t("details.layers.found",{numResults:R.value,numLayers:l.length}))})},S=()=>{s.panel.close("details-items")},F=l=>{if(x.value[l].items.length>0){r.activeGreedy=0;let h=s.panel.get("details-items");if(!h)return;let g={result:x.value[l]};A.value=x.value[l].uid,h.isOpen?h.show({screen:"item-screen",props:g}):s.panel.open({id:"details-items",screen:"item-screen",props:g})}},z=l=>{const h=x.value[l];let g=t.getLayerByUid(h.uid);return g&&w.value[g.id]&&w.value[g.id].name?w.value[g.id].name:g?.name??""};return be(()=>{m.value.push(de(x,l=>{U(l)},{deep:!1,immediate:!0}))}),ie(()=>{u.value.push(s.event.on(j.PANEL_CLOSED,l=>{(l.id==="details-items"||l.id==="details-layers")&&(r.activeGreedy=0)})),m.value.push(de(o,l=>{l===0&&(r.slowLoadingFlag=!1)}))}),le(()=>{u.value.forEach(l=>s.event.off(l)),m.value.forEach(l=>l())}),(l,h)=>{const g=ae("panel-screen"),$=Q("truncate");return a(),X(g,{panel:_.panel},{header:Z(()=>[G(b(v(e)("details.layers.title")),1)]),content:Z(()=>[o.value===0?(a(),n("div",Fe,[f("div",ze,b(v(e)("details.layers.found",{numResults:R.value,numLayers:x.value.length})),1),(a(!0),n(ne,null,oe(p.value,(k,M)=>(a(),n("button",{type:"button",class:"w-full px-20 py-10 text-md flex hover:bg-gray-200 cursor-pointer disabled:cursor-default",key:k.uid,onClick:K=>k.loaded&&F(M),disabled:!(k.loaded&&k.items.length>0)},[q((a(),n("div",null,[G(b(z(M)||v(e)("details.layers.loading")),1)])),[[$]]),Se,k.loaded?(a(),n("div",Me,b(k.items.length),1)):k.errored?(a(),n("div",Ce,b(v(e)("details.layers.error")),1)):(a(),n("div",Ee))],8,De))),128))])):H.value?(a(),n("div",Ne,[Oe,G(" "+b(v(e)("details.item.loading")),1)])):(a(),n("div",je))]),_:1},8,["panel"])}}}),Be={key:0},Pe={key:0},Re={key:0},qe={key:0,class:"flex justify-between py-8 px-8 mb-8 bg-gray-100"},Ze={class:"p-8 font-bold break-words"},Ve={key:1,class:"p-8 mb-8 bg-gray-100 flex justify-between"},Ue=["innerHTML"],Ke={key:1,class:"flex-initial py-5 px-10"},We={key:2,class:"animate-spin spinner h-20 w-20 px-5"},Ye={key:1},Je={key:1,class:"p-5"},Qe={key:1,class:"flex justify-center py-10 items-center"},Xe=f("span",{class:"animate-spin spinner h-20 w-20 px-5 mr-8"},null,-1),et={key:2},tt=Y({__name:"result-screen",props:{panel:{type:Object,required:!0},result:{type:Object,required:!0},previousItemIndex:{type:Number,default:-1}},setup(_){const e=_,{t:s}=J(),t=ee("iApi"),c=W(),r=y(()=>c.properties),p=y(()=>c.activeGreedy),A=y(()=>c.slowLoadingFlag),u=y(()=>t.geo.layer.getLayer(e.result.uid)?.nameField),m=y(()=>{const d=t.geo.layer.getLayer(e.result.uid);return d&&r.value[d.id]&&r.value[d.id].name?r.value[d.id].name:d?.name??""}),o=I([]),H=I(!1),x=I([]),w=I(t.fixture.get("details")),D=I(!0);ie(()=>{H.value=t.geo.layer.getLayer(e.result.uid)!==void 0,D.value=c.hilightToggle??D.value,D.value&&w.value.hilightDetailsItems(e.result.items,e.result.uid),t.updateAlert(t.$i18n.t("details.item.alert.show.list",{layerName:m.value})),x.value.push(t.event.on(j.LAYER_REMOVE,d=>{e.result.uid===d.uid&&e.panel.close()})),x.value.push(t.event.on(j.PANEL_CLOSED,d=>{d.id=="details-items"&&V()})),x.value.push(t.event.on(j.PANEL_MINIMIZED,d=>{d.id=="details-items"&&R()})),x.value.push(t.event.on(j.MAP_BASEMAPCHANGE,()=>{D.value&&w.value.reloadDetailsHilight(e.result.items,e.result.uid)}))}),le(()=>{x.value.forEach(d=>t.event.off(d))});const V=()=>{w.value.removeDetailsHilight(),c.hilightToggle=!0},R=()=>{w.value.removeDetailsHilight()},U=d=>{e.panel.show({screen:"item-screen",props:{result:e.result,itemIndex:d}})},B=(d,S)=>{const F=t.geo.layer.getLayer(e.result.uid);if(F===void 0){console.warn(`could not find layer for uid ${e.result.uid} during icon lookup`);return}const z=F.oidField;return F.getIcon(d[z]).then(l=>{o.value[S]!==l&&(o.value[S]=l)}),o.value[S]},T=d=>{D.value=d,w.value.onHilightToggle(d,e.result.items,e.result.uid)};return(d,S)=>{const F=ae("panel-screen"),z=Q("truncate"),l=Q("focus-item");return a(),X(F,{panel:_.panel},{header:Z(()=>[G(b(v(s)("details.items.title")),1)]),content:Z(()=>[_.result.loaded&&p.value===0?(a(),n("div",Be,[H.value?(a(),n("div",Pe,[_.result.items.length>0?(a(),n("div",Re,[H.value?(a(),n("div",qe,[f("div",Ze,b(m.value),1)])):N("",!0),w.value.hasHilighter()?(a(),n("div",Ve,[f("div",null,b(v(s)("details.togglehilight.title")),1),ue(me,{config:{value:D.value,disabled:!1},onToggled:T},null,8,["config"])])):N("",!0),(a(!0),n(ne,null,oe(_.result.items,(h,g,$,k)=>{const M=[o.value[g]];if(k&&k.key===g&&xe(k,M))return k;const K=q((a(),n("button",{type:"button",class:"w-full flex px-16 py-10 text-md hover:bg-gray-200 cursor-pointer",key:g,onClick:O=>h.loaded&&U(g),disabled:!h.loaded},[h.loaded?(a(),n("span",{key:0,innerHTML:B(h.data,g),class:"flex-none symbologyIcon"},null,8,Ue)):N("",!0),h.loaded?q((a(),n("span",Ke,[G(b(u.value?h.data[u.value]:v(s)("details.result.default.name",[g+1])),1)])),[[z]]):N("",!0),h.loaded?N("",!0):(a(),n("span",We))],8,["onClick","disabled"])),[[l],[z]]);return K.memo=M,K},S,0),128))])):(a(),n("div",Ye,b(v(s)("details.layers.results.empty")),1))])):(a(),n("div",Je,b(v(s)("details.item.no.data")),1))])):A.value?(a(),n("div",Qe,[Xe,G(" "+b(v(s)("details.item.loading")),1)])):(a(),n("div",et))]),_:1},8,["panel"])}}}),st={class:"inline font-bold"},it=f("span",{class:"flex-auto"},null,-1),lt=["innerHTML"],at=Y({__name:"esri-default",props:{fixtureFields:{type:Object,required:!1},fields:{type:Object,required:!0},identifyData:{type:Object,required:!0}},setup(_){const e=_,{t:s}=J(),t=ee("iApi"),c=()=>{const u={};Object.assign(u,e.identifyData.data),t?.ui.exposeOids||delete u[e.fields.find(o=>o.type==="oid").name];let m={};return e.fields.forEach(o=>{const H=e.fixtureFields?.find(x=>o.name==x.field);m[o.name]={name:H?.alias||o.alias||o.name,type:o.type,visible:H?.visible??!0}}),Object.keys(u).map(o=>{u[o]={value:typeof u[o]=="number"?t?.$i18n.n(u[o],"number"):u[o],alias:m[o].name||o,type:m[o].type},m[o].visible||delete u[o]}),u},r=(u,m,o)=>{switch(o){case"date":return A(u);default:return p(u,m)}},p=(u,m)=>{if(!u)return u;if(u.trim().match(/\.(jpeg|jpg|gif|png)$/)||u.trim().match(/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i))return`<img src="${u}" alt="${s("details.item.alert.defaultAltText",{alias:m})}" />`;const o="underline text-blue-600 break-all",H=document.createElement("div");return H.innerHTML=u.trim(),H.firstElementChild?.tagName=="A"?(H.firstElementChild.className=o,H.innerHTML):ce(u,{className:o,target:"_blank",validate:{url:w=>/^https?:\/\//.test(w)}})},A=u=>{const m=parseInt(u);return isNaN(m)?u:new Date(m).toISOString().split("T")[0]};return(u,m)=>(a(),n("div",null,[(a(!0),n(ne,null,oe(c(),(o,H,x)=>(a(),n("div",{class:"p-5 pl-3 flex justify-end flex-wrap even:bg-gray-300",key:x},[f("span",st,b(o.alias),1),it,f("span",{class:"inline",innerHTML:r(o.value,o.alias,o.type)},null,8,lt)]))),128))]))}}),nt=["innerHTML"],ot={key:1},rt=Y({__name:"html-default",props:{identifyData:{type:Object,required:!0}},setup(_){const{t:e}=J();return(s,t)=>_.identifyData?(a(),n("div",{key:0,class:"whitespace-pre-wrap break-words h-full overflow-auto",innerHTML:_.identifyData.data.data??_.identifyData.data},null,8,nt)):(a(),n("div",ot,b(v(e)("details.layers.results.empty")),1))}}),dt={key:0},ut={key:0,class:"p-8 font-bold break-words mb-8 bg-gray-100"},ct={key:1,class:"p-8 mb-8 bg-gray-100 flex justify-between"},mt={key:2,class:"flex flex-col justify-between p-8 mb-8 bg-gray-100"},pt={class:"flex justify-between"},ht=["aria-label"],gt={class:"flex bg-gray-200 py-8 items-center"},vt=["content","aria-label","disabled"],ft=f("svg",{height:"24",width:"24",viewBox:"0 0 23 23"},[f("g",null,[f("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})])],-1),yt=[ft],_t={class:"px-8"},bt=["content","aria-label","disabled"],xt=f("svg",{height:"24",width:"24",viewBox:"0 0 23 23"},[f("g",null,[f("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})])],-1),wt=[xt],$t={key:3},Lt={key:0},kt={key:0,class:"flex py-8 items-center"},At=["innerHTML"],Tt={key:1},It=f("div",{class:"animate-spin spinner h-20 w-20"},null,-1),Ht=[It],Ft=["innerHTML"],zt=["content","aria-label"],Dt={key:0,class:"m-auto animate-spin spinner h-20 w-20"},St={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"green",class:"m-auto w-20 h-20"},Mt=f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"},null,-1),Ct=[Mt],Et={key:2,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"red",class:"m-auto w-20 h-20"},Nt=f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"},null,-1),Ot=[Nt],jt=["innerHTML"],Gt={key:1,class:"flex justify-center py-10 items-center"},Bt=f("span",{class:"animate-spin spinner h-20 w-20 px-5 mr-8"},null,-1),Pt={key:4,class:"p-5"},Rt={key:1,class:"flex justify-center py-10 items-center"},qt=f("span",{class:"animate-spin spinner h-20 w-20 px-5 mr-8"},null,-1),Zt={key:2},Vt=Y({__name:"item-screen",props:{panel:{type:Object,required:!0},result:{type:Object,required:!0},itemIndex:{type:Number,default:0}},setup(_){const e=_,{t:s}=J(),t=ee("iApi"),c=W(),r=y(()=>c.defaultTemplates),p=y(()=>c.properties),A=y(()=>c.activeGreedy),u=y(()=>c.slowLoadingFlag),m=y(()=>e.result.items[d.value]),o=y(()=>{const L=t.geo.layer.getLayer(e.result.uid)?.nameField;return L&&m.value.loaded?m.value.data[L]:t.$i18n.t("details.items.title")}),H=y(()=>{const i=t.geo.layer.getLayer(e.result.uid);return i&&p.value[i.id]&&p.value[i.id].name?p.value[i.id].name:i?.name??""}),x=y(()=>{const i=t.geo.layer.getLayer(e.result.uid);if(i&&p.value[i.id]&&p.value[i.id].fields)return p.value[i.id].fields}),w=y(()=>t.geo.layer.getLayer(e.result.uid)?.supportsFeatures??!1),D=y(()=>t.geo.layer.getLayer(e.result.uid)?.mapLayer??!1),V=y(()=>w.value?t.geo.layer.getLayer(e.result.uid)?.fields||[]:[]),R=y(()=>{const i=t.geo.layer.getLayer(e.result.uid);return i&&p.value[i.id]&&p.value[i.id].template?p.value[i.id].template:r.value&&r.value[m.value.format]?r.value[m.value.format]:w.value?at:rt}),U=i=>{if(typeof i=="string"){const L="underline text-blue-600 break-all",C=document.createElement("div");return C.innerHTML=i.trim(),C.firstElementChild?.tagName=="A"?(C.firstElementChild.className=L,C.innerHTML):ce(i,{className:L,target:"_blank",validate:{url:P=>/^https?:\/\//.test(P)}})}return i},B=I(""),T=I("none"),d=I(0),S=I(!1),F=I([]),z=I(t.fixture.get("details")),l=I(!0),h=I(),g=()=>{z.value.removeDetailsHilight(),c.hilightToggle=!0},$=()=>{z.value.removeDetailsHilight()},k=()=>{d.value=e.itemIndex??0,S.value=!0,l.value=c.hilightToggle??l.value,M()},M=()=>{if(O("none"),m.value.loaded)t.geo.layer.getLayer(e.result.uid)||(S.value=!1),pe(),t.updateAlert(`${t.$i18n.t("details.item.alert.show.item",{itemName:o.value})} ${e.result.items.length>1?t.$i18n.t("details.item.count",[d.value+1,e.result.items.length]):""}`),l.value&&w.value&&D.value?z.value.hilightDetailsItems(e.result.items[d.value],e.result.uid):(!w.value||!D.value)&&z.value.removeDetailsHilight();else{const i=d.value;m.value.loading.then(()=>{i===d.value&&M()})}},K=()=>{e.panel.show({screen:"results-screen",props:{result:e.result,previousItemIndex:d.value}})},O=i=>{i==="zoomed"||i==="error"?setTimeout(()=>{T.value=i,h.value?._tippy.show(),setTimeout(()=>{h.value?._tippy.hide(),T.value="none"},3e3)},300):T.value=i},re=i=>{d.value+=i,M()},pe=()=>{if(B.value="",!(m.value&&m.value.loaded))return;const i=t.geo.layer.getLayer(e.result.uid);if(i===void 0){console.warn(`could not find layer for uid ${e.result.uid} during icon lookup`);return}if(i.supportsFeatures){const L=i.oidField;let C=d.value;i.getIcon(m.value.data[L]).then(E=>{d.value===C&&(B.value=E)})}},he=()=>{if(T.value!=="none")return;O("zooming");const i=t.geo.layer.getLayer(e.result.uid);if(i===void 0||!i.isLoaded){console.warn(`Could not find layer for uid ${e.result.uid} during zoom geometry lookup`),O("error");return}if(!m.value.loaded){console.warn("Details zoomToFeature call on item that is still loading. Should be impossible, alert the devs."),O("error");return}const L=m.value.data[i.oidField],C=()=>{const E={getGeom:!0};i.getGraphic(L,E).then(P=>{P.geometry.invalid()?(console.error(`Could not find graphic for objectid ${L}`),O("error")):(t.geo.map.zoomMapTo(P.geometry),O("zoomed"),t.updateAlert(t.$i18n.t("details.item.alert.zoom")))}).catch(()=>{O("error")})};i.layerType===Le.FEATURE&&i.geomType!==ke.POINT?i.getGraphicExtent(L).then(E=>{t.geo.map.zoomMapTo(E),O("zoomed"),t.updateAlert(t.$i18n.t("details.item.alert.zoom"))}).catch(()=>{C()}):C()},ge=i=>{l.value=i,z.value.onHilightToggle(i,e.result.items[d.value],e.result.uid)};return ie(()=>{k(),F.value.push(t.event.on(j.LAYER_REMOVE,i=>{e.result.uid===i.uid&&e.panel.close()})),F.value.push(t.event.on(j.PANEL_CLOSED,i=>{i.id=="details-items"&&g()})),F.value.push(t.event.on(j.PANEL_MINIMIZED,i=>{i.id=="details-items"&&$()})),F.value.push(t.event.on(j.MAP_BASEMAPCHANGE,()=>{l.value&&z.value.reloadDetailsHilight(e.result.items[d.value],e.result.uid)}))}),le(()=>{F.value.forEach(i=>t.event.off(i))}),we(()=>{k()}),(i,L)=>{const C=ae("panel-screen"),E=Q("tippy");return a(),X(C,{panel:_.panel},{header:Z(()=>[G(b(v(s)("details.items.title")),1)]),content:Z(()=>[_.result.loaded&&A.value===0?(a(),n("div",dt,[S.value?(a(),n("div",ut,b(H.value),1)):N("",!0),z.value.hasHilighter()&&w.value&&D.value?(a(),n("div",ct,[f("div",null,b(v(s)("details.togglehilight.title")),1),ue(me,{config:{value:l.value,disabled:!1},onToggled:ge},null,8,["config"])])):N("",!0),S.value&&_.result.items.length>1?(a(),n("div",mt,[f("div",pt,[f("button",{type:"button",class:"px-8 font-bold hover:bg-gray-200 focus:bg-gray-200","aria-label":v(s)("details.item.see.list"),onClick:K},b(v(s)("details.item.see.list")),9,ht),f("div",gt,[q((a(),n("button",{type:"button",content:v(s)("details.item.previous.item"),onClick:L[0]||(L[0]=P=>re(-1)),class:"mx-2 opacity-60 hover:opacity-90 disabled:opacity-30 disabled:cursor-default","aria-label":v(s)("details.item.previous.item"),disabled:d.value===0},yt,8,vt)),[[E,{placement:"top"}]]),f("span",_t,b(v(s)("details.item.count",[d.value+1,_.result.items.length])),1),q((a(),n("button",{type:"button",content:v(s)("details.item.next.item"),onClick:L[1]||(L[1]=P=>re(1)),class:"mx-2 rotate-180 opacity-60 hover:opacity-90 disabled:opacity-30 disabled:cursor-default","aria-label":v(s)("details.item.next.item"),disabled:d.value===_.result.items.length-1},wt,8,bt)),[[E,{placement:"top"}]])])])])):N("",!0),S.value?(a(),n("div",$t,[m.value.loaded?(a(),n("div",Lt,[w.value?(a(),n("div",kt,[B.value?(a(),n("span",{key:0,class:"flex-none symbologyIcon",innerHTML:B.value},null,8,At)):(a(),n("div",Tt,Ht)),f("span",{class:"flex-grow my-auto text-lg px-8",innerHTML:U(o.value)},null,8,Ft),D.value?q((a(),n("button",{key:2,type:"button",content:v(s)(`details.item.zoom${T.value==="none"?"":`.${T.value}`}`),"aria-label":v(s)(`grid.cells.zoom${T.value==="none"?"":`.${T.value}`}`),ref_key:"button",ref:h,onClick:L[2]||(L[2]=P=>he()),class:"text-gray-600 m-8 w-24 h-24 p-2"},[T.value==="zooming"?(a(),n("div",Dt)):T.value==="zoomed"?(a(),n("svg",St,Ct)):T.value==="error"?(a(),n("svg",Et,Ot)):(a(),n("span",{key:3,innerHTML:v(t).ui.getZoomIcon()},null,8,jt))],8,zt)),[[E,{placement:"bottom"}]]):N("",!0)])):N("",!0),(a(),X($e(R.value),{identifyData:m.value,fields:V.value,fixtureFields:x.value},null,8,["identifyData","fields","fixtureFields"]))])):(a(),n("div",Gt,[Bt,G(" "+b(v(s)("details.item.loading")),1)]))])):(a(),n("div",Pt,b(v(s)("details.item.no.data")),1))])):u.value?(a(),n("div",Rt,[qt,G(" "+b(v(s)("details.item.loading")),1)])):(a(),n("div",Zt))]),_:1},8,["panel"])}}});const Ut={en:{"details.layers.title":"Identified Layers","details.layers.found":"Found {numResults} results in {numLayers} layers","details.layers.loading":"The layer is loading...","details.layers.error":"Error","details.layers.results.empty":"No results found for the selected layer.","details.result.default.name":"Identify Item {0}","details.items.title":"Details","details.item.see.list":"See List","details.item.zoom":"Zoom to feature","details.item.zoom.zooming":"Zooming...","details.item.zoom.error":"Zoom failed","details.item.zoom.zoomed":"Zoomed","details.item.previous.item":"Previous item","details.item.next.item":"Next item","details.item.count":"{0} of {1}","details.item.loading":"Loading results...","details.item.no.data":"No data to show because the layer has been removed","details.item.alert.zoom":"Zoomed into feature","details.item.alert.show.item":"Showing result {itemName}","details.item.alert.show.list":"Showing all results for {layerName}","details.item.alert.defaultAltText":"Image associated with {alias} field","details.togglehilight.title":"Toggle Highlight"},fr:{"details.layers.title":"Couches désignées","details.layers.found":"{numResults} résultats trouvés dans {numLayers} couches","details.layers.loading":"La couche est en cours de chargement...","details.layers.error":"Erreur","details.layers.results.empty":"Aucun résultat trouvé pour la couche sélectionnée.","details.result.default.name":"Désigner l'élément {0}","details.items.title":"Détails","details.item.see.list":"Voir la liste","details.item.zoom":"Zoom à l'élément","details.item.zoom.zooming":"Zoom...","details.item.zoom.error":"Échec du zoom","details.item.zoom.zoomed":"Zoomé","details.item.previous.item":"Élément précédent","details.item.next.item":"Élément suivant","details.item.count":"{0} de {1}","details.item.loading":"Chargement des résultats...","details.item.no.data":"Aucune donnée à afficher","details.item.alert.zoom":"Zoom sur la caractéristique","details.item.alert.show.item":"Affichage du résultat {itemName}","details.item.alert.show.list":"Affichage de tous les résultats pour {layerName}","details.item.alert.defaultAltText":"Image associée au champ {alias}","details.togglehilight.title":"Basculer vers l'élément principal"}};class Qt extends He{async added(){this.$iApi.panel.register({"details-layers":{screens:{"layers-screen":te(Ge)},style:{width:"350px"},button:{tooltip:"details.layers.title",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none" /><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>'},alertName:"details.layers.title"},"details-items":{screens:{"results-screen":te(tt),"item-screen":te(Vt)},style:{width:"350px"},button:{tooltip:"details.items.title",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none" /><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" /></svg>'},alertName:"details.items.title"}},{i18n:{messages:Ut}}),this._parseConfig(this.config);const e=this.$vApp.$watch(()=>this.config,s=>this._parseConfig(s));this.removed=()=>{if(e(),this.$iApi.panel.remove("details-layers"),this.$iApi.panel.remove("details-items"),this.$iApi.fixture.get("appbar")){const t=Ae(this.$vApp.$pinia);t.removeButton("details-layers"),t.removeButton("details-items")}W(this.$vApp.$pinia).$reset()}}}export{Qt as default};
