{"version":3,"file":"AGraphicContainer-3TLlwc66.js","sources":["../../node_modules/@arcgis/core/views/2d/engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js","../../node_modules/@arcgis/core/views/2d/layers/graphics/GraphicBoundsRenderer.js","../../node_modules/@arcgis/core/views/2d/layers/graphics/AGraphicContainer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{TechniqueInstance as e}from\"./TechniqueInstance.js\";import{Techniques as l}from\"./TechniqueRegistry.js\";import{castInstanceId as i}from\"./mesh/instanceIdUtils.js\";let n=0;function a(l,a,t){return new e(i(n++),l,l.meshWriter.name,a,t)}const t={geometry:{visualVariableColor:null,visualVariableOpacity:null,visualVariableSizeMinMaxValue:null,visualVariableSizeScaleStops:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null,visualVariableRotation:null}};class s{constructor(){this.instances={fill:a(l.fill,t,{zoomRange:!0}),marker:a(l.marker,t,{zoomRange:!0}),line:a(l.line,t,{zoomRange:!0}),text:a(l.text,t,{zoomRange:!0,referenceSymbol:!1,clipAngle:!1}),complexFill:a(l.complexFill,t,{zoomRange:!0}),texturedLine:a(l.texturedLine,t,{zoomRange:!0})},this._instancesById=Object.values(this.instances).reduce(((e,l)=>(e.set(l.instanceId,l),e)),new Map)}getInstance(e){return this._instancesById.get(e)}}export{s as GraphicInstanceStore};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../core/maybe.js\";import{identity as e,multiply as r,translate as i,scale as s,rotate as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/mat3f32.js\";import{fromValues as n}from\"../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";import{fromValues as l}from\"../../../../core/libs/gl-matrix-2/factories/vec3f32.js\";import{normalizeMapX as f}from\"../../../../geometry/support/normalizeUtils.js\";import{DisplayObject as m}from\"../../engine/DisplayObject.js\";import{createProgramDescriptor as c}from\"../../engine/webgl/Utils.js\";import{BufferObject as u}from\"../../../webgl/BufferObject.js\";import{BlendFactor as _,PrimitiveType as h,DataType as d,Usage as p}from\"../../../webgl/enums.js\";import{VertexArrayObject as g}from\"../../../webgl/VertexArrayObject.js\";const v=Math.PI/180,x=4;class b extends m{constructor(t){super(),this._program=null,this._vao=null,this._vertexBuffer=null,this._indexBuffer=null,this._dvsMat3=a(),this._localOrigin={x:0,y:0},this._getBounds=t}destroy(){this._vao&&(this._vao.dispose(),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program=t(this._program)}doRender(t){const{context:e}=t,r=this._getBounds();if(r.length<1)return;this._createShaderProgram(e),this._updateMatricesAndLocalOrigin(t),this._updateBufferData(e,r),e.setBlendingEnabled(!0),e.setDepthTestEnabled(!1),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1),e.setBlendFunction(_.ONE,_.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0);const i=this._program;e.bindVAO(this._vao),e.useProgram(i),i.setUniformMatrix3fv(\"u_dvsMat3\",this._dvsMat3),e.gl.lineWidth(1),e.drawElements(h.LINES,8*r.length,d.UNSIGNED_INT,0),e.bindVAO()}_createTransforms(){return{displayViewScreenMat3:a()}}_createShaderProgram(t){if(this._program)return;const e=\"precision highp float;\\n        uniform mat3 u_dvsMat3;\\n\\n        attribute vec2 a_position;\\n\\n        void main() {\\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\\n        }\",r=\"precision mediump float;\\n      void main() {\\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\\n      }\";this._program=t.programCache.acquire(e,r,y().attributes)}_updateMatricesAndLocalOrigin(t){const{state:a}=t,{displayMat3:m,size:c,resolution:u,pixelRatio:_,rotation:h,viewpoint:d}=a,p=v*h,{x:g,y:x}=d.targetGeometry,b=f(g,a.spatialReference);this._localOrigin.x=b,this._localOrigin.y=x;const y=_*c[0],B=_*c[1],M=u*y,j=u*B,A=e(this._dvsMat3);r(A,A,m),i(A,A,n(y/2,B/2)),s(A,A,l(c[0]/M,-B/j,1)),o(A,A,-p)}_updateBufferData(t,e){const{x:r,y:i}=this._localOrigin,s=2*x*e.length,o=new Float32Array(s),a=new Uint32Array(8*e.length);let n=0,l=0;for(const f of e)f&&(o[2*n]=f[0]-r,o[2*n+1]=f[1]-i,o[2*n+2]=f[0]-r,o[2*n+3]=f[3]-i,o[2*n+4]=f[2]-r,o[2*n+5]=f[3]-i,o[2*n+6]=f[2]-r,o[2*n+7]=f[1]-i,a[l]=n+0,a[l+1]=n+3,a[l+2]=n+3,a[l+3]=n+2,a[l+4]=n+2,a[l+5]=n+1,a[l+6]=n+1,a[l+7]=n+0,n+=4,l+=8);if(this._vertexBuffer?this._vertexBuffer.setData(o.buffer):this._vertexBuffer=u.createVertex(t,p.DYNAMIC_DRAW,o.buffer),this._indexBuffer?this._indexBuffer.setData(a):this._indexBuffer=u.createIndex(t,p.DYNAMIC_DRAW,a),!this._vao){const e=y();this._vao=new g(t,e.attributes,e.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer)}}}const y=()=>c(\"bounds\",{geometry:[{location:0,name:\"a_position\",count:2,type:d.FLOAT}]});export{b as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as e}from\"../../../../core/maybe.js\";import{AFeatureContainer as r}from\"../../engine/AFeatureContainer.js\";import{FeatureBatchingStrategy as t}from\"../../engine/webgl/enums.js\";import{GraphicInstanceStore as n}from\"../../engine/webgl/shaderGraph/techniques/GraphicInstanceStore.js\";import s from\"./GraphicBoundsRenderer.js\";class i extends r{constructor(e){super(e),this._instanceStore=new n,this.checkHighlight=()=>!0}destroy(){super.destroy(),this._boundsRenderer=e(this._boundsRenderer)}get instanceStore(){return this._instanceStore}enableRenderingBounds(e){this._boundsRenderer=new s(e),this.requestRender()}get hasHighlight(){return this.checkHighlight()}onTileData(e,r){e.onMessage(r),this.contains(e)||this.addChild(e),this.requestRender()}_renderChildren(e,r){e.selection=r;for(const n of this.children){if(!n.visible)continue;const r=n.getDisplayList(e.drawPhase,this._instanceStore,t.STRICT_ORDER);r?.render(e)}}}export{i as AGraphicContainer};\n"],"names":["n","a","l","e","i","t","s","v","x","b","m","r","_","h","d","c","u","p","g","f","y","B","M","j","A","o"],"mappings":"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","x_google_ignoreList":[0,1,2]}