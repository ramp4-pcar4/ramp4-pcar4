{"version":3,"file":"label2-BaEz5e-W.js","sources":["../../node_modules/@esri/calcite-components/dist/components/label2.js"],"sourcesContent":["/*!\n * All material copyright ESRI, All Rights Reserved, unless otherwise specified.\n * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.\n * v2.6.0\n */\nimport { u as isBefore, q as queryElementRoots, c as closestElementCrossShadowBoundary } from './dom.js';\nimport { c as componentOnReady } from './component.js';\n\n/**\n * Exported for testing purposes only\n *\n * @internal\n */\nconst labelClickEvent = \"calciteInternalLabelClick\";\nconst labelConnectedEvent = \"calciteInternalLabelConnected\";\nconst labelDisconnectedEvent = \"calciteInternalLabelDisconnected\";\nconst labelTagName = \"calcite-label\";\nconst labelToLabelables = new WeakMap();\nconst onLabelClickMap = new WeakMap();\nconst onLabelConnectedMap = new WeakMap();\nconst onLabelDisconnectedMap = new WeakMap();\nconst unlabeledComponents = new Set();\nconst findLabelForComponent = (componentEl) => {\n    const { id } = componentEl;\n    const forLabel = id && queryElementRoots(componentEl, { selector: `${labelTagName}[for=\"${id}\"]` });\n    if (forLabel) {\n        return forLabel;\n    }\n    const parentLabel = closestElementCrossShadowBoundary(componentEl, labelTagName);\n    if (!parentLabel ||\n        // labelable components within other custom elements are not considered labelable\n        hasAncestorCustomElements(parentLabel, componentEl)) {\n        return null;\n    }\n    return parentLabel;\n};\nfunction hasAncestorCustomElements(label, componentEl) {\n    let traversedElements;\n    const customElementAncestorCheckEventType = \"custom-element-ancestor-check\";\n    const listener = (event) => {\n        event.stopImmediatePropagation();\n        const composedPath = event.composedPath();\n        traversedElements = composedPath.slice(composedPath.indexOf(componentEl), composedPath.indexOf(label));\n    };\n    label.addEventListener(customElementAncestorCheckEventType, listener, { once: true });\n    componentEl.dispatchEvent(new CustomEvent(customElementAncestorCheckEventType, { composed: true, bubbles: true }));\n    label.removeEventListener(customElementAncestorCheckEventType, listener);\n    const ancestorCustomElements = traversedElements\n        .filter((el) => el !== componentEl && el !== label)\n        .filter((el) => el.tagName?.includes(\"-\"));\n    return ancestorCustomElements.length > 0;\n}\n/**\n * Helper to set up label interactions on connectedCallback.\n *\n * @param component\n */\nfunction connectLabel(component) {\n    if (!component) {\n        return;\n    }\n    const labelEl = findLabelForComponent(component.el);\n    if ((onLabelClickMap.has(labelEl) && labelEl === component.labelEl) ||\n        (!labelEl && unlabeledComponents.has(component))) {\n        return;\n    }\n    const boundOnLabelDisconnected = onLabelDisconnected.bind(component);\n    if (labelEl) {\n        component.labelEl = labelEl;\n        const labelables = labelToLabelables.get(labelEl) || [];\n        labelables.push(component);\n        labelToLabelables.set(labelEl, labelables.sort(sortByDOMOrder));\n        if (!onLabelClickMap.has(component.labelEl)) {\n            onLabelClickMap.set(component.labelEl, onLabelClick);\n            component.labelEl.addEventListener(labelClickEvent, onLabelClick);\n        }\n        unlabeledComponents.delete(component);\n        document.removeEventListener(labelConnectedEvent, onLabelConnectedMap.get(component));\n        onLabelDisconnectedMap.set(component, boundOnLabelDisconnected);\n        document.addEventListener(labelDisconnectedEvent, boundOnLabelDisconnected);\n    }\n    else if (!unlabeledComponents.has(component)) {\n        boundOnLabelDisconnected();\n        document.removeEventListener(labelDisconnectedEvent, onLabelDisconnectedMap.get(component));\n    }\n}\n/**\n * Helper to tear down label interactions on disconnectedCallback on labelable components.\n *\n * @param component\n */\nfunction disconnectLabel(component) {\n    if (!component) {\n        return;\n    }\n    unlabeledComponents.delete(component);\n    document.removeEventListener(labelConnectedEvent, onLabelConnectedMap.get(component));\n    document.removeEventListener(labelDisconnectedEvent, onLabelDisconnectedMap.get(component));\n    onLabelConnectedMap.delete(component);\n    onLabelDisconnectedMap.delete(component);\n    if (!component.labelEl) {\n        return;\n    }\n    const labelables = labelToLabelables.get(component.labelEl);\n    if (labelables.length === 1) {\n        component.labelEl.removeEventListener(labelClickEvent, onLabelClickMap.get(component.labelEl));\n        onLabelClickMap.delete(component.labelEl);\n    }\n    labelToLabelables.set(component.labelEl, labelables.filter((labelable) => labelable !== component).sort(sortByDOMOrder));\n    component.labelEl = null;\n}\nfunction sortByDOMOrder(a, b) {\n    return isBefore(a.el, b.el) ? -1 : 1;\n}\n/**\n * Helper to get the label text from a component.\n *\n * @param component\n */\nfunction getLabelText(component) {\n    return component.label || component.labelEl?.textContent?.trim() || \"\";\n}\nfunction onLabelClick(event) {\n    const labelClickTarget = event.detail.sourceEvent.target;\n    const labelables = labelToLabelables.get(this);\n    const clickedLabelable = labelables.find((labelable) => labelable.el === labelClickTarget);\n    const labelableChildClicked = labelables.includes(clickedLabelable);\n    if (labelableChildClicked) {\n        // no need to forward click as labelable will receive focus\n        return;\n    }\n    const firstLabelable = labelables[0];\n    if (firstLabelable.disabled) {\n        return;\n    }\n    firstLabelable.onLabelClick(event);\n}\nfunction onLabelConnected() {\n    if (unlabeledComponents.has(this)) {\n        connectLabel(this);\n    }\n}\nfunction onLabelDisconnected() {\n    unlabeledComponents.add(this);\n    const boundOnLabelConnected = onLabelConnectedMap.get(this) || onLabelConnected.bind(this);\n    onLabelConnectedMap.set(this, boundOnLabelConnected);\n    document.addEventListener(labelConnectedEvent, boundOnLabelConnected);\n}\n/**\n * Helper to associate an explicit label (i.e., using `for`) with a labelable component that does not have an associated label.\n *\n * @param label - the label element\n */\nasync function associateExplicitLabelToUnlabeledComponent(label) {\n    await componentOnReady(label);\n    const alreadyLabeled = labelToLabelables.has(label);\n    if (alreadyLabeled) {\n        return;\n    }\n    const forComponentEl = label.ownerDocument?.getElementById(label.for);\n    if (!forComponentEl) {\n        return;\n    }\n    requestAnimationFrame(() => {\n        for (const labelable of unlabeledComponents) {\n            if (labelable.el === forComponentEl) {\n                connectLabel(labelable);\n                break;\n            }\n        }\n    });\n}\n\nexport { associateExplicitLabelToUnlabeledComponent as a, labelDisconnectedEvent as b, connectLabel as c, disconnectLabel as d, getLabelText as g, labelConnectedEvent as l };\n\n//# sourceMappingURL=label2.js.map"],"names":["labelClickEvent","labelConnectedEvent","labelDisconnectedEvent","labelTagName","labelToLabelables","onLabelClickMap","onLabelConnectedMap","onLabelDisconnectedMap","unlabeledComponents","findLabelForComponent","componentEl","id","forLabel","queryElementRoots","parentLabel","closestElementCrossShadowBoundary","hasAncestorCustomElements","label","traversedElements","customElementAncestorCheckEventType","listener","event","composedPath","el","connectLabel","component","labelEl","boundOnLabelDisconnected","onLabelDisconnected","labelables","sortByDOMOrder","onLabelClick","disconnectLabel","labelable","a","b","isBefore","getLabelText","labelClickTarget","clickedLabelable","firstLabelable","onLabelConnected","boundOnLabelConnected","associateExplicitLabelToUnlabeledComponent","componentOnReady","forComponentEl"],"mappings":"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","x_google_ignoreList":[0]}