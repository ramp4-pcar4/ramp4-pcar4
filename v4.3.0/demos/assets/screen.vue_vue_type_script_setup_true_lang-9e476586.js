import{c3 as E,c4 as C,hQ as M,fl as H,c6 as w,fq as I,c9 as t,ch as s,fo as a,ce as g,hJ as P,hI as z,c5 as j,fp as R,hT as K,gN as D,fs as G,c8 as S,cg as y,cc as T,cd as f,ci as A,cj as B,fr as F,gM as Z,hx as J,hN as O,c7 as Q,ca as N,cb as q,cf as V,hH as k,jg as U,jh as X}from"./main-46bfe858.js";const W={class:"rv-geosearch-bar h-26 mb-8 mx-8"},Y=["placeholder","value","aria-label"],ee=E({__name:"search-bar",setup($){const{t:i}=C(),u=M(),r=H(),d=w(()=>u.searchVal),_=n=>u.setSearchTerm(n),v=I(500,n=>{_(n)});return(n,p)=>(t(),s("div",W,[a("input",{type:"search",class:"border-b w-full text-base py-8 outline-none focus:shadow-outline border-gray-600 h-full min-w-0",placeholder:g(i)("geosearch.searchText"),value:d.value,onInput:p[0]||(p[0]=o=>g(v)(o.target.value)),onKeyup:p[1]||(p[1]=P(o=>{g(r).mobileView&&o.target.blur()},["enter"])),"aria-label":g(i)("geosearch.searchText"),onKeypress:p[2]||(p[2]=P(z(()=>{},["prevent"]),["enter"])),enterkeyhint:"done"},null,40,Y)]))}}),te={class:"rv-geosearch-top-filters sm:flex items-center w-full ml-8 mb-14"},se={class:"w-fit inline-block sm:w-1/2 h-26 mb-8 sm:mb-0 pr-16 sm:pr-0"},oe=["value"],ne={value:"",disabled:"",hidden:""},ae={class:"sm:w-1/2 h-26 sm:mx-16 flex"},re=["value"],ce={value:"",disabled:"",hidden:""},le=["disabled","content"],ie=a("div",{class:"rv-geosearch-icon"},[a("svg",{class:"fill-current w-18 h-18",viewBox:"0 0 23 21"},[a("path",{d:"M 14.7574,20.8284L 17.6036,17.9822L 14.7574,15.1716L 16.1716,13.7574L 19.0178,16.568L 21.8284,13.7574L 23.2426,15.1716L 20.432,17.9822L 23.2426,20.8284L 21.8284,22.2426L 19.0178,19.3964L 16.1716,22.2426L 14.7574,20.8284 Z M 2,2L 19.9888,2.00001L 20,2.00001L 20,2.01122L 20,3.99999L 19.9207,3.99999L 13,10.9207L 13,22.909L 8.99999,18.909L 8.99999,10.906L 2.09405,3.99999L 2,3.99999L 2,2 Z "})])],-1),ue=[ie],de=E({__name:"top-filters",setup($){const{t:i}=C(),u=j("iApi"),r=M(),d=R([]),_=R([]),v=R([]),n=w(()=>r.queryParams),p=w(()=>u.language),o=h=>r.setProvince(h),e=h=>r.setType(h),m=()=>{o({}),e({})},L=()=>{r.initService(u.language,u.fixture.get("geosearch").config);const h=d.value.find(c=>n.value.province===c.name)?.code,x=_.value.find(c=>n.value.type===c.name)?.code;r.getProvinces.then(c=>{d.value=c,o({province:c.find(l=>l.code===h)?.name,forceReRun:!0})}),r.getTypes.then(c=>{_.value=c,e({type:c.find(l=>l.code===x)?.name,forceReRun:!0})})};return K(()=>{L(),v.value.push(D(p,L))}),G(()=>{v.value.forEach(h=>h())}),(h,x)=>{const c=S("truncate"),l=S("tippy");return t(),s("div",te,[a("div",se,[y((t(),s("select",{class:"border-b border-b-gray-600 w-full h-full py-0 cursor-pointer",value:n.value.province,onChange:x[0]||(x[0]=b=>o({province:b.target.value}))},[y((t(),s("option",ne,[T(f(g(i)("geosearch.filters.province")),1)])),[[c]]),(t(!0),s(A,null,B(d.value,b=>y((t(),s("option",{key:b.code},[T(f(b.name),1)])),[[c]])),128))],40,oe)),[[c]])]),a("div",ae,[y((t(),s("select",{class:"border-b border-b-gray-600 w-full h-full py-0 cursor-pointer max-w-150",value:n.value.type,onChange:x[1]||(x[1]=b=>e({type:b.target.value}))},[a("option",ce,f(g(i)("geosearch.filters.type")),1),(t(!0),s(A,null,B(_.value,b=>(t(),s("option",{key:b.code},f(b.name),1))),128))],40,re)),[[c]]),y((t(),s("button",{type:"button",class:"text-gray-500 w-1/8 h-24 pl-8 pr-16 sm:pr-8 hover:text-black disabled:cursor-default disabled:text-gray-300",disabled:!n.value.type&&!n.value.province,onClick:m,content:g(i)("geosearch.filters.clear")},ue,8,le)),[[l,{placement:"bottom"}]])])])}}}),pe={class:"rv-geosearch-bottom-filters"},he={class:"bg-white"},_e={class:"ml-8 cursor-pointer font-normal"},ve=["checked"],be=E({__name:"bottom-filters",setup($){const{t:i}=C(),u=j("iApi"),r=M(),d=w(()=>r.resultsVisible),_=I(300,o=>{n(o).then(e=>{v({extent:e,visible:d.value})})}),v=o=>{r.setMapExtent(o)},n=async o=>o.sr.wkid===4326?o:await u.geo.proj.projectGeometry(4326,o),p=o=>{n(u.geo.map.getExtent()).then(e=>{v({extent:e,visible:o})})};return F(()=>{u.event.on(Z.MAP_EXTENTCHANGE,_,"geosearch_map_extent")}),G(()=>{u.event.off("geosearch_map_extent")}),(o,e)=>(t(),s("div",pe,[a("div",he,[a("label",_e,[a("input",{type:"checkbox",class:"border-2 mx-8 border-gray-600 cursor-pointer",checked:d.value,onChange:e[0]||(e[0]=m=>p(m.target.checked)),onKeypress:e[1]||(e[1]=P(z(()=>{},["prevent"]),["enter"]))},null,40,ve),T(f(g(i)("geosearch.visible")),1)])])]))}});const fe={},ge={class:"w-full h-6 relative overflow-hidden rounded-full indeterminate mb-14"},me={class:"h-full progressbar bg-blue-800 rounded-full top-0","aria-valuemin":"0","aria-valuemax":"100"},xe={class:"flex items-center h-full"};function ye($,i){return t(),s("div",ge,[a("div",me,[a("span",xe,[O($.$slots,"default",{},void 0,!0)])])])}const we=J(fe,[["render",ye],["__scopeId","data-v-83b0fe00"]]),Le={class:"flex flex-col h-full"},$e={key:1,class:"text-red-900 text-xs px-8 mb-10"},ke={key:2,class:"px-8 mb-10 truncate"},Se={class:"relative h-48"},Te={class:"font-bold text-blue-600"},Ee={key:3,class:"rv-results-list flex-grow mb-5 border-t border-b border-gray-600 overflow-y-auto"},Ce=["onClick"],Me={class:"rv-result-description px-8"},Re={class:"flex-1 text-left truncate font-bold"},Ve=["innerHTML"],Pe={key:0,class:"text-gray-600 text-sm"},Ae={key:0,class:"flex-1 text-left truncate text-sm"},Ne=E({__name:"screen",props:{panel:{type:Object}},setup($){const{t:i}=C(),u=j("iApi"),r=M(),d=w(()=>r.searchVal),_=w(()=>r.searchResults),v=w(()=>r.loadingResults),n=w(()=>r.failedServices),p=e=>{let m=new U("zoomies",[[[e.bbox[0],e.bbox[1]],[e.bbox[0],e.bbox[3]],[e.bbox[2],e.bbox[3]],[e.bbox[2],e.bbox[1]],[e.bbox[0],e.bbox[1]]]],X.latLongSR(),!0);u.geo.map.zoomMapTo(m)},o=(e,m)=>{const L=e.replace(new RegExp(`${d.value}`,"gi"),h=>'<span class="font-bold text-blue-600">'+h+"</span>");return m?L+",":L};return(e,m)=>{const L=Q("panel-screen"),h=S("truncate"),x=S("focus-item"),c=S("focus-list");return t(),N(L,{panel:$.panel},{header:q(()=>[T(f(g(i)("geosearch.title")),1)]),content:q(()=>[a("div",Le,[V(ee),V(de),v.value?(t(),N(we,{key:0,class:"flex-none"})):k("",!0),n.value.length>0&&!v.value?(t(),s("div",$e,f(g(i)("geosearch.serviceError",{services:n.value.join(", ")})),1)):k("",!0),d.value&&_.value.length===0&&!v.value?(t(),s("div",ke,[a("span",Se,[T(f(g(i)("geosearch.noResults")),1),a("span",Te,'"'+f(d.value)+'"',1)])])):k("",!0),_.value.length>0?y((t(),s("ul",Ee,[(t(!0),s(A,null,B(_.value,(l,b)=>(t(),s("li",{class:"relative h-56",key:b},[y((t(),s("button",{type:"button",class:"absolute inset-0 h-full w-full hover:bg-gray-300 default-focus-style",onClick:Be=>p(l),style:{"border-bottom":"1px solid lightgray"}},[y((t(),s("div",Me,[a("div",Re,[a("span",{innerHTML:o(l.name,l.location.province)},null,8,Ve),l.location.province?(t(),s("span",Pe,f(l.location.city?" "+l.location.city+", "+l.location.province.abbr:" "+l.location.province.abbr),1)):k("",!0)]),l.type?(t(),s("div",Ae,f(l.type),1)):k("",!0)])),[[h]])],8,Ce)),[[x,"show-truncate"]])]))),128))])),[[c]]):k("",!0),V(be,{class:"mt-auto"})])]),_:1},8,["panel"])}}});export{Ne as _};
