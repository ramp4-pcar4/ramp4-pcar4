const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./geometryEngineJSON-C9nf8Xyv.js","./geometryEngineBase-B1c0NMch.js","./main-48Jy8Lgr.js","./preload-helper-dJJaZANz.js","./main-BjH693uE.css","./json-Beimr7gP.js"])))=>i.map(i=>d[i]);
import { da as e$h, qa as t$h, aq as f$g, ar as s$m, ap as l$j, ag as m$d, ao as u$f, W as a$i, qb as n$t, bk as f$h, qc as j$8, qd as c$c, ks as t$i, qe as f$i, qf as i$m, ak as u$g, qg as f$j, ov as G$4, qh as f$k, D as s$n, cS as u$h, qi as s$o, H as s$p, oi as n$u, qj as M$7, oj as e$i, qk as a$j, ql as S$8, fy as o$i, kR as n$v, oS as i$o, oR as s$q, lY as a$k, oD as I$5, ou as t$k, V as has, je as e$j, qm as C$6, oA as B$8, qn as N$5, oJ as w$a, oK as P$9, oL as A$8, oM as F$6, oG as L$3, oI as x$b, oH as T$5, qo as S$9, qp as g$c, ja as e$k, k6 as l$k, as as a$l, gK as u$j, qq as m$f, qr as f$l, qs as d$d, qt as k$7, ai as u$k, s as s$r, aW as e$n, ab as t$m, qu as f$m, kQ as c$e, ot as t$n, qv as O$6, aj as e$o, qw as o$j, oP as a$o, aX as y$9, aY as c$f, dY as S$b, jU as h$l, o1 as s$t, b2 as d$e } from './main-48Jy8Lgr.js';
import { a as a$h, C as C$5, i as i$p, c as c$d } from './TurboLine-C5YrZooe.js';
import './earcut-B9Bfurzd.js';
import { g as e$g, i as i$l, r as r$o, l as l$m } from './GeometryUtils-DX9aSgOT.js';
import { a as a$g, g as U$2, h as g$b, o as ot$1, d as at$1, $ as $$2, r as r$p, l as l$n, S as S$a, _ as _$d } from './definitions-slUvtMCM.js';
import { O as O$5, P as P$8, R as R$7, k as k$6, B as B$7, A as A$7, X as X$2, o as o$h, Y as Y$3, Z as Z$5, K as K$5, U as U$3, w as w$9, a as ie$1, C as C$7, l as l$l, b as a$m, u as u$i, y as y$8, c as ne$1, f as oe$1, m as m$e, e as e$m, n as n$w, i as i$q } from './enums-DZmWLm_j.js';
import { t as t$j } from './Rect-9uT7dZO1.js';
import { i as i$n, a as t$l, f as e$l, w as w$b, g as r$q, T as T$6, r as r$s } from './LabelMetric-B0d1A5uG.js';
import { _ as __vitePreload } from './preload-helper-dJJaZANz.js';
import { C as C$8 } from './enums-CgzwTbC2.js';
import { a as a$n } from './BindType-KnpK3yZX.js';
import { s as s$s } from './Util-CcpJDLeq.js';
import './Texture-CJSk3waQ.js';
import { r as r$r } from './Program-BOtrLCCL.js';
import { l as l$o } from './highlightReasons-Bw6E7Nh2.js';
import { t as t$o } from './constants-C0QDwCF4.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function n$s(n){return n}function r$n(n){return n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function e$f(e,t,r,i,u,o,l){D$4=0;const y=(i-r)*o,p=u&&u.length,c=p?(u[0]-r)*o:y;let v,s,h,d,Z,a=n$r(t,r,i,0,c,o,!0);if(a&&a.next!==a.prev){if(p&&(a=f$f(t,r,i,u,a,o)),y>80*o){v=h=t[0+r*o],s=d=t[1+r*o];for(let e=o;e<c;e+=o){const n=t[e+r*o],x=t[e+1+r*o];v=Math.min(v,n),s=Math.min(s,x),h=Math.max(h,n),d=Math.max(d,x);}Z=Math.max(h-v,d-s),Z=0!==Z?1/Z:0;}x$a(a,e,o,v,s,Z,l,0);}}function n$r(e,n,t,x,r,i,l){let f;if(l===Z$4(e,n,t,x,r,i)>0)for(let o=x;o<r;o+=i)f=u$e(o+n*i,e[o+n*i],e[o+1+n*i],f);else for(let o=r-i;o>=x;o-=i)f=u$e(o+n*i,e[o+n*i],e[o+1+n*i],f);return f&&M$6(f,f.next)&&(o$g(f),f=f.next),f}function t$g(e,n=e){if(!e)return e;let t,x=e;do{if(t=!1,x.steiner||!M$6(x,x.next)&&0!==s$l(x.prev,x,x.next))x=x.next;else {if(o$g(x),x=n=x.prev,x===x.next)break;t=!0;}}while(t||x!==n);return n}function x$a(e,n,u,l,f,y,p,v){if(!e)return;!v&&y&&(e=c$b(e,l,f,y));let s=e;for(;e.prev!==e.next;){const c=e.prev,h=e.next;if(y?i$k(e,l,f,y):r$m(e))n.push(c.index/u+p),n.push(e.index/u+p),n.push(h.index/u+p),o$g(e),e=h.next,s=h.next;else if((e=h)===s){v?1===v?x$a(e=b$8(e,n,u,p),n,u,l,f,y,p,2):2===v&&g$a(e,n,u,l,f,y,p):x$a(t$g(e),n,u,l,f,y,p,1);break}}}function r$m(e){const n=e.prev,t=e,x=e.next;if(s$l(n,t,x)>=0)return !1;let r=e.next.next;const i=r;let u=0;for(;r!==e.prev&&(0===u||r!==i);){if(u++,a$f(n.x,n.y,t.x,t.y,x.x,x.y,r.x,r.y)&&s$l(r.prev,r,r.next)>=0)return !1;r=r.next;}return !0}function i$k(e,n,t,x){const r=e.prev,i=e,u=e.next;if(s$l(r,i,u)>=0)return !1;const o=r.x<i.x?r.x<u.x?r.x:u.x:i.x<u.x?i.x:u.x,l=r.y<i.y?r.y<u.y?r.y:u.y:i.y<u.y?i.y:u.y,f=r.x>i.x?r.x>u.x?r.x:u.x:i.x>u.x?i.x:u.x,y=r.y>i.y?r.y>u.y?r.y:u.y:i.y>u.y?i.y:u.y,p=z$6(o,l,n,t,x),c=z$6(f,y,n,t,x);let v=e.prevZ,h=e.nextZ;for(;v&&v.z>=p&&h&&h.z<=c;){if(v!==e.prev&&v!==e.next&&a$f(r.x,r.y,i.x,i.y,u.x,u.y,v.x,v.y)&&s$l(v.prev,v,v.next)>=0)return !1;if(v=v.prevZ,h!==e.prev&&h!==e.next&&a$f(r.x,r.y,i.x,i.y,u.x,u.y,h.x,h.y)&&s$l(h.prev,h,h.next)>=0)return !1;h=h.nextZ;}for(;v&&v.z>=p;){if(v!==e.prev&&v!==e.next&&a$f(r.x,r.y,i.x,i.y,u.x,u.y,v.x,v.y)&&s$l(v.prev,v,v.next)>=0)return !1;v=v.prevZ;}for(;h&&h.z<=c;){if(h!==e.prev&&h!==e.next&&a$f(r.x,r.y,i.x,i.y,u.x,u.y,h.x,h.y)&&s$l(h.prev,h,h.next)>=0)return !1;h=h.nextZ;}return !0}function u$e(e,n,t,x){const r=q$8.create(e,n,t);return x?(r.next=x.next,r.prev=x,x.next.prev=r,x.next=r):(r.prev=r,r.next=r),r}function o$g(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ);}function l$i(e){let n=e,t=e;do{(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next;}while(n!==e);return t}function f$f(e,t,x,r,i,u){const o=new Array;for(let f=0,y=r.length;f<y;f++){const i=n$r(e,t,x,r[f]*u,f<y-1?r[f+1]*u:x*u,u,!1);i===i.next&&(i.steiner=!0),o.push(l$i(i));}o.sort(m$c);for(const n of o)i=y$7(n,i);return i}function y$7(e,n){const x=p$e(e,n);if(!x)return n;const r=j$7(x,e);return t$g(r,r.next),t$g(x,x.next)}function p$e(e,n){let t=n;const x=e.x,r=e.y;let i,u=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const e=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(e<=x&&e>u){if(u=e,e===x){if(r===t.y)return t;if(r===t.next.y)return t.next}i=t.x<t.next.x?t:t.next;}}t=t.next;}while(t!==n);if(!i)return null;if(x===u)return i.prev;const o=i,l=i.x,f=i.y;let y,p=1/0;for(t=i.next;t!==o;)x>=t.x&&t.x>=l&&x!==t.x&&a$f(r<f?x:u,r,l,f,r<f?u:x,r,t.x,t.y)&&(y=Math.abs(r-t.y)/(x-t.x),(y<p||y===p&&t.x>i.x)&&w$8(t,e)&&(i=t,p=y)),t=t.next;return i}function c$b(e,n,t,x){let r;for(;r!==e;r=r.next){if(r=r||e,null===r.z&&(r.z=z$6(r.x,r.y,n,t,x)),r.prev.next!==r||r.next.prev!==r)return r.prev.next=r,r.next.prev=r,c$b(e,n,t,x);r.prevZ=r.prev,r.nextZ=r.next;}return e.prevZ.nextZ=null,e.prevZ=null,v$6(e)}function v$6(e){let n,t=1;for(;;){let x,r=e;e=null,n=null;let i=0;for(;r;){i++,x=r;let u=0;for(;u<t&&x;u++)x=x.nextZ;let o=t;for(;u>0||o>0&&x;){let t;0===u?(t=x,x=x.nextZ,o--):0!==o&&x?r.z<=x.z?(t=r,r=r.nextZ,u--):(t=x,x=x.nextZ,o--):(t=r,r=r.nextZ,u--),n?n.nextZ=t:e=t,t.prevZ=n,n=t;}r=x;}if(n.nextZ=null,t*=2,i<2)return e}}function s$l(e,n,t){return (n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function h$k(e,n,t,x){return !!(M$6(e,n)&&M$6(t,x)||M$6(e,x)&&M$6(t,n))||s$l(e,n,t)>0!=s$l(e,n,x)>0&&s$l(t,x,e)>0!=s$l(t,x,n)>0}function d$c(e,n){let t=e;do{if(t.index!==e.index&&t.next.index!==e.index&&t.index!==n.index&&t.next.index!==n.index&&h$k(t,t.next,e,n))return !0;t=t.next;}while(t!==e);return !1}function Z$4(e,n,t,x,r,i){let u=0;for(let o=x,l=r-i;o<r;o+=i)u+=(e[l+n*i]-e[o+n*i])*(e[o+1+n*i]+e[l+1+n*i]),l=o;return u}function a$f(e,n,t,x,r,i,u,o){return (r-u)*(n-o)-(e-u)*(i-o)>=0&&(e-u)*(x-o)-(t-u)*(n-o)>=0&&(t-u)*(i-o)-(r-u)*(x-o)>=0}function w$8(e,n){return s$l(e.prev,e,e.next)<0?s$l(e,n,e.next)>=0&&s$l(e,e.prev,n)>=0:s$l(e,n,e.prev)<0||s$l(e,e.next,n)<0}function z$6(e,n,t,x,r){return (e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-t)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-x)*r)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function M$6(e,n){return e.x===n.x&&e.y===n.y}function m$c(e,n){return e.x-n.x}function b$8(e,n,t,x){let r=e;do{const i=r.prev,u=r.next.next;!M$6(i,u)&&h$k(i,r,r.next,u)&&w$8(i,u)&&w$8(u,i)&&(n.push(i.index/t+x),n.push(r.index/t+x),n.push(u.index/t+x),o$g(r),o$g(r.next),r=e=u),r=r.next;}while(r!==e);return r}function g$a(e,n,r,i,u,o,l){let f=e;do{let e=f.next.next;for(;e!==f.prev;){if(f.index!==e.index&&k$5(f,e)){let y=j$7(f,e);return f=t$g(f,f.next),y=t$g(y,y.next),x$a(f,n,r,i,u,o,l,0),void x$a(y,n,r,i,u,o,l,0)}e=e.next;}f=f.next;}while(f!==e)}function k$5(e,n){return e.next.index!==n.index&&e.prev.index!==n.index&&!d$c(e,n)&&w$8(e,n)&&w$8(n,e)&&A$6(e,n)}function A$6(e,n){let t=e,x=!1;const r=(e.x+n.x)/2,i=(e.y+n.y)/2;do{t.y>i!=t.next.y>i&&t.next.y!==t.y&&r<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(x=!x),t=t.next;}while(t!==e);return x}function j$7(e,n){const t=q$8.create(e.index,e.x,e.y),x=q$8.create(n.index,n.x,n.y),r=e.next,i=n.prev;return e.next=n,n.prev=e,t.next=r,r.prev=t,x.next=t,t.prev=x,i.next=x,x.prev=i,x}let q$8 = class q{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1;}static create(e,n,t){const x=D$4<B$6.length?B$6[D$4++]:new q;return x.index=e,x.x=n,x.y=t,x.prev=null,x.next=null,x.z=null,x.prevZ=null,x.nextZ=null,x.steiner=!1,x}};const B$6=[],C$4=8096;let D$4=0;for(let E=0;E<C$4;E++)B$6.push(new q$8);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const i$j=1e-5,f$e=new e$g(0,0,0,1,0),c$a=new e$g(0,0,0,1,0);function u$d(t,e,n){let o=0;for(let r=1;r<n;r++){const n=t[2*(e+r-1)],s=t[2*(e+r-1)+1];o+=(t[2*(e+r)]-n)*(t[2*(e+r)+1]+s);}return o}function h$j(t,e,n,o,r){let s=0;const l=2;for(let i=n;i<o;i+=3){const n=(t[i]-r)*l,o=(t[i+1]-r)*l,f=(t[i+2]-r)*l;s+=Math.abs((e[n]-e[f])*(e[o+1]-e[n+1])-(e[n]-e[o])*(e[f+1]-e[n+1]));}return s}function a$e(t,e){const{coords:n,lengths:o,hasIndeterminateRingOrder:r}=e,s=0,f=t;if(r)return !1;let c=0;for(let a=0;a<o.length;){let t=a,e=o[a],r=u$d(n,c,e);const g=[];for(;++t<o.length;){const s=o[t],l=u$d(n,c+e,s);if(!(l>0))break;r+=l,g.push(c+e),e+=s;}const p=f.length;e$f(f,n,c,c+e,g,2,s);const m=h$j(f,n,p,f.length,s),d=Math.abs(r);if(Math.abs((m-d)/Math.max(1e-7,d))>i$j)return f.length=0,!1;a=t,c+=e;}return !0}function p$d(t){const{coords:n,lengths:o}=t,{buffer:r}=a$h(n,o);return r}function m$b(t,e,n){let o=0;for(let r=0;r<t.lengths.length;r++){const s=t.lengths[r];for(let r=0;r<s;r++){const s=t.coords[2*(r+o)],l=t.coords[2*(r+o)+1];if(s<e||s>n||l<e||l>n)return !0}o+=s;}return !1}function d$b(t,e){if(null==t)return null;if(!m$b(t,-128,a$g+128))return t;f$e.setPixelMargin(e),f$e.reset(i$l.Polygon);let n=0;for(let o=0;o<t.lengths.length;o++){const e=t.lengths[o];let r=t.coords[2*(0+n)],s=t.coords[2*(0+n)+1];f$e.moveTo(r,s);for(let o=1;o<e;o++)r=t.coords[2*(o+n)],s=t.coords[2*(o+n)+1],f$e.lineTo(r,s);f$e.close(),n+=e;}const l=f$e.result(!1);if(!l)return null;const i=[],c=[];for(const o of l){let t=0;for(const e of o)c.push(e.x),c.push(e.y),t++;i.push(t);}return new e$h(i,c)}function x$9(t,e){c$a.setPixelMargin(e);const n=c$a,r=-e,l=a$g+e;let i=[],f=!1;if(!t.nextPath())return null;let u=!0;for(;u;){t.seekPathStart();const e=[];if(!t.pathSize)return null;n.reset(i$l.LineString),t.nextPoint();let s=t.x,c=t.y;if(f)n.moveTo(s,c);else {if(s<r||s>l||c<r||c>l){f=!0;continue}e.push({x:s,y:c});}let h=!1;for(;t.nextPoint();)if(s=t.x,c=t.y,f)n.lineTo(s,c);else {if(s<r||s>l||c<r||c>l){h=!0;break}e.push({x:s,y:c});}if(h)f=!0;else {if(f){const t=n.resultWithStarts();if(t)for(const e of t)i.push(e);}else i.push({line:e,start:0});u=t.nextPath(),f=!1;}}return i=i.filter((t=>t.line.length>1)),0===i.length?null:i}f$e.setExtent(a$g),c$a.setExtent(a$g);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let a$d = class a{static fromOptimized(t,e,s=!1,i=!1,h=1){return (new p$c).initialize(t,e,s,i,h)}static fromJSON(t,e=!1,s=!1){const[i,h]=u$c(t);return (new d$a).initialize(i,h,e,s,1)}static fromOptimizedCIM(t,e,s=!1,i=!1,h=1){return (new m$a).initialize(t,e,s,i,h)}static fromJSONCIM(t,e=!1,s=!1,i=1){const[h,r]=u$c(t);return (new y$6).initialize(h,r,e,s,i)}static fromFeatureSetReader(t){const e=t.readGeometryForDisplay(),s=t.geometryType;return e&&s?this.fromOptimized(e,s):null}static fromFeatureSetReaderCIM(t){const e=t.readGeometryForDisplay(),s=t.geometryType;return e&&s?this.fromOptimizedCIM(e,s):null}static createEmptyOptimized(t,e=!1,s=!1,i=1){return (new p$c).initialize(new e$h,t,e,s,i)}static createEmptyJSON(t,e=!1,s=!1){return (new d$a).initialize([],t,e,s,1)}static createEmptyOptimizedCIM(t,e=!1,s=!1,i=1){return (new m$a).initialize(new e$h,t,e,s,i)}static createEmptyJSONCIM(t,e=!1,s=!1,i=1){return (new y$6).initialize([],t,e,s,i)}asJSON(){const t=t$h(this);return "esriGeometryEnvelope"===this.geometryType?{xmin:t[0][0][0],ymin:t[0][0][1],xmax:t[0][2][0],ymax:t[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:t.flat()}:"esriGeometryPoint"===this.geometryType?{x:t[0][0][0],y:t[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:t}:{paths:t}}getCurrentRingArea(){if(this.pathSize<3)return 0;let t,e,s=0;if(this.seekPathStart(),!this.nextPoint())return 0;t=this.x,e=this.y;const i=t,h=e;for(;this.nextPoint();)s+=(t-this.x)*(e+this.y),t=this.x,e=this.y;return s+=(t-i)*(e+h),-.5*s}invertY(){this.yFactor*=-1;}};let p$c = class p extends a$d{constructor(){super(...arguments),this._end=-1;}initialize(t,e,s,i,h){return this.hasZ=s,this.hasM=i,this.geometryType=e,this._stride=2+Number(s)+Number(i),this._geometry=t,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=h,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor);}seekPath(t){if(t>=0&&t<this.totalSize){if(this._pathIndex<t)for(;this._pathIndex<t&&this.nextPath(););else if(this._pathIndex>t)for(;this._pathIndex>t&&this.prevPath(););return !0}return !1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride;}seekPathEnd(){this._pointOffset=this._end;}seekInPath(t){const e=this._pathOffset+t*this._stride;return e>=0&&e<this._end&&(this._pointOffset=e,!0)}nextPoint(){return (this._pointOffset+=this._stride)<this._end}prevPoint(){return (this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return !(this.pathIndex>=this.totalSize-1)&&(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,!0)}prevPath(){return !(this.pathIndex<=0)&&(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,!0)}pathLength(){const t=this._end,e=this._stride,s=this._geometry.coords;let i=0;for(let h=this._pathOffset+e;h<t;h+=e){const t=s[h-e],r=s[h-e+1],n=s[h]-t,o=s[h+1]-r;i+=Math.sqrt(n*n+o*o);}return i}startPath(){this._geometry.lengths.push(0);}pushPath(t){this.startPath(),this.pushPoints(t);}pushPoint(t){for(let e=0;e<this._stride;++e)this._geometry.coords.push(t[e]);this._geometry.lengths[this.totalSize-1]++;}pushXY(t,e){this._geometry.coords.push(t,e),this._geometry.lengths[this.totalSize-1]++;}pushPoints(t){for(const e of t)for(let t=0;t<this._stride;++t)this._geometry.coords.push(e[t]);this._geometry.lengths[this.totalSize-1]+=t.length;}pushCursor(t){const e=t.asOptimized();this._geometry.coords.push(...e.coords),this._geometry.lengths.push(...e.lengths);}asOptimized(){const t=this._geometry.clone();if(1!==this.yFactor)for(let e=1;e<t.coords.length;e+=this._stride)t.coords[e]*=this.yFactor;return "esriGeometryPoint"===this.geometryType&&(t.lengths.length=0),t}isClosed(){const t=this._geometry.coords,e=this._pathOffset,s=this._end-this._stride;for(let i=0;i<this._stride;i++)if(t[e+i]!==t[s+i])return !1;return !0}clone(){return (new p).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce(((t,e)=>t+e))}get pathSize(){const{lengths:t}=this._geometry;return this._pathIndex<0||this._pathIndex>t.length-1?0:this._geometry.isPoint?1:t[this._pathIndex]}get totalSize(){return this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(t){this._geometry.coords[this._pointOffset]=t;}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(t){this._geometry.coords[this._pointOffset+1]=this.yFactor*t;}get z(){return this._geometry.coords[this._pointOffset+2]}set z(t){this._geometry.coords[this._pointOffset+2]=t;}get m(){const t=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+t]}set m(t){this._geometry.coords[this._pointOffset+3]=t;}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}};function _$c(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e}function u$c(t){return f$g(t)?[t.rings,"esriGeometryPolygon"]:s$m(t)?[t.paths,"esriGeometryPolyline"]:l$j(t)?[[t.points],"esriGeometryMultipoint"]:m$d(t)?[[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]],"esriGeometryEnvelope"]:u$f(t)?[[[_$c(t)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}let d$a = class d extends a$d{initialize(t,e,s,i,h){return this._paths=t,this.geometryType=e,this.hasZ=s,this.hasM=i,this._pathIndex=this._pointIndex=-1,this.yFactor=h,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1;}seekPath(t){return this._pathIndex=t,this._pointIndex=-1,t>=0&&t<this.totalSize&&(this._currentPath=this._paths[t],!0)}seekPathStart(){this._pointIndex=-1;}seekPathEnd(){this._pointIndex=this._currentPath.length;}seekInPath(t){return t>=0&&t<this._currentPath.length&&(this._pointIndex=t,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const t=this._currentPath.length,e=this._currentPath;let s=0;for(let i=1;i<t;i++){const t=e[i-1],h=e[i],r=t[0],n=t[1],o=h[0]-r,a=h[1]-n;s+=Math.sqrt(o*o+a*a);}return s}startPath(){this._paths.push([]);}pushPath(t){this._paths.push(t);}pushPoint(t){this._paths[this.totalSize-1].push(t);}pushXY(t,e){this._paths[this.totalSize-1].push([t,e]);}pushPoints(t){this._paths[this.totalSize-1].push(...t);}pushCursor(t){const s=t$h(t);for(const e of s)this.pushPath(e);}asOptimized(){const t=new e$h;if("esriGeometryPoint"===this.geometryType)t.coords.push(...this._paths[0][0]),t.lengths.length=0;else for(const e of this._paths){for(const s of e)t.coords.push(s[0]),t.coords.push(s[1]*this.yFactor),this.hasZ&&t.coords.push(s[2]),this.hasM&&t.coords.push(s[this._mIndex]);t.lengths.push(e.length);}return t}isClosed(){const t=this._currentPath[0],e=this._currentPath[this._currentPath.length-1];for(let s=0;s<t.length;s++)if(t[s]!==e[s])return !1;return !0}clone(){return (new d).initialize(a$i(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map((t=>t.length)).reduce(((t,e)=>t+e))}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(t){this._currentPoint[0]=t;}get y(){return this.yFactor*this._currentPoint[1]}set y(t){this._currentPoint[1]=this.yFactor*t;}get z(){return this._currentPoint[2]}set z(t){this._currentPoint[2]=t;}get m(){return this._currentPoint[this._mIndex]}set m(t){this._currentPoint[this._mIndex]=t;}get pathIndex(){return this._pathIndex}};const c$9=4,l$h=1;let m$a = class m extends p$c{initialize(t,e,s,i,h){return super.initialize(t,e,s,i,h),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map((t=>new Set))),this}startPath(){super.startPath(),this._controlPoints.push(new Set);}clone(){const t=(new m).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return t._controlPoints=this._controlPoints,t}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex);}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(t){this._controlPoints[this.pathIndex].add(t);}getControlPointAt(t){return this._controlPoints[this.pathIndex].has(t)}};let y$6 = class y extends d$a{initialize(t,e,s,i,h){return super.initialize(t,e,s,i,h)}clone(){return (new y).initialize(a$i(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][c$9]=l$h;}getControlPoint(){return this._paths[this.pathIndex][this._pointIndex][c$9]===l$h}setControlPointAt(t){this._paths[this.pathIndex][t][c$9]=l$h;}getControlPointAt(t){return this._paths[this.pathIndex][t][c$9]===l$h}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const r$l=512;let n$q;let s$k = class s{constructor(t){this._geometry=t;}next(){const t=this._geometry;return this._geometry=null,t}};function i$i(s,i){n$q||(n$q=new e$g(0,0,0,1));const y="esriGeometryPolygon"===s.geometryType,m=y?i$l.Polygon:i$l.LineString,l=y?3:2;let c,p;for(n$q.reset(m),n$q.setPixelMargin(i+1),n$q.setExtent(r$l);s.nextPath();)if(!(s.pathSize<l)){for(s.nextPoint(),c=s.x,p=-s.y,n$q.moveTo(c,p);s.nextPoint();)c=s.x,p=-s.y,n$q.lineTo(c,p);y&&n$q.close();}const f=n$q.result(!1);if(f){const e=a$d.createEmptyOptimizedCIM(s.geometryType);for(const t of f){e.startPath();for(const o of t)e.pushXY(o.x,-o.y);}return e.reset(),e}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let e$e = class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(e,s,n,i,o){return new t$f(e,s,n)}};e$e.instance=null;let t$f = class t{constructor(e,t,s){this._inputGeometries=e,this._angleTolerance=void 0!==t.angleTolerance?t.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI);}next(){let e=this._inputGeometries.next();for(;e;){if("esriGeometryPolygon"===e.geometryType)this._isClosed=!0;else if("esriGeometryPolyline"===e.geometryType)this._isClosed=!1;else {if("esriGeometryEnvelope"!==e.geometryType){e=this._inputGeometries.next();continue}if(this._maxCosAngle)return e;this._isClosed=!0;}for(;e.nextPath();)this._processPath(e);return e.reset(),e}return null}_processPath(e){if(e.nextPoint()){const t=e.x,s=e.y;let n=t,i=s,o=e.pathSize,l=0,r=0,a=0,h=0,c=0,_=0;this._isClosed&&++o;for(let u=1;e.nextPoint()||u<o;++u){let x,m;this._isClosed&&u===o-1?(x=t,m=s):(x=e.x,m=e.y);const y=x-n,g=m-i,C=Math.sqrt(y*y+g*g);if(u>1&&C>0&&a>0){(l*y+r*g)/C/a<=this._maxCosAngle&&e.setControlPointAt(u-1);}1===u&&(h=y,c=g,_=C),C>0&&(n=x,i=m,l=y,r=g,a=C);}if(this._isClosed&&a>0&&_>0){(l*h+r*c)/_/a<=this._maxCosAngle&&e.setControlPointAt(0);}}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let t$e = class t{constructor(){this.setIdentity();}getAngle(){return (null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0;}setTranslate(t,s){this.tx=t,this.ty=s;}setTranslateZ(t){this.tz=t;}setRotateCS(t,s){this.rz=void 0,this.rzCos=t,this.rzSin=s;}setRotate(t){this.rz=t,this.rzCos=void 0,this.rzSin=void 0;}setRotateY(t){this.ry=t;}setScale(t){this.s=t;}setMeasure(t){this.m=t;}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function r$k(t,e){t[4]=e;}let s$j = class s{constructor(e,r=!0,s=!0,i=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!r&&"esriGeometryPolygon"===e.geometryType||!s&&"esriGeometryPolyline"===e.geometryType?null:e,this.geomUnitsPerPoint=i,this.iteratePath=!1,this.internalPlacement=new t$e;}next(){if(!this.geometryCursor)return null;for(;this.iteratePath||this.geometryCursor.pathIndex<this.geometryCursor.totalSize-1;){this.iteratePath||this.geometryCursor.nextPath();const t=this.processPath(this.geometryCursor);if(t)return t}return this.geometryCursor=null,null}};let i$h = class i{constructor(t,e,r,s=0){this.isClosed=!1,this.inputGeometries=t,this.acceptPolygon=e,this.acceptPolyline=r,this.geomUnitsPerPoint=s,this.iteratePath=!1,this.multiPathCursor=null;}next(){for(;;){if(!this.multiPathCursor){let t=this.inputGeometries.next();for(;t&&(this.isClosed=this.acceptPolygon&&"esriGeometryPolygon"===t.geometryType||"esriGeometryEnvelope"===t.geometryType,this.multiPathCursor=t,!this.multiPathCursor);)t=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const t=this.processPath(this.multiPathCursor);if(t)return t}this.multiPathCursor=null;}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const n$p=.03;let s$i = class s{constructor(t=0,e=!1){}isEmpty(t){if(!t.nextPoint())return !0;let e,n,s,r;for(e=t.x,n=t.y;t.nextPoint();e=n,n=r)if(s=t.x,r=t.y,s!==e||r!==n)return t.seekPathStart(),!1;return t.seekPathStart(),!0}normalize(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);0!==e&&(t[0]/=e,t[1]/=e);}getLength(t,e,n,s){const r=n-t,o=s-e;return Math.sqrt(r*r+o*o)}getSegLength(t){const[[e,n],[s,r]]=t;return this.getLength(e,n,s,r)}getCoord2D(t,e,n,s,r){return [t+(n-t)*r,e+(s-e)*r]}getSegCoord2D(t,e){const[[n,s],[r,o]]=t;return this.getCoord2D(n,s,r,o,e)}getAngle(t,e,n,s,r){const o=n-t,i=s-e;return Math.atan2(i,o)}getAngleCS(t,e,n,s,r){const o=n-t,i=s-e,u=Math.sqrt(o*o+i*i);return u>0?[o/u,i/u]:[1,0]}getSegAngleCS(t,e){const[[n,s],[r,o]]=t;return this.getAngleCS(n,s,r,o,e)}cut(t,e,n,s,r,o){return [r<=0?[t,e]:this.getCoord2D(t,e,n,s,r),o>=1?[n,s]:this.getCoord2D(t,e,n,s,o)]}getSubCurve(e,n,s){const r=a$d.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(r,e,n,s)?r:null}appendSubCurve(t,e,n,s){t.startPath(),e.seekPathStart();let r=0,o=!0;if(!e.nextPoint())return !1;let i=e.x,u=e.y;for(;e.nextPoint();){const h=this.getLength(i,u,e.x,e.y);if(0!==h){if(o){if(r+h>n){const l=(n-r)/h;let a=1,c=!1;r+h>=s&&(a=(s-r)/h,c=!0);const f=this.cut(i,u,e.x,e.y,l,a);if(f&&t.pushPoints(f),c)break;o=!1;}}else {if(r+h>s){const n=this.cut(i,u,e.x,e.y,0,(s-r)/h);n&&t.pushPoint(n[1]);break}t.pushXY(e.x,e.y);}r+=h,i=e.x,u=e.y;}else i=e.x,u=e.y;}return !0}getCIMPointAlong(t,e){if(!t.nextPoint())return null;let n,s,r,o,i=0;for(n=t.x,s=t.y;t.nextPoint();n=r,s=o){r=t.x,o=t.y;const u=this.getLength(n,s,r,o);if(0!==u){if(i+u>e){const t=(e-i)/u;return this.getCoord2D(n,s,r,o,t)}i+=u;}}return null}offset(t,n,s,r,o){if(!t||t.length<2)return null;let i=0,u=t[i++],h=i;for(;i<t.length;){const e=t[i];e[0]===u[0]&&e[1]===u[1]||(i!==h&&(t[h]=t[i]),u=t[h++]),i++;}const l=t[0][0]===t[h-1][0]&&t[0][1]===t[h-1][1];if(l&&--h,h<(l?3:2))return null;const a=[];u=l?t[h-1]:null;let c=t[0];for(let f=0;f<h;f++){const o=f===h-1?l?t[0]:null:t[f+1];if(u)if(o){const t=[o[0]-c[0],o[1]-c[1]];this.normalize(t);const i=[c[0]-u[0],c[1]-u[1]];this.normalize(i);const h=i[0]*t[1]-i[1]*t[0],l=i[0]*t[0]+i[1]*t[1];if(0===h&&1===l){c=o;continue}if(h>=0==n<=0){if(l<1){const e=[t[0]-i[0],t[1]-i[1]];this.normalize(e);const s=Math.sqrt((1+l)/2);if(s>1/r){const t=-Math.abs(n)/s;a.push([c[0]-e[0]*t,c[1]-e[1]*t]);}}}else switch(s){case O$5.Mitered:{const e=Math.sqrt((1+l)/2);if(e>0&&1/e<r){const s=[t[0]-i[0],t[1]-i[1]];this.normalize(s);const r=Math.abs(n)/e;a.push([c[0]-s[0]*r,c[1]-s[1]*r]);break}}case O$5.Bevelled:a.push([c[0]+i[1]*n,c[1]-i[0]*n]),a.push([c[0]+t[1]*n,c[1]-t[0]*n]);break;case O$5.Rounded:if(l<1){a.push([c[0]+i[1]*n,c[1]-i[0]*n]);const e=Math.floor(2.5*(1-l));if(e>0){const s=1/e;let r=s;for(let o=1;o<e;o++,r+=s){const e=[i[1]*(1-r)+t[1]*r,-i[0]*(1-r)-t[0]*r];this.normalize(e),a.push([c[0]+e[0]*n,c[1]+e[1]*n]);}}a.push([c[0]+t[1]*n,c[1]-t[0]*n]);}break;case O$5.Square:default:if(h<0)a.push([c[0]+(i[1]+i[0])*n,c[1]+(i[1]-i[0])*n]),a.push([c[0]+(t[1]-t[0])*n,c[1]-(t[0]+t[1])*n]);else {const e=Math.sqrt((1+Math.abs(l))/2),s=[t[0]-i[0],t[1]-i[1]];this.normalize(s);const r=n/e;a.push([c[0]-s[0]*r,c[1]-s[1]*r]);}}}else {const t=[c[0]-u[0],c[1]-u[1]];this.normalize(t),a.push([c[0]+t[1]*n,c[1]-t[0]*n]);}else {const t=[o[0]-c[0],o[1]-c[1]];this.normalize(t),a.push([c[0]+t[1]*n,c[1]-t[0]*n]);}u=c,c=o;}return a.length<(l?3:2)?null:(l&&a.push([a[0][0],a[0][1]]),a)}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const c$8=1.7320508075688772,u$b=5,h$i=P$8.OpenEnded;let p$b = class p{static local(){return null===p.instance&&(p.instance=new p),p.instance}execute(t,e,r,n,o){return new P$7(t,e,r)}};p$b.instance=null;let P$7 = class P extends i$h{constructor(t,e,r){super(t,!1,!0),this._curveHelper=new s$i,this._width=(void 0!==e.width?e.width:u$b)*r,this._arrowType=void 0!==e.geometricEffectArrowType?e.geometricEffectArrowType:void 0!==e.arrowType?e.arrowType:h$i,this._offsetFlattenError=n$p*r;}processPath(e){const r=a$d.createEmptyOptimizedCIM(e.geometryType);switch(this._arrowType){case P$8.OpenEnded:default:this._constructSimpleArrow(r,e,!0);break;case P$8.Block:this._constructSimpleArrow(r,e,!1);break;case P$8.Crossed:this._constructCrossedArrow(r,e);}return r}_constructSimpleArrow(t,r,n){const o=r.pathLength();let s=this._width;o<2*s&&(s=o/2);const i=this._curveHelper.getSubCurve(r,0,o-s);if(!i||!i.nextPath())return;i.seekPathStart();const c=s/2;if(this._curveHelper.isEmpty(i))return;const u=n$t(i),h=this._constructOffset(u,-c);if(!h)return;const p=this._constructOffset(u,c);if(!p)return;const P=this._constructArrowBasePoint(h,-c/2);if(!P)return;const l=this._constructArrowBasePoint(p,c/2);if(!l)return;r.seekInPath(r.pathSize-1);const f=[r.x,r.y];t.pushPath(p),t.nextPath(),t.nextPoint(),t.setControlPoint(),t.pushPoint(l),t.nextPoint(),t.setControlPoint(),t.pushPoint(f),t.nextPoint(),t.setControlPoint(),t.pushPoint(P),t.nextPoint(),t.setControlPoint(),t.pushPoints(h.reverse()),t.setControlPoint(),n||(t.setControlPointAt(0),t.setControlPointAt(t.pathSize-1),t.pushPoint(p[0])),t.reset();}_constructCrossedArrow(t,r){const n=r.pathLength();let o=this._width;n<o*(1+c$8+1)&&(o=n/(1+c$8+1)),r.seekPathStart();const s=this._curveHelper.getSubCurve(r,0,n-o*(1+c$8));if(!s)return;s.nextPath();const i=o/2;if(this._curveHelper.isEmpty(s))return;const u=n$t(s),h=this._constructOffset(u,i);if(!h)return;const p=this._constructOffset(u,-i);if(!p)return;const P=this._curveHelper.getSubCurve(r,0,n-o);if(!P)return;if(P.nextPath(),this._curveHelper.isEmpty(P))return;const l=n$t(P),f=this._constructOffset(l,i);if(!f)return;const a=this._constructOffset(l,-i);if(!a)return;const _=f[f.length-1],m=this._constructArrowBasePoint(f,i/2);if(!m)return;const C=a[a.length-1],w=this._constructArrowBasePoint(a,-i/2);if(!w)return;r.seekInPath(r.pathSize-1);const x=[r.x,r.y];t.pushPath(h),t.nextPath(),t.nextPoint(),t.setControlPoint(),t.pushPoint(C),t.nextPoint(),t.setControlPoint(),t.pushPoint(w),t.nextPoint(),t.setControlPoint(),t.pushPoint(x),t.nextPoint(),t.setControlPoint(),t.pushPoint(m),t.nextPoint(),t.setControlPoint(),t.pushPoint(_),t.nextPoint(),t.setControlPoint(),t.pushPoints(p.reverse()),t.nextPoint(),t.setControlPoint(),t.reset();}_constructOffset(t,e){return this._curveHelper.offset(t,e,O$5.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(t,e){if(!t||t.length<2)return null;const r=t[t.length-2],n=t[t.length-1],o=[n[0]-r[0],n[1]-r[1]];return this._curveHelper.normalize(o),[n[0]+o[1]*e,n[1]-o[0]*e]}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let m$9 = class m{static local(){return null===m.instance&&(m.instance=new m),m.instance}execute(e,t,i,s,r,n){return new l$g(e,t,i,s,r,n)}};m$9.instance=null;let l$g = class l{constructor(e,t,i,n,o,m){this._inputGeometries=e,this._tileKey=n,this._geometryEngine=o,this._curveHelper=new s$i,this._size=(void 0!==t.size?t.size:1)*i,this._maxInflateSize=m*i,this._offsetFlattenError=n$p*i;}next(){let s;for(;s=this._inputGeometries.next();){if(0===this._size)return s;if("esriGeometryEnvelope"===s.geometryType)if(this._size>0){const i=a$d.createEmptyOptimizedCIM(s.geometryType),r=t$h(s)[0],o=this._curveHelper.offset(r,this._size,O$5.Rounded,4,this._offsetFlattenError);if(o)return i.pushPath(o),i}else if(this._size<0){const t=s.asJSON();if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._size>0)return a$d.fromJSONCIM({xmin:t.xmin-this._size,xmax:t.xmax+this._size,ymin:t.ymin-this._size,ymax:t.ymax+this._size})}const r=this._geometryEngine;if(null==r)return null;const m=this._tileKey?i$i(s,this._maxInflateSize):s;if(!m)continue;const l=r.buffer(f$h.WebMercator,m.asJSON(),this._size,1);return l?a$d.fromJSONCIM(l):null}return null}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let e$d = class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(s,t,i,h,e){return new r$j(s,t,i)}};e$d.instance=null;let r$j = class r{constructor(s,t,i){this._defaultPointSize=20,this._inputGeometries=s,this._geomUnitsPerPoint=i,this._rule=t.rule??R$7.FullGeometry,this._defaultSize=this._defaultPointSize*i;}next(){let i;for(;i=this._inputGeometries.next();){const h=this._processGeom(t$h(i));if(h&&h.length)return a$d.fromJSONCIM({paths:h})}return null}_clone(s){return [s[0],s[1]]}_mid(s,t){return [(s[0]+t[0])/2,(s[1]+t[1])/2]}_mix(s,t,i,h){return [s[0]*t+i[0]*h,s[1]*t+i[1]*h]}_add(s,t){return [s[0]+t[0],s[1]+t[1]]}_add2(s,t,i){return [s[0]+t,s[1]+i]}_sub(s,t){return [s[0]-t[0],s[1]-t[1]]}_dist(s,t){return Math.sqrt((s[0]-t[0])*(s[0]-t[0])+(s[1]-t[1])*(s[1]-t[1]))}_norm(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}_normalize(s,t=1){const i=t/this._norm(s);s[0]*=i,s[1]*=i;}_leftPerpendicular(s){const t=-s[1],i=s[0];s[0]=t,s[1]=i;}_leftPerp(s){return [-s[1],s[0]]}_rightPerpendicular(s){const t=s[1],i=-s[0];s[0]=t,s[1]=i;}_rightPerp(s){return [s[1],-s[0]]}_dotProduct(s,t){return s[0]*t[0]+s[1]*t[1]}_crossProduct(s,t){return s[0]*t[1]-s[1]*t[0]}_rotateDirect(s,t,i){const h=s[0]*t-s[1]*i,e=s[0]*i+s[1]*t;s[0]=h,s[1]=e;}_makeCtrlPt(s){const t=[s[0],s[1]];return r$k(t,1),t}_addAngledTicks(s,t,i,h){const e=this._sub(i,t);this._normalize(e);const r=this._crossProduct(e,this._sub(h,t));let _;_=r>0?this._rightPerp(e):this._leftPerp(e);const c=Math.abs(r)/2,u=[];u.push([t[0]+(_[0]-e[0])*c,t[1]+(_[1]-e[1])*c]),u.push(t),u.push(i),u.push([i[0]+(_[0]+e[0])*c,i[1]+(_[1]+e[1])*c]),s.push(u);}_addBezier2(s,t,i,h,e){if(0==e--)return void s.push(h);const r=this._mid(t,i),_=this._mid(i,h),c=this._mid(r,_);this._addBezier2(s,t,r,c,e),this._addBezier2(s,c,_,h,e);}_addBezier3(s,t,i,h,e,r){if(0==r--)return void s.push(e);const _=this._mid(t,i),c=this._mid(i,h),u=this._mid(h,e),o=this._mid(_,c),n=this._mid(c,u),a=this._mid(o,n);this._addBezier3(s,t,_,o,a,r),this._addBezier3(s,a,n,u,e,r);}_add90DegArc(s,t,i,h,e){const r=e??this._crossProduct(this._sub(i,t),this._sub(h,t))>0,_=this._mid(t,i),c=this._sub(_,t);r?this._leftPerpendicular(c):this._rightPerpendicular(c),_[0]+=c[0],_[1]+=c[1],this._addBezier3(s,t,this._mix(t,.33333,_,.66667),this._mix(i,.33333,_,.66667),i,4);}_addArrow(s,t,i){const h=t[0],e=t[1],r=t[t.length-1],_=this._sub(h,e);this._normalize(_);const c=this._crossProduct(_,this._sub(r,e)),u=.5*c,o=this._leftPerp(_),n=[r[0]-o[0]*c,r[1]-o[1]*c],a=t.length-1,p=[];p.push(i?[-o[0],-o[1]]:o);let l=[-_[0],-_[1]];for(let d=1;d<a-1;d++){const s=this._sub(t[d+1],t[d]);this._normalize(s);const i=this._dotProduct(s,l),h=this._crossProduct(s,l),e=Math.sqrt((1+i)/2),r=this._sub(s,l);this._normalize(r),r[0]/=e,r[1]/=e,p.push(h<0?[-r[0],-r[1]]:r),l=s;}p.push(this._rightPerp(l));for(let d=p.length-1;d>0;d--)s.push([t[d][0]+p[d][0]*u,t[d][1]+p[d][1]*u]);s.push([n[0]+p[0][0]*u,n[1]+p[0][1]*u]),s.push([n[0]+p[0][0]*c,n[1]+p[0][1]*c]),s.push(h),s.push([n[0]-p[0][0]*c,n[1]-p[0][1]*c]),s.push([n[0]-p[0][0]*u,n[1]-p[0][1]*u]);for(let d=1;d<p.length;d++)s.push([t[d][0]-p[d][0]*u,t[d][1]-p[d][1]*u]);}_cp2(s,t,i){return s.length>=2?s[1]:this._add2(s[0],t*this._defaultSize,i*this._defaultSize)}_cp3(s,t,i,h){if(s.length>=3)return s[2];const e=this._mix(s[0],1-i,t,i),r=this._sub(t,s[0]);return this._normalize(r),this._rightPerpendicular(r),[e[0]+r[0]*h*this._defaultSize,e[1]+r[1]*h*this._defaultSize]}_arrowPath(s){if(s.length>2)return s;const t=s[0],i=this._cp2(s,-4,0),h=this._sub(t,i);this._normalize(h);const e=this._rightPerp(h);return [t,i,[t[0]+(e[0]-h[0])*this._defaultSize,t[1]+(e[1]-h[1])*this._defaultSize]]}_arrowLastSeg(s){const t=s[0],i=this._cp2(s,-4,0);let h;if(s.length>=3)h=s[s.length-1];else {const s=this._sub(t,i);this._normalize(s);const e=this._rightPerp(s);h=[t[0]+(e[0]-s[0])*this._defaultSize,t[1]+(e[1]-s[1])*this._defaultSize];}return [i,h]}_processGeom(s){if(!s)return null;const t=[];for(const e of s){if(!e||0===e.length)continue;const s=e.length;let r=e[0];switch(this._rule){case R$7.PerpendicularFromFirstSegment:{const s=this._cp2(e,0,-1),i=this._cp3(e,s,.5,4),h=[];h.push(i),h.push(this._mid(r,s)),t.push(h);break}case R$7.ReversedFirstSegment:{const s=this._cp2(e,0,-1);t.push([s,r]);break}case R$7.PerpendicularToSecondSegment:{const s=this._cp2(e,-4,1),i=this._cp3(e,s,.882353,-1.94),h=[];h.push(this._mid(s,i)),h.push(r),t.push(h);break}case R$7.SecondSegmentWithTicks:{const s=this._cp2(e,-4,1),i=this._cp3(e,s,.882353,-1.94),h=this._sub(i,s);let _;_=this._crossProduct(h,this._sub(r,s))>0?this._rightPerp(_):this._leftPerp(h);const c=[];c.push([s[0]+(_[0]-h[0])/3,s[1]+(_[1]-h[1])/3]),c.push(s),c.push(i),c.push([i[0]+(_[0]+h[0])/3,i[1]+(_[1]+h[1])/3]),t.push(c);break}case R$7.DoublePerpendicular:{const s=this._cp2(e,0,-1),i=this._cp3(e,s,.5,3),h=this._mid(r,s),_=this._sub(h,i);this._normalize(_);const c=this._crossProduct(_,this._sub(r,i));this._leftPerpendicular(_);const u=[];u.push(r),u.push([i[0]+_[0]*c,i[1]+_[1]*c]),t.push(u);const o=[];o.push([i[0]-_[0]*c,i[1]-_[1]*c]),o.push(s),t.push(o);break}case R$7.OppositeToFirstSegment:{const s=this._cp2(e,0,-1),i=this._cp3(e,s,.5,3),h=this._mid(r,s),_=this._sub(h,i);this._normalize(_);const c=this._crossProduct(_,this._sub(r,i));this._leftPerpendicular(_);const u=[];u.push([i[0]+_[0]*c,i[1]+_[1]*c]),u.push([i[0]-_[0]*c,i[1]-_[1]*c]),t.push(u);break}case R$7.TriplePerpendicular:{const s=this._cp2(e,0,-1),i=this._cp3(e,s,.5,4),h=this._mid(r,s),_=this._sub(h,i);this._normalize(_);const c=this._crossProduct(_,this._sub(r,i));this._leftPerpendicular(_);const u=[];u.push([i[0]+_[0]*c*.8,i[1]+_[1]*c*.8]),u.push([h[0]+.8*(r[0]-h[0]),h[1]+.8*(r[1]-h[1])]),t.push(u),t.push([i,h]);const o=[];o.push([i[0]-_[0]*c*.8,i[1]-_[1]*c*.8]),o.push([h[0]+.8*(s[0]-h[0]),h[1]+.8*(s[1]-h[1])]),t.push(o);break}case R$7.HalfCircleFirstSegment:{const s=this._cp2(e,0,-1),i=this._cp3(e,s,.5,4),h=this._mid(r,s);let _=this._sub(s,r);const c=Math.cos(Math.PI/18),u=Math.sin(Math.PI/18),o=Math.sqrt((1+c)/2),n=Math.sqrt((1-c)/2),a=[];let p;this._crossProduct(_,this._sub(i,r))>0?(a.push(r),_=this._sub(r,h),p=s):(a.push(s),_=this._sub(s,h),p=r),this._rotateDirect(_,o,n),_[0]/=o,_[1]/=o;for(let t=1;t<=18;t++)a.push(this._add(h,_)),this._rotateDirect(_,c,u);a.push(p),t.push(a);break}case R$7.HalfCircleSecondSegment:{const s=this._cp2(e,0,-1),i=this._cp3(e,s,1,-1);let h=this._sub(r,s);this._normalize(h);const _=this._crossProduct(h,this._sub(i,s))/2;this._leftPerpendicular(h);const c=[s[0]+h[0]*_,s[1]+h[1]*_];h=this._sub(s,c);const u=Math.cos(Math.PI/18);let o=Math.sin(Math.PI/18);_>0&&(o=-o);const n=[s];for(let t=1;t<=18;t++)this._rotateDirect(h,u,o),n.push(this._add(c,h));t.push(n);break}case R$7.HalfCircleExtended:{const i=this._cp2(e,0,-2),h=this._cp3(e,i,1,-1);let _;if(s>=4)_=e[3];else {const s=this._sub(r,i);_=this._add(h,s);}const c=this._dist(i,h)/2/.75,u=this._sub(i,r);this._normalize(u,c);const o=this._sub(h,_);this._normalize(o,c);const n=[_,h];t.push(n);const a=[this._clone(h)];this._addBezier3(a,h,this._add(h,o),this._add(i,u),i,4),a.push(r),t.push(a);break}case R$7.OpenCircle:{const s=this._cp2(e,-2,0),i=this._sub(s,r),h=Math.cos(Math.PI/18),_=-Math.sin(Math.PI/18),c=[s];for(let t=1;t<=33;t++)this._rotateDirect(i,h,_),c.push(this._add(r,i));t.push(c);break}case R$7.CoverageEdgesWithTicks:{const i=this._cp2(e,0,-1);let h,_;if(s>=3)h=e[2];else {const s=this._sub(i,r),t=this._leftPerp(s);h=[r[0]+t[0]-.25*s[0],r[1]+t[1]-.25*s[1]];}if(s>=4)_=e[3];else {const s=this._mid(r,i),t=this._sub(r,i);this._normalize(t),this._leftPerpendicular(t);const e=this._crossProduct(t,this._sub(h,s));this._rightPerpendicular(t),_=[h[0]+t[0]*e*2,h[1]+t[1]*e*2];}const c=this._sub(i,r);let u,o;u=this._crossProduct(c,this._sub(h,r))>0?this._rightPerp(c):this._leftPerp(c),o=[],o.push(h),o.push(r),o.push([r[0]+(u[0]-c[0])/3,r[1]+(u[1]-c[1])/3]),t.push(o),u=this._crossProduct(c,this._sub(_,i))>0?this._rightPerp(u):this._leftPerp(c),o=[],o.push([i[0]+(u[0]+c[0])/3,i[1]+(u[1]+c[1])/3]),o.push(i),o.push(_),t.push(o);break}case R$7.GapExtentWithDoubleTicks:{const i=this._cp2(e,0,2),h=this._cp3(e,i,0,1);let _;if(s>=4)_=e[3];else {const s=this._sub(i,r);_=this._add(h,s);}this._addAngledTicks(t,r,i,this._mid(h,_)),this._addAngledTicks(t,h,_,this._mid(r,i));break}case R$7.GapExtentMidline:{const i=this._cp2(e,2,0),h=this._cp3(e,i,0,1);let _;if(s>=4)_=e[3];else {const s=this._sub(i,r);_=this._add(h,s);}const c=[];c.push(this._mid(r,h)),c.push(this._mid(i,_)),t.push(c);break}case R$7.Chevron:{const i=this._cp2(e,-1,-1);let h;if(s>=3)h=e[2];else {const s=this._sub(i,r);this._leftPerpendicular(s),h=this._add(r,s);}t.push([i,this._makeCtrlPt(r),h]);break}case R$7.PerpendicularWithArc:{const s=this._cp2(e,0,-2),i=this._cp3(e,s,.5,-1);let h=this._sub(s,r);const _=this._norm(h);h[0]/=_,h[1]/=_;const c=this._crossProduct(h,this._sub(i,r));let u=this._dotProduct(h,this._sub(i,r));u<.05*_?u=.05*_:u>.95*_&&(u=.95*_);const o=[r[0]+h[0]*u,r[1]+h[1]*u];this._leftPerpendicular(h);let n=[];n.push([o[0]-h[0]*c,o[1]-h[1]*c]),n.push([o[0]+h[0]*c,o[1]+h[1]*c]),t.push(n);const a=[s[0]+h[0]*c,s[1]+h[1]*c];h=this._sub(s,a);const p=Math.cos(Math.PI/18);let l=Math.sin(Math.PI/18);c<0&&(l=-l),n=[r,s];for(let t=1;t<=9;t++)this._rotateDirect(h,p,l),n.push(this._add(a,h));t.push(n);break}case R$7.ClosedHalfCircle:{const s=this._cp2(e,2,0),i=this._mid(r,s),h=this._sub(s,i),_=Math.cos(Math.PI/18),c=Math.sin(Math.PI/18),u=[r,s];for(let t=1;t<=18;t++)this._rotateDirect(h,_,c),u.push(this._add(i,h));t.push(u);break}case R$7.TripleParallelExtended:{const s=this._cp2(e,0,-2),h=this._cp3(e,s,1,-2),_=this._mid(r,s),c=this._sub(h,s);this._normalize(c);const u=Math.abs(this._crossProduct(c,this._sub(_,s)))/2,o=this._dist(s,h),n=[s,r];n.push([r[0]+c[0]*o*.5,r[1]+c[1]*o*.5]),t.push(n);const a=[];a.push([_[0]-c[0]*u,_[1]-c[1]*u]),a.push([_[0]+c[0]*o*.375,_[1]+c[1]*o*.375]),r$k(a[a.length-1],1),a.push([_[0]+c[0]*o*.75,_[1]+c[1]*o*.75]),t.push(a);const p=[s,h];t.push(p);break}case R$7.ParallelWithTicks:{const s=this._cp2(e,3,0),i=this._cp3(e,s,.5,-1),h=this._sub(i,s);this._normalize(h);const _=this._crossProduct(h,this._sub(i,r));this._leftPerpendicular(h),this._addAngledTicks(t,r,s,i),this._addAngledTicks(t,this._mix(r,1,h,_),this._mix(s,1,h,_),this._mid(r,s));break}case R$7.Parallel:{const s=this._cp2(e,3,0),i=this._cp3(e,s,.5,-1),h=this._sub(s,r);this._normalize(h);const _=this._leftPerp(h),c=this._crossProduct(h,this._sub(i,r));let u=[r,s];t.push(u),u=[],u.push([r[0]+_[0]*c,r[1]+_[1]*c]),u.push([s[0]+_[0]*c,s[1]+_[1]*c]),t.push(u);break}case R$7.PerpendicularToFirstSegment:{const s=this._cp2(e,3,0),i=this._cp3(e,s,.5,-1),h=this._mid(r,s),_=this._sub(s,r);this._normalize(_);const c=this._crossProduct(_,this._sub(i,r));this._leftPerpendicular(_);const u=[];u.push([h[0]-_[0]*c*.25,h[1]-_[1]*c*.25]),u.push([h[0]+_[0]*c*1.25,h[1]+_[1]*c*1.25]),t.push(u);break}case R$7.ParallelOffset:{const s=this._cp2(e,3,0),i=this._cp3(e,s,.5,-1),h=this._sub(s,r);this._normalize(h);const _=this._crossProduct(h,this._sub(i,r));this._leftPerpendicular(h);const c=[];c.push([r[0]-h[0]*_,r[1]-h[1]*_]),c.push([s[0]-h[0]*_,s[1]-h[1]*_]),t.push(c);const u=[];u.push([r[0]+h[0]*_,r[1]+h[1]*_]),u.push([s[0]+h[0]*_,s[1]+h[1]*_]),t.push(u);break}case R$7.OffsetOpposite:{const s=this._cp2(e,3,0),i=this._cp3(e,s,.5,-1),h=this._sub(s,r);this._normalize(h);const _=this._crossProduct(h,this._sub(i,r));this._leftPerpendicular(h);const c=[];c.push([r[0]-h[0]*_,r[1]-h[1]*_]),c.push([s[0]-h[0]*_,s[1]-h[1]*_]),t.push(c);break}case R$7.OffsetSame:{const s=this._cp2(e,3,0),i=this._cp3(e,s,.5,-1),h=this._sub(s,r);this._normalize(h);const _=this._crossProduct(h,this._sub(i,r));this._leftPerpendicular(h);const c=[];c.push([r[0]+h[0]*_,r[1]+h[1]*_]),c.push([s[0]+h[0]*_,s[1]+h[1]*_]),t.push(c);break}case R$7.CircleWithArc:{let h=this._cp2(e,3,0);const _=this._cp3(e,h,.5,-1);let c,u;if(s>=4)c=e[3],u=this._crossProduct(this._sub(c,h),this._sub(_,h))>0;else {c=h,u=this._crossProduct(this._sub(c,r),this._sub(_,r))>0;const s=24*this._geomUnitsPerPoint,t=this._sub(c,r);this._normalize(t,s);const i=Math.sqrt(2)/2;this._rotateDirect(t,i,u?i:-i),h=this._add(r,t);}const o=this._sub(h,r),n=Math.cos(Math.PI/18),a=Math.sin(Math.PI/18),p=[h];for(let s=1;s<=36;s++)this._rotateDirect(o,n,a),p.push(this._add(r,o));this._add90DegArc(p,h,c,_,u),r$k(p[p.length-8],1),t.push(p);break}case R$7.DoubleJog:{let i,h,_=this._cp2(e,-3,1);if(i=s>=3?e[2]:this._add(r,this._sub(r,_)),s>=4)h=e[3];else {const s=r;r=_,h=i;const t=this._dist(r,s),e=this._dist(h,s);let c=30*this._geomUnitsPerPoint;.5*t<c&&(c=.5*t),.5*e<c&&(c=.5*e),_=this._mix(r,c/t,s,(t-c)/t),i=this._mix(h,c/e,s,(e-c)/e);}const c=this._mid(r,_),u=this._mid(h,i),o=this._dist(r,_),n=this._dist(i,h);let a=Math.min(o,n)/8;a=Math.min(a,24*this._geomUnitsPerPoint);const p=Math.cos(Math.PI/4);let l=this._sub(r,_);this._normalize(l,a),this._crossProduct(l,this._sub(h,_))>0?this._rotateDirect(l,p,-p):this._rotateDirect(l,p,p);let d=[];d.push(_),d.push(this._add(c,l)),d.push(this._sub(c,l)),d.push(r),t.push(d),l=this._sub(h,i),this._normalize(l,a),this._crossProduct(l,this._sub(r,i))<0?this._rotateDirect(l,p,p):this._rotateDirect(l,p,-p),d=[],d.push(i),d.push(this._add(u,l)),d.push(this._sub(u,l)),d.push(h),t.push(d);break}case R$7.PerpendicularOffset:{const s=this._cp2(e,-4,1),i=this._cp3(e,s,.882353,-1.94),h=this._sub(i,s);this._crossProduct(h,this._sub(r,s))>0?this._rightPerpendicular(h):this._leftPerpendicular(h);const _=[h[0]/8,h[1]/8],c=this._sub(this._mid(s,i),_);t.push([c,r]);break}case R$7.LineExcludingLastSegment:{const s=this._arrowPath(e),i=[];let h=s.length-2;for(;h--;)i.push(s[h]);t.push(i);break}case R$7.MultivertexArrow:{const s=this._arrowPath(e),i=[];this._addArrow(i,s,!1),t.push(i);break}case R$7.CrossedArrow:{const s=this._arrowPath(e),i=[];this._addArrow(i,s,!0),t.push(i);break}case R$7.ChevronArrow:{const[s,i]=this._arrowLastSeg(e),h=10*this._geomUnitsPerPoint,_=this._sub(r,s);this._normalize(_);const c=this._crossProduct(_,this._sub(i,s)),u=this._leftPerp(_),o=[i[0]-u[0]*c*2,i[1]-u[1]*c*2],n=[];n.push([i[0]+_[0]*h,i[1]+_[1]*h]),n.push(r),n.push([o[0]+_[0]*h,o[1]+_[1]*h]),t.push(n);break}case R$7.ChevronArrowOffset:{const[s,i]=this._arrowLastSeg(e),h=this._sub(r,s);this._normalize(h);const _=this._crossProduct(h,this._sub(i,s));this._leftPerpendicular(h);const c=[i[0]-h[0]*_,i[1]-h[1]*_],u=[];u.push([c[0]+h[0]*_*.5,c[1]+h[1]*_*.5]),u.push(this._mid(c,r)),u.push([c[0]-h[0]*_*.5,c[1]-h[1]*_*.5]),t.push(u);break}case R$7.PartialFirstSegment:{const[s,i]=this._arrowLastSeg(e),h=this._sub(r,s);this._normalize(h);const _=this._crossProduct(h,this._sub(i,s));this._leftPerpendicular(h);const c=[i[0]-h[0]*_,i[1]-h[1]*_];t.push([s,c]);break}case R$7.Arch:{const s=this._cp2(e,0,-1),i=this._cp3(e,s,.5,1),h=this._sub(r,s),_=this._mix(i,1,h,.55),c=this._mix(i,1,h,-.55),u=[r];this._addBezier2(u,r,_,i,4),this._addBezier2(u,i,c,s,4),t.push(u);break}case R$7.CurvedParallelTicks:{const s=this._cp2(e,-4,1),i=this._cp3(e,s,.882353,-1.94),h=this._sub(i,s);this._crossProduct(h,this._sub(r,s))>0?this._rightPerpendicular(h):this._leftPerpendicular(h);const _=[h[0]/8,h[1]/8],c=this._sub(this._mid(s,i),_),u=this._sub(this._mix(s,.75,i,.25),_),o=this._sub(this._mix(s,.25,i,.75),_),n=[s];this._addBezier2(n,s,u,c,3),this._addBezier2(n,c,o,i,3),t.push(n);for(let e=0;e<8;e++){const s=n[2*e+1],i=[this._clone(s)];i.push(this._add(s,[h[0]/4,h[1]/4])),t.push(i);}break}case R$7.Arc90Degrees:{const s=this._cp2(e,0,-1),i=this._cp3(e,s,.5,1),h=[s];this._add90DegArc(h,s,r,i),t.push(h);break}case R$7.FullGeometry:default:t.push(e);}}return t}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let r$i = class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(e,t,i,r,n){return new u$a(e,t,i)}};r$i.instance=null;let u$a = class u extends i$h{constructor(e,t,r){super(e,!0,!0),this._curveHelper=new s$i,this._beginCut=(void 0!==t.beginCut?t.beginCut:1)*r,this._endCut=(void 0!==t.endCut?t.endCut:1)*r,this._middleCut=(void 0!==t.middleCut?t.middleCut:0)*r,this._invert=void 0!==t.invert&&t.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0);}processPath(t){const{_beginCut:i,_endCut:r,_middleCut:u}=this,n=t.pathLength(),s=a$d.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(0!==i||0!==r||0!==u)if(i+r+u>=n)for(s.startPath();t.nextPoint();)s.pushXY(t.x,t.y);else this._curveHelper.appendSubCurve(s,t,0,i),this._curveHelper.appendSubCurve(s,t,.5*(n-u),.5*(n+u)),this._curveHelper.appendSubCurve(s,t,n-r,r);}else if(0===i&&0===r&&0===u)for(s.startPath();t.nextPoint();)s.pushXY(t.x,t.y);else i+r+u<n&&(0===u?this._curveHelper.appendSubCurve(s,t,i,n-r):(this._curveHelper.appendSubCurve(s,t,i,.5*(n-u)),this._curveHelper.appendSubCurve(s,t,.5*(n+u),n-r)));return 0===s.totalSize?null:s}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const n$o=1e-7;let i$g = class i{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0;}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(t,e,s=!0){if(this._setEmpty(),!t||0===t.length)return !1;for(let i=0;i<t.length;i++){let e=Math.abs(t[i]);s&&e<n$o&&(e=n$o),this._values.push(e),this._length+=e;}return e&&1&t.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(t){const e=this._values?this._values.length:0;for(let s=0;s<e;++s)this._values[s]*=t;this._length*=t,this.extPtGap*=t,this.ctrlPtGap*=t;}addValue(t){this._length+=t,this._values.push(t);}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1;}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0;}};let h$h = class h{constructor(){this.pt=null,this.ca=0,this.sa=0;}};var r$h;!function(t){t[t.FAIL=0]="FAIL",t[t.END=1]="END",t[t.CONTINUE=2]="CONTINUE";}(r$h||(r$h={}));let a$c = class a{constructor(){this.reset();}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1;}isValid(){return null!==this.segment}copyTo(t){t.segment=this.segment,t.segmentLength=this.segmentLength,t.abscissa=this.abscissa,t.isPathEnd=this.isPathEnd,t.isPartEnd=this.isPartEnd;}};let o$f = class o extends s$i{constructor(t=0,e=!1){super(t,e),this._tolerance=n$p,this._currentPosition=new a$c;}updateTolerance(t){this._tolerance=n$p*t;}init(t,e,s=!0){return s?(this._patternLength=e.length(),this._partExtPtGap=e.extPtGap,this._partCtrlPtGap=e.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=t,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(t,e=r$h.FAIL){const s=new a$c;return !!this._nextPosition(t,s,null,e)&&(s.copyTo(this._currentPosition),!0)}curPointAndAngle(t){t.pt=this._getPoint(this._currentPosition);const[e,s]=this._getAngleCS(this._currentPosition);t.ca=e,t.sa=s;}nextPointAndAngle(t,e,s=r$h.FAIL){const n=new a$c;if(!this._nextPosition(t,n,null,s))return !1;n.copyTo(this._currentPosition),e.pt=this._getPoint(n);const[i,h]=this._getAngleCS(n);return e.ca=i,e.sa=h,!0}nextCurve(e){if(0===e)return null;const s=a$d.createEmptyOptimizedCIM("esriGeometryPolyline");s.startPath(),s.nextPath();const n=new a$c;return this._nextPosition(e,n,s,r$h.END)?(n.copyTo(this._currentPosition),s):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(t){return this._pathCursor.seekInPath(t),[this._pathCursor.x,this._pathCursor.y]}getSeg(t){return [this.getPt(t),this.getPt(t+1)]}_nextPosition(t,e,s,n){if(this._currentPosition.isPathEnd)return !1;let i=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(i/=this._currentPosition.segmentLength),this._currentPosition.copyTo(e);e.abscissa+t*this._partLengthRatio>e.segmentLength+this._tolerance;){if(s){if(0===s.pathSize)if(0===i){const t=e.segment[0];s.pushXY(t[0],t[1]);}else s.pushPoint(this.getSegCoord2D(e.segment,i));const t=e.segment[1];s.pushXY(t[0],t[1]);}if(i=0,t-=(e.segmentLength-e.abscissa)/this._partLengthRatio,this._partSegCount)e.segment=this._nextSegment(),e.segmentLength=this.getSegLength(e.segment),e.abscissa=0,this._partSegCount--;else {if(!this._setPosAtNextPart())return n!==r$h.FAIL&&(e.segmentLength=this.getSegLength(e.segment),e.isPartEnd=!0,n===r$h.END?(e.abscissa=e.segmentLength,e.isPathEnd=!0):e.abscissa=e.segmentLength+t,!0);this._currentPosition.copyTo(e);}}if(e.abscissa+=t*this._partLengthRatio,s){0===s.pathSize&&(0===i?s.pushPoint(e.segment[0]):s.pushPoint(this.getSegCoord2D(e.segment,i)));const t=e.abscissa/e.segmentLength;1===t?s.pushPoint(e.segment[1]):s.pushPoint(this.getSegCoord2D(e.segment,t));}return this._partSegCount||Math.abs(e.abscissa-e.segmentLength)<this._tolerance&&(e.isPathEnd=this._partIsLast,e.isPartEnd=!0),!0}_getPoint(t){const e=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegCoord2D(this._currentPosition.segment,e)}_getAngleCS(t){const e=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegAngleCS(this._currentPosition.segment,e)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return !1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let t=this._partSegCount;for(;t;)this._previousSegment(),--t;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const e=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(e);let s=e+this._partSegCount+1;if(s>=this._pathCursor.pathSize&&(s=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(s),this._patternLength>0){const t=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,e=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let s=Math.round((this._partLength-(t+e))/this._patternLength);s<=0&&(s=t+e>0?0:1),this._partLengthRatio=this._partLength/(t+e+s*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1);}else this._partLengthRatio=1;return !0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let h$g = class h{static local(){return null===h.instance&&(h.instance=new h),h.instance}execute(t,e,s,i,r){return new l$f(t,e,s)}};h$g.instance=null;let l$f = class l extends i$h{constructor(t,e,s){super(t,!0,!0),this._firstCurve=null,this._walker=new o$f,this._walker.updateTolerance(s),this._endings=e.lineDashEnding,this._customDashPos=-(e.offsetAlongLine??0)*s,this._offsetAtEnd=(e.customEndingOffset??0)*s,this._pattern=new i$g,this._pattern.init(j$8(e).dashTemplate,!0),this._pattern.scale(s);}processPath(s){if(0===this._pattern.length()){this.iteratePath=!1;const i=n$t(s);return a$d.fromJSONCIM({paths:[i]})}if(!this.iteratePath){let r=!0;switch(this._endings){case k$6.HalfPattern:case k$6.HalfGap:default:this._pattern.extPtGap=0;break;case k$6.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case k$6.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case k$6.NoConstraint:this.isClosed||(r=!1);break;case k$6.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd);}const a=s.pathLength();if(this._pattern.isEmpty()||a<.1*this._pattern.length()){const i=n$t(s);return a$d.fromJSONCIM({paths:[i]})}if(!this._walker.init(s,this._pattern,r)){const i=n$t(s);return a$d.fromJSONCIM({paths:[i]})}}let r;if(this.iteratePath)r=this._pattern.nextValue();else {let t;switch(this._endings){case k$6.HalfPattern:default:t=.5*this._pattern.firstValue();break;case k$6.HalfGap:t=.5*-this._pattern.lastValue();break;case k$6.FullGap:t=-this._pattern.lastValue();break;case k$6.FullPattern:t=0;break;case k$6.NoConstraint:case k$6.Custom:t=-this._customDashPos;}let e=t/this._pattern.length();e-=Math.floor(e),t=e*this._pattern.length(),this._pattern.reset(),r=this._pattern.nextValue();let s=!1;for(;t>=r;)t-=r,r=this._pattern.nextValue(),s=!s;r-=t,s?(this._walker.nextPosition(r),r=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(r),r=this._pattern.nextValue(),this._walker.nextPosition(r),r=this._pattern.nextValue());}let a=this._walker.nextCurve(r);if(a)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)a.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null;}}else r=this._pattern.nextValue(),!this._walker.nextPosition(r)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(a.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,a=this._firstCurve,this._firstCurve=null;return a?.reset(),a}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let s$h = class s{static local(){return null===s.instance&&(s.instance=new s),s.instance}execute(t,i,e,n,s,o){return new r$g(t,i,e,n,s,o)}};s$h.instance=null;let r$g = class r{constructor(t,i,n,s,r,o){switch(this._inputGeometries=t,this._tileKey=s,this._geometryEngine=r,this._maxInflateSize=o*n,this._width=(void 0!==i.width?i.width:2)*n,i.method){case B$7.Mitered:case B$7.Bevelled:case B$7.Rounded:case B$7.TrueBuffer:case B$7.Square:}this._option=i.option;}next(){let e;for(;e=this._inputGeometries.next();){if("esriGeometryEnvelope"===e.geometryType&&this._width>0){const i=e.asJSON();return Math.min(i.xmax-i.xmin,i.ymax-i.ymin)-2*this._width<0?e:a$d.fromJSONCIM({paths:[[[i.xmin+this._width,i.ymin+this._width],[i.xmax-this._width,i.ymin+this._width],[i.xmax-this._width,i.ymax-this._width],[i.xmin+this._width,i.ymax-this._width],[i.xmin+this._width,i.ymin+this._width]],[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]})}if("esriGeometryPolygon"===e.geometryType){if(0===this._width)return e.clone();const t=this._geometryEngine;if(null==t)return null;const s=this._tileKey?i$i(e,this._maxInflateSize):e.clone();if(!s)continue;const r=t.buffer(f$h.WebMercator,s.asJSON(),-this._width,1);if(r)for(const i of r.rings)if(i){s.startPath();for(const t of i.reverse())s.pushXY(t[0],s.yFactor*t[1]);}return s}}return null}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let e$c = class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(t,i,s,e,o){return new n$n(t,i,s)}};e$c.instance=null;let n$n = class n extends i$h{constructor(t,i,e){super(t,!1,!0),this._curveHelper=new s$i,this._length=(void 0!==i.length?i.length:20)*e,this._angle=void 0!==i.angle?i.angle:225,this._position=void 0!==i.position?i.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1;}processPath(i){const s=a$d.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(i))return null;i.seekInPath(0);const e=i.x,n=i.y;i.seekInPath(i.pathSize-1);const o=i.x,r=i.y,h=[o-e,r-n];this._curveHelper.normalize(h);const l=e+(o-e)*this._position/100,_=n+(r-n)*this._position/100,a=Math.cos((90-this._angle)/180*Math.PI);let p=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(p=-p),this._mirror=!this._mirror;const c=[l-this._length/2*a,_-this._length/2*p],m=[l+this._length/2*a,_+this._length/2*p];return s.pushPath([[e,n],c,m,[o,r]]),s}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let t$d = class t{static local(){return null===t.instance&&(t.instance=new t),t.instance}execute(t,s,n,o,i){return new e$b(t,s,n)}};t$d.instance=null;let e$b = class e{constructor(t,e,s){this._inputGeometries=t,this._offsetX=void 0!==e.offsetX?e.offsetX*s:0,this._offsetY=void 0!==e.offsetY?e.offsetY*s:0;}next(){let t=this._inputGeometries.next();for(;t;){if(t.totalSize>0)return this._move(t.clone(),this._offsetX,this._offsetY);t=this._inputGeometries.next();}return null}_move(t,e,s){for(;t.nextPath();)for(;t.nextPoint();)t.x=t.x+e,t.y=t.y+s;return t.reset(),t}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const f$d=10;let h$f = class h{static local(){return null===h.instance&&(h.instance=new h),h.instance}execute(t,e,s,o,r,i){return new l$e(t,e,s,o,r,i)}};h$f.instance=null;let l$e = class l{constructor(t,e,s,o,n,m){this._inputGeometries=t,this._tileKey=o,this._geometryEngine=n,this._curveHelper=new s$i,this._offset=(e.offset??1)*s,this._method=e.method,this._maxInflateSize=Math.max(Math.abs(m*s),f$d),this._option=e.option,this._offsetFlattenError=n$p*s;}next(){let r;for(;r=this._inputGeometries.next();){if(0===this._offset)return r.clone();if("esriGeometryEnvelope"===r.geometryType){if(this._method===O$5.Rounded&&this._offset>0){const s=n$t(r),o=this._curveHelper.offset(s,-this._offset,this._method,4,this._offsetFlattenError);if(o){const e=a$d.createEmptyOptimizedCIM(r.geometryType);return e.pushPath(o),e}return null}const o=r.asJSON();if(m$d(o)&&Math.min(o.xmax-o.xmin,o.ymax-o.ymin)+2*this._offset>0)return a$d.fromJSONCIM({xmin:o.xmin-this._offset,xmax:o.xmax+this._offset,ymin:o.ymin-this._offset,ymax:o.ymax+this._offset})}const i=this._geometryEngine;if(null==i)continue;const f=this._tileKey?i$i(r,this._maxInflateSize):r.clone();if(!f)continue;const h=i.offset(f$h.WebMercator,f.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return h?a$d.fromJSONCIM(h):null}return null}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let e$a = class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(e,n,r,s,i){return new t$c(e,n,r)}};e$a.instance=null;let t$c = class t{constructor(e,t,n){this._inputGeometries=e,this._reverse=void 0===t.reverse||t.reverse;}next(){let e=this._inputGeometries.next();for(;e;){if(!this._reverse)return e;if("esriGeometryPolyline"===e.geometryType)return n$m(e.clone());e=this._inputGeometries.next();}return null}};function n$m(e){for(;e.nextPath();)for(let t=0;t<e.pathSize/2;t++){e.seekInPath(t);const n=e.x,r=e.y;e.seekInPath(e.pathSize-t-1);const s=e.x,i=e.y;e.x=n,e.y=r,e.seekInPath(t),e.x=s,e.y=i;}return e.reset(),e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let e$9 = class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(t,e,r,s,o){return new n$l(t,e,r)}};e$9.instance=null;let n$l = class n{constructor(t,e,n){this._inputGeometries=t,this._rotateAngle=void 0!==e.angle?e.angle*Math.PI/180:0;}next(){let e=this._inputGeometries.next();for(;e;){if(0===this._rotateAngle||"esriGeometryPoint"===e.geometryType)return e;if(e.totalSize>0){const n=c$c(e),r=(n[2]+n[0])/2,s=(n[3]+n[1])/2;return e.reset(),this._rotate(e.clone(),r,s)}e=this._inputGeometries.next();}return null}_rotate(t,e,n){const r=Math.cos(this._rotateAngle),s=Math.sin(this._rotateAngle);for(;t.nextPath();)for(;t.nextPoint();){const o=t.x-e,i=t.y-n;t.x=e+o*r-i*s,t.y=n+o*s+i*r;}return t.reset(),t}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let e$8 = class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(t,e,o,s,n){return new r$f(t,e,o)}};e$8.instance=null;let r$f = class r{constructor(t,e,r){this._inputGeometries=t,this._xFactor=void 0!==e.XScaleFactor?e.XScaleFactor:1.15,this._yFactor=void 0!==e.YScaleFactor?e.YScaleFactor:1.15;}next(){const e=this._inputGeometries.next();if(e){if(1===this._xFactor&&1===this._yFactor)return e;if("esriGeometryPoint"===e.geometryType)return e;if(e.totalSize>0){const r=c$c(e),o=(r[2]+r[0])/2,s=(r[3]+r[1])/2;return e.reset(),this._scaleCursor(e.clone(),o,s)}}return null}_scaleCursor(t,e,r){for(;t.nextPath();)for(;t.nextPoint();)t.x=e+(t.x-e)*this._xFactor,t.y=r+(t.y-r)*this._yFactor;return t.reset(),t}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let n$k = class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(t,e,i,s,h){return new r$e(t,e,i)}};n$k.instance=null;let r$e = class r{constructor(t,e,h){this._inputGeometries=t,this._height=(void 0!==e.amplitude?e.amplitude:2)*h,this._period=(void 0!==e.period?e.period:3)*h,this._style=e.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new i$g,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new o$f,this._walker.updateTolerance(h);}next(){let t=this._inputGeometries.next();for(;t;){if(0===this._height||0===this._period)return t;const e=this._processGeom(t);if(e)return e;t=this._inputGeometries.next();}return null}_processGeom(i){const s=a$d.createEmptyOptimizedCIM(i.geometryType);for(;i.nextPath();){s.startPath();const t=i.pathLength();if(this._walker.init(i,this._pattern))switch(this._style){case A$7.Sinus:default:this._constructCurve(s,t,!1);break;case A$7.Square:this._constructSquare(s,t);break;case A$7.Triangle:this._constructTriangle(s,t);break;case A$7.Random:this._constructCurve(s,t,!0);}else for(;i.nextPoint();)s.pushXY(i.x,i.y);}return s}_constructCurve(t,e,i){let s=Math.round(e/this._period);0===s&&(s=1);const n=s*16+1,r=e/s,a=this._period/16,o=1/n,p=2*Math.PI*e/r,_=2*Math.PI*Math.random(),u=2*Math.PI*Math.random(),l=2*Math.PI*Math.random(),c=.75-Math.random()/2,d=.75-Math.random()/2,g=new h$h;this._walker.curPointAndAngle(g),t.pushPoint(g.pt);let w=0;for(;;){if(!this._walker.nextPointAndAngle(a,g)){t.pushPoint(this._walker.getPathEnd());break}{const e=w;let s;if(w+=o,i){const t=this._height/2*(1+.3*Math.sin(c*p*e+_));s=t*Math.sin(p*e+u),s+=t*Math.sin(d*p*e+l),s/=2;}else s=.5*this._height*Math.sin(.5*p*e);t.pushXY(g.pt[0]-s*g.sa,g.pt[1]+s*g.ca);}}}_constructSquare(t,e){Math.round(e/this._period);let i=!0;for(;;){let e=!1;if(this._walker.curPositionIsValid()){const s=new h$h;this._walker.curPointAndAngle(s);const n=new h$h;if(this._walker.nextPointAndAngle(this._period,n)){const r=new h$h;this._walker.nextPointAndAngle(this._period,r)&&(i?(t.pushPoint(s.pt),i=!1):t.pushPoint(s.pt),t.pushXY(s.pt[0]-this._height/2*s.sa,s.pt[1]+this._height/2*s.ca),t.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),t.pushXY(n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca),t.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca),e=!0);}}if(!e){t.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(t,e){Math.round(e/this._period);let i=!0;for(;;){let e=!1;if(this._walker.curPositionIsValid()){const s=new h$h;this._walker.curPointAndAngle(s);const n=new h$h;if(this._walker.nextPointAndAngle(this._period/2,n)){const r=new h$h;this._walker.nextPointAndAngle(this._period,r)&&(this._walker.nextPosition(this._period/2)&&(i?(t.pushPoint(s.pt),i=!1):t.pushPoint(s.pt),t.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),t.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca)),e=!0);}}if(!e){t.pushPoint(this._walker.getPathEnd());break}}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let a$b = class a{static local(){return null===a.instance&&(a.instance=new a),a.instance}execute(t,e,s,i,n){return new r$d(t,e,s)}};a$b.instance=null;let r$d = class r extends s$j{constructor(t,e,n){super(t),this._geometryWalker=new o$f,this._geometryWalker.updateTolerance(n),this._angleToLine=e.angleToLine??!0,this._offset=(e.offset?e.offset:0)*n,this._originalEndings=e.endings,this._offsetAtEnd=(e.customEndingOffset?e.customEndingOffset:0)*n,this._position=-(e.offsetAlongLine?e.offsetAlongLine:0)*n,this._pattern=new i$g,this._pattern.init(e.placementTemplate,!1),this._pattern.scale(n),this._endings=this._originalEndings;}processPath(t){if(this._pattern.isEmpty())return null;let s;if(this.iteratePath)s=this._pattern.nextValue();else {this._originalEndings===X$2.WithFullGap&&this.isClosed?this._endings=X$2.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;let i,n=!0;switch(this._endings){case X$2.NoConstraint:i=-this._position,i=this._adjustPosition(i),n=!1;break;case X$2.WithHalfGap:default:i=-this._pattern.lastValue()/2;break;case X$2.WithFullGap:i=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case X$2.WithMarkers:i=0;break;case X$2.Custom:i=-this._position,i=this._adjustPosition(i),this._pattern.extPtGap=.5*this._offsetAtEnd;}if(!this._geometryWalker.init(t,this._pattern,n))return null;this._pattern.reset();let a=0;for(;i>a;)i-=a,a=this._pattern.nextValue();a-=i,s=a,this.iteratePath=!0;}const i=new h$h;return this._geometryWalker.nextPointAndAngle(s,i)?this._endings===X$2.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===X$2.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca),this._angleToLine&&this.internalPlacement.setRotateCS(i.ca,i.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(t){let e=t/this._pattern.length();return e-=Math.floor(e),e*this._pattern.length()}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let i$f = class i{static local(){return null===i.instance&&(i.instance=new i),i.instance}execute(e,t,s,i,r){return new n$j(e,t,s)}};i$f.instance=null;let n$j = class n extends s$j{constructor(e,s,i){super(e,!1,!0),this._curveHelper=new s$i,this._angleToLine=void 0===s.angleToLine||s.angleToLine,this._offset=void 0!==s.offset?s.offset*i:0,this._type=s.extremityPlacement,this._position=void 0!==s.offsetAlongLine?s.offsetAlongLine*i:0,this._beginProcessed=!1;}processPath(e){let t;switch(this._type){case o$h.Both:default:this._beginProcessed?(t=this._atExtremities(e,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(t=this._atExtremities(e,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case o$h.JustBegin:t=this._atExtremities(e,this._position,!0);break;case o$h.JustEnd:t=this._atExtremities(e,this._position,!1);case o$h.None:}return t}_atExtremities(e,t,s){if(s||e.seekPathEnd(),s?e.nextPoint():e.prevPoint()){let i=0,[n,r]=[0,0],[o,a]=[e.x,e.y];for(;s?e.nextPoint():e.prevPoint();){n=o,r=a,o=e.x,a=e.y;const s=this._curveHelper.getLength(n,r,o,a);if(i+s>t){const e=(t-i)/s,[h,l]=this._curveHelper.getAngleCS(n,r,o,a,e),c=this._curveHelper.getCoord2D(n,r,o,a,e);return this.internalPlacement.setTranslate(c[0]-this._offset*l,c[1]+this._offset*h),this._angleToLine&&this.internalPlacement.setRotateCS(-h,-l),this.internalPlacement}i+=s;}}return null}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let a$a = class a{static local(){return null===a.instance&&(a.instance=new a),a.instance}execute(t,i,s,e,n){return new r$c(t,i,s)}};a$a.instance=null;let r$c = class r extends s$j{constructor(t,e,n){super(t),this._walker=new o$f,this._walker.updateTolerance(n),this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*n:0,this._beginGap=void 0!==e.beginPosition?e.beginPosition*n:0,this._endGap=void 0!==e.endPosition?e.endPosition*n:0,this._flipFirst=void 0===e.flipFirst||e.flipFirst,this._pattern=new i$g,this._pattern.init(e.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0;}processPath(t){if(this._pattern.isEmpty())return null;let i;if(this.iteratePath){const t=this._pattern.nextValue()*this._subPathLen,s=this._beginGap+t;i=s-this._prevPos,this._prevPos=s;}else {if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=t.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(t,this._pattern,!1))return null;this._pattern.reset();const s=this._pattern.nextValue()*this._subPathLen,e=this._beginGap+s;i=e-this._prevPos,this._prevPos=e,this.iteratePath=!0;}const s=new h$h;if(!this._walker.nextPointAndAngle(i,s,r$h.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(s.pt[0]-this._offset*s.sa,s.pt[1]+this._offset*s.ca);const a=this._isFirst&&this._flipFirst;let r,h;return this._angleToLine?(r=s.ca,h=s.sa):(r=1,h=0),a&&(r=-r,h=-h),this.internalPlacement.setRotateCS(r,h),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const e$7=512,h$e=10,n$i=24,_$b=1e-6;let r$b = class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(t,s,i,e,h){return new a$9(t,s,i,e,h)}};r$b.instance=null;let a$9 = class a{constructor(h,n,_,r,a){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(n.stepX??16)*_,this._stepY=Math.abs(n.stepY??16)*_,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,0!==this._stepX&&0!==this._stepY){if(this._gridType=n.gridType??Y$3.Fixed,this._gridType===Y$3.Random){const s=n.seed??13,i=1;this._randomLCG=new t$i(s*i),this._randomness=(n.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues();}else {if(this._randomness=0,this._gridAngle=n.gridAngle??0,this._shiftOddRows=n.shiftOddRows??!1,this._offsetX=(n.offsetX??0)*_,this._offsetY=(n.offsetY??0)*_,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY;}if(this._graphicOriginX=0,this._graphicOriginY=0,null!=r){const[t,s,i,h]=r.split("/"),n=parseFloat(t),_=parseFloat(s),a=parseFloat(i),o=parseFloat(h);this._graphicOriginX=-(o*2**n+a)*e$7,this._graphicOriginY=_*e$7,this._testInsidePolygon=!0;}this._internalPlacement=new t$e,this._calculateMinMax(h),this._geometryCursor=h;}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!a._randValues){a._randValues=[];for(let t=0;t<n$i;t++)for(let s=0;s<n$i;s++)a._randValues.push(this._randomLCG.getFloat()),a._randValues.push(this._randomLCG.getFloat());}}_calculateMinMax(t){let s,i,h,n,_,r,a,o,l,f,c,u,p,M;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,a=o=p=c=Number.MAX_VALUE,l=f=M=u=-Number.MAX_VALUE;const g=1!==this._cosAngle;for(t.reset();t.nextPath();)for(;t.nextPoint();)r=t.x,_=t.y,s=r-this._graphicOriginX-this._offsetX,i=_-this._graphicOriginY-this._offsetY,g?(h=this._cosAngle*s-this._sinAngle*i,n=this._sinAngle*s+this._cosAngle*i):(h=s,n=i),a=Math.min(a,h),l=Math.max(l,h),o=Math.min(o,n),f=Math.max(f,n),c=Math.min(c,_),u=Math.max(u,_),p=Math.min(p,r),M=Math.max(M,r);c=c!==Number.MAX_VALUE?c:-e$7-this._stepY,u=u!==-Number.MAX_VALUE?u:this._stepY,p=p!==Number.MAX_VALUE?p:-this._stepX,M=M!==-Number.MAX_VALUE?M:e$7+this._stepX;const d=u-c,X=M-p;if(this._verticalSubdivision=d>=X,this._polygonMin=this._verticalSubdivision?c:p,this._testInsidePolygon){let t=0-this._graphicOriginX-this._offsetX-this._stepX,s=e$7-this._graphicOriginX-this._offsetX+this._stepX,i=-e$7-this._graphicOriginY-this._offsetY-this._stepY,h=0-this._graphicOriginY-this._offsetY+this._stepY;if(g){const e=[[t,i],[t,h],[s,i],[s,h]];t=i=Number.MAX_VALUE,s=h=-Number.MAX_VALUE;for(const n of e){const e=this._cosAngle*n[0]-this._sinAngle*n[1],_=this._sinAngle*n[0]+this._cosAngle*n[1];t=Math.min(t,e),s=Math.max(s,e),i=Math.min(i,_),h=Math.max(h,_);}}a=a!==Number.MAX_VALUE?Math.max(a,t):t,o=o!==Number.MAX_VALUE?Math.max(o,i):i,l=l!==-Number.MAX_VALUE?Math.min(l,s):s,f=f!==-Number.MAX_VALUE?Math.min(f,h):h;}this._xMin=Math.round(a/this._stepX),this._xMax=Math.round(l/this._stepX),this._yMin=Math.round(o/this._stepY),this._yMax=Math.round(f/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(t,p,M,c,u);}_buildAccelerationMap(t,s,i,n,_){t.reset();const r=new Map,a=this._verticalSubdivision,o=a?_-n:i-s;let f=Math.ceil(o/h$e);if(f<=1)return;const c=Math.floor(o/f);let u,p,M,g,d,X,m,x,A,Y,y;for(f++,this._delta=c,a?(A=-e$7-2*this._stepY,Y=2*this._stepY,y=n):(A=-2*this._stepX,Y=e$7+2*this._stepX,y=s);t.nextPath();)if(!(t.pathSize<2)&&t.nextPoint())for(u=t.x,p=t.y;t.nextPoint();u=M,p=g){if(M=t.x,g=t.y,a){if(p===g||p<A&&g<A||p>Y&&g>Y)continue;d=Math.min(p,g),X=Math.max(p,g);}else {if(u===M||u<A&&M<A||u>Y&&M>Y)continue;d=Math.min(u,M),X=Math.max(u,M);}for(;d<X;)m=Math.floor((d-y)/c),l$d(m,u,p,M,g,r),d+=c;x=Math.floor((X-y)/c),x>m&&l$d(x,u,p,M,g,r);}this._accelerationMap=r;}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--;}let t=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(t+=.5*this._stepX);const s=this._currentY*this._stepY+this._offsetY;let e,h;if(this._currentX++,this._gridType===Y$3.Random){const i=(this._currentX%n$i+n$i)%n$i,_=(this._currentY%n$i+n$i)%n$i;e=this._graphicOriginX+t+this._stepX*this._randomness*(.5-a._randValues[_*n$i+i])*2/3,h=this._graphicOriginY+s+this._stepY*this._randomness*(.5-a._randValues[_*n$i+i+1])*2/3;}else e=this._graphicOriginX+this._cosAngle*t+this._sinAngle*s,h=this._graphicOriginY-this._sinAngle*t+this._cosAngle*s;if(!this._testInsidePolygon||this._isInsidePolygon(e,h,this._geometryCursor))return this._internalPlacement.setTranslate(e,h),this._internalPlacement}}_isInsidePolygon(t,s,i){if(null==this._accelerationMap)return o$e(t,s,i);t+=_$b,s+=_$b;const e=this._verticalSubdivision,h=e?s:t,n=Math.floor((h-this._polygonMin)/this._delta),r=this._accelerationMap.get(n);if(!r)return !1;let a,l,f,c=0;for(const _ of r){if(a=_[0],l=_[1],e){if(a[1]>s==l[1]>s)continue;f=(l[0]-a[0])*(s-a[1])-(l[1]-a[1])*(t-a[0]);}else {if(a[0]>t==l[0]>t)continue;f=(l[1]-a[1])*(t-a[0])-(l[0]-a[0])*(s-a[1]);}f>0?c++:c--;}return 0!==c}};function o$e(t,s,i){let e,h,n,r,a=0;for(t+=_$b,s+=_$b,i.reset();i.nextPath();)if(i.nextPoint())for(e=i.x,h=i.y;i.nextPoint();e=n,h=r){if(n=i.x,r=i.y,h>s==r>s)continue;(n-e)*(s-h)-(r-h)*(t-e)>0?a++:a--;}return 0!==a}function l$d(t,s,i,e,h,n){let _=n.get(t);_||(_=[],n.set(t,_)),_.push([[s,i],[e,h]]);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const i$e=.001;let s$g = class s{static local(){return null===s.instance&&(s.instance=new s),s.instance}execute(e,t,n,i,s){return new r$a(e,t,n)}};s$g.instance=null;let r$a = class r extends s$j{constructor(e,n,s){super(e),this._curveHelper=new s$i,this._angleToLine=void 0===n.angleToLine||n.angleToLine,this._offset=void 0!==n.offset?n.offset*s:0,this._relativeTo=n.relativeTo,this._position=void 0!==n.startPointOffset?n.startPointOffset*s:0,this._epsilon=i$e*s;}processPath(e){const t=this._position;if(this._relativeTo===Z$5.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),e.nextPoint()){let[t,n]=[e.x,e.y],[i,s]=[0,0];for(;e.nextPoint();){i=e.x,s=e.y;const r=this._curveHelper.getLength(t,n,i,s);if(r<this._epsilon){t=i,n=s;continue}const o=.5+this._position/r,[a,l]=this._curveHelper.getAngleCS(t,n,i,s,o),h=this._curveHelper.getCoord2D(t,n,i,s,o);return this.internalPlacement.setTranslate(h[0]-this._offset*l,h[1]+this._offset*a),this._angleToLine&&this.internalPlacement.setRotateCS(a,l),this.internalPlacement}}return this.iteratePath=!1,null}const i=this._relativeTo===Z$5.LineEnd;return this.onLine(e,t,i)}onLine(e,t,i){let s,r=!1;switch(this._relativeTo){case Z$5.LineMiddle:default:e.seekPathStart(),s=e.pathLength()/2+t;break;case Z$5.LineBeginning:s=t;break;case Z$5.LineEnd:s=t,r=!0;}i?e.seekPathEnd():e.seekPathStart();let o=0;if(i?e.prevPoint():e.nextPoint()){let[t,n]=[e.x,e.y],[a,l]=[0,0];for(;i?e.prevPoint():e.nextPoint();){a=e.x,l=e.y;const i=this._curveHelper.getLength(t,n,a,l);if(o+i>s){const e=(s-o)/i,[h,c]=this._curveHelper.getAngleCS(t,n,a,l,e),f=this._curveHelper.getCoord2D(t,n,a,l,e),u=r?-this._offset:this._offset;return this.internalPlacement.setTranslate(f[0]-u*c,f[1]+u*h),this._angleToLine&&(r?this.internalPlacement.setRotateCS(-h,-c):this.internalPlacement.setRotateCS(h,c)),this.internalPlacement}t=a,n=l,o+=i;}}return null}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const s$f=1e-15;let i$d = class i{static local(){return null===i.instance&&(i.instance=new i),i.instance}execute(t,e,s,i,o){return new n$h(t,e,s)}};i$d.instance=null;let n$h = class n extends s$j{constructor(t,s,i){super(t),this._curveHelper=new s$i,this._angleToLine=void 0===s.angleToLine||s.angleToLine,this._offset=void 0!==s.offset?s.offset*i:0,this._endPoints=void 0===s.placeOnEndPoints||s.placeOnEndPoints,this._controlPoints=void 0===s.placeOnControlPoints||s.placeOnControlPoints,this._regularVertices=void 0===s.placeOnRegularVertices||s.placeOnRegularVertices,this._tags=[],this._tagIterator=0;}processPath(t){if(this.iteratePath||(this._preparePath(t),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);let s=e[0],i=e[1];if(0!==this._offset){const t=Math.cos(e[2]),n=Math.sin(e[2]);s-=this._offset*n,i+=this._offset*t;}return this.internalPlacement.setTranslate(s,i),this._tagIterator++,this.internalPlacement}_preparePath(t){this._tags.length=0,this._tagIterator=0,t.seekPathStart();const e=t.isClosed();let s=0,i=!1,n=0,r=0;if(t.seekPathStart(),t.nextPoint()){let a=t.x,h=t.y,l=t.getControlPoint(),_=!0,c=t.nextPoint();for(;c;){const g=t.x,P=t.y,u=t.getControlPoint();(this._angleToLine||0!==this._offset)&&(n=this._curveHelper.getAngle(a,h,g,P,0)),_?(_=!1,e?(s=n,i=l):(this._endPoints||this._controlPoints&&l)&&this._tags.push([a,h,n])):l?this._controlPoints&&this._tags.push([a,h,o$d(r,n)]):this._regularVertices&&this._tags.push([a,h,o$d(r,n)]),(this._angleToLine||0!==this._offset)&&(r=this._curveHelper.getAngle(a,h,g,P,1)),c=t.nextPoint(),c||(e?u||i?this._controlPoints&&this._tags.push([g,P,o$d(r,s)]):this._regularVertices&&this._tags.push([g,P,o$d(r,s)]):(this._endPoints||this._controlPoints&&u)&&this._tags.push([g,P,r])),a=g,h=P,l=u;}}this._tagIterator=0;}};function o$d(t,e){const i=Math.PI;for(;Math.abs(e-t)>i+2*s$f;)e-t>i?e-=2*i:e+=2*i;return (t+e)/2}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const N$4=100*222045e-21;function l$c(t){if(0===t.totalSize)return null;const a=c$c(t);if(!a)return null;const o=4*(Math.abs(a[0])+Math.abs(a[2])+Math.abs(a[1])+Math.abs(a[3])+1)*N$4;let s=0,c=0;t.reset();for(let e=0;t.nextPath();e++){const n=t.getCurrentRingArea();n>c&&(c=n,s=e);}if(t.seekPath(s),0===t.pathSize)return null;t.seekPathStart();const l=f$i(t);if(Math.abs(c)<=2*o*o)return [(l[0]+l[2])/2,(l[1]+l[3])/2];t.seekPathStart();const x=i$m(t,u$g());if(null===x)return null;if(t.totalPoints<4)return x;const m=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],d=[NaN,NaN,NaN,NaN],P=[NaN,NaN,NaN,NaN];let y=!1,M=f$c(x,t,!0);0===M.distance&&(y=!0,m[0][0]=x[0],m[0][1]=x[1],M=f$c(x,t,!1)),d[0]=M.distance,P[0]=0;const b=[NaN,NaN];let S=!1,k=.25,z=-1,g=NaN;do{if(g=NaN,m[1]=h$d(t,w$7(l[0],l[2],k),o,a),isNaN(m[1][0])||isNaN(m[1][1])||(M=f$c(m[1],t,!1),g=M.distance),!isNaN(g)&&g>o&&u$9(m[1],t))S=!0,d[1]=g,P[1]=p$a(m[1],x);else if(!isNaN(g)&&g>z&&(z=g,b[0]=m[1][0],b[1]=m[1][1]),k-=.01,k<.1){if(!(z>=0))break;S=!0,d[1]=z,m[1][0]=b[0],m[1][1]=b[1],P[1]=p$a(m[1],x);}}while(!S);S=!1,k=.5,z=-1;let q=.01,j=1;do{if(g=NaN,m[2]=h$d(t,w$7(l[0],l[2],k),o,a),isNaN(m[2][0])||isNaN(m[2][1])||(M=f$c(m[2],t,!1),g=M.distance),!isNaN(g)&&g>o&&u$9(m[2],t))S=!0,d[2]=g,P[2]=p$a(m[2],x);else if(!isNaN(g)&&g>z)z=g,b[0]=m[2][0],b[1]=m[2][1];else if(g>z&&(z=g,b[0]=m[2][0],b[1]=m[2][1]),k=.5+q*j,q+=.01,j*=-1,k<.3||k>.7){if(!(z>=0))break;S=!0,d[2]=z,m[2][0]=b[0],m[2][1]=b[1],P[2]=p$a(m[2],x);}}while(!S);S=!1,k=.75,z=-1;do{if(g=NaN,m[3]=h$d(t,w$7(l[0],l[2],k),o,a),isNaN(m[3][0])||isNaN(m[3][1])||(M=f$c(m[3],t,!1),g=M.distance),!isNaN(g)&&g>o&&u$9(m[3],t))S=!0,d[3]=g,P[3]=p$a(m[3],x);else if(g>z&&(z=g,b[0]=m[3][0],b[1]=m[3][1]),k+=.01,k>.9){if(!(z>=0))break;S=!0,d[3]=z,m[3][0]=b[0],m[3][1]=b[1],P[3]=p$a(m[3],x);}}while(!S);const T=[0,1,2,3],D=y?0:1;let R;for(let e=D;e<4;e++)for(let t=D;t<3;t++){const e=P[t],n=P[t+1];C$3(e,n)>0&&(R=T[t],T[t]=T[t+1],T[t+1]=R,P[t]=n,P[t+1]=e);}let B=D,Q=0,U=0;for(let e=D;e<4;e++){switch(e){case 0:U=2*d[T[e]];break;case 1:U=1.66666666*d[T[e]];break;case 2:U=1.33333333*d[T[e]];break;case 3:U=d[T[e]];}U>Q&&(Q=U,B=T[e]);}return m[B]}function u$9(t,e){let n,i,r,a,o=0;for(e.reset();e.nextPath()&&e.nextPoint();)for(n=e.x,i=e.y;e.nextPoint();n=r,i=a){if(r=e.x,a=e.y,i>t[1]==a>t[1])continue;(r-n)*(t[1]-i)-(a-i)*(t[0]-n)>0?o++:o--;}return 0!==o}function f$c(t,e,n){if(n&&u$9(t,e))return {coord:t,distance:0};let i=1/0,r=0,a=0,s=[0,0],c=[0,0];const N=[0,0];for(e.reset();e.nextPath()&&e.nextPoint();)if(!(e.pathSize<2))for(s[0]=e.x,s[1]=e.y;e.nextPoint();s=c){c=[e.x,e.y],f$j(N,t,s,c);const n=p$a(t,N);n<i&&(i=n,r=N[0],a=N[1]);}return {coord:[r,a],distance:Math.sqrt(i)}}function h$d(t,n,i,r){const a=[n,0];let o=1/0,s=1/0,N=!1,l=!1;const u=[[n,r[1]-1],[n,r[3]+1]],f=[0,0],h=[0,0],m=[0,0],d=[[0,0],[0,0]],P=u$g();for(t.reset();t.nextPath()&&t.nextPoint();)if(!(t.pathSize<2))for(d[0][0]=t.x,d[0][1]=t.y;t.nextPoint();d[0][0]=d[1][0],d[0][1]=d[1][1]){if(d[1][0]=t.x,d[1][1]=t.y,null===x$8(P,d))continue;if(h[0]=u[0][0],h[1]=u[0][1],m[0]=u[1][0],m[1]=u[1][1],0===M$5(P,h,m))continue;if(!G$4(u[0],u[1],d[0],d[1],f))continue;const e=f[1];o>s?e<o&&(o=e,N=!0):e<s&&(s=e,l=!0);}return N&&l?a[1]=(o+s)/2:a[0]=a[1]=NaN,a}function x$8(t,n){if(n.length<2)return null;t||(t=u$g());const[i,r]=n[0],[a,o]=n[1];return t[0]=Math.min(i,a),t[1]=Math.min(r,o),t[2]=Math.max(i,a),t[3]=Math.max(r,o),t}const m$8=1,d$9=4,P$6=3,y$5=12;function M$5(t,e,n){let i=b$7(e,t),r=b$7(n,t);const a=t[0],o=t[1],s=t[2],c=t[3];if(i&r)return 0;if(!(i|r))return 4;const N=(i?1:0)|(r?2:0);do{const N=n[0]-e[0],l=n[1]-e[1];if(N>l)i&P$6?(i&m$8?(e[1]+=l*(a-e[0])/N,e[0]=a):(e[1]+=l*(s-e[0])/N,e[0]=s),i=b$7(e,t)):r&P$6?(r&m$8?(n[1]+=l*(a-n[0])/N,n[0]=a):(n[1]+=l*(s-n[0])/N,n[0]=s),r=b$7(n,t)):i?(i&d$9?(e[0]+=N*(o-e[1])/l,e[1]=o):(e[0]+=N*(c-e[1])/l,e[1]=c),i=b$7(e,t)):(r&d$9?(n[0]+=N*(o-n[1])/l,n[1]=o):(n[0]+=N*(c-n[1])/l,n[1]=c),r=b$7(n,t));else if(i&y$5?(i&d$9?(e[0]+=N*(o-e[1])/l,e[1]=o):(e[0]+=N*(c-e[1])/l,e[1]=c),i=b$7(e,t)):r&y$5?(r&d$9?(n[0]+=N*(o-n[1])/l,n[1]=o):(n[0]+=N*(c-n[1])/l,n[1]=c),r=b$7(n,t)):i?(i&m$8?(e[1]+=l*(a-e[0])/N,e[0]=a):(e[1]+=l*(s-e[0])/N,e[0]=s),i=b$7(e,t)):(r&m$8?(n[1]+=l*(a-n[0])/N,n[0]=a):(n[1]+=l*(s-n[0])/N,n[0]=s),r=b$7(n,t)),i&r)return 0}while(i|r);return N}function b$7(t,e){return (t[0]<e[0]?1:0)|(t[0]>e[2]?1:0)<<1|(t[1]<e[1]?1:0)<<2|(t[1]>e[3]?1:0)<<3}function w$7(t,e,n){return t+(e-t)*n}function p$a(t,e){return (t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function C$3(t,e){if(t<e)return -1;if(t>e)return 1;if(t===e)return 0;const n=isNaN(t),i=isNaN(e);return n<i?-1:n>i?1:0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let r$9 = class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(t,e,s,n,o){return new i$c(t,e,s)}};r$9.instance=null;let i$c = class i{constructor(t,e,s){this._geometryCursor=t,this._offsetX=void 0!==e.offsetX?e.offsetX*s:0,this._offsetY=void 0!==e.offsetY?e.offsetY*s:0,this._method=void 0!==e.method?e.method:K$5.OnPolygon,this._internalPlacement=new t$e;}next(){const t=this._geometryCursor;return this._geometryCursor=null,t?this._polygonCenter(t):null}_polygonCenter(n){let r=!1;switch(this._method){case K$5.CenterOfMass:{const t=f$k(n);t&&(this._internalPlacement.setTranslate(t[0]+this._offsetX,t[1]+this._offsetY),r=!0);}break;case K$5.BoundingBoxCenter:{const e=c$c(n);e&&(this._internalPlacement.setTranslate((e[2]+e[0])/2+this._offsetX,(e[3]+e[1])/2+this._offsetY),r=!0);}break;case K$5.OnPolygon:default:{const t=l$c(n);null!==t&&(this._internalPlacement.setTranslate(t[0]+this._offsetX,t[1]+this._offsetY),r=!0);}}return r?this._internalPlacement:null}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function A$5(p){if(!p)return null;switch(p.type){case"CIMGeometricEffectAddControlPoints":return e$e.local();case"CIMGeometricEffectArrow":return p$b.local();case"CIMGeometricEffectBuffer":return m$9.local();case"CIMGeometricEffectControlMeasureLine":return e$d.local();case"CIMGeometricEffectCut":return r$i.local();case"CIMGeometricEffectDashes":return h$g.local();case"CIMGeometricEffectDonut":return s$h.local();case"CIMGeometricEffectJog":return e$c.local();case"CIMGeometricEffectMove":return t$d.local();case"CIMGeometricEffectOffset":return h$f.local();case"CIMGeometricEffectReverse":return e$a.local();case"CIMGeometricEffectRotate":return e$9.local();case"CIMGeometricEffectScale":return e$8.local();case"CIMGeometricEffectWave":return n$k.local()}return null}function g$9(e){if(!e)return null;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":return a$b.local();case"CIMMarkerPlacementAtExtremities":return i$f.local();case"CIMMarkerPlacementAtRatioPositions":return a$a.local();case"CIMMarkerPlacementInsidePolygon":return r$b.local();case"CIMMarkerPlacementOnLine":return s$g.local();case"CIMMarkerPlacementOnVertices":return i$d.local();case"CIMMarkerPlacementPolygonCenter":return r$9.local()}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const n$g=new C$5;function i$b(r){if(null==r)return ["",!1];if(!n$g.hasBidiChar(r))return [r,!1];let i;return i="rtl"===n$g.checkContextual(r)?"IDNNN":"ICNNN",[n$g.bidiTransform(r,i,"VLYSN"),!0]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const t$b="arial-unicode-ms",n$f="woff2",r$8=new Map,s$e=new Set;let o$c = class o{constructor(e,t){this.fontFace=e,this.promise=t;}};async function c$7(t){const c=f$b(t),a=r$8.get(c);if(a)return a.promise;const i=new FontFace(t.family,`url('${s$n.fontsUrl}/woff2/${c}.${n$f}') format('${n$f}')`,{style:t.style,weight:t.weight}),u=document.fonts;if(u.has(i)&&"loading"===i.status)return i.loaded;const l=i.load().then((()=>(u.add(i),i)));return r$8.set(c,new o$c(i,l)),s$e.add(i),l}function u$8(e){if(!e)return t$b;const n=e.toLowerCase().split(" ").join("-");switch(n){case"serif":return "noto-serif";case"sans-serif":return "arial-unicode-ms";case"monospace":return "ubuntu-mono";case"fantasy":return "cabin-sketch";case"cursive":return "redressed";default:return n}}function f$b(e){const t=l$b(e)+d$8(e);return u$8(e.family)+(t.length>0?t:"-regular")}function l$b(e){if(!e.weight)return "";switch(e.weight.toLowerCase()){case"bold":case"bolder":return "-bold"}return ""}function d$8(e){if(!e.style)return "";switch(e.style.toLowerCase()){case"italic":case"oblique":return "-italic"}return ""}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let t$a = class t{applyColorSubstituition(t,a){if(!a)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:e,height:n}=t,o=this._rasterizationCanvas,r=o.getContext("2d",{willReadFrequently:!0});t!==o&&(o.width=e,o.height=n,r.drawImage(t,0,0,e,n));const i=r.getImageData(0,0,e,n).data;if(a)for(const l of a)if(l&&l.oldColor&&4===l.oldColor.length&&l.newColor&&4===l.newColor.length){const[t,a,e,n]=l.oldColor,[o,r,s,h]=l.newColor;if(t===o&&a===r&&e===s&&n===h)continue;for(let l=0;l<i.length;l+=4)t===i[l]&&a===i[l+1]&&e===i[l+2]&&n===i[l+3]&&(i[l]=o,i[l+1]=r,i[l+2]=s,i[l+3]=h);}const s=new ImageData(i,e,n);return r.putImageData(s,0,0),o}tintImageData(t,a){if(!a||a.length<4)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:e,height:n}=t,o=this._rasterizationCanvas,r=o.getContext("2d",{willReadFrequently:!0});t!==o&&(o.width=e,o.height=n,r.drawImage(t,0,0,e,n));const i=r.getImageData(0,0,e,n),s=new Uint8Array(i.data),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255];for(let g=0;g<s.length;g+=4)s[g]*=l[0],s[g+1]*=l[1],s[g+2]*=l[2],s[g+3]*=l[3];const h=new ImageData(new Uint8ClampedArray(s.buffer),e,n);return r.putImageData(h,0,0),o}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function t$9(t){const e=t.getFrame(0);if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)return e;const n=document.createElement("canvas");n.width=t.width,n.height=t.height;const a=n.getContext("2d");return e instanceof ImageData?a.putImageData(e,0,0):a.drawImage(e,0,0),n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let t$8 = class t{constructor(t=0,h=0,i=0,s=0){this.x=t,this.y=h,this.width=i,this.height=s;}static fromExtent(h){return new t(h.xmin,-h.ymax,h.xmax-h.xmin,h.ymax-h.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function i$a(t){return `rgb(${t.slice(0,3).toString()})`}function s$d(t){return `rgba(${t.slice(0,3).toString()},${t[3]})`}let r$7 = class r{constructor(t){t&&(this._textRasterizationCanvas=t);}rasterizeText(r,o){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const h=this._textRasterizationCanvas,a=h.getContext("2d",{willReadFrequently:!0});this._setFontProperties(a,o),this._parameters=o,this._textLines=r.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:l,weight:d}=o.font;this._lineThroughWidthOffset=l&&"line-through"===l?.1*this._lineHeight:0;const c=null!=o.backgroundColor||null!=o.borderLine,_=c?s$o:0,g=this._computeTextWidth(a,o)+2*_,f=this._lineHeight*this._textLines.length+2*_;if(h.width=g+2*this._lineThroughWidthOffset,h.height=f,0===h.width||0===h.height)return h.width=h.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:h};this._renderedLineHeight=Math.round(this._lineHeight*o.pixelRatio),this._renderedHaloSize=u$h(o.halo.size)*o.pixelRatio,this._renderedWidth=g*o.pixelRatio,this._renderedHeight=f*o.pixelRatio,this._lineThroughWidthOffset*=o.pixelRatio;const u=o.color??[0,0,0,0],p=o.halo&&o.halo.color?o.halo.color:[0,0,0,0];this._fillStyle=s$d(u),this._haloStyle=i$a(p);const x=this._renderedLineHeight,m=this._renderedHaloSize;a.save(),a.clearRect(0,0,h.width,h.height),this._setFontProperties(a,o);const b=_*o.pixelRatio,w=n$e(a.textAlign,this._renderedWidth-2*b)+m+b,z=m+b,y=m>0;let R=this._lineThroughWidthOffset,v=0;if(c){a.save();const e=o.backgroundColor??[0,0,0,0],i=o.borderLine?.color??[0,0,0,0],r=2*u$h(o.borderLine?.size??0);a.fillStyle=s$d(e),a.strokeStyle=s$d(i),a.lineWidth=r,a.fillRect(0,0,h.width,h.height),a.strokeRect(0,0,h.width,h.height),a.restore();}y&&this._renderHalo(a,w,z,R,v,o),v+=z,R+=w;for(const t of this._textLines)y?(a.globalCompositeOperation="destination-out",a.fillStyle="rgb(0, 0, 0)",a.fillText(t,R,v),a.globalCompositeOperation="source-over",a.fillStyle=this._fillStyle,a.fillText(t,R,v)):(a.fillStyle=this._fillStyle,a.fillText(t,R,v)),l&&"none"!==l&&this._renderDecoration(a,R,v,l,d),v+=x;a.restore();const H=this._renderedWidth+2*this._lineThroughWidthOffset,S=this._renderedHeight,C=a.getImageData(0,0,H,S),T=new Uint8Array(C.data);if(o.premultiplyColors){let t;for(let e=0;e<T.length;e+=4)t=T[e+3]/255,T[e]=T[e]*t,T[e+1]=T[e+1]*t,T[e+2]=T[e+2]*t;}let W,k;switch(o.horizontalAlignment){case"left":W=-.5;break;case"right":W=.5;break;default:W=0;}switch(o.verticalAlignment){case"bottom":k=-.5;break;case"top":k=.5;break;case"baseline":k=-1/6;break;default:k=0;}return {size:[H,S],image:new Uint32Array(T.buffer),sdf:!1,simplePattern:!1,anchorX:W,anchorY:k,canvas:h}}_renderHalo(t,e,i,s,r,n){const o=this._renderedWidth,h=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=o,this._haloRasterizationCanvas.height=h;const a=this._haloRasterizationCanvas,l=a.getContext("2d");l.clearRect(0,0,o,h),this._setFontProperties(l,n);const{decoration:d,weight:c}=n.font;l.fillStyle=this._haloStyle,l.strokeStyle=this._haloStyle,l.lineJoin="round",this._renderHaloNative(l,e,i,d,c),t.globalAlpha=this._parameters.halo.color[3],t.drawImage(a,0,0,o,h,s,r,o,h),t.globalAlpha=1;}_renderHaloNative(t,e,i,s,r){const n=this._renderedLineHeight,o=this._renderedHaloSize;for(const h of this._textLines){const a=2*o,l=5,d=.1;for(let n=0;n<l;n++){const o=(1-(l-1)*d+n*d)*a;t.lineWidth=o,t.strokeText(h,e,i),s&&"none"!==s&&this._renderDecoration(t,e,i,s,r,o);}i+=n;}}_setFontProperties(e,i){const s=Math.max(i.size,.5),r=i.font,n=`${r.style} ${r.weight} ${u$h(s*i.pixelRatio).toFixed(1)}px ${r.family}, sans-serif`;let o;switch(e.font=n,e.textBaseline="top",i.horizontalAlignment){case"left":default:o="left";break;case"right":o="right";break;case"center":o="center";}e.textAlign=o;}computeTextSize(t,e){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,s=i.getContext("2d");this._setFontProperties(s,e),this._parameters=e,this._textLines=t.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const r=this._computeTextWidth(s,e),n=this._lineHeight*this._textLines.length;return i.width=r,i.height=n,[r*e.pixelRatio,n*e.pixelRatio]}_computeTextWidth(e,i){let s=0;for(const t of this._textLines)s=Math.max(s,e.measureText(t).width);const r=i.font;return ("italic"===r.style||"oblique"===r.style||"string"==typeof r.weight&&("bold"===r.weight||"bolder"===r.weight)||"number"==typeof r.weight&&r.weight>600)&&(s+=.3*e.measureText("w").width),s+=2*u$h(this._parameters.halo.size),Math.round(s)}_computeLineHeight(){let e=1.275*this._parameters.size;const i=this._parameters.font.decoration;return i&&"underline"===i&&(e*=1.3),Math.round(e+2*u$h(this._parameters.halo.size))}_renderDecoration(t,e,i,s,r,n){const o=.9*this._lineHeight,h="bold"===r?.06:"bolder"===r?.09:.04;switch(t.textAlign){case"center":e-=this._renderedWidth/2;break;case"right":e-=this._renderedWidth;}const a=t.textBaseline;if("underline"===s)switch(a){case"top":i+=o;break;case"middle":i+=o/2;}else if("line-through"===s)switch(a){case"top":i+=o/1.5;break;case"middle":i+=o/3;}const l=n?1.5*n:Math.ceil(o*h);t.save(),t.beginPath(),t.strokeStyle=t.fillStyle,t.lineWidth=l,t.moveTo(e-this._lineThroughWidthOffset,i),t.lineTo(e+this._renderedWidth+2*this._lineThroughWidthOffset,i),t.stroke(),t.restore();}};function n$e(t,e){return "center"===t?.5*e:"right"===t?e:0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const t$7=()=>s$p.getLogger("esri.views.2d.engine.webgl.alignmentUtils");var r$6,n$d;function a$8(e){if(!e)return r$6.Center;switch(e){case"Left":case"left":return r$6.Left;case"Right":case"right":return r$6.Right;case"Justify":return t$7().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),r$6.Center;case"Center":case"center":return r$6.Center}}function c$6(e){if(!e)return n$d.Center;switch(e){case"Top":case"top":return n$d.Top;case"Center":case"middle":return n$d.Center;case"Baseline":case"baseline":return n$d.Baseline;case"Bottom":case"bottom":return n$d.Bottom}}function o$b(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return ["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return ["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return ["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return ["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return ["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return ["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return ["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return ["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return ["left","top"];default:return console.debug(`Found invalid placement type ${e}`),["center","middle"]}}function s$c(e){switch(e){case r$6.Right:case"right":return -1;case r$6.Center:case"center":return 0;case r$6.Left:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function i$9(e){switch(e){case n$d.Top:case"top":return 1;case n$d.Center:case"middle":return 0;case n$d.Bottom:case n$d.Baseline:case"baseline":case"bottom":return -1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}!function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right";}(r$6||(r$6={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline";}(n$d||(n$d={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const _$a=22,l$a=4,u$7=_$a+l$a,x$7=_$a-6,p$9=3,b$6=Math.PI/180,y$4=8,w$6=1.5;let M$4 = class M{constructor(t,s,i,e){this._rotationT=n$u(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const h=i.rect,n=new Float32Array(8);t*=e,s*=e;const r=i.code?h.width*e:i.metrics.width,a=i.code?h.height*e:i.metrics.height;this.width=r,this.height=a,n[0]=t,n[1]=s,n[2]=t+r,n[3]=s,n[4]=t,n[5]=s+a,n[6]=t+r,n[7]=s+a,this._data=n,this._setTextureCoords(h),this._scale=e,this._mosaic=i,this.x=t,this.y=s,this.maxOffset=Math.max(t+r,s+a);}get mosaic(){return this._mosaic}set angle(s){this._angle=s,M$7(this._rotationT,-s),this._setOffsets();}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:t,width:i}=this._mosaic.metrics,e=i*this._scale,n=Math.abs(t)*this._scale,r=new Float32Array(8);r[0]=this.x,r[1]=this.y,r[2]=this.x+e,r[3]=this.y,r[4]=this.x,r[5]=this.y+n,r[6]=this.x+e,r[7]=this.y+n;const a=e$i(n$u(),this._rotationT,this._transform);a$j(r,r,a);let f=1/0,c=1/0,m=0,d=0;for(let s=0;s<4;s++){const t=r[2*s],i=r[2*s+1];f=Math.min(f,t),c=Math.min(c,i),m=Math.max(m,t),d=Math.max(d,i);}const _=m-f,l=d-c,u=f+_/2,x=c+l/2;this._bounds=new i$n(u,x,_,l);}return this._bounds}setTransform(t){this._transform=t,this._offsets=null;}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const t=e$i(n$u(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],S$8(this._offsets.topLeft,this._offsets.topLeft,t),S$8(this._offsets.topRight,this._offsets.topRight,t),S$8(this._offsets.bottomLeft,this._offsets.bottomLeft,t),S$8(this._offsets.bottomRight,this._offsets.bottomRight,t);}_setTextureCoords({x:t,y:s,width:i,height:e}){this._texcoords={topLeft:[t,s],topRight:[t+i,s],bottomLeft:[t,s+e],bottomRight:[t+i,s+e]};}};const L$2=(t,s)=>({code:0,page:0,sdf:!0,rect:new t$j(0,0,11,8),textureBinding:s,metrics:{advance:0,height:4,width:t,left:0,top:0}});function R$6(t,s){return t.forEach((t=>S$8(t,t,s))),{topLeft:t[0],topRight:t[1],bottomLeft:t[2],bottomRight:t[3]}}let B$5 = class B{constructor(t,s,i){this._rotation=0,this._decorate(t,s,i),this.glyphs=t,this.bounds=this._createBounds(t),this.isMultiline=s.length>1,this._hasRotation=0!==i.angle,this._transform=this._createGlyphTransform(this.bounds,i),this._borderLineSizePx=i.borderLineSizePx,(i.borderLineSizePx||i.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const e of t)e.setTransform(this._transform);}setRotation(i){if(0===i&&0===this._rotation)return;this._rotation=i;const e=this._transform,h=M$7(n$u(),i);e$i(e,h,e);for(const t of this.glyphs)t.setTransform(this._transform);}_decorate(t,s,i){if(!i.decoration||"none"===i.decoration||!t.length)return;const e=i.scale,o="underline"===i.decoration?u$7:x$7,h=t[0].textureBinding;for(const n of s){const s=n.startX*e,i=n.startY*e,r=(n.width+n.glyphWidthEnd)*e;t.push(new M$4(s,i+o*e,L$2(r,h),1));}}shapeBackground(t){const s=this._borderLineSizePx||0,i=(w$6+s)/2,e=this._borderLineSizePx?i:0,{xmin:o,ymin:h,xmax:n,ymax:r,x:a,y:f,width:c,height:m}=this.bounds,d=[o-y$4,h-y$4],_=[n+y$4,h-y$4],l=[o-y$4,r+y$4],u=[n+y$4,r+y$4],x=R$6([[d[0]-i,d[1]-i],[_[0]+i,_[1]-i],[d[0]+e,d[1]+e],[_[0]-e,_[1]+e]],t),p=R$6([[l[0]+e,l[1]-e],[u[0]-e,u[1]-e],[l[0]-i,l[1]+i],[u[0]+i,u[1]+i]],t),b=R$6([[d[0]-i,d[1]-i],[d[0]+e,d[1]+e],[l[0]-i,l[1]+i],[l[0]+e,l[1]-e]],t),M=R$6([[_[0]-e,_[1]+e],[_[0]+i,_[1]-i],[u[0]-e,u[1]-e],[u[0]+i,u[1]+i]],t),L={main:R$6([d,_,l,u],t),top:x,bot:p,left:b,right:M};return [new i$n(a,f,c+2*i,m+2*i),L]}get boundsT(){const t=this.bounds,s=o$i(n$v(),t.x,t.y);if(S$8(s,s,this._transform),this._hasRotation){const i=Math.max(t.width,t.height);return new i$n(s[0],s[1],i,i)}return new i$n(s[0],s[1],t.width,t.height)}_createBounds(t){let s=1/0,i=1/0,e=0,o=0;for(const r of t)s=Math.min(s,r.xTopLeft),i=Math.min(i,r.yTopLeft),e=Math.max(e,r.xBottomRight),o=Math.max(o,r.yBottomRight);const h=e-s,n=o-i;return new i$n(s+h/2,i+n/2,h,n)}_createGlyphTransform(t,s){const h=b$6*s.angle,n=n$u(),f=n$v();return i$o(n,n,o$i(f,s.xOffset,-s.yOffset)),s.useCIMAngleBehavior?s$q(n,n,h):(i$o(n,n,o$i(f,t.x,t.y)),s$q(n,n,h),i$o(n,n,o$i(f,-t.x,-t.y))),n}};let T$4 = class T{constructor(t,s,i,e,o,h){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(s,i)),this.end=Math.max(0,Math.max(s,i)),this.end<t.length&&(this.glyphWidthEnd=t[this.end].metrics.width),this.width=e,this.yMin=o,this.yMax=h;}};const v$5=t=>10===t,j$6=t=>32===t;function A$4(t,s,i){const e=new Array,o=1/i.scale,h=i.maxLineWidth*o,n=s?t.length-1:0,r=s?-1:t.length,a=s?-1:1;let f=n,c=0,m=0,d=f,g=d,_=0,l=1/0,u=0;for(;f!==r;){const{code:s,metrics:i}=t[f],o=Math.abs(i.top);if(v$5(s)||j$6(s)||(l=Math.min(l,o),u=Math.max(u,o+i.height)),v$5(s))f!==n&&(e.push(new T$4(t,d,f-a,c,l,u)),l=1/0,u=0),c=0,d=f+a,g=f+a,m=0;else if(j$6(s))g=f+a,m=0,_=i.advance,c+=i.advance;else if(c>h){if(g!==d){const s=g-2*a;c-=_,e.push(new T$4(t,d,s,c-m,l,u)),l=1/0,u=0,d=g,c=m;}else e.push(new T$4(t,d,f-a,c,l,u)),l=1/0,u=0,d=f,g=f,c=0;c+=i.advance,m+=i.advance;}else c+=i.advance,m+=i.advance;f+=a;}const x=new T$4(t,d,f-a,c,l,u);return x.start>=0&&x.end<t.length&&e.push(x),e}function z$5(t,s){let i=0;for(let h=0;h<t.length;h++){const{width:s}=t[h];i=Math.max(s,i);}const e="underline"===s.decoration?l$a:0,o=t[0].yMin;return {x:0,y:o,height:t[t.length-1].yMax+s.lineHeight*(t.length-1)+e-o,width:i}}function O$4(t,s){const i=s.scale,e=new Array,{glyphs:o,isRightToLeft:h}=t,n=A$4(o,h,s),r=z$5(n,s),a=a$8(s.horizontalAlignment),d=c$6(s.verticalAlignment),g=d===n$d.Baseline?1:0,l=g?0:d-1,u=(1-g)*-r.y+l*(r.height/2)+(g?1:0)*-_$a;for(let f=0;f<n.length;f++){const{start:t,end:h,width:r}=n[f];let c=-1*(a+1)*(r/2)-p$9;const m=f*s.lineHeight+u-p$9;n[f].startX=c,n[f].startY=m;for(let s=t;s<=h;s++){const t=o[s];if(v$5(t.code))continue;const h=new M$4(c+t.metrics.left,m-t.metrics.top,t,i);c+=t.metrics.advance,e.push(h);}}return new B$5(e,n,s)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const N$3=Math.PI/180,J$3=.5,O$3=()=>s$p.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let V$2 = class V{constructor(t){this._t=t;}static createIdentity(){return new V([1,0,0,0,1,0])}clone(){const t=this._t;return new V(t.slice())}transform(t){const e=this._t;return [e[0]*t[0]+e[1]*t[1]+e[2],e[3]*t[0]+e[4]*t[1]+e[5]]}static createScale(t,e){return new V([t,0,0,0,e,0])}scale(t,e){const r=this._t;return r[0]*=t,r[1]*=t,r[2]*=t,r[3]*=e,r[4]*=e,r[5]*=e,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(t,e){return new V([0,0,t,0,0,e])}translate(t,e){const r=this._t;return r[2]+=t,r[5]+=e,this}static createRotate(t){const e=Math.cos(t),r=Math.sin(t);return new V([e,-r,0,r,e,0])}rotate(t){return V.multiply(this,V.createRotate(t),this)}angle(){const t=this._t[0],e=this._t[3],r=Math.sqrt(t*t+e*e);return [t/r,e/r]}static multiply(t,e,r){const i=t._t,s=e._t,o=i[0]*s[0]+i[3]*s[1],n=i[1]*s[0]+i[4]*s[1],a=i[2]*s[0]+i[5]*s[1]+s[2],l=i[0]*s[3]+i[3]*s[4],h=i[1]*s[3]+i[4]*s[4],c=i[2]*s[3]+i[5]*s[4]+s[5],m=r._t;return m[0]=o,m[1]=n,m[2]=a,m[3]=l,m[4]=h,m[5]=c,r}invert(){const t=this._t;let e=t[0]*t[4]-t[1]*t[3];if(0===e)return new V([0,0,0,0,0,0]);e=1/e;const r=(t[1]*t[5]-t[2]*t[4])*e,i=(t[2]*t[3]-t[0]*t[5])*e,s=t[4]*e,o=-t[1]*e,n=-t[3]*e,a=t[0]*e;return new V([s,o,r,n,a,i])}};let q$7 = class q{constructor(t,e){this._resourceManager=t,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new e$k(t$e,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(e||V$2.createIdentity()),this._sizeTransfos.push(e?e.scaleRatio():1);}setTransform(t,e){this._transfos=[t||V$2.createIdentity()],this._sizeTransfos=[e||(t?t.scaleRatio():1)];}setGeomUnitsPerPoint(t){this._geomUnitsPerPoint=t;}transformPt(t){return this._transfos[this._transfos.length-1].transform(t)}transformSize(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(t){return this._transfos[this._transfos.length-1].invert().transform(t)}reverseTransformSize(t){return t/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(t){return t/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(t,e){const r=e?t.scaleRatio():1;V$2.multiply(t,this.back(),t),this._transfos.push(t),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*r);}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1);}drawSymbol(t,e,r){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(t,e);break;case"CIMTextSymbol":this.drawTextSymbol(t,e,r);}}drawMultiLayerSymbol(t,e){if(!t||!e)return;const r=t.symbolLayers;if(!r)return;const i=t.effects;if(i&&i.length>0){const t=this.executeEffects(i,e);if(t){let e=t.next();for(;e;)this.drawSymbolLayers(r,e.asJSON()),e=t.next();}}else this.drawSymbolLayers(r,e);}executeEffects(t,e){const r=this._resourceManager.geometryEngine;let i=new s$k(a$d.fromJSONCIM(e));for(const s of t){const t=A$5(s);t&&(i=t.execute(i,s,this.geomUnitsPerPoint(),null,r));}return i}drawSymbolLayers(t,e){let r=t.length;for(;r--;){const i=t[r];if(!i||!1===i.enable)continue;const s=i.effects;if(s&&s.length>0){const t=this.executeEffects(s,e);if(t){let e=null;for(;(e=t.next())&&(this.drawSymbolLayer(i,e.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(i,e);if(this._earlyReturn)return}}drawSymbolLayer(t,e){switch(t.type){case"CIMSolidFill":this.drawSolidFill(e,t.color);break;case"CIMHatchFill":this.drawHatchFill(e,t);break;case"CIMPictureFill":this.drawPictureFill(e,t);break;case"CIMGradientFill":this.drawGradientFill(e,t);break;case"CIMSolidStroke":this.drawSolidStroke(e,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(e,t);break;case"CIMGradientStroke":this.drawGradientStroke(e,t);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(t,e);}}drawHatchFill(t,e){const r=this._buildHatchPolyline(e,t,this.geomUnitsPerPoint());r&&(this.pushClipPath(t),this.drawMultiLayerSymbol(e.lineSymbol,r),this.popClipPath());}drawPictureFill(t,e){}drawGradientFill(t,e){}drawPictureStroke(t,e){}drawGradientStroke(t,e){}drawMarkerLayer(t,e){const r=t.markerPlacement;if(r){const i=g$9(r);if(i){const s="CIMMarkerPlacementInsidePolygon"===r.type||"CIMMarkerPlacementPolygonCenter"===r.type&&r.clipAtBoundary;s&&this.pushClipPath(e);const o=i.execute(a$d.fromJSONCIM(e),r,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(o){let e=null;for(;(e=o.next())&&(this.drawMarker(t,e),!this._earlyReturn););}s&&this.popClipPath();}}else {const r=this._placementPool.acquire();if(u$f(e))r.tx=e.x,r.ty=e.y,this.drawMarker(t,r);else if(f$g(e)){const i=l$k(e);i&&([r.tx,r.ty]=i,this.drawMarker(t,r));}else for(const i of e.points)if(r.tx=i[0],r.ty=i[1],this.drawMarker(t,r),this._earlyReturn)break;this._placementPool.release(r);}}drawMarker(t,e){switch(t.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(t,e);break;case"CIMVectorMarker":this.drawVectorMarker(t,e);}}drawPictureMarker(t,e){if(!t)return;const r=this._resourceManager.getResource(t.url),i=I$5(t.size,t$k.CIMPictureMarker.size);if(null==r||i<=0)return;const s=r.width,o=r.height;if(!s||!o)return;const n=s/o,a=I$5(t.scaleX,1),l=V$2.createIdentity(),h=t.anchorPoint;if(h){let e=h.x,r=h.y;"Absolute"!==t.anchorPointUnits&&(e*=i*n*a,r*=i),l.translate(-e,-r);}let c=I$5(t.rotation);t.rotateClockwise&&(c=-c),this._mapRotation&&(c+=this._mapRotation),c&&l.rotate(c*N$3);let m=I$5(t.offsetX),f=I$5(t.offsetY);if(m||f){if(this._mapRotation){const t=N$3*this._mapRotation,e=Math.cos(t),r=Math.sin(t),i=m*r+f*e;m=m*e-f*r,f=i;}l.translate(m,f);}const u=this.geomUnitsPerPoint();1!==u&&l.scale(u,u);const d=e.getAngle();d&&l.rotate(d),l.translate(e.tx,e.ty),this.push(l,!1),this.drawImage(t,i),this.pop();}drawVectorMarker(t,e){if(!t)return;const r=t.markerGraphics;if(!r)return;const i=I$5(t.size,t$k.CIMVectorMarker.size),s=t.frame,o=s?s.ymax-s.ymin:0,n=i&&o?i/o:1,a=V$2.createIdentity();s&&a.translate(.5*-(s.xmax+s.xmin),.5*-(s.ymax+s.ymin));const l=t.anchorPoint;if(l){let e=l.x,r=l.y;"Absolute"!==t.anchorPointUnits?s&&(e*=s.xmax-s.xmin,r*=s.ymax-s.ymin):(e/=n,r/=n),a.translate(-e,-r);}1!==n&&a.scale(n,n);let h=I$5(t.rotation);t.rotateClockwise&&(h=-h),this._mapRotation&&(h+=this._mapRotation),h&&a.rotate(h*N$3);let c=I$5(t.offsetX),m=I$5(t.offsetY);if(c||m){if(this._mapRotation){const t=N$3*this._mapRotation,e=Math.cos(t),r=Math.sin(t),i=c*r+m*e;c=c*e-m*r,m=i;}a.translate(c,m);}const f=this.geomUnitsPerPoint();1!==f&&a.scale(f,f);const u=e.getAngle();u&&a.rotate(u),a.translate(e.tx,e.ty),this.push(a,t.scaleSymbolsProportionally);for(const d of r){d?.symbol&&d.geometry||O$3().error("Invalid marker graphic",d);let t=d.textString;if("number"==typeof t&&(t=t.toString()),this.drawSymbol(d.symbol,d.geometry,t),this._earlyReturn)break}this.pop();}drawTextSymbol(t,e,r){if(!t)return;if(!u$f(e))return;if(I$5(t.height,t$k.CIMTextSymbol.height)<=0)return;const i=V$2.createIdentity();let s=I$5(t.angle);s=-s,s&&i.rotate(s*N$3);const o=I$5(t.offsetX),n=I$5(t.offsetY);(o||n)&&i.translate(o,n);const a=this.geomUnitsPerPoint();1!==a&&i.scale(a,a),i.translate(e.x,e.y),this.push(i,!1),this.drawText(t,r),this.pop();}_buildHatchPolyline(t,e,r){let i=I$5(t.separation,t$k.CIMHatchFill.separation)*r,s=I$5(t.rotation);if(0===i)return null;i<0&&(i=-i);let o=0;const n=.5*i;for(;o>n;)o-=i;for(;o<-n;)o+=i;const l=u$g();a$l(l,e),l[0]-=n,l[1]-=n,l[2]+=n,l[3]+=n;const c=[[l[0],l[1]],[l[0],l[3]],[l[2],l[3]],[l[2],l[1]]];for(;s>180;)s-=180;for(;s<0;)s+=180;const m=Math.cos(s*N$3),f=Math.sin(s*N$3),u=-i*f,d=i*m;let p,_,y,g;o=I$5(t.offsetX)*r*f-I$5(t.offsetY)*r*m,p=y=Number.MAX_VALUE,_=g=-Number.MAX_VALUE;for(const a of c){const t=a[0],e=a[1],r=m*t+f*e,i=-f*t+m*e;p=Math.min(p,r),y=Math.min(y,i),_=Math.max(_,r),g=Math.max(g,i);}y=Math.floor(y/i)*i;let P=m*p-f*y-u*o/i,x=f*p+m*y-d*o/i,S=m*_-f*y-u*o/i,M=f*_+m*y-d*o/i;const b=1+Math.round((g-y)/i),k=[];for(let a=0;a<b;a++)P+=u,x+=d,S+=u,M+=d,k.push([[P,x],[S,M]]);return {paths:k}}};let Y$2 = class Y extends q$7{constructor(t,e){super(t,e),this.reset();}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0;}envelope(){return new t$8(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return a$k(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(t){if(t&&!(this._clipCount>0))if(f$g(t))this._processPath(t.rings,0);else if(s$m(t))this._processPath(t.paths,0);else if(m$d(t)){const e=Z$3(t);e&&this._processPath(e.rings,0);}else console.error("drawSolidFill Unexpected geometry type!");}drawSolidStroke(t,e,r){if(!t||this._clipCount>0||null==r||r<=0)return;const i=Math.max(.5*this.transformSize(I$5(r,t$k.CIMSolidStroke.width)),.5*J$3);if(f$g(t))this._processPath(t.rings,i);else if(s$m(t))this._processPath(t.paths,i);else if(m$d(t)){const e=Z$3(t);e&&this._processPath(e.rings,i);}else console.error("drawSolidStroke unexpected geometry type!");}drawMarkerLayer(t,e){f$g(e)&&t.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===t.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===t.markerPlacement.type&&t.markerPlacement.clipAtBoundary)?this._processPath(e.rings,0):super.drawMarkerLayer(t,e);}drawHatchFill(t,e){this.drawSolidFill(t);}drawPictureFill(t,e){this.drawSolidFill(t);}drawGradientFill(t,e){this.drawSolidFill(t);}drawPictureStroke(t,e){this.drawSolidStroke(t,null,e.width);}drawGradientStroke(t,e){this.drawSolidStroke(t,null,e.width);}pushClipPath(t){this.drawSolidFill(t),this._clipCount++;}popClipPath(){this._clipCount--;}drawImage(t,e){const{url:r}=t,i=I$5(t.scaleX,1);let s=i*e,o=e;const n=this._resourceManager.getResource(r);if(null!=n){const t=n.height/n.width;s=i*(e?t>1?e:e/t:n.width),o=e?t>1?e*t:e:n.height;}this._merge(this.transformPt([-s/2,-o/2]),0),this._merge(this.transformPt([-s/2,o/2]),0),this._merge(this.transformPt([s/2,-o/2]),0),this._merge(this.transformPt([s/2,o/2]),0);}drawText(t,e){if(!e||0===e.length)return;this._textRasterizer||(this._textRasterizer=new r$7);const r=tt$1(t);let[i,o]=this._textRasterizer.computeTextSize(e,r);i=e$j(i),o=e$j(o);let n=0;switch(t.horizontalAlignment){case"Left":n=i/2;break;case"Right":n=-i/2;}let a=0;switch(t.verticalAlignment){case"Bottom":a=o/2;break;case"Top":a=-o/2;break;case"Baseline":a=o/6;}this._merge(this.transformPt([-i/2+n,-o/2+a]),0),this._merge(this.transformPt([-i/2+n,o/2+a]),0),this._merge(this.transformPt([i/2+n,-o/2+a]),0),this._merge(this.transformPt([i/2+n,o/2+a]),0);}_processPath(t,e){if(t)for(const r of t){const t=r?r.length:0;if(t>1){this._merge(this.transformPt(r[0]),e);for(let i=1;i<t;i++)this._merge(this.transformPt(r[i]),e);}}}_merge(t,e){t[0]-e<this._xmin&&(this._xmin=t[0]-e),t[0]+e>this._xmax&&(this._xmax=t[0]+e),t[1]-e<this._ymin&&(this._ymin=t[1]-e),t[1]+e>this._ymax&&(this._ymax=t[1]+e);}};let W$3 = class W extends q$7{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null;}hitTest(t,e,r,i,n,a){const l=a*u$h(1);this.setTransform(),this.setGeomUnitsPerPoint(l),this._searchPoint=[(t[0]+t[2])/2,(t[1]+t[3])/2],this._searchDistPoint=(t[2]-t[0])/2/l,this._textInfo=i;const h=e&&("CIMPointSymbol"===e.type&&"Map"!==e.angleAlignment||"CIMTextSymbol"===e.type);if(this._mapRotation=h?n:0,!has("esri-mobile")){const t=e$j(has("hittest-2d-small-symbol-tolerance")*window.devicePixelRatio),r=e$j(has("hittest-2d-small-symbol-tolerance-threshold"));!(("CIMLineSymbol"===e?.type||"CIMPolygonSymbol"===e?.type)&&e.symbolLayers?.some(C$6))&&"CIMMeshSymbol"!==e?.type&&(B$8(e)??0)<r&&(this._searchDistPoint=t);}return this._earlyReturn=!1,this.drawSymbol(e,r),this._earlyReturn}drawSolidFill(t,e){this._hitTestFill(t);}drawHatchFill(t,e){this._hitTestFill(t);}drawPictureFill(t,e){this._hitTestFill(t);}drawGradientFill(t,e){this._hitTestFill(t);}drawSolidStroke(t,e,r,i,s,o){this._hitTestStroke(t,r);}drawPictureStroke(t,e){this._hitTestStroke(t,e.width);}drawGradientStroke(t,e){this._hitTestStroke(t,e.width);}drawMarkerLayer(t,e){t.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===t.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===t.markerPlacement.type&&t.markerPlacement.clipAtBoundary)?this._hitTestFill(e):super.drawMarkerLayer(t,e);}pushClipPath(t){}popClipPath(){}drawImage(t,e){const{url:r}=t,i=I$5(t.scaleX,1),s=this._resourceManager.getResource(r);if(null==s||0===s.height||0===e)return;const o=e*this.geomUnitsPerPoint(),n=o*i*(s.width/s.height),a=this.reverseTransformPt(this._searchPoint),l=this._searchDistPoint;Math.abs(a[0])<n/2+l&&Math.abs(a[1])<o/2+l&&(this._earlyReturn=!0);}drawText(t,e){const r=this._textInfo;if(!r)return;const i=r.get(t);if(!i)return;if(!i.glyphMosaicItems.glyphs.length)return;const s=I$5(t.height,t$k.CIMTextSymbol.height),{lineGapType:o,lineGap:n}=t,a=o?$$1(o,I$5(n),s):0,l="CIMBackgroundCallout"===t.callout?.type,h=O$4(i.glyphMosaicItems,{scale:s/U$2,angle:0,xOffset:0,yOffset:0,horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,maxLineWidth:512,lineHeight:g$b*Math.max(.25,Math.min(a||1,4)),decoration:t.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:l}),c=this.reverseTransformPt(this._searchPoint),m=c[0],f=c[1];for(const u of h.glyphs)if(m>u.xTopLeft&&m<u.xBottomRight&&f>-u.yBottomRight&&f<-u.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(t){let e=null;if(m$d(t)){const r=t;e=[[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]];}else if(f$g(t))e=t.rings;else {if(!s$m(t))return;e=t.paths;}const r=this.reverseTransformPt(this._searchPoint);if(this._pointInPolygon(r,e)&&(this._earlyReturn=!0),!this._earlyReturn){const t=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint();this._nearLine(r,e,t)&&(this._earlyReturn=!0);}}_hitTestStroke(t,e){let r=null;if(m$d(t)){const e=t;r=[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]];}else if(f$g(t))r=t.rings;else {if(!s$m(t))return;r=t.paths;}const i=this.reverseTransformPt(this._searchPoint),s=I$5(e,t$k.CIMSolidStroke.width)*this.geomUnitsPerPoint(),o=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint();this._nearLine(i,r,s/2+o)&&(this._earlyReturn=!0);}_pointInPolygon(t,e){let r=0;for(const i of e){const e=i.length;for(let s=1;s<e;s++){const e=i[s-1],o=i[s];if(e[1]>t[1]==o[1]>t[1])continue;(o[0]-e[0])*(t[1]-e[1])-(o[1]-e[1])*(t[0]-e[0])>0?r++:r--;}}return 0!==r}_nearLine(t,e,r){for(const i of e){const e=i.length;for(let s=1;s<e;s++){const e=i[s-1],o=i[s];let n=(o[0]-e[0])*(o[0]-e[0])+(o[1]-e[1])*(o[1]-e[1]);if(0===n)continue;n=Math.sqrt(n);const a=((o[0]-e[0])*(t[1]-e[1])-(o[1]-e[1])*(t[0]-e[0]))/n;if(Math.abs(a)<r){const i=((o[0]-e[0])*(t[0]-e[0])+(o[1]-e[1])*(t[1]-e[1]))/n;if(i>-r&&i<n+r)return !0}}}return !1}};let K$4 = class K extends q$7{constructor(t,e,r,i){super(e,r),this._applyAdditionalRenderProps=i,this._colorSubstitutionHelper=new t$a,this._ctx=t;}drawSolidFill(t,e){if(!t)return;if(f$g(t))this._buildPath(t.rings,!0);else if(s$m(t))this._buildPath(t.paths,!0);else if(m$d(t))this._buildPath(Z$3(t).rings,!0);else {if(!l$j(t))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!");}const r=this._ctx;r.fillStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+(e[3]??255)/255+")",r.fill("evenodd");}drawSolidStroke(t,e,r,i,s,o){if(!t||!e||0===r)return;if(f$g(t))this._buildPath(t.rings,!0);else if(s$m(t))this._buildPath(t.paths,!1);else {if(!m$d(t))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(Z$3(t).rings,!0);}const n=this._ctx;n.strokeStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+(e[3]??255)/255+")",n.lineWidth=Math.max(this.transformSize(r),J$3),this._setCapStyle(i),this._setJoinStyle(s),n.miterLimit=o,n.stroke();}pushClipPath(t){if(this._ctx.save(),f$g(t))this._buildPath(t.rings,!0);else if(s$m(t))this._buildPath(t.paths,!0);else {if(!m$d(t))return;this._buildPath(Z$3(t).rings,!0);}this._ctx.clip("evenodd");}popClipPath(){this._ctx.restore();}drawImage(t,e){const{colorSubstitutions:r,url:i,tintColor:s}=t,o=I$5(t.scaleX,1),n=this._resourceManager.getResource(i);if(null==n)return;let a=e*(n.width/n.height),l=e;e||(a=n.width,l=n.height);const h=N$5(i)||"src"in n&&N$5(n.src);let c="getFrame"in n?t$9(n):n;r&&(c=this._colorSubstitutionHelper.applyColorSubstituition(c,r)),this._applyAdditionalRenderProps&&!h&&s&&(c=this._colorSubstitutionHelper.tintImageData(c,s));const m=this.transformPt([0,0]),[f,u]=this.getTransformAngle(),d=this.transformSize(1),p=this._ctx;p.save(),p.setTransform({m11:o*d*f,m12:o*d*u,m21:-d*u,m22:d*f,m41:m[0],m42:m[1]}),p.drawImage(c,-a/2,-l/2,a,l),p.restore();}drawText(t,e){if(!e||0===e.length)return;this._textRasterizer||(this._textRasterizer=new r$7);const r=tt$1(t);r.size*=this.transformSize(e$j(1));const i=this._textRasterizer.rasterizeText(e,r);if(!i)return;const{size:o,anchorX:n,anchorY:a,canvas:l}=i,h=o[0]*(n+.5),c=o[1]*(a-.5),m=this._ctx,f=this.transformPt([0,0]),[u,d]=this.getTransformAngle(),p=1;m.save(),m.setTransform({m11:p*u,m12:p*d,m21:-p*d,m22:p*u,m41:f[0]-p*h,m42:f[1]+p*c}),m.drawImage(l,0,0),m.restore();}drawPictureFill(t,e){if(!t)return;let{colorSubstitutions:r,height:i,offsetX:s,offsetY:o,rotation:n,scaleX:a,tintColor:l,url:h}=e;const c=this._resourceManager.getResource(h);if(null==c)return;if(f$g(t))this._buildPath(t.rings,!0);else if(s$m(t))this._buildPath(t.paths,!0);else if(m$d(t))this._buildPath(Z$3(t).rings,!0);else {if(!l$j(t))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!");}const m=this._ctx,_=N$5(h)||"src"in c&&N$5(c.src);let y,g="getFrame"in c?t$9(c):c;if(r&&(g=this._colorSubstitutionHelper.applyColorSubstituition(g,r)),this._applyAdditionalRenderProps){_||l&&(g=this._colorSubstitutionHelper.tintImageData(g,l)),y=m.createPattern(g,"repeat");const t=this.transformSize(1);n||(n=0),s?s*=t:s=0,o?o*=t:o=0,i&&(i*=t);const e=i?i/c.height:1,r=a&&i?a*i/c.width:1;if(0!==n||1!==e||1!==r||0!==s||0!==o){const t=new DOMMatrix;t.rotateSelf(0,0,-n).translateSelf(s,o).scaleSelf(r,e,1),y.setTransform(t);}}else y=m.createPattern(g,"repeat");m.save(),m.fillStyle=y,m.fill("evenodd"),m.restore();}drawPictureStroke(t,r){if(!t)return;let{colorSubstitutions:i,capStyle:s,joinStyle:n,miterLimit:a,tintColor:l,url:h,width:c}=r;const m=this._resourceManager.getResource(h);if(null==m)return;let _;if(f$g(t))_=t.rings;else if(s$m(t))_=t.paths;else {if(!m$d(t))return l$j(t)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;_=Z$3(t).rings;}c||(c=m.width);const y=N$5(h)||"src"in m&&N$5(m.src);let g="getFrame"in m?t$9(m):m;i&&(g=this._colorSubstitutionHelper.applyColorSubstituition(g,i)),this._applyAdditionalRenderProps&&(y||l&&(g=this._colorSubstitutionHelper.tintImageData(g,l)));const P=Math.max(this.transformSize(u$h(c)),.5),x=P/g.width,w=this._ctx,S=w.createPattern(g,"repeat-y");let M,k;w.save(),this._setCapStyle(s),this._setJoinStyle(n),void 0!==a&&(w.miterLimit=a),w.lineWidth=P;for(let o of _)if(o=a$i(o),rt$1(o),o&&!(o.length<=1)){M=this.transformPt(o[0]);for(let t=1;t<o.length;t++){k=this.transformPt(o[t]);const e=Q$2(M,k),r=new DOMMatrix;r.translateSelf(0,M[1]-P/2).scaleSelf(x,x,1).rotateSelf(0,0,90-e),S.setTransform(r),w.strokeStyle=S,w.beginPath(),w.moveTo(M[0],M[1]),w.lineTo(k[0],k[1]),w.stroke(),M=k;}}w.restore();}_buildPath(t,e){const r=this._ctx;if(r.beginPath(),t)for(const i of t){const t=i?i.length:0;if(t>1){let s=this.transformPt(i[0]);r.moveTo(s[0],s[1]);for(let e=1;e<t;e++)s=this.transformPt(i[e]),r.lineTo(s[0],s[1]);e&&r.closePath();}}}_setCapStyle(t){switch(t){case U$3.Butt:this._ctx.lineCap="butt";break;case U$3.Round:this._ctx.lineCap="round";break;case U$3.Square:this._ctx.lineCap="square";}}_setJoinStyle(t){switch(t){case w$9.Bevel:this._ctx.lineJoin="bevel";break;case w$9.Round:this._ctx.lineJoin="round";break;case w$9.Miter:this._ctx.lineJoin="miter";}}};function Q$2(t,e){const r=e[0]-t[0],i=e[1]-t[1];return 180/Math.PI*Math.atan2(i,r)}const Z$3=t=>t?{spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:null,$$1=(t,e,r)=>{switch(t){case"ExtraLeading":return 1+e/r;case"Multiple":return e;case"Exact":return e/r}};function tt$1(e,r=1){const i=w$a(e),s=P$9(e.fontStyleName),o=e.fontFamilyName??t$b,{weight:n,style:a}=s,l=r*(e.height||5),h=A$8(e.horizontalAlignment),c=F$6(e.verticalAlignment),m=L$3(e),f=L$3(e.haloSymbol),u=null!=f?r*(e.haloSize??0):0,d="CIMBackgroundCallout"===e.callout?.type?e.callout.backgroundSymbol:null,p=L$3(d),_=x$b(d),y=T$5(d);return {color:m,size:l,horizontalAlignment:h,verticalAlignment:c,font:{family:o,style:S$9(a),weight:g$c(n),decoration:i},halo:{size:u||0,color:f,style:a},backgroundColor:p,borderLine:null!=_&&null!=y?{size:_,color:y}:null,pixelRatio:1,premultiplyColors:!0}}const et$1=1e-4;function rt$1(t){let e,r,i,s,o,n=t[0],a=1;for(;a<t.length;)e=t[a][0]-n[0],r=t[a][1]-n[1],s=0!==e?r/e:Math.PI/2,void 0!==i&&s-i<=et$1?(t.splice(a-1,1),n=o):(o=n,n=t[a],a++),i=s;}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const X$1=Math.PI,V$1=X$1/2,N$2=Math.PI/180,Y$1=96/72,_$9=4,H$3=()=>s$p.getLogger("esri.symbols.cim.CIMSymbolHelper");function U$1(e){let t;switch(e.type){case"cim":return e.data;case"web-style":return e;case"simple-marker":{const r=K$3.fromSimpleMarker(e);if(!r)throw new Error("InternalError: Cannot convert symbol to CIM");t=r;break}case"picture-marker":t=K$3.fromPictureMarker(e);break;case"simple-line":t=K$3.fromSimpleLineSymbol(e);break;case"simple-fill":t=K$3.fromSimpleFillSymbol(e);break;case"picture-fill":t=K$3.fromPictureFillSymbol(e);break;case"text":t=K$3.fromTextSymbol(e);}return {type:"CIMSymbolReference",symbol:t}}function O$2(e,t,r){switch(t.type){case"CIMSymbolReference":return O$2(e,t.symbol,r);case"CIMPointSymbol":null==r&&(r={x:0,y:0}),e.drawSymbol(t,r);break;case"CIMLineSymbol":null==r&&(r={paths:[[[0,0],[10,0]]]}),e.drawSymbol(t,r);break;case"CIMPolygonSymbol":null==r&&(r={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),e.drawSymbol(t,r);break;case"CIMTextSymbol":{const r={x:0,y:0};e.drawSymbol(t,r);break}case"CIMVectorMarker":{const r=new t$e;e.drawMarker(t,r);break}}return e.envelope()}function q$6(e){if(!e)return 0;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(e.offset);default:return 0}}function W$2(e){if(!e)return 0;switch(e.type){case"CIMGeometricEffectArrow":return Math.abs(.5*e.width);case"CIMGeometricEffectBuffer":return Math.abs(e.size);case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(e.length);case"CIMGeometricEffectJog":return Math.abs(.5*e.length);case"CIMGeometricEffectMove":return Math.max(Math.abs(I$5(e.offsetX)),Math.abs(I$5(e.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(e.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(e.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return .5*Math.max(Math.abs(e.fromWidth),Math.abs(e.toWidth));case"CIMGeometricEffectWave":return Math.abs(e.amplitude);case"CIMGeometricEffectDonut":return Math.abs(e.width)}}function $(e){if(!e)return 0;let t=0;for(const r of e)t+=W$2(r);return t}let J$2 = class J{static getSymbolInflateSize(e,t,r,o,a){return e||(e=[0,0,0,0]),t?this._getInflateSize(e,t,r,o,a):e}static safeSize(e){const t=Math.max(Math.abs(e[0]),Math.abs(e[2])),r=Math.max(Math.abs(e[1]),Math.abs(e[3]));return Math.sqrt(t*t+r*r)}static _vectorMarkerBounds(e,t,r,o){let a=!0;const i=u$g();if(t?.markerGraphics)for(const s of t.markerGraphics){const t=[0,0,0,0];s.geometry&&(a$l(i,s.geometry),t[0]=0,t[1]=0,t[2]=0,t[3]=0,this.getSymbolInflateSize(t,s.symbol,r,0,o),i[0]+=t[0],i[1]+=t[1],i[2]+=t[2],i[3]+=t[3],a?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],a=!1):(e[0]=Math.min(e[0],i[0]),e[1]=Math.min(e[1],i[1]),e[2]=Math.max(e[2],i[2]),e[3]=Math.max(e[3],i[3])));}return e}static _getInflateSize(e,t,r,o,a){if(le(t)){const s=this._getLayersInflateSize(e,t.symbolLayers,r,o,a),i=$(t.effects);return i>0&&(s[0]-=i,s[1]-=i,s[2]+=i,s[3]+=i),s}return this._getTextInflatedSize(e,t,a)}static _getLayersInflateSize(e,t,r,o,a){let n=!0;if(!t)return e;for(const l of t){if(!l)continue;let t=[0,0,0,0];switch(l.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=l;let r=e.width;null!=r&&(e.capStyle===U$3.Square||e.joinStyle===w$9.Miter?r/=1.4142135623730951:r/=2,t[0]=-r,t[1]=-r,t[2]=r,t[3]=r);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const e=l;if("CIMVectorMarker"===l.type){const e=l;if(t=this._vectorMarkerBounds(t,e,r,a),e.frame){const r=(e.frame.xmin+e.frame.xmax)/2,o=(e.frame.ymin+e.frame.ymax)/2;if(t[0]-=r,t[1]-=o,t[2]-=r,t[3]-=o,null!=e.size){const r=e.size/(e.frame.ymax-e.frame.ymin);t[0]*=r,t[1]*=r,t[2]*=r,t[3]*=r;}}}else if("CIMPictureMarker"===l.type){const o=l,a=r.getResource(o.url);let s=1;if(null!=a&&a.height&&(s=a.width/a.height),null!=e.size){const r=e.size/2,a=e.size*s*o.scaleX/2;t=[-a,-r,a,r];}}else if(null!=e.size){const r=e.size/2;t=[-r,-r,r,r];}if(e.anchorPoint){let r,o;"Absolute"===e.anchorPointUnits?(r=e.anchorPoint.x,o=e.anchorPoint.y):(r=e.anchorPoint.x*(t[2]-t[0]),o=e.anchorPoint.y*(t[3]-t[1])),t[0]-=r,t[1]-=o,t[2]-=r,t[3]-=o;}let n=I$5(e.rotation);if(e.rotateClockwise&&(n=-n),o&&(n-=o),n){const e=N$2*n,r=Math.cos(e),o=Math.sin(e),a=u$g([r$o,r$o,-r$o,-r$o]);f$l(a,[t[0]*r-t[1]*o,t[0]*o+t[1]*r]),f$l(a,[t[0]*r-t[3]*o,t[0]*o+t[3]*r]),f$l(a,[t[2]*r-t[1]*o,t[2]*o+t[1]*r]),f$l(a,[t[2]*r-t[3]*o,t[2]*o+t[3]*r]),t=a;}let c=I$5(e.offsetX),m=I$5(e.offsetY);if(o){const e=N$2*o,t=Math.cos(e),r=Math.sin(e),a=c*r+m*t;c=c*t-m*r,m=a;}t[0]+=c,t[1]+=m,t[2]+=c,t[3]+=m;const f=q$6(e.markerPlacement);f>0&&(t[0]-=f,t[1]-=f,t[2]+=f,t[3]+=f);break}}const c=$(l.effects);c>0&&(t[0]-=c,t[1]-=c,t[2]+=c,t[3]+=c),n?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],n=!1):(e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3]));}return e}static _getTextInflatedSize(e,t,r){const o=t.height??t$k.CIMTextSymbol.height;if(e[0]=-o/2,e[1]=-o/2,e[2]=o/2,e[3]=o/2,!r)return e;const a=r.get(t);if(!a)return e;if(!a.glyphMosaicItems.glyphs.length)return e;const{lineGapType:s,lineGap:i}=t,n=s?$$1(s,i??0,o):0,l="CIMBackgroundCallout"===t.callout?.type,c=O$4(a.glyphMosaicItems,{scale:o/U$2,angle:I$5(t.angle),xOffset:I$5(t.offsetX),yOffset:I$5(t.offsetY),horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,maxLineWidth:512,lineHeight:g$b*Math.max(.25,Math.min(n||1,4)),decoration:t.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:l}).boundsT;return e[0]=c.x-c.halfWidth,e[1]=-c.y-c.halfHeight,e[2]=c.x+c.halfWidth,e[3]=-c.y+c.halfHeight,e}};let K$3 = class K{static getEnvelope(e,t,r){if(!e)return null;const o=new Y$2(r);if(Array.isArray(e)){let r;for(const a of e)r?r.union(O$2(o,a,t)):r=O$2(o,a,t);return r}return O$2(o,e,t)}static getTextureAnchor(e,t){const r=this.getEnvelope(e,null,t);if(!r)return [0,0,0];const o=(r.x+.5*r.width)*Y$1,a=(r.y+.5*r.height)*Y$1,s=r.width*Y$1+2,i=r.height*Y$1+2;return [-o/s,-a/i,i]}static rasterize(e,t,r,o,a=!0){const s=r||this.getEnvelope(t,null,o);if(!s)return [null,0,0,0,0];const i=(s.x+.5*s.width)*Y$1,n=(s.y+.5*s.height)*Y$1;e.width=s.width*Y$1,e.height=s.height*Y$1,r||(e.width+=2,e.height+=2);const l=e.getContext("2d",{willReadFrequently:!0}),m=V$2.createScale(Y$1,-Y$1);m.translate(.5*e.width-i,.5*e.height+n);const h=new K$4(l,o,m);switch(t.type){case"CIMPointSymbol":{const e={type:"point",x:0,y:0};h.drawSymbol(t,e);break}case"CIMVectorMarker":{const e=new t$e;h.drawMarker(t,e);break}}const u=l.getImageData(0,0,e.width,e.height),p=new Uint8Array(u.data);if(a){let e;for(let t=0;t<p.length;t+=4)e=p[t+3]/255,p[t]=p[t]*e,p[t+1]=p[t+1]*e,p[t+2]=p[t+2]*e;}return [p,e.width,e.height,-i/e.width,-n/e.height]}static fromTextSymbol(e){const{text:t}=e;return {type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:K.createCIMTextSymbolfromTextSymbol(e),textString:t}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(e){const{height:t,outline:r,width:o,xoffset:a,xscale:s,yoffset:i,yscale:n}=e,l=[],c={type:"CIMPolygonSymbol",symbolLayers:l};if(r){const e=ye(r);e&&l.push(e);}let m=e.url;"esriPFS"===e.type&&e.imageData&&(m=e.imageData);const f="angle"in e?e.angle??0:0,y=(o??0)*(s||1),h=(t??0)*(n||1);return l.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:ie$1.Picture,tintColor:null,url:m,height:h,width:y,offsetX:I$5(a),offsetY:I$5(i),rotation:I$5(-f),colorSubstitutions:null}),c}static fromSimpleFillSymbol(e){const{color:r,style:o,outline:s}=e,i=[],n={type:"CIMPolygonSymbol",symbolLayers:i};if(s){const e=ye(s);e&&i.push(e);}if(o&&"solid"!==o&&"none"!==o&&"esriSFSSolid"!==o&&"esriSFSNull"!==o){const e={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:oe(r),capStyle:U$3.Butt,joinStyle:w$9.Miter,width:.75}]};let s=0;const n=e$j(me(o)?8:10);switch(o){case"vertical":case"esriSFSVertical":s=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":s=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":s=45;break;case"cross":case"esriSFSCross":s=0;}i.push({type:"CIMHatchFill",lineSymbol:e,offsetX:0,offsetY:0,rotation:s,separation:n}),"cross"===o||"esriSFSCross"===o?i.push({type:"CIMHatchFill",lineSymbol:a$i(e),offsetX:0,offsetY:0,rotation:90,separation:n}):"diagonal-cross"!==o&&"esriSFSDiagonalCross"!==o||i.push({type:"CIMHatchFill",lineSymbol:a$i(e),offsetX:0,offsetY:0,rotation:45,separation:n});}else !o||"solid"!==o&&"esriSFSSolid"!==o||i.push({type:"CIMSolidFill",enable:!0,color:oe(r)});return n}static fromSimpleLineSymbol(e){const{cap:t,color:r,join:o,marker:a,miterLimit:s,style:i,width:n}=e;let l=null;"solid"!==i&&"none"!==i&&"esriSLSSolid"!==i&&"esriSLSNull"!==i&&(l=[{type:"CIMGeometricEffectDashes",dashTemplate:ne(i,t),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const c=[];if(a){let e;switch(a.placement){case"begin-end":e=o$h.Both;break;case"begin":e=o$h.JustBegin;break;case"end":e=o$h.JustEnd;break;default:e=o$h.None;}const t=K.fromSimpleMarker(a,n,r).symbolLayers[0];t.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:e,offsetAlongLine:0},c.push(t);}return c.push({type:"CIMSolidStroke",color:"none"!==i&&"esriSLSNull"!==i?oe(r):[0,0,0,0],capStyle:Z$2(t),joinStyle:ee$1(o),miterLimit:s,width:n,effects:l}),{type:"CIMLineSymbol",symbolLayers:c}}static fromPictureMarker(e){const{angle:t,height:r,width:o,xoffset:a,yoffset:s}=e;let i=e.url;return "esriPMS"===e.type&&e.imageData&&(i=e.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:ie$1.Picture,tintColor:null,url:i,size:r,width:o,offsetX:I$5(a),offsetY:I$5(s),rotation:I$5(-t)}]}}static createCIMTextSymbolfromTextSymbol(t){const{angle:r,color:o,font:a,haloColor:s,haloSize:i,horizontalAlignment:n,kerning:l,text:c,verticalAlignment:m,xoffset:f,yoffset:y,backgroundColor:h,borderLineColor:u,borderLineSize:p}=t;let M,S,d,L,z,D;a&&(M=a.family,S=a.style,d=a.weight,L=a.size,z=a.decoration);let E=!1;if(c){E=i$b(c)[1];}return (h||p)&&(D={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:oe(h)},{type:"CIMSolidStroke",color:oe(u),width:p}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMTextSymbol",angle:r,blockProgression:C$7.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:l$l.Normal,fontEncoding:a$m.Unicode,fontFamilyName:M||"Arial",fontStyleName:ae(S,d),fontType:u$i.Unspecified,haloSize:i,height:L,hinting:y$8.Default,horizontalAlignment:te$1(n??"center"),kerning:l,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:I$5(f),offsetY:I$5(y),strikethrough:"line-through"===z,underline:"underline"===z,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:oe(o)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:oe(s)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:E?ne$1.RTL:ne$1.LTR,verticalAlignment:re(m??"baseline"),verticalGlyphOrientation:oe$1.Right,wordSpacing:100,billboardMode3D:m$e.FaceNearPlane,callout:D}}static createPictureMarkerRasterizationParam(e){const{angle:t,height:r,width:o,xoffset:a,yoffset:s}=e,i=e.url??e.source?.url??e.source?.imageData;return i?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:ie$1.Picture,tintColor:null,url:i,size:r,width:o,offsetX:I$5(a),offsetY:I$5(s),rotation:I$5(-t)}}:null}static createPictureFillRasterizationParam(e){const{width:t,height:r,xoffset:o,yoffset:a,url:s}=e;return s?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureFill",scaleX:1,textureFilter:ie$1.Picture,tintColor:null,url:s,width:t,height:r,offsetX:I$5(o),offsetY:I$5(a),rotation:0}}:null}static fromSimpleMarker(e,t,r){const{style:o}=e,a=e.color??r;if("path"===o||"esriSMSPath"===o){const t=[];if("outline"in e&&e.outline){const r=e.outline;t.push({type:"CIMSolidStroke",enable:!0,width:r.width,color:oe(r.color),path:e.path});}t.push({type:"CIMSolidFill",enable:!0,color:oe(a),path:e.path});const[r,o]=ce("square");return {type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:-I$5(e.angle),size:I$5(e.size||6),offsetX:I$5(e.xoffset),offsetY:I$5(e.yoffset),scaleSymbolsProportionally:!1,frame:r,markerGraphics:[{type:"CIMMarkerGraphic",geometry:o,symbol:{type:"CIMPolygonSymbol",symbolLayers:t}}]}]}}const s=[];let i,n,l=e.size;if("outline"in e&&e.outline&&"none"!==e.outline.style&&"esriSLSNull"!==e.outline.style){const t=e.outline,r="solid"!==t.style&&"esriSLSSolid"!==t.style;[i,n]=r?ce(o,e.size):ce(o);const a=t.width??u$j.width;if(r){const t=a/e.size,r=(i.xmax-i.xmin)*t/2,o=(i.ymax-i.ymin)*t/2;i.xmin-=r,i.xmax+=r,i.ymin-=o,i.ymax+=o,l&&(l+=a);}const c="cross"!==e.style&&"x"!==e.style||"dot"===e?.outline.style||"short-dot"===e?.outline.style?k$6.HalfGap:k$6.FullPattern,m=r?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:ne(t.style,null).map((e=>t.width&&t.width>0?e*t.width:e)),lineDashEnding:c,controlPointEnding:k$6.FullPattern}]:void 0;s.push({type:"CIMSolidStroke",capStyle:r?U$3.Round:U$3.Butt,enable:!0,width:a,color:oe(t.color),effects:m});}else !t||"line-marker"!==e.type||"cross"!==e.style&&"x"!==e.style?[i,n]=ce(o):([i,n]=ce(o),s.push({type:"CIMSolidStroke",enable:!0,width:t,color:oe(a)}));s.push({type:"CIMSolidFill",enable:!0,color:oe(a)});const c={type:"CIMPolygonSymbol",symbolLayers:s};return {type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:I$5(-e.angle),size:I$5(l||6*t),offsetX:I$5(e.xoffset),offsetY:I$5(e.yoffset),scaleSymbolsProportionally:!1,frame:i,markerGraphics:[{type:"CIMMarkerGraphic",geometry:n,symbol:c}]}]}}static fromCIMHatchFill(e,r){const o=r*(e.separation??t$k.CIMHatchFill.separation),a=o/2,s=a$i(e.lineSymbol);s.symbolLayers?.forEach((e=>{switch(e.type){case"CIMSolidStroke":null!=e.width&&(e.width*=r),e.effects?.forEach((e=>{if("CIMGeometricEffectDashes"===e.type){const t=e.dashTemplate;e.dashTemplate=t.map((e=>e*r));}}));break;case"CIMVectorMarker":{null!=e.size&&(e.size*=r);const t=e.markerPlacement;null!=t&&"placementTemplate"in t&&(t.placementTemplate=t.placementTemplate.map((e=>e*r)));break}}}));let i=this._getLineSymbolPeriod(s)||_$9;for(;i<_$9;)i*=2;const n=i/2;return {type:"CIMVectorMarker",frame:{xmin:-n,xmax:n,ymin:-a,ymax:a},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-n,0],[n,0]]]},symbol:s}],size:o}}static fetchResources(e,t,r,o=null){return e&&t?(Q$1(e,(e=>{fe(e,t,r),"url"in e&&e.url&&r.push(t.fetchResource(e.url,{signal:o}));})),r):r}static fetchFonts(e,t,r){if(e&&t)if("symbolLayers"in e&&e.symbolLayers){for(const o of e.symbolLayers)if("CIMVectorMarker"===o.type&&o.markerGraphics)for(const e of o.markerGraphics)e?.symbol&&K.fetchFonts(e.symbol,t,r);}else if("CIMTextSymbol"===e.type){const{fontFamilyName:o,fontStyleName:a}=e;if(!o||"calcitewebcoreicons"===o.toLowerCase())return;const{style:s,weight:i}=P$9(a),n=w$a(e),c=new m$f({family:o,style:s,weight:i,decoration:n});r.push(t.loadFont(c).catch((()=>{H$3().error(`Unsupported font ${o} in CIM symbol`);})));}}static _getLineSymbolPeriod(e){if(e){const t=this._getEffectsRepeat(e.effects);if(t)return t;if(e.symbolLayers)for(const r of e.symbolLayers)if(r){const e=this._getEffectsRepeat(r.effects);if(e)return e;switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const e=this._getPlacementRepeat(r.markerPlacement);if(e)return e}}}}return 0}static _getEffectsRepeat(e){if(e)for(const t of e)if(t)switch(t.type){case"CIMGeometricEffectDashes":{const e=t.dashTemplate;if(e&&e.length){let t=0;for(const r of e)t+=r;return 1&e.length&&(t*=2),t}break}case"CIMGeometricEffectWave":return t.period;default:H$3().error(`unsupported geometric effect type ${t.type}`);}return 0}static _getPlacementRepeat(e){if(e)switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const t=e.placementTemplate;if(t&&t.length){let e=0;for(const r of t)e+=+r;return 1&t.length&&(e*=2),e}break}}return 0}static fromCIMInsidePolygon(e){const t=e.markerPlacement,r={...e};r.markerPlacement=null,r.anchorPoint=null;const s=Math.abs(t.stepX),i=Math.abs(t.stepY),n=(t.randomness??100)/100;let l,c,m,f;if("Random"===t.gridType){const e=e$j(ot$1),r=Math.max(Math.floor(e/s),1),y=Math.max(Math.floor(e/i),1);l=r*s/2,c=y*i/2,m=2*c;const h=new t$i(t.seed),u=n*s/1.5,p=n*i/1.5;f=[];for(let t=0;t<r;t++)for(let e=0;e<y;e++){const r=t*s-l+u*(.5-h.getFloat()),o=e*i-c+p*(.5-h.getFloat());f.push({x:r,y:o}),0===t&&f.push({x:r+2*l,y:o}),0===e&&f.push({x:r,y:o+2*c});}}else !0===t.shiftOddRows?(l=s/2,c=i,m=2*i,f=[{x:-l,y:0},{x:l,y:0},{x:0,y:c},{x:0,y:-c}]):(l=s/2,c=i/2,m=i,f=[{x:-s,y:0},{x:0,y:-i},{x:-s,y:-i},{x:0,y:0},{x:s,y:0},{x:0,y:i},{x:s,y:i},{x:-s,y:i},{x:s,y:-i}]);return {type:"CIMVectorMarker",frame:{xmin:-l,xmax:l,ymin:-c,ymax:c},markerGraphics:f.map((e=>({type:"CIMMarkerGraphic",geometry:e,symbol:{type:"CIMPointSymbol",symbolLayers:[r]}}))),size:m}}};function Q$1(e,t){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const r=e.symbolLayers;if(!r)return;for(const e of r)if(t(e),"CIMVectorMarker"===e.type){const r=e.markerGraphics;if(!r)continue;for(const e of r)if(e){const r=e.symbol;r&&Q$1(r,t);}}break}}}const Z$2=e=>{if(!e)return U$3.Butt;switch(e){case"butt":return U$3.Butt;case"square":return U$3.Square;case"round":return U$3.Round}},ee$1=e=>{if(!e)return w$9.Miter;switch(e){case"miter":return w$9.Miter;case"round":return w$9.Round;case"bevel":return w$9.Bevel}},te$1=e=>{if(null==e)return "Center";switch(e){case"left":return "Left";case"right":return "Right";case"center":return "Center"}},re=e=>{if(null==e)return "Center";switch(e){case"baseline":return "Baseline";case"top":return "Top";case"middle":return "Center";case"bottom":return "Bottom"}},oe=e=>{if(!e)return [0,0,0,0];const{r:t,g:r,b:o,a}=e;return [t,r,o,255*a]},ae=(e,t)=>{const r=se$1(t),o=ie(e);return r&&o?`${r}-${o}`:`${r}${o}`},se$1=e=>{if(!e)return "";switch(e.toLowerCase()){case"bold":case"bolder":return "bold"}return ""},ie=e=>{if(!e)return "";switch(e.toLowerCase()){case"italic":case"oblique":return "italic"}return ""},ne=(e,t)=>{const r=has("safari")?.001:0,o="butt"===t;switch(e){case"dash":case"esriSLSDash":return o?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return o?[4,3,1,3]:[3,4,r,4];case"dot":case"esriSLSDot":return o?[1,3]:[r,4];case"long-dash":case"esriSLSLongDash":return o?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return o?[8,3,1,3]:[7,4,r,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return o?[8,3,1,3,1,3]:[7,4,r,4,r,4];case"short-dash":case"esriSLSShortDash":return o?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return o?[4,1,1,1]:[3,2,r,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return o?[4,1,1,1,1,1]:[3,2,r,2,r,2];case"short-dot":case"esriSLSShortDot":return o?[1,1]:[r,2];case"solid":case"esriSLSSolid":case"none":return H$3().error("Unexpected: style does not require rasterization"),[0,0];default:return H$3().error(`Tried to rasterize SLS, but found an unexpected style: ${e}!`),[0,0]}};function le(e){return void 0!==e.symbolLayers}const ce=(e,t=100)=>{const r=t/2;let o,a;const s=e;if("circle"===s||"esriSMSCircle"===s){const e=.25;let t=Math.acos(1-e/r),s=Math.ceil(X$1/t/4);0===s&&(s=1),t=V$1/s,s*=4;const i=[];i.push([r,0]);for(let o=1;o<s;o++)i.push([r*Math.cos(o*t),-r*Math.sin(o*t)]);i.push([r,0]),o={rings:[i]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};}else if("cross"===s||"esriSMSCross"===s){const e=0;o={paths:[[[e,r],[e,-r]],[[r,e],[-r,e]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};}else if("diamond"===s||"esriSMSDiamond"===s)o={rings:[[[-r,0],[0,r],[r,0],[0,-r],[-r,0]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("square"===s||"esriSMSSquare"===s)o={rings:[[[-r,-r],[-r,r],[r,r],[r,-r],[-r,-r]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("x"===s||"esriSMSX"===s)o={paths:[[[r,r],[-r,-r]],[[r,-r],[-r,r]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("triangle"===s||"esriSMSTriangle"===s){const e=t*.5773502691896257,r=-e,s=2/3*t,i=s-t;o={rings:[[[r,i],[0,s],[e,i],[r,i]]]},a={xmin:r,ymin:i,xmax:e,ymax:s};}else "arrow"===s&&(o={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r});return [a,o]},me=e=>"vertical"===e||"horizontal"===e||"cross"===e||"esriSFSCross"===e||"esriSFSVertical"===e||"esriSFSHorizontal"===e;function fe(e,t,r){if(!e.effects||null!=t.geometryEngine)return;if(t.geometryEnginePromise)return void r.push(t.geometryEnginePromise);d$d(e.effects)&&(t.geometryEnginePromise=k$7(),r.push(t.geometryEnginePromise),t.geometryEnginePromise.then((e=>t.geometryEngine=e)));}function ye(e){if(!e)return null;let t=null;const{cap:r,color:o,join:a,miterLimit:s,style:i,width:n}=e;return "solid"!==i&&"none"!==i&&"esriSLSSolid"!==i&&"esriSLSNull"!==i&&(t=[{type:"CIMGeometricEffectDashes",dashTemplate:ne(i,r),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:"esriSLSNull"!==i&&"none"!==i?oe(o):[0,0,0,0],capStyle:Z$2(r),joinStyle:ee$1(a),miterLimit:s,width:n,effects:t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const n$c=96/72;let l$9 = class l{static executeEffects(t,e,l,c){const f=n$c,m=$(t);let p=new s$k(e);for(const o of t){const t=A$5(o);t&&(p=t.execute(p,o,f,l,c,m));}return p}static applyEffects(n,l,c){if(!n)return l;const f=$(n);let m,p=new s$k(a$d.fromJSONCIM(l));for(const t of n){const e=A$5(t);e&&(p=e.execute(p,t,1,null,c,f));}const u=[];let i=null;for(;m=p.next();)u.push(...t$h(m)),i=m.geometryType;return 0===u.length||null===i?null:"esriGeometryPolygon"===i?{rings:u}:{paths:u}}};

let n$b=null;function t$6(){return n$b}async function e$6(){n$b=await __vitePreload(() => import('./geometryEngineJSON-C9nf8Xyv.js').then(n => n.g),true?__vite__mapDeps([0,1,2,3,4,5]):void 0,import.meta.url);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function s$b(t){switch(t){case C$8.BYTE:case C$8.UNSIGNED_BYTE:return 1;case C$8.SHORT:case C$8.UNSIGNED_SHORT:return 2;case C$8.FLOAT:case C$8.INT:case C$8.UNSIGNED_INT:return 4}}function o$a(t){const e=[],o=[],n=[];for(const i of t){const t=s$b(i.type)*i.count;switch(t%2||t%4||4){case 4:e.push(i);continue;case 2:o.push(i);continue;case 1:n.push(i);continue;default:throw new Error("Found unexpected dataType byte count")}}return e.push(...o),e.push(...n),e}let n$a = class n{static fromVertexSpec({attributes:t},e){let i,a,r;const c=[];for(const s in t){const o=t[s];!1!==e?.[s]&&("position"===o.pack?i={...o,name:s,offset:0}:"id"===o.pack?a={...o,name:s,offset:4}:"bitset"===s?r={...o,name:s,offset:7}:c.push({...o,name:s}));}const u=o$a(c),p=[];let h=8,f=1;for(const o of u)p.push({...o,offset:h}),h+=s$b(o.type)*o.count,o.packAlternating&&(f=Math.max(o.packAlternating.count,f));const m=Uint32Array.BYTES_PER_ELEMENT,b=h%m;return new n(i,a,r,p,h+(b?m-b:0),f)}constructor(t,e,s,o,n,i){this.position=t,this.id=e,this.bitset=s,this.standardAttributes=o,this.stride=n,this.packVertexCount=i,o.push(s),this._attributes=[t,e,s,...o];}get attributeLayout(){if(!this._attributeLayout){const e=t$l(this._attributes),s=this._attributes.map((t=>({name:t.name,count:t.count,offset:t.offset,type:t.type,packPrecisionFactor:t.packPrecisionFactor,normalized:t.normalized??!1})));this._attributeLayout={attributes:s,hash:e,stride:this.stride};}return this._attributeLayout}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let i$8 = class i{static fromVertexSpec(t,s){const c=n$a.fromVertexSpec(t,s);return new i(c)}constructor(t){this._spec=t,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer);}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(t,e,s,i,c,a){for(let p=0;p<this._spec.packVertexCount;p++){const t=p*this._spec.stride;this._packPosition(s,i,t),this._packId(e,t);const r=this._spec.bitset;if(a){if(r.packTessellation){const e=r.packTessellation(a,c);this._pack(e,r,t);}for(const e of this._spec.standardAttributes)if(null!=e.packTessellation){const s=e.packTessellation(a,c);this._pack(s,e,t);}else if(e.packAlternating?.packTessellation){const t=e.packAlternating.packTessellation(a,c);for(let s=0;s<this._spec.packVertexCount;s++){const i=t[s];this._pack(i,e,s*this._spec.stride);}}}}t.vertexWriteRegion(this._packedU32View);}pack(t,e){for(const s of this._spec.standardAttributes)if(s.pack&&"string"!=typeof s.pack){const i=s.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++)this._pack(i,s,t*this._spec.stride);}else if(s.packAlternating?.pack){const i=s.packAlternating.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++){const e=i[t];this._pack(e,s,t*this._spec.stride);}}}_packPosition(e,s,i){const{offset:c}=this._spec.position,a=this._spec.position.packPrecisionFactor??1,p=w$b(e*a,s*a);this._dataView.setUint32(i+c,p,!0);}_packId(t,e){const s=t*(this._spec.id.packPrecisionFactor??1),i=4278190080&this._dataView.getUint32(e+this._spec.id.offset,!0);this._dataView.setUint32(e+this._spec.id.offset,s|i,!0);}_pack(t,e,i){e$l(this._dataView,t,e,i);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function i$7(e){if(!e)return !1;for(const t of e)switch(t.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return !0}return !1}let o$9 = class o{constructor(e,t,r,s){this._instanceId=e,this._evaluator=t,this._viewParams=r,this._optionalAttributes=s,this._evaluator.evaluator=e=>this.vertexSpec.createComputedParams(e);}get _vertexPack(){if(!this._cachedVertexPack){const e=i$8.fromVertexSpec(this.vertexSpec,this._optionalAttributes);this._evaluator.hasDynamicProperties||e.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=e;}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return !!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(e){this._references=e;}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){i$7(this._evaluator.inputMeshParams.params.effects?.effectInfos)&&await e$6();}enqueueRequest(e,t,r){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(e,t,r);}write(r,a,i,o,c){this.ensurePacked(a,i,o);const n=this.evaluatedMeshParams.effects;if(!n||0===n.length)return void this._write(r,i,void 0,c);const u=i.readGeometryForDisplay()?.clone();if(!u)return;const h=a$d.fromOptimizedCIM(u,i.geometryType),f=t$6();h.invertY();const m=r.id||"",l=l$9.executeEffects(n,h,m,f);let v;for(;v=l.next();)v.invertY(),this._write(r,i,v,c);}ensurePacked(e,t,r){if(!this._evaluator.hasDynamicProperties)return;const s=this._evaluator.evaluateMeshParams(e,t,r);this._vertexPack.pack(s,this._viewParams);}_writeVertex(e,t,r,s,a){const i=this.evaluatedMeshParams;this._vertexPack.writeVertex(e,t,r,s,i,a);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const o$8=100,n$9=has("featurelayer-fast-triangulation-enabled");let a$7 = class a extends o$9{async loadDependencies(){await Promise.all([super.loadDependencies(),i$p()]);}_write(e,t,r){const s=r?.asOptimized()??t.readGeometryForDisplay(),i=this._clip(s);i&&(e.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(e,t,i),e.recordEnd());}_clip(e){if(!e)return null;const r=this.hasEffects;return d$b(e,r?256:8)}_writeGeometry(e,t,i){const a=i.maxLength>o$8,c=[],l=this.createTesselationParams(t);if(!a&&n$9&&a$e(c,i))return void(c.length&&this._writeVertices(e,t,i.coords,l,c));const d=p$d(i);this._writeVertices(e,t,d,l);}_writeVertices(e,t,r,s,i){const o=t.getDisplayId(),n=e.vertexCount(),a=this.hasEffects;let c=0;if(i)for(const l of i){const t=r[2*l],i=r[2*l+1];a&&e.recordBounds(t,i,0,0),this._writeVertex(e,o,t,i,s),c++;}else for(let l=0;l<r.length;l+=2){const t=Math.round(r[l]),i=Math.round(r[l+1]);a&&e.recordBounds(t,i,0,0),this._writeVertex(e,o,t,i,s),c++;}e.indexEnsureSize(c);for(let l=0;l<c;l++)e.indexWrite(l+n);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const r$5={createComputedParams:e=>e,attributes:{id:{type:C$8.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:C$8.UNSIGNED_BYTE,count:1},pos:{type:C$8.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:C$8.FLOAT,count:1,packTessellation:({inverseArea:e})=>e}}};let s$a = class s extends a$7{constructor(){super(...arguments),this.vertexSpec=r$5;}createTesselationParams(e){return {inverseArea:1/e.readGeometryArea()}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const i$6=()=>s$p.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils"),u$6=0,a$6=100;function m$7(r,e){return [!!r?.minScale&&e.scaleToZoom(r.minScale)||u$6,!!r?.maxScale&&e.scaleToZoom(r.maxScale)||a$6]}function f$a(r){return 1<<r}function l$8(r){let e=0;for(const[t,n]of r)n&&(e|=1<<t);return e}function h$c(t){let n;if(!t)return [0,0,0,0];if("string"==typeof t){const o=u$k.fromString(t);if(!o)return i$6().errorOnce(new s$r("mapview:mesh-processing","Unable to parse string into color",{color:t})),[0,0,0,0];n=o.toArray();}else n=t;const[o,c,s,u]=n;return [o*(u/255),c*(u/255),s*(u/255),u]}function g$8(r){switch(r){case"butt":case U$3.Butt:return e$m.BUTT;case"round":case U$3.Round:return e$m.ROUND;case"square":case U$3.Square:return e$m.SQUARE}}function p$8(r){switch(r){case"bevel":case w$9.Bevel:return n$w.BEVEL;case"miter":case w$9.Miter:return n$w.MITER;case"round":case w$9.Round:return n$w.ROUND}}function d$7(r,e){return Math.round(Math.min(Math.sqrt(r*e),255))}function M$3(r,e){return Math.round(r*e)/e}function S$7(r,e){return Math.ceil(r*e)/e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const c$5={createComputedParams:t=>t,attributes:{id:{type:C$8.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:C$8.UNSIGNED_BYTE,count:1},pos:{type:C$8.SHORT,count:2,pack:"position",packPrecisionFactor:10},zoomRange:{type:C$8.SHORT,count:2,packPrecisionFactor:at$1,pack:({scaleInfo:t},{tileInfo:o})=>m$7(t,o)},color:{type:C$8.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>h$c(t)}}};let i$5 = class i extends a$7{constructor(){super(...arguments),this.vertexSpec=c$5;}createTesselationParams(t){return null}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const s$9={createComputedParams:t=>t,attributes:{...c$5.attributes,tlbr:{count:4,type:C$8.UNSIGNED_SHORT,pack:({sprite:e})=>{const{rect:r,width:i,height:s}=e,a=r.x+$$2,o=r.y+$$2;return [a,o,a+i,o+s]}},inverseRasterizationScale:{count:1,type:C$8.BYTE,packPrecisionFactor:16,pack:({sprite:t})=>1/t.rasterizationScale}}};let a$5 = class a extends i$5{constructor(){super(...arguments),this.vertexSpec=s$9;}_write(t,e,r){const i=r?.asOptimized()??e.readGeometryForDisplay(),s=this._clip(i);if(!s)return;const a=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,a),this._writeGeometry(t,e,s),t.recordEnd();}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
var i$4;!function(i){i[i.Geographic=0]="Geographic",i[i.Arithmatic=1]="Arithmatic";}(i$4||(i$4={}));const t$5=3.14159265359/180,c$4=3.14159265359/128,o$7=1,h$b=1.1,n$8=1,A$3=24,G$3=8,s$8=1e-5,u$5=.05,k$4=1e-30,q$5=4,B$4=0,C$2=2,D$3=5,E$3=6,F$5=2,H$2=3,I$4=0,J$1=3,K$2=16777216;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function l$7(e){const{sprite:o,aspectRatio:r,scaleProportionally:s}=e,i=u$h(e.height),n=i>0?i:o.height;let c=i*r;return c<=0?c=o.width:s&&(c*=o.width/o.height),{width:c,height:n}}function m$6(t){const{applyRandomOffset:e,sampleAlphaOnly:r}=t,{width:i,height:n}=l$7(t);return l$8([[C$2,e],[q$5,r],[E$3,i<r$p],[D$3,n<r$p]])}function f$9(t){const{width:e}=l$7(t);return Math.round(e<r$p?e*l$n:e)}function d$6(t){const{height:e}=l$7(t);return Math.round(e<r$p?e*l$n:e)}const g$7={createComputedParams:t=>t,attributes:{...s$9.attributes,bitset:{count:1,type:C$8.UNSIGNED_BYTE,pack:m$6},width:{count:1,type:C$8.UNSIGNED_SHORT,pack:f$9},height:{count:1,type:C$8.UNSIGNED_SHORT,pack:d$6},offset:{count:2,type:C$8.SHORT,pack:({offsetX:e,offsetY:o})=>[u$h(e),-u$h(o)]},scale:{count:2,type:C$8.UNSIGNED_BYTE,packPrecisionFactor:16,pack:({scaleX:t,scaleY:e})=>[t,e]},angle:{count:1,type:C$8.UNSIGNED_BYTE,pack:({angle:t})=>l$m(t)}}};let y$3 = class y extends a$5{constructor(){super(...arguments),this.vertexSpec=g$7;}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let f$8 = class f{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0;}};const _$8={createComputedParams:t=>t,attributes:{id:{type:C$8.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:C$8.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:C$8.UNSIGNED_BYTE,count:1},zoomRange:{type:C$8.SHORT,count:2,packPrecisionFactor:at$1,pack:({scaleInfo:t},{tileInfo:e})=>m$7(t,e)},color:{type:C$8.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>h$c(t)},offset:{type:C$8.BYTE,count:2,packPrecisionFactor:16,packTessellation:({extrusionOffsetX:t,extrusionOffsetY:e})=>[M$3(t,16),M$3(e,16)]},normal:{type:C$8.BYTE,count:2,packPrecisionFactor:16,packTessellation:({normalX:t,normalY:e})=>[M$3(t,16),M$3(e,16)]},halfWidth:{type:C$8.UNSIGNED_SHORT,count:1,packPrecisionFactor:16,pack:({width:e})=>S$7(u$h(.5*e),16)},referenceHalfWidth:{type:C$8.UNSIGNED_SHORT,count:1,packPrecisionFactor:16,pack:({referenceWidth:e})=>S$7(u$h(.5*e),16)}}};let x$6 = class x{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0;}};const T$3=65535;let w$5 = class w extends o$9{constructor(t,e,s,i){super(t,e,s,i),this.vertexSpec=_$8,this._currentWrite=new x$6,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:T$3,textured:!1},this._tessParams=new f$8,this._initializeTessellator();}writeLineVertices(t,e,s){const i=this._getLines(e);null!=i&&this._writeVertices(t,s,i);}_initializeTessellator(){this._lineTessellator=new c$d(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0);}_write(t,s,i){const r=i??a$d.fromFeatureSetReaderCIM(s);r&&this._writeGeometry(t,s,r);}_writeGeometry(t,e,s,i){t.recordStart(this.instanceId,this.attributeLayout,i),this.writeLineVertices(t,s,e),t.recordEnd();}_getLines(t){return x$9(t,r$q(this.evaluatedMeshParams))}_writeVertices(e,s,r){const{_currentWrite:o,_tessellationOptions:n,evaluatedMeshParams:a}=this,{width:c,capType:h,joinType:u,miterLimit:p,hasSizeVV:d}=a,f=u$h(.5*c);n.halfWidth=f,n.capType=g$8(h),n.joinType=p$8(u),n.miterLimit=p;const _=!d;o.out=e,o.id=s.getDisplayId(),o.vertexCount=0,o.indexCount=0,o.vertexFrom=e.vertexCount(),o.vertexBounds=_&&f<S$a?0:1;for(const{line:t,start:i}of r)n.initialDistance=i%T$3,this._lineTessellator.tessellate(t,n,_);}_writeTesselatedVertex(t,e,s,i,r,o,n,a,c,h,l){const{out:m,id:u,vertexBounds:p}=this._currentWrite;return this.hasEffects&&m.recordBounds(t,e,p,p),this._tessParams.extrusionOffsetX=n,this._tessParams.extrusionOffsetY=a,this._tessParams.normalX=c,this._tessParams.normalY=h,this._tessParams.directionX=r,this._tessParams.directionY=o,this._tessParams.distance=l,this._writeVertex(m,u,t,e,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(t,e,s){const{out:i}=this._currentWrite;i.indexEnsureSize(3),i.indexWrite(t),i.indexWrite(e),i.indexWrite(s),this._currentWrite.indexCount+=3;}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const l$6={createComputedParams:e=>e,attributes:{..._$8.attributes,bitset:{type:C$8.UNSIGNED_BYTE,count:1,pack:e=>0},color:{type:C$8.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:e})=>h$c(e)}}},m$5={createComputedParams:e=>e,attributes:{..._$8.attributes,bitset:{type:C$8.UNSIGNED_BYTE,count:1,pack:e=>l$8([[B$4,!0]])},color:{type:C$8.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:e})=>h$c(e)}}};let p$7 = class p extends w$5{constructor(){super(...arguments),this.vertexSpec=m$5;}};let h$a = class h extends i$5{constructor(e,t,r,s){super(e,t,r,s),this.vertexSpec=l$6,this._lineMeshWriter=this._createOutlineWriter(e,t,r,s);}_createOutlineWriter(e,t,r,s){return new p$7(e,t,r,s)}_write(t,r,s){const i=s?.asOptimized()??r.readGeometryForDisplay(),o=this._clip(i);o&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,r,o),this._lineMeshWriter.writeLineVertices(t,a$d.fromOptimizedCIM(o,"esriGeometryPolyline"),r),t.recordEnd());}_clip(e){return e?d$b(e,r$q(this.evaluatedMeshParams)):null}ensurePacked(e,t,r){super.ensurePacked(e,t,r),this._lineMeshWriter.ensurePacked(e,t,r);}enqueueRequest(e,t,r){super.enqueueRequest(e,t,r),this._lineMeshWriter.enqueueRequest(e,t,r);}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()]);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const s$7=()=>s$p.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");let i$3 = class i{constructor(){this._includedModules=new Map;}include(e,r){if(this._includedModules.has(e)){const t=this._includedModules.get(e);if(t!==r){s$7().error("Trying to include shader module multiple times with different sets of options.");const r=new Set;for(const n of Object.keys(t))t[n]!==e[n]&&r.add(n);for(const n of Object.keys(e))t[n]!==e[n]&&r.add(n);r.forEach((r=>console.error(`  ${r}: current ${t[r]} new ${e[r]}`)));}}else this._includedModules.set(e,r),e(this.builder,r);}};let o$6 = class o extends i$3{constructor(){super(...arguments),this.vertex=new u$4,this.fragment=new u$4,this.attributes=new m$4,this.varyings=new h$9,this.extensions=new l$5,this.constants=new d$5;}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(e,r=!0){const t=this.extensions.generateSource(e),n=this.attributes.generateSource(e),s=this.varyings.generateSource(e),i="vertex"===e?this.vertex:this.fragment,o=i.uniforms.generateSource(),a=i.code.generateSource(),c="vertex"===e?f$7:_$7(r),u=this.constants.generateSource().concat(i.constants.generateSource());return `${r?"#version 300 es":""}\n${t.join("\n")}\n${c}\n${u.join("\n")}\n${o.join("\n")}\n${n.join("\n")}\n${s.join("\n")}\n${a.join("\n")}`}generateBindPass(e){const r=new Map;this.vertex.uniforms.entries.forEach((e=>{const n=e.bind[a$n.Pass];n&&r.set(e.name,n);})),this.fragment.uniforms.entries.forEach((e=>{const n=e.bind[a$n.Pass];n&&r.set(e.name,n);}));const n=Array.from(r.values()),s=n.length;return (r,t)=>{for(let i=0;i<s;++i)n[i](e,r,t);}}generateBindDraw(e){const r=new Map;this.vertex.uniforms.entries.forEach((e=>{const n=e.bind[a$n.Draw];n&&r.set(e.name,n);})),this.fragment.uniforms.entries.forEach((e=>{const n=e.bind[a$n.Draw];n&&r.set(e.name,n);}));const n=Array.from(r.values()),s=n.length;return (r,t,i)=>{for(let o=0;o<s;++o)n[o](e,r,t,i);}}};let a$4 = class a{constructor(){this._entries=new Map;}add(...e){for(const r of e)this._add(r);}get(e){return this._entries.get(e)}_add(r){if(null!=r){if(this._entries.has(r.name)&&!this._entries.get(r.name).equals(r))throw new s$r(`Duplicate uniform name ${r.name} for different uniform type`);this._entries.set(r.name,r);}else s$7().error(`Trying to add null Uniform from ${(new Error).stack}.`);}generateSource(){return Array.from(this._entries.values()).map((e=>null!=e.arraySize?`uniform ${e.type} ${e.name}[${e.arraySize}];`:`uniform ${e.type} ${e.name};`))}get entries(){return Array.from(this._entries.values())}};let c$3 = class c{constructor(){this._entries=new Array;}add(e){this._entries.push(e);}generateSource(){return this._entries}};let u$4 = class u extends i$3{constructor(){super(...arguments),this.uniforms=new a$4,this.code=new c$3,this.constants=new d$5;}get builder(){return this}};let m$4 = class m{constructor(){this._entries=new Array;}add(e,r){this._entries.push([e,r]);}generateSource(e){return "fragment"===e?[]:this._entries.map((e=>`in ${e[1]} ${e[0]};`))}};let h$9 = class h{constructor(){this._entries=new Map;}add(e,r){this._entries.has(e)&&s$s(this._entries.get(e)===r),this._entries.set(e,r);}generateSource(e){const r=new Array;return this._entries.forEach(((t,n)=>r.push("vertex"===e?`out ${t} ${n};`:`in ${t} ${n};`))),r}};let l$5 = class l{constructor(){this._entries=new Set;}add(e){this._entries.add(e);}generateSource(e){const r="vertex"===e?l.ALLOWLIST_VERTEX:l.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((e=>r.includes(e))).map((e=>`#extension ${e} : enable`))}};l$5.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],l$5.ALLOWLIST_VERTEX=[];let d$5 = class d{constructor(){this._entries=new Set;}add(e,r,t){let n="ERROR_CONSTRUCTOR_STRING";switch(r){case"float":n=d._numberToFloatStr(t);break;case"int":n=d._numberToIntStr(t);break;case"bool":n=t.toString();break;case"vec2":n=`vec2(${d._numberToFloatStr(t[0])},                            ${d._numberToFloatStr(t[1])})`;break;case"vec3":n=`vec3(${d._numberToFloatStr(t[0])},                            ${d._numberToFloatStr(t[1])},                            ${d._numberToFloatStr(t[2])})`;break;case"vec4":n=`vec4(${d._numberToFloatStr(t[0])},                            ${d._numberToFloatStr(t[1])},                            ${d._numberToFloatStr(t[2])},                            ${d._numberToFloatStr(t[3])})`;break;case"ivec2":n=`ivec2(${d._numberToIntStr(t[0])},                             ${d._numberToIntStr(t[1])})`;break;case"ivec3":n=`ivec3(${d._numberToIntStr(t[0])},                             ${d._numberToIntStr(t[1])},                             ${d._numberToIntStr(t[2])})`;break;case"ivec4":n=`ivec4(${d._numberToIntStr(t[0])},                             ${d._numberToIntStr(t[1])},                             ${d._numberToIntStr(t[2])},                             ${d._numberToIntStr(t[3])})`;break;case"mat2":case"mat3":case"mat4":n=`${r}(${Array.prototype.map.call(t,(e=>d._numberToFloatStr(e))).join(", ")})`;}return this._entries.add(`const ${r} ${e} = ${n};`),this}static _numberToIntStr(e){return e.toFixed(0)}static _numberToFloatStr(e){return Number.isInteger(e)?e.toFixed(1):e.toString()}generateSource(){return Array.from(this._entries)}};function _$7(e=!0){return `#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif\n${e?"out vec4 fragColor;":""}\n`}const f$7="precision highp float;\nprecision highp sampler2D;";

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function t$4(t){return t.split(" ").map(((t,e)=>e>0?t.charAt(0).toUpperCase()+t.slice(1):t)).join("")}function e$5(t,e){const s=[];for(s.push(e);s.length;){const e=s.pop();if("object"==typeof e&&!t.has(e.uid)){t.add(e.uid);for(const t of e.children)s.push(t);}}}let s$6 = class s{constructor(){this.uid=s.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1;}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(e){return e=t$4(e),this._debugName=e,this.isImplicit&&this.children[0]instanceof s&&this.children[0].setDebugName(e),this}get debugInfo(){return {name:this._debugName??""}}cloneInto(t){t._debugName=this._debugName,t._isMutable=this._isMutable,t.isImplicit=this.isImplicit,t.uid=this.uid;}};function i$2(t){return "object"==typeof t?t.clone():t}s$6.NodeCount=0;let r$4 = class r extends s$6{constructor(){super(...arguments),this.shaderType="primitive-node";}};let n$7 = class n extends s$6{constructor(t){super(),this.child=t,this.shaderType="scope-node";}get children(){return [this.child]}clone(){const t=new n(i$2(this.child));return this.cloneInto(t),t}};let o$5 = class o extends s$6{constructor(t,e,s){super(),this.property=t,this.target=e,this.returnType=s,this.shaderType="property-access-node";}get children(){const t=[this.target];return "string"!=typeof this.property&&t.push(this.property),t}clone(){const t=new o(this.property,i$2(this.target),this.returnType);return this.cloneInto(t),t}};let c$2 = class c extends s$6{constructor(t,e,s){super(),this.condition=t,this.ifTrue=e,this.ifFalse=s,this.shaderType="condition-node";}get children(){return [this.condition,this.ifTrue,this.ifFalse]}clone(){const t=i$2(this.ifTrue),e=this.ifFalse?i$2(this.ifFalse):null,s=new c(this.condition,t,e);return this.cloneInto(s),s}};let u$3 = class u extends s$6{constructor(t,e,s,i){super(),this.captureList=t,this.returnType=e,this.generator=i,this.shaderType="block-node",s&&(this.subgraph=new n$7(s));}get children(){return Object.keys(this.captureList).map((t=>this.captureList[t])).concat(this.subgraph??[])}clone(){const t={};for(const s in this.captureList)t[s]=i$2(this.captureList[s]);const e=new u(t,this.returnType,this.subgraph?i$2(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(e),e}};let p$6 = class p extends s$6{constructor(t,e,s,i,r,n=!1){super(),this.token=t,this._children=e,this.isInfix=s,this.isPropertyAccess=i,this.returnType=r,this.isTernary=n,this.shaderType="function-node";}get children(){return this._children}clone(){const t=new p(this.token,this._children.map(i$2),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(t),t}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
var s$5,l$4,h$8,f$6,a$3,p$5,d$4,w$4,y$2,m$3,v$4,b$5,I$3,x$5;function z$4(t){const n=[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]];for(const e of n)if(e.includes(t))return e.map((t=>et[t]));throw new Error("Unable to find type family")}function D$2(t){return new Proxy(t,{get(n,e){if("constructor"===e)return new Proxy(n.constructor,{construct:(t,n,e)=>D$2(new t(...n))});if(e in n)return n[e];if("string"==typeof e){const n=z$4(t.type);return ft(t,e,n[e.length-1])}}})}function N$1(t){return new Proxy(t,{construct:(t,n,e)=>D$2(new t(...n))})}function P$5(t){return new Proxy(t,{get(n,e){if(e in n)return n[e];if("string"==typeof e){const n=parseInt(e,10);if(!isNaN(n))return ft(t,`[${n}]`,t.elementType.constructor)}}})}function q$4(t){return new Proxy(t,{construct:(t,n,e)=>P$5(new t(...n))})}let B$3 = class B extends Error{};let U=s$5=class extends r$4{constructor(t,n){super(),this.elementType=t,this.size=n,this.children=[],this.type="array";}clone(){const t=new s$5(this.elementType,this.size);return super.cloneInto(t),t}get(t){if("number"==typeof t){const n=new O$1(t);return n.isImplicit=!0,ft(this,n,this.elementType.constructor)}return ft(this,t,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(t,n,e){return bt(this,t,n,e)}glslFindIndex(t,n,e){return It(this,t,n,e)}static ofType(t,n){const e={construct:(e,r)=>new s$5(new t,n)};return new Proxy(s$5,e)}};U.type="array",U=s$5=e$n([q$4],U);let S$6 = class S extends r$4{constructor(){super(...arguments),this.type="sampler2D",this.children=[];}clone(){const t=new S;return t.children=this.children.map(i$2),super.cloneInto(t),t}};S$6.type="sampler2D";let j$5 = class j extends r$4{constructor(t){super(),this.type="float",this.children=[t];}clone(){const t=new j(i$2(this.children[0]));return super.cloneInto(t),t}multiply(t){return Tt(this,"number"==typeof t?K$1(t,j):t)}divide(t){return $t(this,"number"==typeof t?K$1(t,j):t)}add(t){return Ft(this,"number"==typeof t?K$1(t,j):t)}subtract(t){return kt(this,"number"==typeof t?K$1(t,j):t)}};j$5.type="float";let C$1=l$4=class extends r$4{constructor(t,n){super(),this.type="vec2",this.children=[t,n].filter((t=>null!=t));}clone(){const t=new l$4(i$2(this.children[0]),i$2(this.children[1]));return super.cloneInto(t),t}get 0(){return ft(this,"[0]",j$5)}get 1(){return ft(this,"[1]",j$5)}get 2(){throw new B$3}get 3(){throw new B$3}multiply(t){return Tt(this,"number"==typeof t?K$1(t,j$5):t)}divide(t){return $t(this,"number"==typeof t?K$1(t,j$5):t)}add(t){return Ft(this,"number"==typeof t?K$1(t,j$5):t)}subtract(t){return kt(this,"number"==typeof t?K$1(t,j$5):t)}};C$1.type="vec2",C$1=l$4=e$n([N$1],C$1);let G$2=h$8=class extends r$4{constructor(t,n,e){super(),this.type="vec3",this.children=[t,n,e].filter((t=>null!=t));}get 0(){return ft(this,"[0]",j$5)}get 1(){return ft(this,"[1]",j$5)}get 2(){return ft(this,"[2]",j$5)}get 3(){throw new B$3}clone(){const t=new h$8(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]));return super.cloneInto(t),t}multiply(t){return Tt(this,"number"==typeof t?K$1(t,j$5):t)}divide(t){return $t(this,"number"==typeof t?K$1(t,j$5):t)}add(t){return Ft(this,"number"==typeof t?K$1(t,j$5):t)}subtract(t){return kt(this,"number"==typeof t?K$1(t,j$5):t)}};G$2.type="vec3",G$2=h$8=e$n([N$1],G$2);let H$1=f$6=class extends r$4{constructor(t,n,e,r){super(),this.type="vec4",this.children=[t,n,e,r].filter((t=>null!=t));}clone(){const t=new f$6(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]),i$2(this.children[3]));return super.cloneInto(t),t}get 0(){return ft(this,"[0]",j$5)}get 1(){return ft(this,"[1]",j$5)}get 2(){return ft(this,"[2]",j$5)}get 3(){return ft(this,"[3]",j$5)}multiply(t){return Tt(this,"number"==typeof t?K$1(t,j$5):t)}divide(t){return $t(this,"number"==typeof t?K$1(t,j$5):t)}add(t){return Ft(this,"number"==typeof t?K$1(t,j$5):t)}subtract(t){return kt(this,"number"==typeof t?K$1(t,j$5):t)}};H$1.type="vec4",H$1=f$6=e$n([N$1],H$1);let M$2=a$3=class extends r$4{constructor(t){super(),this.type="uint",this.children=[t];}clone(){const t=new a$3(i$2(this.children[0]));return super.cloneInto(t),t}};M$2.type="uint",M$2=a$3=e$n([N$1],M$2);let R$5=p$5=class extends r$4{constructor(t,n){super(),this.type="uvec2",this.children=[t,n].filter((t=>null!=t));}clone(){const t=new p$5(i$2(this.children[0]),i$2(this.children[1]));return super.cloneInto(t),t}};R$5.type="uvec2",R$5=p$5=e$n([N$1],R$5);let A$2=d$4=class extends r$4{constructor(t,n,e){super(),this.type="uvec3",this.children=[t,n,e].filter((t=>null!=t));}clone(){const t=new d$4(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]));return super.cloneInto(t),t}};A$2.type="uvec3",A$2=d$4=e$n([N$1],A$2);let X=w$4=class extends r$4{constructor(t,n,e,r){super(),this.type="uvec4",this.children=[t,n,e,r].filter((t=>null!=t));}clone(){const t=new w$4(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]),i$2(this.children[3]));return super.cloneInto(t),t}};X.type="uvec4",X=w$4=e$n([N$1],X);class Y extends r$4{constructor(t){super(),this.type="bool",this.children=[t];}and(t){return Rt(this,t)}or(t){return Ht(this,t)}clone(){const t=new Y(i$2(this.children[0]));return super.cloneInto(t),t}}Y.type="bool";let _$6=y$2=class extends r$4{constructor(t,n){super(),this.type="bvec2",this.children=[t,n].filter((t=>null!=t));}all(){return Jt(this)}any(){return Kt(this)}clone(){const t=new y$2(i$2(this.children[0]),i$2(this.children[1]));return super.cloneInto(t),t}};_$6.type="bvec2",_$6=y$2=e$n([N$1],_$6);let J=m$3=class extends r$4{constructor(t,n,e){super(),this.type="bvec3",this.children=[t,n,e].filter((t=>null!=t));}all(){return Jt(this)}any(){return Kt(this)}clone(){const t=new m$3(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]));return super.cloneInto(t),t}};function K$1(t,n){if("number"==typeof t){return new n(t)}return t}J.type="bvec3",J=m$3=e$n([N$1],J);let L$1=v$4=class extends r$4{constructor(t,n,e,r){super(),this.type="bvec4",this.children=[t,n,e,r].filter((t=>null!=t));}all(){return Jt(this)}any(){return Kt(this)}clone(){const t=new v$4(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]),i$2(this.children[3]));return super.cloneInto(t),t}};L$1.type="bvec4",L$1=v$4=e$n([N$1],L$1);let O$1 = class O extends r$4{constructor(t){super(),this.type="int",this.children=[t];}multiply(t){return Tt(this,K$1(t,O))}add(t){return Ft(this,K$1(t,O))}subtract(t){return kt(this,K$1(t,O))}divide(t){return $t(this,K$1(t,O))}clone(){const t=new O(i$2(this.children[0]));return super.cloneInto(t),t}};O$1.type="int";let Q=b$5=class extends r$4{constructor(t,n){super(),this.type="ivec2",this.children=[t,n].filter((t=>null!=t));}clone(){const t=new b$5(i$2(this.children[0]),i$2(this.children[1]));return super.cloneInto(t),t}};Q.type="ivec2",Q=b$5=e$n([N$1],Q);let V=I$3=class extends r$4{constructor(t,n,e){super(),this.type="ivec3",this.children=[t,n,e].filter((t=>null!=t));}clone(){const t=new I$3(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]));return super.cloneInto(t),t}};V.type="ivec3",V=I$3=e$n([N$1],V);let W$1=x$5=class extends r$4{constructor(t,n,e,r){super(),this.type="ivec4",this.children=[t,n,e,r].filter((t=>null!=t));}clone(){const t=new x$5(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]),i$2(this.children[3]));return super.cloneInto(t),t}};W$1.type="ivec4",W$1=x$5=e$n([N$1],W$1);let Z$1 = class Z extends r$4{constructor(t,n,e,r){super(),this.type="mat2",this.children=[t,n,e,r];}clone(){const t=new Z(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]),i$2(this.children[3]));return super.cloneInto(t),t}};Z$1.type="mat2";class tt extends r$4{static identity(){return new tt(1,0,0,0,1,0,0,0,1)}static fromRotation(t){const n=Wn(t),e=tn(t);return new tt(e,n,0,yt(n),e,0,0,0,1)}constructor(t,n,e,r,c,i,u,o,s){super(),this.type="mat3",this.children=[t,n,e,r,c,i,u,o,s];}add(t){return Ft(this,t)}multiply(t){return Tt(this,t)}clone(){const t=new tt(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]),i$2(this.children[3]),i$2(this.children[4]),i$2(this.children[5]),i$2(this.children[6]),i$2(this.children[7]),i$2(this.children[8]));return super.cloneInto(t),t}}tt.type="mat3";class nt extends r$4{static identity(){return new nt(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(t,n,e,r,c,i,u,o,s,l,h,f,a,p,d,w){super(),this.type="mat4",this.children=[t,n,e,r,c,i,u,o,s,l,h,f,a,p,d,w];}static fromColumns(t,n,e,r){return new nt(t.x,t.y,t.z,t.w,n.x,n.y,n.z,n.w,e.x,e.y,e.z,e.w,r.x,r.y,r.z,r.w)}multiply(t){return Tt(this,t)}clone(){const t=new nt(i$2(this.children[0]),i$2(this.children[1]),i$2(this.children[2]),i$2(this.children[3]),i$2(this.children[4]),i$2(this.children[5]),i$2(this.children[6]),i$2(this.children[7]),i$2(this.children[8]),i$2(this.children[9]),i$2(this.children[10]),i$2(this.children[11]),i$2(this.children[12]),i$2(this.children[13]),i$2(this.children[14]),i$2(this.children[15]));return super.cloneInto(t),t}}nt.type="mat4";const et={float:j$5,vec2:C$1,vec3:G$2,vec4:H$1,int:O$1,ivec2:Q,ivec3:V,ivec4:W$1,uint:M$2,uvec2:R$5,uvec3:A$2,uvec4:X,bool:Y,bvec2:_$6,bvec3:J,bvec4:L$1},rt=(...t)=>new O$1(...t),ct=(...t)=>new j$5(...t),it=(...t)=>new C$1(...t),ut=(...t)=>new G$2(...t),ot=(...t)=>new H$1(...t),lt=(...t)=>new tt(...t);function ft(t,n,e){const c=new e(new o$5(n,t,e));return c.isImplicit=!0,c}function at(t,n,e,r=null){if(r){const c=new r,i=new r(new p$6(t,[n,e],!0,!1,c));return i.isImplicit=!0,i}if("float"===n.type||"int"===n.type){const r=new e.constructor(new p$6(t,[n,e],!0,!1,e.constructor));return r.isImplicit=!0,r}if(("mat2"===n.type||"mat3"===n.type||"mat4"===n.type)&&"float"!==e.type){const r=new e.constructor(new p$6(t,[n,e],!0,!1,e.constructor));return r.isImplicit=!0,r}const c=new n.constructor(new p$6(t,[n,e],!0,!1,n.constructor));return c.isImplicit=!0,c}function pt(t,n,e=n.constructor){const r=new e(new p$6(t,[n],!1,!1,e));return r.isImplicit=!0,r}function dt(t,n,e,r=n.constructor){const c=new r(new p$6(t,[n,e],!1,!1,r));return c.isImplicit=!0,c}function wt(t,n,e,r,c=n.constructor){const i=new c(new p$6(t,[n,e,r],!1,!1,c));return i.isImplicit=!0,i}function yt(t){return Tt(t,ct(-1))}function mt(t,n,e,r){return new n(new u$3(t,n,e,r))}function bt(t,n,e=0,r=t.size){const c=new O$1(e).setMutable().setDebugName("FindIndexIterator"),i=n(t.get(c)).setDebugName("FindIndexPredicate"),u=mt({iter:c},O$1,i,(({out:t,iter:n,subgraph:e})=>`\n${t} = -1;\n\nfor (; ${n} < ${r}; ${n}++) {\n\n${e.body}\n\n  if (${e.varName}) {\n    ${t} = ${n};\n    break;\n  }\n\n}\n`)).setDebugName("FindIndexBlock");return u}function It(t,n,e=0,r=t.size){const c=mt({array:t},O$1,null,(({out:t,array:c})=>`\n${t} = -1;\nfor (int i = ${e}; i < ${r}; i++) {\n  bool condition;\n  ${n({array:c,i:"i",out:"condition"})}\n  if (condition) {\n    ${t} = i;\n    break;\n  }\n}\n`)).setDebugName("GlslFindIndexBlock");return c}function xt(t,n,e){const r="function"==typeof n?n():n,c="function"==typeof e?e():e,i=new r.constructor(new c$2(t,r,c));return i.isImplicit=!0,i}function gt(...t){const n=t.map((([t,n])=>"function"==typeof n?[t,n()]:[t,n])),e=n[0][1].constructor,r=n.findIndex((t=>!0===t[0]));if(-1===r)throw new Error("A cond must have a fallthrough case with `true`/; ");const c=n.slice(0,r),i=n[r][1],u=new e(c.reduceRight(((t,n)=>xt(n[0],n[1],t)),i));return u.isImplicit=!0,u}function Tt(t,n){return at("*",t,n)}function $t(t,n){return at("/",t,n)}function Ft(t,n){return at("+",t,n)}function kt(t,n){return at("-",t,n)}function Dt(t,n){return at(">>",t,n)}function Nt(t,n){return at("&",t,n)}function Bt(t,n){return at("==",t,n,Y)}function St(t,n){return at("<",t,n,Y)}function jt(t,n){return at("<=",t,n,Y)}function Ct(t,n){return at(">",t,n,Y)}function Gt(t,n){return at(">=",t,n,Y)}function Ht(...t){return t.length<=1?t[0]:t.slice(1).reduce(((t,n)=>Mt(t,n)),t[0])}function Mt(t,n){return at("||",t,n,Y)}function Rt(...t){return t.length<=1?t[0]:t.slice(1).reduce(((t,n)=>At(t,n)),t[0])}function At(t,n){return at("&&",t,n,Y)}function Xt(t){return pt("abs",t)}function Jt(t){return pt("all",t,Y)}function Kt(t){return pt("any",t,Y)}function Wt(t){return pt("ceil",t)}function Zt(t,n,e){return wt("clamp",t,n,e,t.constructor)}function tn(t){return pt("cos",t)}function sn(t,n){return dt("distance",t,n,j$5)}function ln(t,n){return dt("dot",t,n,j$5)}function vn(t){return pt("floor",t)}function bn(t){return pt("fract",t)}function kn(t){return pt("length",t,j$5)}function Bn(t,n){return dt("max",t,n)}function Un(t,n){return dt("min",t,n)}function Sn(t,n,e){return wt("mix",t,n,e)}function jn(t,n){return dt("mod",t,n)}function Gn(t){return pt("normalize",t)}function Hn(t){return "bool"===t.type?pt("!",t):pt("not",t)}function Wn(t){return pt("sin",t)}function te(t,n,e){return wt("smoothstep",t,n,e)}function ee(t,n){return dt("step",t,n,n.constructor)}function se(t,n){return dt("texture2D",t,n,H$1)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const e$4=5;function t$3(e,t,r){const n=t.split("\n");for(const i of n)if(i.trim().length){{let t="";null!=r&&(t+=`/*id:${r??"000"}*/   `),e.body+=t.padEnd(14);}e.body+=" ".repeat(e.indent)+i+"\n";}}let r$3 = class r{write(e){for(const t of e.rootOutputNodes())e.shouldPruneOutputNode(t)||(t.variableName=this._write(e,t.node));return e}_createVarName(e,t){let r="";return "boolean"!=typeof t&&"number"!=typeof t&&t.debugInfo.name&&(r=`${t.debugInfo.name}_`),`${r}v${e.varCount++}`}_write(e,t,r=!1){if("number"==typeof t)return t.toString();if("boolean"==typeof t)return t.toString();let n=e.getEmit(t);if(n)return n;switch(t.shaderType){case"scope-node":n=this._writeScopeNode(e,t);break;case"primitive-node":n=this._writePrimitveNode(e,t,r);break;case"function-node":n=this._writeFunctionNode(e,t);break;case"property-access-node":n=this._writePropertyAccessNode(e,t);break;case"text-node":n=t.text;break;case"block-node":n=this._writeBlockNode(e,t);break;case"condition-node":n=this._writeConditionNode(e,t);}return e.setEmit(t,n),n}_writeScopeNode(e,r){const n=new r.child.constructor;n.setDebugName(r.debugInfo.name);const i=this._write(e,n,!0);t$3(e,`{ /*ScopeStart: ${r.uid} ${r.debugInfo.name}*/`),e.indent+=2;return t$3(e,`${i} = ${this._write(e,r.child)};`),e.indent-=2,t$3(e,`} /*ScopeEnd: ${r.uid} ${r.debugInfo.name}*/`),i}_writeConditionNode(e,r){const n=new r.ifTrue.constructor,i=this._write(e,n,!0);t$3(e,`if (${this._write(e,r.condition)}) {`),e.indent+=2;const o=e.createSubgraphContext(),d=this._write(o,r.ifTrue);if(e.body+=o.body,d&&t$3(e,`${i} = ${d};`),e.indent-=2,t$3(e,"}"),r.ifFalse){t$3(e,"else {"),e.indent+=2;const n=e.createSubgraphContext(),o=this._write(n,r.ifFalse);e.body+=n.body,o&&t$3(e,`${i} = ${o};`),e.indent-=2,t$3(e,"}");}return i}_writeBlockNode(e,r){const{captureList:n,generator:i,returnType:o}=r,d={};for(const t in n){if(!n[t])continue;const r=this._write(e,n[t]);d[t]=r;}const s=new o,c=this._write(e,s,!0);if(d.out=c,r.subgraph){const t=e.createSubgraphContext(),n=this._write(t,r.subgraph.child),i=t.body;d.subgraph={varName:n,body:i};}const a=i(d);return t$3(e,"{\n"),e.indent+=2,t$3(e,a),e.indent-=2,t$3(e,"}\n"),c}_writePropertyAccessNode(e,t){const r=this._write(e,t.target);if("string"==typeof t.property&&t.property.includes("["))return `${r}${t.property}`;if("string"!=typeof t.property){return `${r}[${this._write(e,t.property)}]`}return `${r}.${t.property}`}_writeFunctionNode(r,n){const i=n.returnType.type;if(n.isInfix){const[o,d]=n.children.map((e=>this._write(r,e))),s=this._createVarName(r,n);return t$3(r,`${i.padEnd(e$4)} ${s} = ${o} ${n.token} ${d};`,n.uid),s}const o=n.children.map((e=>this._write(r,e))).join(", "),d=this._createVarName(r,n);return t$3(r,`${i.padEnd(e$4)} ${d} = ${n.token}(${o});`,n.uid),d}_writePrimitveNode(r,n,i=!1){const o=r.getInput(n);if(o)return o.isUsed=!0,o.variableName;const d=1===n.children.length&&n.children[0]?.type===n.type;if(n.isImplicit||d)return this._write(r,n.children[0]);const s=this._createVarName(r,n);if(i)return t$3(r,`${n.type.padEnd(e$4)} ${s};`,n.uid),s;const c=!n.debugInfo.name&&!n.isMutable;if(c&&"float"===n.type&&"number"==typeof n.children[0])return Number.isInteger(n.children[0])?n.children[0].toFixed(1):n.children[0].toString();if(c&&"int"===n.type&&"number"==typeof n.children[0]&&Number.isInteger(n.children[0]))return n.children[0].toString();const a=n.children.map((e=>this._write(r,e))).join(", ");return "array"===n.type?(t$3(r,`${n.type.padEnd(e$4)} ${s} = [${a}];`,n.uid),s):c?`${n.type}(${a})`:(t$3(r,`${n.type.padEnd(e$4)} ${s} = ${n.type}(${a});`,n.uid),s)}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let t$2 = class t{constructor(e,t,n){this.variableName=e,this.variableInputType=t,this.node=n,this.type="shader-input",this.isUsed=!1;}clone(){return new t(this.variableName,this.variableInputType,i$2(this.node))}};let n$6 = class n{constructor(e,t,n){this.outVariableName=e,this.outVariableType=t,this.node=n,this.type="shader-output";}clone(){const t=new n(this.outVariableName,this.outVariableType,i$2(this.node));return t.variableName=this.variableName,t}};let o$4 = class o{static createVertex(e,a,d,i,r,s){const u=[];for(const n in e){const o=e[n],a=d.get(n);a?u.push(new t$2(a,"builtin",o)):u.push(new t$2("a_"+n,"attribute",o));}for(const n of i){const e=n.uniformHydrated;u.push(new t$2(n.uniformName,"uniform",e));}const p=[];for(const t in a){const e=a[t];"glPosition"===t?p.push(new n$6("gl_Position","builtin",e)):"glPointSize"===t?p.push(new n$6("gl_PointSize","builtin",e)):p.push(new n$6("v_"+t,"varying",e));}return new o(u,p,r,s)}static createFragment(e,a,d,i,r,s){const u=[],p=Array.from(r.rootOutputNodes());for(const n in e){const o=e[n],a=d.get(n);if(a){u.push(new t$2(a,"builtin",o));continue}const i=p.find((e=>e.node===o));i&&u.push(new t$2(i.outVariableName,i.outVariableType,o));}for(const n of i){const e=n.uniformHydrated;u.push(new t$2(n.uniformName,"uniform",e));}const h=[];for(const t in a){const e=a[t],o=d.get(t);if("discard"===t)h.push(new n$6(null,"discard",e));else {if(!o)throw new Error(`Member ${t} in shader fragment output shoule be tagged as builtin`);h.push(new n$6(o,"builtin",e));}}return new o(u,h,s)}constructor(e,t,n,o){this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map;for(const a of e)this._inputShaderTypesByNodeUid.set(a.node.uid,a);this._outputShaderTypes=t,this._transformFeedbackBindings=n,this._transformFeedbackNames=new Set(n.map((e=>"v_"+e.propertyKey))),this._usedInFragmentShader=o;}shouldPruneOutputNode(e){return !!this._usedInFragmentShader&&("builtin"!==e.outVariableType&&(!this._transformFeedbackNames.has(e.outVariableName)&&!this._usedInFragmentShader.has(e.node.uid)))}setEmit(e,t){this._nodeEmitMap.set(e.uid,t);}getEmit(e){return this._nodeEmitMap.get(e.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(e){return this._inputShaderTypesByNodeUid.get(e.uid)}*rootOutputNodes(){for(const e of this._outputShaderTypes)yield e;}*nodes(){const e=[];for(const t of this._outputShaderTypes.values())e.push(t.node);for(;e.length;){const t=e.pop();"number"!=typeof t&&"boolean"!=typeof t&&e.push(...t.children.filter(Boolean)),yield t;}}*nodesOfTypeOrFunction(){for(const e of this.nodes())"number"!=typeof e&&"boolean"!=typeof e&&(yield e);}createSubgraphContext(){const e=this.clone();return e.body="",e.indent=this.indent+2,e._nodeEmitMap=new Map(this._nodeEmitMap),e}clone(){const e=new o([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return e._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,e.indent=this.indent,e.body=this.body,e.varCount=this.varCount,e._nodeEmitMap=this._nodeEmitMap,e}insertVertexShader(e){e.vertex.code.add(""),this._insertInputs(e,"vertex"),e.vertex.code.add(""),e.vertex.code.add("// OUTPUTS: "),e.vertex.code.add("// --------------------------------------------------------- ");for(const t of this.rootOutputNodes()){const n="builtin"===t.outVariableType;this.shouldPruneOutputNode(t)||(n?e.vertex.code.add(`// ${t.outVariableType.padEnd(7)} ${t.node.type.padEnd(9)} ${t.outVariableName};`):e.vertex.code.add(`${t.outVariableType.padEnd(10)} ${t.node.type.padEnd(9)} ${t.outVariableName};`));}e.vertex.code.add(""),e.vertex.code.add("void main() {"),e.vertex.code.add("  "+this.body.split("\n").join("\n  "));for(const t of this.rootOutputNodes())this.shouldPruneOutputNode(t)||e.vertex.code.add(`  ${t.outVariableName} = ${t.variableName};`);e.vertex.code.add("}");}insertFragmentShader(e){this._insertInputs(e,"fragment"),e.fragment.code.add(""),e.fragment.code.add("void main() {"),e.fragment.code.add("  "+this.body.split("\n").join("\n  "));for(const t of this.rootOutputNodes())"discard"===t.outVariableType?(e.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),e.fragment.code.add(`  if (${t.variableName}) {`),e.fragment.code.add("    discard;"),e.fragment.code.add("  }"),e.fragment.code.add("  ")):e.fragment.code.add(`  ${t.outVariableName} = ${t.variableName};`);e.fragment.code.add("}");}_insertInputs(e,t){e[t].code.add("// INPUTS: "),e[t].code.add("// --------------------------------------------------------- ");for(const n of this.inputs())n.isUsed&&"builtin"!==n.variableInputType&&("array"===n.node.type?e[t].code.add(`${n.variableInputType.padEnd(10)} ${n.node.elementType.type.padEnd(9)} ${n.variableName}[${n.node.size}];`):e[t].code.add(`${n.variableInputType.padEnd(10)} ${n.node.type.padEnd(9)} ${n.variableName};`));}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const s$4=()=>s$p.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram");function n$5(e,t,o){const i=t.length;if(i!==o){const n=new s$r("Invalid Uniform",`Invalid length, expected ${o} but got ${i}`,{uniformName:e,values:t});s$4().errorOnce(n);}}let a$2 = class a{constructor(r,e,t,o,i,s){this._program=null,this._vao=null,this._temporaryTextures=[],this.vertexShader=r,this.fragmentShader=e,this._locations=t,this._locationInfo=o,this._uniformBindings=i,this._transformFeedbackBindings=s;}destroy(){this._program&&this._program.dispose(),this.cleanupTemporaryTextures();}get locations(){return this._locations}get locationInfo(){return this._locationInfo}setUniforms(r){this._uniforms=r;}cleanupTemporaryTextures(){for(const r of this._temporaryTextures)r.dispose();this._temporaryTextures=[];}bind(r){const e=this._uniforms;if(!this._program){const e=new Map;for(const[r,o]of this._locations)e.set(r,o);const t=[];for(const r of this._transformFeedbackBindings??[]){const{index:e,propertyKey:o}=r;t[e]=`v_${o}`;}this._program=new r$r(r,this.vertexShader,this.fragmentShader,e,new Map,t);}const s=this._program;r.useProgram(s);for(const o of this._uniformBindings){const{shaderModulePath:a,uniformName:f,uniformType:m,uniformArrayLength:c}=o,l=t$m(a,e);if(null==l){if("sampler2D"===m)continue;throw new Error(`Failed to find uniform value for ${a}`)}switch("array"===m?o.uniformArrayElementType:m){case"sampler2D":{const{unit:e,texture:t}=l;if(s.setUniform1i(f,e),"type"in t)r.bindTexture(t,e);else {const o=T$6(r,t.descriptor,t.data);r.bindTexture(o,e);}break}case"int":if(!c){s.setUniform1i(f,l);break}n$5(o.uniformName,l,c),s.setUniform1iv(f,l);break;case"float":if(!c){s.setUniform1f(f,l);break}n$5(o.uniformName,l,c),s.setUniform1fv(f,l);break;case"vec2":if(!c){s.setUniform2f(f,l[0],l[1]);break}n$5(o.uniformName,l,c),s.setUniform2fv(f,l.flat());break;case"vec3":if(!c){s.setUniform3f(f,l[0],l[1],l[2]);break}n$5(o.uniformName,l,c),s.setUniform3fv(f,l.flat());break;case"vec4":if(!c){s.setUniform4f(f,l[0],l[1],l[2],l[3]);break}n$5(o.uniformName,l,c),s.setUniform4fv(f,l.flat());break;case"mat3":s.setUniformMatrix3fv(f,l.flat());break;case"mat4":s.setUniformMatrix4fv(f,l.flat());break;default:throw new Error(`Unable to set uniform for type ${m}`)}}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function h$7(t){return new t}function f$5(t,e,r){const o=t.constructor[e]??[];t.constructor.hasOwnProperty(e)||Object.defineProperty(t.constructor,e,{value:o.slice()}),t.constructor[e].push(r);}function l$3(t,e){return (r,o)=>{f$5(r,"locations",{typeCtor:e,propertyKey:o,parameterIndex:null,index:t});}}const m$2=t=>(e,r)=>{f$5(e,"builtins",{builtin:t,propertyKey:r});},g$6=t=>(e,r,o)=>{f$5(e,"inputs",{inputCtor:t,propertyKey:r,parameterIndex:o});},_$5=t=>(e,r)=>{f$5(e,"uniforms",{typeCtor:t,propertyKey:r});},K=t=>(e,r)=>{f$5(e,"options",{typeCtor:t,propertyKey:r});},x$4=(t,e)=>{f$5(t,"defines",{propertyKey:e});};const I$2=(t,e)=>(r,o)=>{r.constructor.builtins.push({builtin:t,propertyKey:o,typeCtor:e});};let b$4 = class b{};b$4.builtins=[],e$n([I$2("gl_VertexID",O$1)],b$4.prototype,"glVertexID",void 0);let v$3 = class v{};let w$3 = class w{};w$3.builtins=[],e$n([I$2("gl_FragCoord",H$1)],w$3.prototype,"glFragCoord",void 0),e$n([I$2("gl_PointCoord",C$1)],w$3.prototype,"glPointCoord",void 0);let F$4 = class F{};e$n([m$2("gl_FragColor")],F$4.prototype,"glFragColor",void 0);let P$4 = class P{constructor(){this.type="uniform-group";}get _uniforms(){return this.constructor.uniforms??[]}};let j$4 = class j{constructor(){this.logShader=!1,this.computeAttributes={};}get vertexInput(){const t=f$m(this._shaderModuleClass.inputs,(t=>"vertex"===t.propertyKey&&0===t.parameterIndex));if(!t)throw new Error("Unable to find vertex input parameter");return t}get computeInput(){return f$m(this._shaderModuleClass.inputs,(t=>"vertex"===t.propertyKey&&1===t.parameterIndex))}get fragmentInput(){const t=f$m(this._shaderModuleClass.inputs,(t=>"fragment"===t.propertyKey));if(!t)throw new Error("Unable to find fragment input parameter");return t}get transformFeedbackBindings(){return this.fragmentInput.inputCtor.transformFeedbackBindings??[]}get locations(){return [...this.vertexInput.inputCtor.locations,...this.computeInput?.inputCtor.locations??[]]}get locationsMap(){const t=new Map,e=new Set;for(const o of this.locations)e.has(o.index)?s$p.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering",`Unable to assigned attribute ${o.propertyKey} to ${o.index}. Index already in use`,{locationsMap:t}):(t.set(o.propertyKey,o.index),e.add(o.index));return t}get locationInfo(){if(!this._locationInfo){const t=this.locationsMap,e=Array.from(t.entries()).map((([t,e])=>`${t}.${e}`)).join("."),r=c$e(e);this._locationInfo={hash:r,locations:t};}return this._locationInfo}get renamedLocationsMap(){const t=new Map;for(const e of this.locations)t.set("a_"+e.propertyKey,e.index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){const t=new Set;for(const e of this._options)t.add(e.propertyKey);this._optionPropertyKeys=t;}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){return this._shaderModuleClass.defines??[]}get _options(){return this._shaderModuleClass.options??[]}get _uniforms(){return this._shaderModuleClass.uniforms??[]}getProgram(t,e,r,o){try{const{vertex:n,fragment:s,uniformBindings:i}=this._generateShaders(t,e,r,o);return new a$2(n,s,this.renamedLocationsMap,this.locationInfo,i,this.transformFeedbackBindings)}catch(n){return console.error("Failed to create program",{error:n}),new a$2("","",this.renamedLocationsMap,this.locationInfo,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(t){const e=this._options.find((e=>e.propertyKey===t));if(e)return {type:"option",className:e.typeCtor};const r=this._uniforms.find((e=>e.propertyKey===t));if(!r)throw new Error(`Unable to find uniform class type for property: ${t}`);return {type:"required",className:r.typeCtor}}getShaderKey(t,e,r,o){const n=Object.keys(r).map((t=>`${t}.${r[t]}`)).join("."),s=Object.keys(o).map((t=>`${t}.${o[t]}`)).join("."),i=Object.keys(e).filter((t=>this.optionPropertyKeys.has(t)&&e[t])).join(".");return `${this.constructor.name}.${t.hash}.${n}.${s}.${i}`}_generateShaders(t,e,r,o){const n=[];this._setDefines(r),this._setOptionalUniforms(n,e),this._setRequiredUniforms(n);const s=this._hydrateVertexInput(o),i=this._injectPackPrecisionFactor(s,t),p=this._hydrateComputeInput(),a=p&&this._injectPackPrecisionFactor(p,t),d=this.vertex(i,a),h=this._hydrateFragmentInput(d),f=this.fragment(h),l=new Set;for(const c in f){const t=f[c];e$5(l,t);}const m=this._getVertexInputBuiltins(),g=o$4.createVertex({...s,...p},d,m,n,this.transformFeedbackBindings,l);(new r$3).write(g);const _=this._getFragmentInputBuiltins(f);_.set("glPointCoord","gl_PointCoord");const K=o$4.createFragment(h,f,_,n,g,this.transformFeedbackBindings);(new r$3).write(K);const x=this._createShaderBuilder(g,K),C=x.generate("vertex",!1),I=x.generate("fragment",!1);return this.logShader&&(console.log(C),console.log(I)),{vertex:C,fragment:I,uniformBindings:n}}_setDefines(t){for(const e in t)this[e]=t[e];}_setOptionalUniforms(t,e){for(const r of this._options){e[r.propertyKey]?this[r.propertyKey]=this._hydrateUniformGroup(t,r):this[r.propertyKey]=null;}}_setRequiredUniforms(t){for(const e of this._uniforms)this[e.propertyKey]=this._hydrateUniformGroup(t,e);}_hydrateUniformGroup(t,e){const r=new(e.typeCtor);for(const o of r._uniforms??[]){const n=h$7(o.typeCtor),s=`u_${e.propertyKey}_${o.propertyKey}`,i=n.type,p=[e.propertyKey,o.propertyKey].join(".");if("type"in o.typeCtor&&"array"===o.typeCtor.type){const e=n;t.push({shaderModulePath:p,uniformName:s,uniformType:i,uniformArrayLength:e.size,uniformArrayElementType:e.elementType.type,uniformHydrated:n});}else t.push({shaderModulePath:p,uniformName:s,uniformType:i,uniformHydrated:n});r[o.propertyKey]=n;}return r}_hydrateVertexInput(t){const e=this.vertexInput.inputCtor,r=e.locations.reduce(((e,r)=>!1===t[r.propertyKey]?e:{...e,[r.propertyKey]:h$7(r.typeCtor)}),{});for(const{propertyKey:o,typeCtor:n}of e.builtins){const t=h$7(n);r[o]=t;}return r}_hydrateComputeInput(){if(null==this.computeInput)return null;return this.computeInput.inputCtor.locations.reduce(((t,e)=>({...t,[e.propertyKey]:h$7(e.typeCtor)})),{})}_injectPackPrecisionFactor(t,e){const r={};for(const o in t){const n=t[o],i=e.attributes.find((t=>t.name===o));if(i?.packPrecisionFactor){if("float"!==n.type&&"vec2"!==n.type&&"vec3"!==n.type&&"vec4"!==n.type)throw new Error(`InternalError: packPrecisionFactor requires GenType, but found ${n.type}`);r[o]=n.divide(new j$5(i.packPrecisionFactor));}else r[o]=n;}return r}_hydrateFragmentInput(t){const e={};for(const r in t)e[r]=t[r];for(const{propertyKey:r,typeCtor:o}of w$3.builtins){const t=h$7(o);e[r]=t;}return e}_getVertexInputBuiltins(){const t=this.vertexInput.inputCtor,e=new Map;for(const{builtin:r,propertyKey:o}of t.builtins)e.set(o,r);return e}_getFragmentInputBuiltins(t){const e=t.constructor,r=new Map;for(const o of e.builtins??[])r.set(o.propertyKey,o.builtin);return r}_createShaderBuilder(t,e){const r=new o$6;return this._insertDebugInfo(r),t.insertVertexShader(r),e.insertFragmentShader(r),r}_insertDebugInfo(t){t.vertex.code.add("// DEFINES: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._defines)this[e.propertyKey]?t.vertex.code.add(`//   ${e.propertyKey}: true`):t.vertex.code.add(`//   ${e.propertyKey}: false`);t.vertex.code.add(""),t.vertex.code.add("// OPTIONS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._options)this[e.propertyKey]?t.vertex.code.add(`//   ${e.propertyKey}: true`):t.vertex.code.add(`//   ${e.propertyKey}: false`);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function g$5(t){const e=ct(12.9898),l=ct(78.233),s=ct(43758.5453),f=ln(t,it(e,l)),m=jn(f,ct(3.14));return bn(Wn(m).multiply(s))}function h$6(t){return Bt(t,ct(k$4))}function b$3(t,n){return t.x.multiply(n.y).subtract(n.x.multiply(t.y))}function d$3(t){return t.multiply(2).subtract(1)}function j$3(t,r){const u=ct(2**r);return jn(vn(t.divide(u)),ct(2))}function z$3(t,r){return Ct(j$3(t,r),ct(.5))}function v$2(n,r){return j$3(n,r+l$o.length)}function w$2(t,n){return j$3(t,n)}function R$4(t){const r=j$3(t.z,7),u=ct(1).subtract(r),i=t.xyz.subtract(ut(0,0,ct(128)));return u.multiply(t).add(r.multiply(i))}function k$3(t){const n=ot(255/256,255/65536,255/16777216,255/4294967296);return ln(t,n)}function q$3(t){return Bn(Bn(Bn(t.x,t.y),t.z),t.w)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let p$4 = class p extends P$4{getVisualVariableData(t){if(!this._vvData){const a=this.getAttributeDataCoords(t);this._vvData=se(this.visualVariableData,a).setDebugName("storage2");}return this._vvData}getAttributeDataCoords(t){if(!this._uv){const a=R$4(t),e=this.size,i=rt(a.x),g=rt(a.y).multiply(rt(256)),l=rt(a.z).multiply(rt(256)).multiply(rt(256)),n=ct(i.add(g).add(l)),p=jn(n,e),d=n.subtract(p).divide(e);this._uv=new C$1(p,d).add(.5).divide(e);}return this._uv}getFilterData(t){const a=this.getAttributeDataCoords(t);return se(this.filterFlags,a).setDebugName("storage0")}getAnimationData(t){const a=this.getAttributeDataCoords(t);return se(this.animation,a).setDebugName("storage1")}getVVData(t){return this.getVisualVariableData(t)}getDataDrivenData0(t){const a=this.getAttributeDataCoords(t);return se(this.dataDriven0,a).setDebugName("storage30")}getDataDrivenData1(t){const a=this.getAttributeDataCoords(t);return se(this.dataDriven1,a).setDebugName("storage31")}getDataDrivenData2(t){const a=this.getAttributeDataCoords(t);return se(this.dataDriven2,a).setDebugName("storage32")}getGPGPUData(t){const a=this.getAttributeDataCoords(t);return se(this.gpgpu,a).setDebugName("storage4")}getFilterFlags(t){return has("webgl-ignores-sampler-precision")?Wt(this.getFilterData(t).x.multiply(ct(255))):this.getFilterData(t).x.multiply(ct(255))}getAnimationValue(t){return this.getAnimationData(t).x}getSizeValue(t){return this.getVisualVariableData(t).x}getColorValue(t){return this.getVisualVariableData(t).y}getOpacityValue(t){return this.getVisualVariableData(t).z}getRotationValue(t){return this.getVisualVariableData(t).w}};e$n([_$5(S$6)],p$4.prototype,"filterFlags",void 0),e$n([_$5(S$6)],p$4.prototype,"animation",void 0),e$n([_$5(S$6)],p$4.prototype,"gpgpu",void 0),e$n([_$5(S$6)],p$4.prototype,"visualVariableData",void 0),e$n([_$5(S$6)],p$4.prototype,"dataDriven0",void 0),e$n([_$5(S$6)],p$4.prototype,"dataDriven1",void 0),e$n([_$5(S$6)],p$4.prototype,"dataDriven2",void 0),e$n([_$5(j$5)],p$4.prototype,"size",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let e$3 = class e extends P$4{};e$n([_$5(j$5)],e$3.prototype,"activeReasons",void 0),e$n([_$5(j$5)],e$3.prototype,"highlightAll",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let e$2 = class e extends P$4{};e$n([_$5(C$1)],e$2.prototype,"position",void 0),e$n([_$5(j$5)],e$2.prototype,"distance",void 0),e$n([_$5(j$5)],e$2.prototype,"smallSymbolDistance",void 0),e$n([_$5(j$5)],e$2.prototype,"smallSymbolSizeThreshold",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let d$2 = class d extends P$4{};e$n([_$5(tt)],d$2.prototype,"displayViewScreenMat3",void 0),e$n([_$5(tt)],d$2.prototype,"displayViewMat3",void 0),e$n([_$5(tt)],d$2.prototype,"displayMat3",void 0),e$n([_$5(tt)],d$2.prototype,"viewMat3",void 0),e$n([_$5(tt)],d$2.prototype,"tileMat3",void 0),e$n([_$5(j$5)],d$2.prototype,"displayZoomFactor",void 0),e$n([_$5(j$5)],d$2.prototype,"requiredZoomFactor",void 0),e$n([_$5(C$1)],d$2.prototype,"tileOffset",void 0),e$n([_$5(j$5)],d$2.prototype,"currentScale",void 0),e$n([_$5(j$5)],d$2.prototype,"currentZoom",void 0),e$n([_$5(j$5)],d$2.prototype,"metersPerSRUnit",void 0),e$n([_$5(j$5)],d$2.prototype,"rotation",void 0),e$n([_$5(j$5)],d$2.prototype,"pixelRatio",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let S$5 = class S extends b$4{};e$n([l$3(0,G$2)],S$5.prototype,"id",void 0),e$n([l$3(1,j$5)],S$5.prototype,"bitset",void 0),e$n([l$3(2,C$1)],S$5.prototype,"pos",void 0);let q$2 = class q extends v$3{};e$n([l$3(14,C$1)],q$2.prototype,"nextPos1",void 0),e$n([l$3(15,C$1)],q$2.prototype,"nextPos2",void 0);let F$3 = class F extends w$3{};let P$3 = class P extends j$4{clip(t,i){let e=new j$5(0);const o=this.storage.getFilterFlags(t);if(e=e.add(ct(2).multiply(ct(1).subtract(v$2(o,0)))),this.inside?e=e.add(ct(2).multiply(ct(1).subtract(v$2(o,1)))):this.outside?e=e.add(ct(2).multiply(v$2(o,1))):this.highlight&&(e=e.add(ct(2).multiply(ct(1).subtract(this._checkHighlight(o))))),null!=i){const t=new j$5(1).subtract(ee(i.x,this.view.currentZoom)),o=ee(i.y,this.view.currentZoom);e=e.add(new j$5(2).multiply(t.add(o)));}return e}getFragmentOutput(t,i,e=new j$5(1/255)){const o=new F$4;return o.glFragColor=this._maybeWriteHittest(i)??this._maybeHighlight(t,e)??t,o}_maybeHighlight(t,i){return this.highlight?new H$1(t.rgb,ee(i,t.a)):null}_checkHighlight(t){let e=this._checkHighlightBit(t,0);for(let o=1;o<l$o.length;o++)e=e.add(this._checkHighlightBit(t,o));return ee(new j$5(.1),e.add(this.highlight.highlightAll))}_checkHighlightBit(t,i){return w$2(t,i).multiply(j$3(this.highlight.activeReasons,i))}maybeRunHittest(t,i,e){if(null==this.hittestRequest)return null;const o=this.hittest(t,i,e);let s=xt(Ct(o,this.hittestRequest.distance),new j$5(2),new j$5(0));const r=this.storage.getAttributeDataCoords(t.id),h=d$3(r);s=s.add(this.clip(t.id,t.zoomRange));const l=new H$1(new j$5(1/255),0,0,0);return {glPointSize:new j$5(1),glPosition:new H$1(h,s,1),color:l}}_maybeWriteHittest(t){return null!=this.hittestRequest?t.color:null}};e$n([x$4],P$3.prototype,"inside",void 0),e$n([x$4],P$3.prototype,"outside",void 0),e$n([K(e$3)],P$3.prototype,"highlight",void 0),e$n([_$5(p$4)],P$3.prototype,"storage",void 0),e$n([_$5(d$2)],P$3.prototype,"view",void 0),e$n([K(e$2)],P$3.prototype,"hittestRequest",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function v$1(n,r){return ln(n,Gn(r))}function j$2(t,u,s){const l=s.subtract(u),c=v$1(t.subtract(u),l),e=Zt(c.divide(kn(l)),new j$5(0),new j$5(1));return sn(t,u.add(e.multiply(s.subtract(u))))}function g$4(t){const u=Xt(t);return ee(u.x.add(u.y).add(u.z),new j$5(1.05))}function h$5(t,u,n,i){const y=new tt(n.x.multiply(i.y).subtract(i.x.multiply(n.y)),i.x.multiply(u.y).subtract(u.x.multiply(i.y)),u.x.multiply(n.y).subtract(n.x.multiply(u.y)),n.y.subtract(i.y),i.y.subtract(u.y),u.y.subtract(n.y),i.x.subtract(n.x),u.x.subtract(i.x),n.x.subtract(u.x)),s=u.x.multiply(n.y.subtract(i.y)),l=n.x.multiply(i.y.subtract(u.y)),a=i.x.multiply(u.y.subtract(n.y)),o=s.add(l).add(a);return new j$5(1).divide(o).multiply(y.multiply(new G$2(1,t)))}function M$1(t,u,n,i){return Bt(g$4(h$5(t,u,n,i)),new j$5(1))}function P$2(t,u,n,i){const y=n.subtract(u),s=i.subtract(u),l=b$3(y,s),c=Rt(St(l,new j$5(u$5)),Ct(l,new j$5(-u$5)));return gt([Rt(Hn(c),M$1(t.xy,u,n,i)),new j$5(-1)],[!0,()=>{const r=j$2(t,u,n),y=j$2(t,n,i),s=j$2(t,i,u);return Un(Un(r,y),s)}])}function q$1(t){return t.distance.add(1)}function z$2(t,u,n){const{viewMat3:r,tileMat3:i}=t.view,y=r.multiply(i),s=y.multiply(new G$2(u.pos,1)),l=y.multiply(new G$2(n.nextPos1,1)),c=y.multiply(new G$2(n.nextPos2,1));return P$2(t.hittestRequest.position,s.xy,l.xy,c.xy)}function R$3(t,u,n){return sn(t,n).subtract(u)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let f$4 = class f extends P$4{getColor(s,t,o){return gt([Ht(h$6(s),o),t],[jt(s,this.values.first()),this.colors.first()],[Gt(s,this.values.last()),this.colors.last()],[!0,()=>{const t=this.values.findIndex((t=>Ct(t,s))),o=this.values.get(t),r=t.subtract(1),e=this.values.get(r),i=s.subtract(e).divide(o.subtract(e));return Sn(this.colors.get(r),this.colors.get(t),i)}])}};e$n([_$5(U.ofType(H$1,8))],f$4.prototype,"colors",void 0),e$n([_$5(U.ofType(j$5,8))],f$4.prototype,"values",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let h$4 = class h extends P$4{getOpacity(t){return gt([h$6(t),new j$5(1)],[jt(t,this.opacityValues.first()),this.opacities.first()],[Gt(t,this.opacityValues.last()),this.opacities.last()],[!0,()=>{const s=this.opacityValues.findIndex((s=>Ct(s,t))),i=this.opacityValues.get(s),e=s.subtract(1),o=this.opacityValues.get(e),a=t.subtract(o).divide(i.subtract(o));return Sn(this.opacities.get(e),this.opacities.get(s),a)}])}};e$n([_$5(U.ofType(j$5,8))],h$4.prototype,"opacities",void 0),e$n([_$5(U.ofType(j$5,8))],h$4.prototype,"opacityValues",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function l$2(a){return null!=a.visualVariableSizeMinMaxValue||null!=a.visualVariableSizeScaleStops||null!=a.visualVariableSizeStops||null!=a.visualVariableSizeUnitValue}function t$1(a,e,i){if(l$2(a)){const l=a.storage.getSizeValue(e);return a.visualVariableSizeMinMaxValue?.getSize(l,i)??a.visualVariableSizeScaleStops?.getSizeForViewScale(a.view.currentScale)??a.visualVariableSizeStops?.getSize(l,i)??a.visualVariableSizeUnitValue?.getSize(l,i)}return i}function r$2(e,i,l,t=new Y(!1)){if(null==e.visualVariableColor)return l;const r=e.storage.getColorValue(i);return e.visualVariableColor.getColor(r,l,t)}function u$2(a,i){if(null==a.visualVariableOpacity)return new j$5(1);const l=a.storage.getOpacityValue(i);return a.visualVariableOpacity.getOpacity(l)}function n$4(a,e){if(null==a.visualVariableRotation)return tt.identity();const l=a.storage.getRotationValue(e);return a.visualVariableRotation.getVVRotationMat3(l)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let g$3 = class g extends S$5{};e$n([l$3(3,H$1)],g$3.prototype,"color",void 0),e$n([l$3(4,C$1)],g$3.prototype,"zoomRange",void 0);let x$3 = class x extends P$3{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]};}vertex(t,o){const r=u$2(this,t.id),e=r$2(this,t.id,t.color).multiply(r),i=this.view.displayViewScreenMat3.multiply(new G$2(t.pos.xy,1)),p=this.clip(t.id,t.zoomRange);return {glPosition:new H$1(i.xy,p,1),color:e,...this.maybeRunHittest(t,o,null)}}fragment(t){return this.getFragmentOutput(t.color,t,new j$5(0))}hittest(t,o){return z$2(this,t,o)}};e$n([K(f$4)],x$3.prototype,"visualVariableColor",void 0),e$n([K(h$4)],x$3.prototype,"visualVariableOpacity",void 0),e$n([t$n(0,g$6(g$3)),t$n(1,g$6(q$2))],x$3.prototype,"vertex",null),e$n([t$n(0,g$6(F$3))],x$3.prototype,"fragment",null);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let n$3 = class n extends P$4{getPatternOffsetAtTileOrigin(t,i=new j$5(0),l=new j$5(1)){const n=new C$1(K$2).divide(t);let p=t.multiply(bn(this.maxIntsToLocalOrigin.multiply(n))).add(this.tileOffsetFromLocalOrigin).subtract(new j$5(.5).multiply(t));return p=new C$1(p.x.multiply(l).subtract(p.y.multiply(i)),p.x.multiply(i).add(p.y.multiply(l))),jn(p,t)}};e$n([_$5(C$1)],n$3.prototype,"tileOffsetFromLocalOrigin",void 0),e$n([_$5(C$1)],n$3.prototype,"maxIntsToLocalOrigin",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let p$3 = class p extends P$4{};e$n([_$5(C$1)],p$3.prototype,"size",void 0),e$n([_$5(S$6)],p$3.prototype,"texture",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let P$1 = class P extends g$3{};e$n([l$3(5,H$1)],P$1.prototype,"tlbr",void 0),e$n([l$3(6,j$5)],P$1.prototype,"width",void 0),e$n([l$3(7,j$5)],P$1.prototype,"height",void 0),e$n([l$3(8,C$1)],P$1.prototype,"offset",void 0),e$n([l$3(9,C$1)],P$1.prototype,"scale",void 0),e$n([l$3(10,j$5)],P$1.prototype,"angle",void 0);class Z extends F$3{}function _$4(t,e,o,i,r){const l=Bt(j$3(r,C$2),ct(1)),s=k$3(new H$1(t,0));return xt(l,lt(i.divide(e.x),o.divide(e.y),0,yt(o.divide(e.x)),i.divide(e.y),0,g$5(it(s,0)),g$5(it(0,s)),1),lt(i.divide(e.x),o.divide(e.y),0,yt(o.divide(e.x)),i.divide(e.y),0,0,0,1))}function B$2(t,e){const i=Sn(new C$1(1),new C$1(1/l$n),new C$1(j$3(e.bitset,E$3),j$3(e.bitset,D$3))),r=t.view.requiredZoomFactor,l=new C$1(e.width,e.height).multiply(i),f=l.multiply(e.scale).multiply(r),y=e.angle.multiply(c$4),c=Wn(y),v=tn(y),x=_$4(e.id,f,c,v,e.bitset),h=t.localTileOffset.getPatternOffsetAtTileOrigin(l,c,v),g=r.multiply(e.scale).multiply(e.offset.subtract(h)).divide(f),w=new G$2(e.pos,1),b=x.multiply(w).xy.subtract(g),j=e.tlbr.divide(t.mosaicInfo.size.xyxy);let O=j$3(e.bitset,q$5);return null!=t.visualVariableColor&&(O=xt(h$6(t.storage.getColorValue(e.id)),new j$5(0),O)),{tileTextureCoord:b,tlbr:j,sampleAlphaOnly:O}}function D$1(t,e){const o=jn(e.tileTextureCoord,new j$5(1)),i=Sn(e.tlbr.xy,e.tlbr.zw,o);let r=se(t.mosaicInfo.texture,i);return r=xt(Ct(e.sampleAlphaOnly,new j$5(.5)),r.aaaa,r),e.color.multiply(r)}let E$2 = class E extends x$3{vertex(t,e){return {...super.vertex(t,e),...B$2(this,t)}}fragment(t){const e=D$1(this,t);return this.getFragmentOutput(e,t,new j$5(0))}};e$n([_$5(p$3)],E$2.prototype,"mosaicInfo",void 0),e$n([_$5(n$3)],E$2.prototype,"localTileOffset",void 0),e$n([t$n(0,g$6(P$1)),t$n(1,g$6(q$2))],E$2.prototype,"vertex",null),e$n([t$n(0,g$6(Z))],E$2.prototype,"fragment",null);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let m$1 = class m extends P$4{getSize(t,e){const r=this.minMaxValueAndSize.xy,o=this.minMaxValueAndSize.zw;return xt(h$6(t),e,(()=>{const e=t.subtract(r.x).divide(r.y.subtract(r.x)),s=Zt(e,new j$5(0),new j$5(1));return o.x.add(s.multiply(o.y.subtract(o.x)))}))}};e$n([_$5(H$1)],m$1.prototype,"minMaxValueAndSize",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let p$2 = class p extends P$4{getSizeForViewScale(s){return gt([jt(s,this.values.first()),this.sizes.first()],[Gt(s,this.values.last()),this.sizes.last()],[!0,()=>{const t=this.values.findIndex((t=>Ct(t,s))),e=this.values.get(t),i=t.subtract(1),r=this.values.get(i),o=s.subtract(r).divide(e.subtract(r));return Sn(this.sizes.get(i),this.sizes.get(t),o)}])}};e$n([_$5(U.ofType(j$5,8))],p$2.prototype,"sizes",void 0),e$n([_$5(U.ofType(j$5,8))],p$2.prototype,"values",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let f$3 = class f extends P$4{getSize(s,t){const e=gt([h$6(s),t],[jt(s,this.values.first()),this.sizes.first()],[Gt(s,this.values.last()),this.sizes.last()],[!0,()=>{const t=this.values.findIndex((t=>Ct(t,s))),e=this.values.get(t),i=t.subtract(1),r=this.values.get(i),o=s.subtract(r).divide(e.subtract(r));return Sn(this.sizes.get(i),this.sizes.get(t),o)}]);return xt(h$6(e),t,e)}};e$n([_$5(U.ofType(j$5,8))],f$3.prototype,"sizes",void 0),e$n([_$5(U.ofType(j$5,8))],f$3.prototype,"values",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let l$1 = class l extends P$4{getSize(t,o){return xt(h$6(t),o,t.multiply(this.unitValueToPixelsRatio))}};e$n([_$5(j$5)],l$1.prototype,"unitValueToPixelsRatio",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
class q extends S$5{}e$n([l$3(3,H$1)],q.prototype,"color",void 0),e$n([l$3(4,C$1)],q.prototype,"offset",void 0),e$n([l$3(5,C$1)],q.prototype,"normal",void 0),e$n([l$3(6,j$5)],q.prototype,"halfWidth",void 0),e$n([l$3(7,j$5)],q.prototype,"referenceHalfWidth",void 0),e$n([l$3(8,C$1)],q.prototype,"zoomRange",void 0);let A$1 = class A extends F$3{};let F$2 = class F extends P$4{};function k$2(t){return Bn(new j$5(h$b).multiply(ee(t,new j$5(n$8))),new j$5(1))}function D(t,i){const{halfWidth:e,normal:o}=t,l=k$2(e),a=kn(o).multiply(e);return Zt(l.multiply(e.subtract(a)).divide(i.add(l).subtract(new j$5(1))),new j$5(0),new j$5(1))}function G$1(t,i){const{id:e,halfWidth:o,referenceHalfWidth:l}=i;if(l$2(t)){const i=new j$5(2).multiply(l),a=t$1(t,e,i);return new j$5(.5).multiply(o.divide(Bn(l,new j$5(s$8)))).multiply(a)}return o}function T$2(t,i){const{id:e,offset:o,pos:l,normal:a,zoomRange:r}=i,{displayViewScreenMat3:s,displayViewMat3:n}=t.view,c=r$2(t,e,i.color),f=u$2(t,e),h=G$1(t,i),v=new j$5(.5).multiply(t.antialiasingControls.antialiasing),w=Bn(h.add(v),new j$5(.45)).add(new j$5(.1).multiply(v)),V=k$2(w).multiply(w).multiply(o),b=n.multiply(new G$2(V,new j$5(0))),S=s.multiply(new G$2(l,new j$5(1))).add(b),x=new j$5(2).multiply(ee(h,new j$5(0))).add(t.clip(e,r)),g=new H$1(S.xy,x,1);return {color:c,opacity:f,halfWidth:w,normal:a,scaledOffset:V,scaledHalfWidth:h,glPosition:new H$1(g.xy,x,1)}}function _$3(t,i){const{opacity:e,color:o}=t,l=D(t,i);return e.multiply(o).multiply(l)}e$n([_$5(j$5)],F$2.prototype,"antialiasing",void 0),e$n([_$5(j$5)],F$2.prototype,"blur",void 0);let B$1 = class B extends P$3{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]};}vertex(t,i){const e=T$2(this,t);return {...e,...this.maybeRunHittest(t,i,e.halfWidth)}}fragment(t){const i=_$3(t,this.antialiasingControls.blur);return this.getFragmentOutput(i,t)}hittest(t,i,e){const{viewMat3:o,tileMat3:l}=this.view,a=o.multiply(l),r=a.multiply(new G$2(t.pos,1)),s=a.multiply(new G$2(i.nextPos1,1)),n=a.multiply(new G$2(i.nextPos2,1)),{distance:p,smallSymbolDistance:u,smallSymbolSizeThreshold:y}=this.hittestRequest,f=ee(e,y.multiply(.5)).multiply(p.subtract(u)),h=this.hittestRequest.position;return Un(j$2(h,r.xy,s.xy),j$2(h,r.xy,n.xy)).subtract(e).add(f)}};e$n([_$5(F$2)],B$1.prototype,"antialiasingControls",void 0),e$n([K(f$4)],B$1.prototype,"visualVariableColor",void 0),e$n([K(h$4)],B$1.prototype,"visualVariableOpacity",void 0),e$n([K(m$1)],B$1.prototype,"visualVariableSizeMinMaxValue",void 0),e$n([K(p$2)],B$1.prototype,"visualVariableSizeScaleStops",void 0),e$n([K(f$3)],B$1.prototype,"visualVariableSizeStops",void 0),e$n([K(l$1)],B$1.prototype,"visualVariableSizeUnitValue",void 0),e$n([t$n(0,g$6(q)),t$n(1,g$6(q$2))],B$1.prototype,"vertex",null),e$n([t$n(0,g$6(A$1))],B$1.prototype,"fragment",null);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
class W extends S$5{}e$n([l$3(3,C$1)],W.prototype,"offset",void 0),e$n([l$3(4,H$1)],W.prototype,"color",void 0),e$n([l$3(5,C$1)],W.prototype,"normal",void 0),e$n([l$3(6,j$5)],W.prototype,"halfWidth",void 0),e$n([l$3(7,j$5)],W.prototype,"referenceHalfWidth",void 0),e$n([l$3(8,C$1)],W.prototype,"zoomRange",void 0);let R$2 = class R extends A$1{};function A(t,o,i){const{id:e,bitset:r}=o,s=j$3(r,B$4),u=Ct(s,new j$5(.5)),d=T$2(t,o),c=xt(u,d.halfWidth,new j$5(0)),f=u$2(t,e),y=r$2(t,e,o.color),V=xt(u,o.color,y.multiply(f)),h=t.view.displayViewScreenMat3.multiply(new G$2(o.pos.xy,1)),b=t.clip(o.id),j=new H$1(h.xy,b,1),g=xt(u,d.glPosition,j),w=i&&t.maybeRunHittest(o,i,u);return {isOutline:s,color:V,opacity:new j$5(1),halfWidth:c,normal:d.normal,glPosition:g,...w}}let F$1 = class F extends P$3{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]};}};e$n([_$5(F$2)],F$1.prototype,"antialiasingControls",void 0),e$n([K(f$4)],F$1.prototype,"visualVariableColor",void 0),e$n([K(h$4)],F$1.prototype,"visualVariableOpacity",void 0),e$n([K(m$1)],F$1.prototype,"visualVariableSizeMinMaxValue",void 0),e$n([K(p$2)],F$1.prototype,"visualVariableSizeScaleStops",void 0),e$n([K(f$3)],F$1.prototype,"visualVariableSizeStops",void 0),e$n([K(l$1)],F$1.prototype,"visualVariableSizeUnitValue",void 0);class H extends F$1{vertex(t,o){return A(this,t,o)}fragment(t){const{color:o,isOutline:i}=t,e=Ct(i,new j$5(.5)),r=_$3(t,this.antialiasingControls.blur),s=xt(e,r,o),n=xt(e,new j$5(1/255),new j$5(0));return this.getFragmentOutput(s,t,n)}hittest(t,o,i){return xt(i,q$1(this.hittestRequest),z$2(this,t,o))}}e$n([t$n(0,g$6(W)),t$n(1,g$6(q$2))],H.prototype,"vertex",null),e$n([t$n(0,g$6(R$2))],H.prototype,"fragment",null);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let h$3 = class h extends g$3{};e$n([l$3(5,H$1)],h$3.prototype,"tlbr",void 0),e$n([l$3(6,j$5)],h$3.prototype,"inverseRasterizationScale",void 0);let g$2 = class g extends F$3{};function j$1(t){const e=new j$5(1),r=new j$5(0);return new tt(e.divide(t.x),r.divide(t.y),0,yt(r.divide(t.x)),e.divide(t.y),0,0,0,1)}function O(t,e){const r=e.tlbr.xy,o=e.tlbr.zw,i=o.x.subtract(r.x),n=r.y.subtract(o.y),a=new C$1(i,n).multiply(e.inverseRasterizationScale),p=a.multiply(t.view.requiredZoomFactor),u=j$1(p),d=t.localTileOffset.getPatternOffsetAtTileOrigin(a).divide(p),c=new G$2(e.pos,1);return {tileTextureCoord:u.multiply(c).xy.subtract(d),tlbr:e.tlbr.divide(t.mosaicInfo.size.xyxy)}}function T$1(t,e){const r=jn(t.tileTextureCoord,new j$5(1)),o=Sn(t.tlbr.xy,t.tlbr.zw,r),i=se(e.texture,o);return t.color.multiply(i)}let z$1 = class z extends x$3{vertex(t,e){return {...super.vertex(t,e),...O(this,t)}}fragment(t){const e=T$1(t,this.mosaicInfo);return this.getFragmentOutput(e,t,new j$5(0))}};e$n([_$5(p$3)],z$1.prototype,"mosaicInfo",void 0),e$n([_$5(n$3)],z$1.prototype,"localTileOffset",void 0),e$n([t$n(0,g$6(h$3)),t$n(1,g$6(q$2))],z$1.prototype,"vertex",null),e$n([t$n(0,g$6(g$2))],z$1.prototype,"fragment",null);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let x$2 = class x extends W{};e$n([l$3(9,H$1)],x$2.prototype,"tlbr",void 0),e$n([l$3(10,j$5)],x$2.prototype,"inverseRasterizationScale",void 0);let y$1 = class y extends R$2{};let S$4 = class S extends H{vertex(t,o){return {...A(this,t,o),...O(this,t)}}fragment(t){const{isOutline:o}=t,r=Ct(o,new j$5(.5)),e=_$3(t,this.antialiasingControls.blur),s=T$1(t,this.mosaicInfo),n=xt(r,e,s),p=xt(r,new j$5(1/255),new j$5(0));return this.getFragmentOutput(n,t,p)}};e$n([_$5(p$3)],S$4.prototype,"mosaicInfo",void 0),e$n([_$5(n$3)],S$4.prototype,"localTileOffset",void 0),e$n([t$n(0,g$6(x$2)),t$n(1,g$6(q$2))],S$4.prototype,"vertex",null),e$n([t$n(0,g$6(y$1))],S$4.prototype,"fragment",null);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const S$3=16,b$2=1/S$3,w$1=128;class F extends S$5{}e$n([l$3(3,H$1)],F.prototype,"color",void 0),e$n([l$3(4,H$1)],F.prototype,"tlbr",void 0),e$n([l$3(5,j$5)],F.prototype,"angle",void 0),e$n([l$3(6,j$5)],F.prototype,"aux1",void 0),e$n([l$3(7,j$5)],F.prototype,"aux2",void 0),e$n([l$3(8,C$1)],F.prototype,"aux3",void 0),e$n([l$3(9,C$1)],F.prototype,"aux4",void 0),e$n([l$3(10,C$1)],F.prototype,"zoomRange",void 0);let R$1 = class R extends y$1{};class C extends F$1{vertex(t,o){const{aux1:e,aux2:r,aux3:i,aux4:p}=t,a={...t,width:e,height:r,offset:i,scale:p.multiply(b$2)},m={...t,halfWidth:e.multiply(b$2),referenceHalfWidth:r.multiply(b$2),offset:i.multiply(b$2),normal:p.subtract(w$1).multiply(b$2)},n=A(this,m),u=B$2(this,a),h=Ct(n.isOutline,new j$5(.5));return {...n,...u,...this.maybeRunHittest(t,o,h)}}fragment(t){const{isOutline:o}=t,e=Ct(o,new j$5(.5)),r=_$3(t,this.antialiasingControls.blur),i=D$1(this,t),a=xt(e,r,i),m=xt(e,new j$5(1/255),new j$5(0));return this.getFragmentOutput(a,t,m)}hittest(t,o,e){return xt(e,q$1(this.hittestRequest),z$2(this,t,o))}}e$n([_$5(p$3)],C.prototype,"mosaicInfo",void 0),e$n([_$5(n$3)],C.prototype,"localTileOffset",void 0),e$n([t$n(0,g$6(F)),t$n(1,g$6(q$2))],C.prototype,"vertex",null),e$n([t$n(0,g$6(R$1))],C.prototype,"fragment",null);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const h$2=g$7.attributes,f$2=m$5.attributes,y={createComputedParams:e=>e,attributes:{id:h$2.id,pos:h$2.pos,zoomRange:h$2.zoomRange,tlbr:h$2.tlbr,angle:h$2.angle,color:h$2.color,bitset:{type:C$8.UNSIGNED_BYTE,count:1,pack:e=>m$6(e)},aux1:{count:1,type:C$8.UNSIGNED_SHORT,pack:e=>f$9(e)},aux2:{count:1,type:C$8.UNSIGNED_SHORT,pack:e=>d$6(e)},aux3:{count:2,type:C$8.SHORT,pack:({offsetX:t,offsetY:r})=>[u$h(t),u$h(r)]},aux4:{count:2,type:C$8.UNSIGNED_BYTE,pack:({scaleX:e,scaleY:t})=>[e*S$3,t*S$3]}}},x$1={createComputedParams:e=>e,attributes:{id:h$2.id,pos:h$2.pos,zoomRange:h$2.zoomRange,tlbr:h$2.tlbr,angle:h$2.angle,color:f$2.color,bitset:{type:C$8.UNSIGNED_BYTE,count:1,pack:e=>l$8([[B$4,!0]])},aux1:{count:1,type:C$8.UNSIGNED_SHORT,pack:t=>u$h(.5*t.width)*S$3},aux2:{count:1,type:C$8.UNSIGNED_SHORT,pack:t=>u$h(.5*t.referenceWidth)*S$3},aux3:{count:2,type:C$8.SHORT,packTessellation:({extrusionOffsetX:e,extrusionOffsetY:t})=>[e*S$3,t*S$3]},aux4:{count:2,type:C$8.UNSIGNED_BYTE,packTessellation:({normalX:e,normalY:t})=>[e*S$3+w$1,t*S$3+w$1]}}};let S$2 = class S extends p$7{constructor(){super(...arguments),this.vertexSpec=x$1;}};class N extends h$a{constructor(){super(...arguments),this.vertexSpec=y;}_createOutlineWriter(e,t,r,s){return new S$2(e,t,r,s)}_write(e,r,s){const o=s?.asOptimized()??r.readGeometryForDisplay(),i=this._clip(o);if(!i)return;const a=this.evaluatedMeshParams.sprite?.textureBinding;e.recordStart(this.instanceId,this.attributeLayout,a),this._writeGeometry(e,r,i),this._lineMeshWriter.writeLineVertices(e,a$d.fromOptimizedCIM(i,"esriGeometryPolyline"),r),e.recordEnd();}ensurePacked(e,t,r){super.ensurePacked(e,t,r),this._lineMeshWriter.ensurePacked(e,t,r);}enqueueRequest(e,t,r){super.enqueueRequest(e,t,r),this._lineMeshWriter.enqueueRequest(e,t,r);}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()]);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const n$2={createComputedParams:e=>e,attributes:{...s$9.attributes,...l$6.attributes}},u$1={createComputedParams:e=>e,attributes:{...s$9.attributes,...m$5.attributes}};let o$3 = class o extends p$7{constructor(){super(...arguments),this.vertexSpec=u$1;}};let c$1 = class c extends h$a{constructor(){super(...arguments),this.vertexSpec=n$2;}_createOutlineWriter(e,t,r,s){return new o$3(e,t,r,s)}_write(t,r,s){const i=s?.asOptimized()??r.readGeometryForDisplay(),a=this._clip(i);if(!a)return;const n=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,n),this._writeGeometry(t,r,a),this._lineMeshWriter.writeLineVertices(t,a$d.fromOptimizedCIM(a,"esriGeometryPolyline"),r),t.recordEnd();}ensurePacked(e,t,r){super.ensurePacked(e,t,r),this._lineMeshWriter.ensurePacked(e,t,r);}enqueueRequest(e,t,r){super.enqueueRequest(e,t,r),this._lineMeshWriter.enqueueRequest(e,t,r);}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()]);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const r$1={createComputedParams:e=>e,attributes:{pos:{type:C$8.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:C$8.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:C$8.UNSIGNED_BYTE,count:1},offset:{type:C$8.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};let i$1 = class i extends o$9{constructor(){super(...arguments),this.vertexSpec=r$1;}_write(e,t){e.recordStart(this.instanceId,this.attributeLayout);const r=t.getDisplayId();if("esriGeometryPoint"===t.geometryType){const i=t.readXForDisplay(),o=t.readYForDisplay();this._writeQuad(e,r,i,o);}else if("esriGeometryMultipoint"===t.geometryType){const i=t.readGeometryForDisplay();i?.forEachVertex(((t,i)=>{t>=0&&t<=512&&i>=0&&i<=512&&this._writeQuad(e,r,t,i);}));}e.recordEnd();}_writeQuad(e,t,r,i){const o=e.vertexCount();this._writeVertex(e,t,r,i),e.indexWrite(o+0),e.indexWrite(o+1),e.indexWrite(o+2),e.indexWrite(o+1),e.indexWrite(o+3),e.indexWrite(o+2);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const n$1=8388607,t=8388608,f$1=t=>t&n$1;function s$3(n,r){return ((r?t:0)|n)>>>0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
function e$1(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function n(t,e){return Math.sqrt(t*t+e*e)}function s$2(t){const e=n(t[0],t[1]);t[0]/=e,t[1]/=e;}function i(t,e){return n(t[0]-e[0],t[1]-e[1])}function r(t,e){return t[e+1]}function h$1(t){return t.length-1}function a$1(t){let e=0;for(let n=0;n<h$1(t);n++)e+=c(t,n);return e}function c(t,e,n=1){let[s,i]=r(t,e);return [s,i]=[Math.round(s),Math.round(i)],Math.sqrt(s*s+i*i)*n}class u{constructor(t,e,n,s,i){this._segments=t,this._index=e,this._distance=n,this._xStart=s,this._yStart=i,this._done=!1;}static create(t){return new u(t,0,0,t[0][0],t[0][1])}clone(){return new u(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)}leq(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance}geq(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance}get _segment(){return this._segments[this._index+1]}get angle(){const t=this.dy,e=(0*t+-1*-this.dx)/(1*this.length);let n=Math.acos(e);return t>0&&(n=2*Math.PI-n),n}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:t,dy:e}=this;return Math.sqrt(t*t+e*e)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<h$1(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(t,e){const n=this.backwardLength;if(t<=n)return this._distance=(n-t)/this.length,this;let s=this.backwardLength;for(;this.prev();){if(s+this.length>t)return this._seekBackwards(t-s);s+=this.length;}return this._distance=0,e?this:null}seek(t,e=!1){if(t<0)return this._seekBackwards(Math.abs(t),e);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let n=this.remainingLength;for(;this.next();){if(n+this.length>t)return this.seek(t-n,e);n+=this.length;}return this._distance=1,e?this:null}}function d$1(e,n,s,i=!0){const r=a$1(e),h=u.create(e),c=r/2;if(!i)return h.seek(c),void(Math.abs(h.x)<t$o&&Math.abs(h.y)<t$o&&s(h.clone(),0,c+0*n,r));const d=Math.max((r-n)/2,0),o=Math.floor(d/n),_=c-o*n;h.seek(_);for(let a=-o;a<=o;a++)Math.abs(h.x)<t$o&&Math.abs(h.y)<t$o&&s(h.clone(),a,c+a*n,r),h.seek(n);}function l(t,e){const n=e;for(let s=0;s<t.length;s++){let e=t[s];g$1(e,n);const i=[];i.push(e[0]);for(let t=1;t<e.length;t++){const[n,s]=e[t-1],[r,h]=e[t],a=r-n,c=h-s;i.push([a,c]);}t[s]=i,e=i;}return t}function g$1(t,n){const r=1e-6;if(n<=0)return;const h=t.length;if(h<3)return;const a=[];let c=0;a.push(0);for(let e=1;e<h;e++)c+=i(t[e],t[e-1]),a.push(c);n=Math.min(n,.2*c);const u=[];u.push(t[0][0]),u.push(t[0][1]);const d=t[h-1][0],o=t[h-1][1],_=e$1([0,0],t[0],t[1]);s$2(_),t[0][0]+=n*_[0],t[0][1]+=n*_[1],e$1(_,t[h-1],t[h-2]),s$2(_),t[h-1][0]+=n*_[0],t[h-1][1]+=n*_[1];for(let e=1;e<h;e++)a[e]+=n;a[h-1]+=n;const l=.5*n;for(let e=1;e<h-1;e++){let s=0,i=0,c=0;for(let h=e-1;h>=0&&!(a[h+1]<a[e]-l);h--){const u=l+a[h+1]-a[e],d=a[h+1]-a[h],o=a[e]-a[h]<l?1:u/d;if(Math.abs(o)<r)break;const _=o*o,g=o*u-.5*_*d,x=o*d/n,f=t[h+1],y=t[h][0]-f[0],k=t[h][1]-f[1];s+=x/g*(f[0]*o*u+.5*_*(u*y-d*f[0])-_*o*d*y/3),i+=x/g*(f[1]*o*u+.5*_*(u*k-d*f[1])-_*o*d*k/3),c+=x;}for(let u=e+1;u<h&&!(a[u-1]>a[e]+l);u++){const h=l-a[u-1]+a[e],d=a[u]-a[u-1],o=a[u]-a[e]<l?1:h/d;if(Math.abs(o)<r)break;const _=o*o,g=o*h-.5*_*d,x=o*d/n,f=t[u-1],y=t[u][0]-f[0],k=t[u][1]-f[1];s+=x/g*(f[0]*o*h+.5*_*(h*y-d*f[0])-_*o*d*y/3),i+=x/g*(f[1]*o*h+.5*_*(h*k-d*f[1])-_*o*d*k/3),c+=x;}u.push(s/c),u.push(i/c);}u.push(d),u.push(o);for(let e=0,s=0;e<h;e++)t[e][0]=u[s++],t[e][1]=u[s++];}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
class e{static getPlacement(e,r,n,s,c,o){const a=g$9(n);if(!a)return null;-1===r&&e.invertY();return a.execute(e,n,s,c,o)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const s$1=96;let o$2 = class o{constructor(o){const{offsetX:f,offsetY:i,postAngle:e,fontSize:n,scaleFactor:h,transforms:r}=o;if(this.offsetX=f,this.offsetY=i,this.postAngle=e,this.fontSize=Math.min(n,s$1),this.transforms=r,r&&r.infos.length>1){const o=O$6(n,e,!1,f,i,r);this.fontSize=Math.min(o.size,s$1),this.postAngle=o.rotation,this.offsetX=o.offsetX,this.offsetY=o.offsetY;}h&&(this.fontSize*=h,this.offsetX*=h,this.offsetY*=h);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const _$2=28,P=[4,4],S$1=[16,4],k$1={topLeft:S$1,topRight:S$1,bottomLeft:S$1,bottomRight:S$1},T=[4,2],b$1=[4,6],B={topLeft:T,topRight:T,bottomLeft:b$1,bottomRight:b$1},R={topLeft:T,topRight:b$1,bottomLeft:T,bottomRight:b$1},w={topLeft:b$1,topRight:b$1,bottomLeft:P,bottomRight:P},M={topLeft:P,topRight:P,bottomLeft:b$1,bottomRight:b$1},z={topLeft:b$1,topRight:P,bottomLeft:b$1,bottomRight:P},L={topLeft:P,topRight:b$1,bottomLeft:P,bottomRight:b$1},I$1={createComputedParams:t=>t,attributes:{pos:{type:C$8.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:C$8.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:C$8.UNSIGNED_BYTE,count:1,packTessellation:({isBackground:t,mapAligned:e})=>l$8([[I$4,t],[J$1,!!e]])},zoomRange:{type:C$8.UNSIGNED_SHORT,count:2,packPrecisionFactor:at$1,packTessellation:({minZoom:t,maxZoom:e})=>[t||0,e||_$2]},offset:{type:C$8.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:({offsets:t})=>{const{bottomLeft:e,bottomRight:o,topLeft:r,topRight:i}=t;return [r,i,e,o]}}},textureUV:{type:C$8.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:({texcoords:t})=>{const{bottomLeft:e,bottomRight:o,topLeft:r,topRight:i}=t;return [r,i,e,o]}}},color:{type:C$8.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:({color:t})=>t},fontSize:{type:C$8.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:({fontSize:t})=>u$h(t)},referenceSize:{type:C$8.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:({fontSize:t},{referenceSize:o})=>u$h(o??t)},haloColor:{type:C$8.UNSIGNED_BYTE,count:4,normalized:!0,pack:({haloColor:t})=>h$c(t)},haloFontSize:{type:C$8.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,pack:({haloFontSize:t})=>u$h(t)},clipAngle:{type:C$8.UNSIGNED_BYTE,count:1,packTessellation:({clipAngle:t})=>G(t||0)},referenceSymbol:{type:C$8.BYTE,count:4,packPrecisionFactor:1,packTessellation:(t,o)=>{if(!t.referenceBounds)return [0,0,0,0];const r=s$c(o.horizontalAlignment),n=i$9(o.verticalAlignment),{offsetX:a,offsetY:c,size:l}=t.referenceBounds;return [u$h(a),-u$h(c),u$h(l),r+1<<2|n+1]}}}};let E$1 = class E extends o$9{constructor(){super(...arguments),this.vertexSpec=I$1,this._textMeshParamsPropsInitialized=!1;}ensurePacked(t,e,o){super.ensurePacked(t,e,o),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new o$2(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0);}_write(t,e,o){const r=this._getShaping();if(!r)return;const i=e.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(t,e,r,o);if(o&&o.nextPath())return o.nextPoint(),this._writeGlyphs(t,i,o.x,o.y,r,0);if("esriGeometryPolygon"===e.geometryType){const o=e.readCentroidForDisplay();if(!o)return;const[s,n]=o.coords;return this._writeGlyphs(t,i,s,n,r,0)}if("esriGeometryMultipoint"===e.geometryType){const o=e.readGeometryForDisplay();return void o?.forEachVertex(((e,o)=>this._writeGlyphs(t,i,e,o,r,0)))}const s=e.readXForDisplay(),n=e.readYForDisplay();return this._writeGlyphs(t,i,s,n,r,0)}_writePlacedTextMarkers(t,i,s,n){const a=n??a$d.fromFeatureSetReaderCIM(i);if(!a)return;const c=-1,l=e.getPlacement(a,c,this.evaluatedMeshParams.placement,u$h(1),t.id,t$6());if(!l)return;const f=i.getDisplayId();let h=l.next();for(;null!=h;){const e=h.tx,o=-h.ty,r=-h.getAngle();this._writeGlyphs(t,f,e,o,s,r),h=l.next();}}_getShaping(){const o=this._textMeshTransformProps,r=this.evaluatedMeshParams;if(!r.glyphs?.glyphs.length)return null;const i=Math.round(u$h(o.fontSize)),s=u$h(o.offsetX),n=u$h(o.offsetY),f=e$o(u$h(r.lineWidth),32,512),h=g$b*e$o(r.lineHeightRatio,.25,4);return O$4(r.glyphs,{scale:i/U$2,angle:o.postAngle,xOffset:s,yOffset:n,horizontalAlignment:r.horizontalAlignment,verticalAlignment:r.verticalAlignment,maxLineWidth:f,lineHeight:h,decoration:r.decoration,borderLineSizePx:u$h(r.boxBorderLineSize),hasBackground:!!r.boxBackgroundColor,useCIMAngleBehavior:r.useCIMAngleBehavior})}_writeGlyphs(t,o,r,i,s,n,a,c){const l=this.evaluatedMeshParams,f=this._textMeshTransformProps,m=f.fontSize,d=u$h(f.offsetX),u=u$h(f.offsetY),[g,x]=m$7(l.scaleInfo,this.getTileInfo());0!==n&&s.setRotation(n);const y=s.bounds,_=r+y.x+d,P=i+y.y-u,S=2*(l.minPixelBuffer?l.minPixelBuffer/m:1),k=Math.max(y.width,y.height)*S;s.textBox&&(t.recordStart(this.instanceId,this.attributeLayout,s.glyphs[0].textureBinding),t.recordBounds(_,P,k,k),this._writeTextBox(t,o,r,i,s.textBox,a,c),t.recordEnd());for(const e of s.glyphs){t.recordStart(this.instanceId,this.attributeLayout,e.textureBinding),t.recordBounds(_,P,k,k);const{texcoords:s,offsets:n}=e;this._writeQuad(t,o,r,i,{texcoords:s,offsets:n,fontSize:m,color:h$c(l.color),isBackground:!1,referenceBounds:a,minZoom:g,maxZoom:x,...c}),t.recordEnd();}0!==n&&s.setRotation(-n);}_writeTextBox(t,e,o,r,i,s,n){const a=this.evaluatedMeshParams,{fontSize:c}=this._textMeshTransformProps,{boxBackgroundColor:l,boxBorderLineColor:f}=a,p={isBackground:!0,fontSize:c,referenceBounds:s,...n};l&&(this._writeQuad(t,e,o,r,{texcoords:k$1,offsets:i.main,color:h$c(l),...p}),f||(this._writeQuad(t,e,o,r,{texcoords:w,offsets:i.top,color:h$c(l),...p}),this._writeQuad(t,e,o,r,{texcoords:M,offsets:i.bot,color:h$c(l),...p}),this._writeQuad(t,e,o,r,{texcoords:z,offsets:i.left,color:h$c(l),...p}),this._writeQuad(t,e,o,r,{texcoords:L,offsets:i.right,color:h$c(l),...p}))),f&&(this._writeQuad(t,e,o,r,{texcoords:B,offsets:i.top,color:h$c(f),...p}),this._writeQuad(t,e,o,r,{texcoords:B,offsets:i.bot,color:h$c(f),...p}),this._writeQuad(t,e,o,r,{texcoords:R,offsets:i.left,color:h$c(f),...p}),this._writeQuad(t,e,o,r,{texcoords:R,offsets:i.right,color:h$c(f),...p}));}_writeQuad(t,e,o,r,i){const s=t.vertexCount();this._writeVertex(t,e,o,r,i),t.indexWrite(s+0),t.indexWrite(s+1),t.indexWrite(s+2),t.indexWrite(s+1),t.indexWrite(s+3),t.indexWrite(s+2);}};const G=t=>Math.round(t*(254/360));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const g=1,p$1=0,f=128,_$1=o$j((e=>{let t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t}));class x extends E$1{constructor(){super(...arguments),this._zoomLevel=0;}_write(e,t,i,s){if(this._zoomLevel=s||0,null!=i)throw new Error("InternalError: EffectGeometry not support for LabelMeshWriter");switch(t.geometryType){case"esriGeometryPoint":{const i=t.readXForDisplay(),s=t.readYForDisplay();return this._writePoint(e,i,s,t)}case"esriGeometryEnvelope":case"esriGeometryPolygon":case"esriGeometryMultipoint":{const i=t.readCentroidForDisplay();if(!i)return;const[s,a]=i.coords;return this._writePoint(e,s,a,t)}case"esriGeometryPolyline":{const i=t.readLegacyGeometryForDisplay();this._writeLines(e,t,i);}}}_writePoint(e,t,i,n){const l=this._getShaping();if(!l)return;let h=this._getPointReferenceBounds();h||(h={offsetX:0,offsetY:0,size:0});const c=l.boundsT,m=a$8(this.evaluatedMeshParams.horizontalAlignment),d=c$6(this.evaluatedMeshParams.verticalAlignment),u=this.evaluatedMeshParams.scaleInfo?.maxScale??0,g=this.evaluatedMeshParams.scaleInfo?.minScale??0,p=f$1(n.getDisplayId());e.metricStart(new r$s(p,t,i,m,d,u,g,h)),e.metricBoxWrite(c),this._writeGlyphs(e,n.getDisplayId(),t,i,l,0,h),e.metricEnd();}_getPointReferenceBounds(){if(!this._references)return null;for(const e of this._references){const t=e.getBoundsInfo();if(t)return t}return null}_writeLines(e,t,i){const{repeatLabel:s,scaleInfo:a}=this.evaluatedMeshParams,o=this.evaluatedMeshParams.repeatLabelDistance||128,n=this._getShaping();if(!n)return;this._current={out:e,id:t.getDisplayId(),shaping:n,zoomRange:m$7(a,this.getTileInfo()),referenceBounds:this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0}};const r=l(i.paths,n.bounds.width),m=this._placeSubdivGlyphs.bind(this),d=(n.bounds.width+o)/(1<<g);for(const l of r)d$1(l,d,m,!!s);}_placeSubdivGlyphs(e,t,i,s){const{allowOverrun:a,labelPosition:o,repeatLabelDistance:n}=this.evaluatedMeshParams,r=this._current.zoomRange[0],l=_$1(t),h=this._current.shaping.bounds.width/(1<<g),c=Math.sqrt(n||f)/(1<<g),m=Math.min(i,s-i),d=this._current.shaping.isMultiline?_$2:Math.log2(m/(c+h/2)),p=0===t?d:Math.min(l,d),x=Math.max(r,this._zoomLevel+g-p),M=this._zoomLevel-x,y=this._current.shaping.bounds.width/2*2**M;this._current.shaping.isMultiline?0===t&&this._placeStraight(e,x):a&&M<0?this._placeStraightAlong(e,r):"parallel"===o?this._placeStraightAlong(e,x):"curved"===o&&this._placeCurved(e,x,y);}_placeStraight(e,t){const{out:i,id:s,shaping:a,referenceBounds:n}=this._current,{x:l,y:h}=e,c=f$1(s),m=this.evaluatedMeshParams.scaleInfo?.maxScale??0,d=this.evaluatedMeshParams.scaleInfo?.minScale??0;i.metricStart(new r$s(c,e.x,e.y,0,0,m,d,null)),i.metricBoxWrite(a.boundsT);const u=e.angle*(180/Math.PI)%360,g=(e.angle*(180/Math.PI)+180)%360;this._writeGlyphs(i,s,l,h,a,0,n,{clipAngle:u,mapAligned:!0,isLineLabel:!0,minZoom:t}),this._writeGlyphs(i,s,l,h,a,0,n,{clipAngle:g,mapAligned:!0,isLineLabel:!0,minZoom:t}),i.metricEnd();}_placeCurved(e,t,i){const{out:s,id:a}=this._current,n=e.clone(),l=e.angle*(180/Math.PI)%360,h=(e.angle*(180/Math.PI)+180)%360,c=f$1(a),m=this.evaluatedMeshParams.scaleInfo?.maxScale??0,d=this.evaluatedMeshParams.scaleInfo?.minScale??0;s.metricStart(new r$s(c,e.x,e.y,0,0,m,d,null)),this._placeFirst(n,t,1,l),this._placeBack(e,n,t,i,1,l),this._placeForward(e,n,t,i,1,l),this._placeFirst(n,t,0,h),this._placeBack(e,n,t,i,0,h),this._placeForward(e,n,t,i,0,h),s.metricEnd();}_placeStraightAlong(e,s){const{out:a,id:n,shaping:l,zoomRange:h,referenceBounds:c}=this._current,{boxBorderLineColor:m,boxBackgroundColor:d}=this.evaluatedMeshParams,g=e.clone(),p=e.angle*(180/Math.PI)%360,f=(e.angle*(180/Math.PI)+180)%360;if(l.glyphs.length>0&&(m||d)){const o=Math.max(s,h[0],0),r=Math.min(_$2,h[1]),m=M$7(n$u(),-e.angle),[d,g]=l.shapeBackground(m),_={minZoom:o,maxZoom:r,clipAngle:p,mapAligned:!0,isLineLabel:!0};a.recordStart(this.instanceId,this.attributeLayout,l.glyphs[0].textureBinding),this._writeTextBox(a,n,e.x,e.y,g,c,_),a.recordEnd(),_.clipAngle=f,a.recordStart(this.instanceId,this.attributeLayout,l.glyphs[0].textureBinding),this._writeTextBox(a,n,e.x,e.y,g,c,_),a.recordEnd();}const _=f$1(n),x=this.evaluatedMeshParams.scaleInfo?.maxScale??0,M=this.evaluatedMeshParams.scaleInfo?.minScale??0;a.metricStart(new r$s(_,e.x,e.y,0,0,x,M,null)),this._placeFirst(g,s,1,p,!0),this._placeFirst(g,s,0,f,!0),a.metricEnd();}_placeBack(e,t,i,s,a,o){const n=e.clone();let r=e.backwardLength+p$1;for(;n.prev()&&!(r>=s);)this._placeOnSegment(n,t,r,i,-1,a,o),r+=n.length+p$1;}_placeForward(e,t,i,s,a,o){const n=e.clone();let r=e.remainingLength+p$1;for(;n.next()&&!(r>=s);)this._placeOnSegment(n,t,r,i,1,a,o),r+=n.length+p$1;}_placeFirst(e,t,i,s,a=!1){const o=e,{out:n,id:r,shaping:l,zoomRange:h,referenceBounds:c}=this._current,m=l.glyphs;for(const d of m){const m=d.x>l.bounds.x?i:1-i,g=m*e.remainingLength+(1-m)*e.backwardLength,f=Math.abs(d.x+d.width/2-l.bounds.x),_=Math.max(0,this._zoomLevel+Math.log2(f/(g+p$1))),x=Math.max(t,a?0:_);d.maxZoom=Math.min(h[1],_$2),d.angle=e.angle+(1-i)*Math.PI,d.minZoom=Math.max(h[0],x),this._writeLineGlyph(n,r,o.x,o.y,l.bounds,d,s,c,!0),i&&this._isVisible(d.minZoom,d.maxZoom)&&n.metricBoxWrite(d.bounds);}}_placeOnSegment(e,t,i,s,a,o,r){const{out:l,id:h,shaping:c,referenceBounds:m}=this._current,d=c.glyphs,u=e.dx/e.length,g=e.dy/e.length,f={x:e.x+i*-a*u,y:e.y+i*-a*g};for(const _ of d){const d=_.x>c.bounds.x?o:1-o;if(!(d&&1===a||!d&&-1===a))continue;const u=Math.abs(_.x+_.width/2-c.bounds.x),g=Math.max(0,this._zoomLevel+Math.log2(u/i)-.1),x=Math.max(s,this._zoomLevel+Math.log2(u/(i+e.length+p$1)));if(0!==g&&(_.angle=e.angle+(1-o)*Math.PI,_.minZoom=x,_.maxZoom=g,this._writeLineGlyph(l,h,f.x,f.y,c.bounds,_,r,m,!0),o&&this._isVisible(_.minZoom,_.maxZoom))){const i=_.bounds,s=e.x-t.x,a=e.y-t.y,o=new i$n(i.center[0]+s,i.center[1]+a,i.width,i.height);l.metricBoxWrite(o);}}}_writeLineGlyph(e,t,i,s,a,o,n,r,l){const h=i+a.x,c=s+a.y,d=2*(this.evaluatedMeshParams.minPixelBuffer?this.evaluatedMeshParams.minPixelBuffer/this._textMeshTransformProps.fontSize:1),u=Math.max(a.width,a.height)*d;e.recordStart(this.instanceId,this.attributeLayout,o.textureBinding),e.recordBounds(h,c,u,u);const{texcoords:g,offsets:p}=o,f=this._textMeshTransformProps.fontSize;this._writeQuad(e,t,i,s,{texcoords:g,offsets:p,fontSize:f,color:h$c(this.evaluatedMeshParams.color),isBackground:!1,referenceBounds:r,minZoom:Math.max(this._current.zoomRange[0],o.minZoom),maxZoom:Math.min(this._current.zoomRange[1],o.maxZoom),clipAngle:n,mapAligned:l,isLineLabel:!0}),e.recordEnd();}_isVisible(e,t){const i=this._zoomLevel;return e<=i&&i<=t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const m={createComputedParams:t=>t,attributes:{..._$8.attributes,bitset:{type:C$8.UNSIGNED_BYTE,count:1,pack:({shouldSampleAlphaOnly:t,shouldScaleDash:e,isSDF:s})=>l$8([[q$5,t],[F$5,e],[H$2,s]])},tlbr:{type:C$8.UNSIGNED_SHORT,count:4,pack:({sprite:t})=>{const{rect:r,width:s,height:i}=t,o=r.x+$$2,n=r.y+$$2;return [o,n,o+s,n+i]}},accumulatedDistance:{type:C$8.UNSIGNED_SHORT,count:1,packTessellation:({distance:t})=>t},segmentDirection:{type:C$8.BYTE,count:2,packPrecisionFactor:16,packTessellation:({directionX:t,directionY:e})=>[t,e]}}};class p extends w$5{constructor(t,e,r,s){super(t,e,r,s),this.vertexSpec=m,this._tessellationOptions.textured=!0;}_write(e,r,s){const i=s??a$d.fromFeatureSetReaderCIM(r);if(!i)return;const{sprite:o}=this.evaluatedMeshParams;this._writeGeometry(e,r,i,o?.textureBinding);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
class h{static from(t){return "width"in t?this.fromSimpleMeshParams(t):this.fromComplexMeshParams(t)}static fromSimpleMeshParams(e){const i=new h(e.sprite,e.color,e.outlineColor,e.minPixelBuffer,e.placement,e.scaleInfo,e.effects),{type:o,width:s,height:r,angle:n,alignment:a,outlineSize:c,referenceSize:l,sprite:m,overrideOutlineColor:f}=e;i.rawWidth=u$h(s),i.rawHeight=u$h(r),i.angle=n,i.alignment=a,i.outlineSize=u$h(c),i.referenceSize=u$h(l),i.overrideOutlineColor=f,i.offsetX=u$h(e.offsetX),i.offsetY=u$h(e.offsetY),"simple"!==o||m.sdf||(i.rawWidth=m.width,i.rawHeight=m.height);const d=2;return i.sizeRatio=m.sdf?d:1,i._computeSize(e,!1),i}static fromComplexMeshParams(e){const o=new h(e.sprite,e.color,e.outlineColor,e.minPixelBuffer,e.placement,e.scaleInfo,e.effects);let{alignment:s,transforms:r,size:n,scaleX:a,anchorX:c,anchorY:l,angle:m,colorLocked:f,frameHeight:d,widthRatio:u,offsetX:p,offsetY:g,outlineSize:x,referenceSize:z,scaleFactor:w,sizeRatio:S,isAbsoluteAnchorPoint:X,rotateClockwise:Y,scaleSymbolsProportionally:H,sprite:C}=e;if(r&&r.infos.length>0){const t=O$6(n,m,Y,p,g,r);n=t.size,m=t.rotation,p=t.offsetX,g=t.offsetY,Y=!1;}w&&(n*=w,p*=w,g*=w);const M=a*(C.width/C.height);o.alignment=s,o.rawHeight=u$h(n),o.rawWidth=o.rawHeight*M,o.referenceSize=u$h(z),o.sizeRatio=S,o.angle=m,o.rotateClockwise=Y,o.anchorX=c,o.anchorY=l,o.offsetX=u$h(p),o.offsetY=u$h(g),X&&n&&(C.sdf?o.anchorX=c/(n*u):o.anchorX=c/(n*M),o.anchorY=l/n);const W=H&&d?n/d:1;return o.outlineSize=0===x||isNaN(x)?0:u$h(x)*W,o.scaleSymbolsProportionally=H,o.colorLocked=f,o._computeSize(e,!0),o}constructor(t,i,o,s,h,r,n){this.sprite=t,this.color=i,this.outlineColor=o,this.minPixelBuffer=s,this.placement=h,this.scaleInfo=r,this.effects=n,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.alignment=i$q.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0;}get boundsInfo(){return {size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(t,e){const{sprite:i,hasSizeVV:h}=t,r=!!i.sdf,{rawWidth:n,rawHeight:a,sizeRatio:c,outlineSize:l}=this,m=n*c,f=a*c;if(r&&!h){const t=e&&n>a?m:n,i=a,o=l+2*1;this.computedWidth=Math.min(t+o,m),this.computedHeight=Math.min(i+o,f);}else this.computedWidth=m,this.computedHeight=f;const d=r?_$d/Math.max(m,f):1,u=.5*(m-this.computedWidth)*d,p=.5*(f-this.computedHeight)*d,g=i.rect.x+$$2+u,x=i.rect.y+$$2+p,z=g+i.width-2*u,w=x+i.height-2*p;this.texXmin=Math.floor(g),this.texYmin=Math.floor(x),this.texXmax=Math.ceil(z),this.texYmax=Math.ceil(w),this.computedWidth*=(this.texXmax-this.texXmin)/(z-g),this.computedHeight*=(this.texYmax-this.texYmin)/(w-x),this.anchorX*=m/this.computedWidth,this.anchorY*=f/this.computedHeight;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const o$1={bitset:{isSDF:0,isMapAligned:1,scaleSymbolsProportionally:2,overrideOutlineColor:3,colorLocked:4}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const k=3.14159265359/180,b=128/Math.PI;function S(e,t){return e%=t,Math.abs(e>=0?e:e+t)}function I(e){return S(e*b,256)}function _(e,a,n,c,m=!1){const l=n$u(),u=m?1:-1;return a$o(l),(a||n)&&i$o(l,l,[a,-n]),c&&s$q(l,l,u*k*-c),l}const v={createComputedParams:e=>h.from(e),attributes:{pos:{type:C$8.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:C$8.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:C$8.UNSIGNED_BYTE,count:1,pack:({sprite:e,alignment:t,scaleSymbolsProportionally:r,overrideOutlineColor:o,colorLocked:s})=>{let i=0;return e.sdf&&(i|=f$a(o$1.bitset.isSDF)),t===i$q.MAP&&(i|=f$a(o$1.bitset.isMapAligned)),r&&(i|=f$a(o$1.bitset.scaleSymbolsProportionally)),o&&(i|=f$a(o$1.bitset.overrideOutlineColor)),s&&(i|=f$a(o$1.bitset.colorLocked)),i}},zoomRange:{type:C$8.SHORT,count:2,packPrecisionFactor:at$1,pack:({scaleInfo:e},{tileInfo:t})=>m$7(e,t)},offset:{type:C$8.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({angle:e,computedWidth:t,computedHeight:r,anchorX:o,anchorY:s,offsetX:i,offsetY:n,rotateClockwise:c})=>{const m=_(0,i,n,-e,c),l=-(.5+o)*t,u=-(.5-s)*r,d=[l,u],p=[l+t,u],h=[l,u+r],f=[l+t,u+r];return S$8(d,d,m),S$8(p,p,m),S$8(h,h,m),S$8(f,f,m),[d,p,h,f]}}},textureUV:{type:C$8.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({texXmax:e,texXmin:t,texYmax:r,texYmin:o})=>[[t,o],[e,o],[t,r],[e,r]]}},color:{type:C$8.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:e})=>h$c(e)},outlineColor:{type:C$8.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:e})=>h$c(e)},sizing:{type:C$8.UNSIGNED_BYTE,count:4,pack:({rawWidth:e,rawHeight:t,outlineSize:r,referenceSize:o})=>{const s=Math.max(e,t);return [d$7(s,128),d$7(r,128),d$7(o,128),0]}},placementAngle:{type:C$8.UNSIGNED_BYTE,count:1,packTessellation:({placementAngle:e})=>I(e)},sizeRatio:{type:C$8.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:({sizeRatio:e})=>e}}};class E extends o$9{constructor(){super(...arguments),this.vertexSpec=v;}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(e,t,r){const o=this.evaluatedMeshParams.sprite?.textureBinding,s=t.getDisplayId();e.recordStart(this.instanceId,this.attributeLayout,o);const i=this.evaluatedMeshParams.minPixelBuffer,a=Math.max(this.evaluatedMeshParams.computedWidth,i),n=Math.max(this.evaluatedMeshParams.computedHeight,i),m=this.evaluatedMeshParams.offsetX,l=-this.evaluatedMeshParams.offsetY;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(e,t,r,a,n);else if(r&&r.nextPath()){r.nextPoint();const t=r.x,o=r.y;e.recordBounds(t+m,o+l,a,n),this._writeQuad(e,s,t,o);}else if("esriGeometryPolygon"===t.geometryType){const r=t.readCentroidForDisplay();if(!r)return;const[o,i]=r.coords;e.recordBounds(o+m,i+l,a,n),this._writeQuad(e,s,o,i);}else if("esriGeometryPoint"===t.geometryType){const r=t.readXForDisplay(),o=t.readYForDisplay();e.recordBounds(r+m,o+l,a,n),this._writeQuad(e,s,r,o);}else {const r=t.readGeometryForDisplay();r?.forEachVertex(((t,r)=>{e.recordBounds(t+m,r+l,a,n),Math.abs(t)>t$o||Math.abs(r)>t$o||this._writeQuad(e,s,t,r);}));}e.recordEnd();}_writePlacedMarkers(t,r,o,s,i){const a=o??a$d.fromFeatureSetReaderCIM(r)?.clone();if(!a)return;const m=-1,u=e.getPlacement(a,m,this.evaluatedMeshParams.placement,u$h(1),t.id,t$6());if(!u)return;const d=r.getDisplayId();let p=u.next();const h=this.evaluatedMeshParams.offsetX,f=-this.evaluatedMeshParams.offsetY;for(;null!=p;){const e=p.tx,r=-p.ty;if(Math.abs(e)>t$o||Math.abs(r)>t$o){p=u.next();continue}const o=-p.getAngle();t.recordBounds(e+h,r+f,s,i),this._writeQuad(t,d,e,r,o),p=u.next();}}_writeQuad(e,t,r,o,s){const i=e.vertexCount(),a=null==s?null:{placementAngle:s};this._writeVertex(e,t,r,o,a),e.indexWrite(i+0),e.indexWrite(i+1),e.indexWrite(i+2),e.indexWrite(i+1),e.indexWrite(i+3),e.indexWrite(i+2);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const o={createComputedParams:e=>e,attributes:{pos:{type:C$8.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:C$8.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:C$8.UNSIGNED_BYTE,count:1,pack:e=>0},offset:{type:C$8.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:({size:t})=>{const r=u$h(t),i=-r/2,o=-r/2;return [[i,o],[i+r,o],[i,o+r],[i+r,o+r]]}}},texCoords:{type:C$8.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:C$8.UNSIGNED_BYTE,count:2,pack:({size:e})=>[e,e]},referenceSize:{type:C$8.UNSIGNED_BYTE,count:1,pack:({size:t})=>u$h(t)},zoomRange:{type:C$8.UNSIGNED_BYTE,count:2,pack:({scaleInfo:e},{tileInfo:r})=>m$7(e,r)}}};class s extends o$9{constructor(){super(...arguments),this.vertexSpec=o;}_write(t,r){const i=r.getDisplayId(),o=this.evaluatedMeshParams.minPixelBuffer,s=Math.max(u$h(this.evaluatedMeshParams.size),o);let c,n;if("esriGeometryPoint"===r.geometryType)c=r.readXForDisplay(),n=r.readYForDisplay();else {const e=r.readCentroidForDisplay();if(!e)return;c=e?.coords[0],n=e?.coords[1];}t.recordStart(this.instanceId,this.attributeLayout),t.recordBounds(c,n,s,s);const a=t.vertexCount();this._writeVertex(t,i,c,n),t.indexWrite(a+0),t.indexWrite(a+1),t.indexWrite(a+2),t.indexWrite(a+1),t.indexWrite(a+3),t.indexWrite(a+2),t.recordEnd();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
const a=j({FillMeshWriter:i$5,DotDensityMeshWriter:s$a,ComplexFillMeshWriter:y$3,PatternFillMeshWriter:a$5,OutlineFillMeshWriter:h$a,PatternOutlineFillMeshWriter:c$1,ComplexOutlineFillMeshWriter:N,MarkerMeshWriter:E,PieChartMeshWriter:s,TextMeshWriter:E$1,LineMeshWriter:w$5,TexturedLineMeshWriter:p,HeatmapMeshWriter:i$1,LabelMeshWriter:x});function j(r){const e={};for(const t in r){const i={name:t,constructor:r[t]};e[t]=i;}return e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
let d=class extends S$b{constructor(t){super(t),this.debugName="",this._updatingHandles=new h$l,this._idToUpdatingState=new s$t;}get updating(){const t=this._updatingHandles.updating||Array.from(this._idToUpdatingState.values()).some((t=>t));if(has("esri-2d-log-updating")){const r=Array.from(this._idToUpdatingState.entries()).map((([t,r])=>`-> ${t}: ${r}`)).join("\n");console.log(`${this.debugName}: Updating: ${t}\n-> Handles: ${this._updatingHandles.updating}\n${r}`);}return t}addUpdateTracking(t,r){const o=d$e((()=>r.updating),(r=>this._idToUpdatingState.set(t,r)),{sync:!0});this.addHandles(o);}addPromise(t){return this._updatingHandles.addPromise(t)}};e$n([y$9({constructOnly:!0})],d.prototype,"debugName",void 0),e$n([y$9({readOnly:!0})],d.prototype,"updating",null),d=e$n([c$f("esri.view.2d.layers.support.UpdateTracking2D")],d);

export { w$3 as $, x$4 as A, Bn as B, C$1 as C, S$5 as D, P$3 as E, F$4 as F, G$2 as G, H$1 as H, nt as I, J$2 as J, K$3 as K, ln as L, q$3 as M, q$1 as N, x$3 as O, P$4 as P, E$2 as Q, C as R, S$6 as S, H as T, U$1 as U, z$1 as V, W$3 as W, S$4 as X, R$3 as Y, Z$2 as Z, _$5 as _, a, xt as a0, h$6 as a1, Bt as a2, i$4 as a3, t$5 as a4, Wn as a5, tn as a6, K as a7, v$3 as a8, Xt as a9, Zt as aA, Ct as aB, T$2 as aC, D as aD, F$5 as aE, H$2 as aF, q$5 as aG, q$2 as aH, z$3 as aI, u$2 as aJ, r$2 as aK, c$4 as aL, St as aM, o$7 as aN, sn as aO, h$5 as aP, yt as aQ, g$4 as aR, o$1 as aS, a$2 as aT, l$9 as aU, u$8 as aV, c$7 as aW, f$b as aX, i$b as aY, Un as aa, vn as ab, j$3 as ac, A$3 as ad, t$1 as ae, n$4 as af, G$3 as ag, P$2 as ah, O$1 as ai, Dt as aj, Nt as ak, Y as al, I$4 as am, J$1 as an, f$4 as ao, h$4 as ap, m$1 as aq, p$2 as ar, f$3 as as, l$1 as at, p$3 as au, B$1 as av, q as aw, bn as ax, Sn as ay, k$3 as az, n$1 as b, a$d as c, d, ne as e, f$1 as f, l$3 as g, b$4 as h, tt as i, j$4 as j, k$4 as k, l$c as l, se as m, n$s as n, o$b as o, j$5 as p, ee as q, r$n as r, s$3 as s, t$8 as t, kn as u, te as v, g$6 as w, d$2 as x, F$3 as y, U as z };
