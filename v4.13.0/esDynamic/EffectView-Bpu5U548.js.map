{"version":3,"file":"EffectView-Bpu5U548.js","sources":["../../node_modules/@arcgis/core/layers/effects/EffectView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Accessor.js\";import has from\"../../core/has.js\";import{clone as s}from\"../../core/lang.js\";import r from\"../../core/Logger.js\";import{property as i}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as n}from\"../../core/accessorSupport/decorators/subclass.js\";import{parse as c}from\"./parser.js\";import{canInterpolateEffects as o,normalizeEffects as f}from\"./utils.js\";const l=-1;let a=class extends e{constructor(t){super(t),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=has(\"mapview-transitions-duration\"),this.effects=[]}set effect(t){if(this._get(\"effect\")!==(t=t||\"\")){this._set(\"effect\",t);try{this._transitionTo(h(t))}catch(e){this._transitionTo([]),r.getLogger(this).warn(\"Invalid Effect\",{effect:t,error:e})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(t){this._updateForScale(t)}get transitioning(){return null!==this._to}canTransitionTo(t){try{return this.scale>0&&u(this._current,h(t),this.scale)}catch{return!1}}transitionStep(t,e){this._applyTimeTransition(t),this._updateForScale(e)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(t){this.scale>0&&u(this._current,t,this.scale)?(this._final=t,this._to=s(t),_(this._current,this._to,this.scale),this._from=s(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=t),this._set(\"effects\",this._current[0]?s(this._current[0].effects):[])}_applyTimeTransition(t){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=t;const e=Math.min(1,this._time/this.duration);for(let s=0;s<this._current.length;s++){const t=this._current[s],r=this._from[s],i=this._to[s];t.scale=p(r.scale,i.scale,e);for(let s=0;s<t.effects.length;s++){const n=t.effects[s],c=r.effects[s],o=i.effects[s];n.interpolate(c,o,e)}}1===e&&(this._current=this._final,this._set(\"effects\",this._current[0]?s(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(t){if(this._set(\"scale\",t),0===this._current.length)return;const e=this._current,s=this._current.length-1;let r,i,n=1;if(1===e.length||t>=e[0].scale)i=r=e[0].effects;else if(t<=e[s].scale)i=r=e[s].effects;else for(let c=0;c<s;c++){const s=e[c],o=e[c+1];if(s.scale>=t&&o.scale<=t){n=(t-s.scale)/(o.scale-s.scale),r=s.effects,i=o.effects;break}}for(let c=0;c<this.effects.length;c++){this.effects[c].interpolate(r[c],i[c],n)}}};function h(t){const e=c(t)||[];return m(e)?[{scale:l,effects:e}]:e}function u(t,e,s){if(!t[0]?.effects||!e[0]?.effects)return!0;return!((t[0]?.scale===l||e[0]?.scale===l)&&(t.length>1||e.length>1)&&s<=0)&&o(t[0].effects,e[0].effects)}function _(t,e,s){const r=t.length>e.length?t:e,i=t.length>e.length?e:t,n=i[i.length-1],c=n?.scale??s,o=n?.effects??[];for(let f=i.length;f<r.length;f++)i.push({scale:c,effects:[...o]});for(let a=0;a<r.length;a++)i[a].scale=i[a].scale===l?s:i[a].scale,r[a].scale=r[a].scale===l?s:r[a].scale,f(i[a].effects,r[a].effects)}function p(t,e,s){return t+(e-t)*s}function m(t){const e=t[0];return!!e&&\"type\"in e}t([i()],a.prototype,\"_to\",void 0),t([i()],a.prototype,\"duration\",void 0),t([i({value:\"\"})],a.prototype,\"effect\",null),t([i({readOnly:!0})],a.prototype,\"effects\",void 0),t([i({readOnly:!0})],a.prototype,\"final\",null),t([i({readOnly:!0})],a.prototype,\"hasEffects\",null),t([i({value:0})],a.prototype,\"scale\",null),t([i({readOnly:!0})],a.prototype,\"transitioning\",null),a=t([n(\"esri.layers.effects.EffectView\")],a);export{a as EffectView,u as canInterpolateEffectStops,h as convertEffectToStops,_ as normalizeEffectStops};\n"],"names":["l","a","e","has","h","r","u","s","_","t","i","p","n","c","o","m","f"],"mappings":"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","x_google_ignoreList":[0]}