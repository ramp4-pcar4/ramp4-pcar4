import{bN as m,bO as l,bP as N,bK as s,bQ as S}from"./main-BFDurRCu.js";function b(e,t){return{...t,filterMode:e.mode}}function x(e,t){return I(e,t).next().value??null}function T(e,t,n){const r=h(e);if(r&&(m(t,r[0])||l(n,r[1])))return"";const a=Array.from(I(e,t,n)),i=p(a,t,n)?"1=1":a.map(o=>o.where||"1=1").reduce((o,f)=>N(o,f),"");return i&&i!=="1=1"?i:""}function h(e){if(d(e)==="manual")return null;const t=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:n,maxScale:r}of e.filters)t[0]=Math.max(t[0],u(n)),t[1]=Math.min(t[1],c(r));return t}function*I(e,t,n){if(d(e)==="manual"){const r=e.filters.find(a=>a.id===e.activeFilterId);r&&(yield r)}else{typeof t=="object"&&(t=t.scale);for(const r of e.filters)y(r.minScale,r.maxScale,t,n)&&(yield r)}}function p(e,t,n){if(e.length===0)return!0;const r=u(e.at(0)?.minScale),a=c(e.at(-1)?.maxScale);if(l(r,t)||m(a,n))return!0;for(let i=0;i<e.length-1;i++){const o=e[i],f=e[i+1];if(l(u(f.minScale),c(o.maxScale)))return!0}return!1}function y(e,t,n,r){return e=u(e),n=u(n),t=c(t),!(!s(n,e)&&(r??n)>e)&&!S(t,n)&&(r===void 0||!s(r,e))}function d(e){return"mode"in e?e.mode:e.filterMode}function u(e){return e||Number.POSITIVE_INFINITY}function c(e){return e||0}export{T as c,b as i,x as u};
