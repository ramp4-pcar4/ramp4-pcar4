import{af as J,ah as _}from"./main-BFDurRCu.js";import{o as h,_ as v,A as m,P as f,u as k,g as L,c as T,H as X}from"./vec32-Cj8pVsU0.js";import"./vec42-D8CJyqHG.js";import{r as Q,c as N,a as x}from"./vectorStacks-5ZZtmT9E.js";function V(t){const n=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],o=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],a=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(n,o,a))}function j(t,n){const o=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),a=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),s=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return h(t,o,a,s),t}function u(t,n,o){Math.abs(t[0])>Math.abs(t[1])?h(n,0,1,0):h(n,1,0,0),v(o,t,n),v(n,o,t),m(o,o),m(n,n)}function y(t=g){return[t[0],t[1],t[2],t[3]]}function K(t=g[0],n=g[1],o=g[2],a=g[3]){return d(t,n,o,a,Q.get())}function w(t,n){return d(n[0],n[1],n[2],n[3],t)}function $(t){return t}function d(t,n,o,a,s=y()){return s[0]=t,s[1]=n,s[2]=o,s[3]=a,s}function z(t,n,o){const a=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],s=Math.abs(a-1)>1e-5&&a>1e-12?1/Math.sqrt(a):1;return o[0]=n[0]*s,o[1]=n[1]*s,o[2]=n[2]*s,o[3]=-(o[0]*t[0]+o[1]*t[1]+o[2]*t[2]),o}function G(t,n,o,a=y()){const s=o[0]-n[0],i=o[1]-n[1],c=o[2]-n[2],e=t[0]-n[0],U=t[1]-n[1],C=t[2]-n[2],M=i*C-c*U,q=c*e-s*C,b=s*U-i*e,p=M*M+q*q+b*b,P=Math.abs(p-1)>1e-5&&p>1e-12?1/Math.sqrt(p):1;return a[0]=M*P,a[1]=q*P,a[2]=b*P,a[3]=-(a[0]*t[0]+a[1]*t[1]+a[2]*t[2]),a}function H(t,n,o,a=0,s=Math.floor(o*(1/3)),i=Math.floor(o*(2/3))){if(o<3)return!1;n(D,a);let c=s,e=!1;for(;c<o-1&&!e;)n(S,c),c++,e=!X(D,S);if(!e)return!1;for(c=Math.max(c,i),e=!1;c<o&&!e;)n(E,c),c++,T(A,D,S),m(A,A),T(F,S,E),m(F,F),e=!X(D,E)&&!X(S,E)&&Math.abs(f(A,F))<W;return e?(G(D,S,E,t),!0):(a!==0||s!==1||i!==2)&&H(t,n,o,0,1,2)}function B(t,n,o=!0){const a=n.length/3;return H(t,(s,i)=>h(s,n[3*i+0],n[3*i+1],n[3*i+2]),o?a-1:a)}const W=.99619469809,D=_(),S=_(),E=_(),A=_(),F=_();function Y(t,n,o){return n!==t&&w(t,n),t[3]=-f(t,o),t}function Z(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function tt(t,n,o,a){return v(E,n,t),z(o,E,a)}function nt(t,n,o,a){return l(R(t,n,T(N.get(),o,n),Et,a))}function ot(t,n,o){return n!=null&&l(R(t,n.origin,n.direction,ft,o))}function at(t,n,o){return l(R(t,n.origin,n.vector,I.NONE,o))}function st(t,n,o){return l(R(t,n.origin,n.vector,I.CLAMP,o))}function et(t,n){return O(t,n)>=0}function ct(t,n){const o=f(t,n.ray.direction),a=-O(t,n.ray.origin);if(o>-1e-6&&o<1e-6)return a>0;const s=a/o;return o>0?s<n.c1&&(n.c1=s):s>n.c0&&(n.c0=s),n.c0<=n.c1}function it(t,n,o){const a=L(N.get(),t,-t[3]),s=It(t,T(N.get(),n,a),N.get());return k(o,s,a),o}function rt(t,n,o,a){const s=t,i=N.get(),c=N.get();u(s,i,c);const e=T(N.get(),o,n),U=x(i,e),C=x(c,e),M=x(s,e);return h(a,U,C,M)}function It(t,n,o){const a=L(N.get(),t,f(t,n));return T(o,n,a),o}function Nt(t,n){return Math.abs(O(t,n))}function O(t,n){return f(t,n)+t[3]}var r;function l(t){return t===r.INTERSECTS_INSIDE_OUT||t===r.INTERSECTS_OUTSIDE_IN}function R(t,n,o,a,s){const i=f(t,o),c=O(t,n);if(i===0)return c>=0?r.INSIDE:r.OUTSIDE;let e=-c/i;return a&I.CLAMP&&(e=J(e,0,1)),!(a&I.INFINITE_MIN)&&e<0||!(a&I.INFINITE_MAX)&&e>1?c>=0?r.INSIDE:r.OUTSIDE:(k(s,n,L(s,o,e)),c>=0?r.INTERSECTS_INSIDE_OUT:r.INTERSECTS_OUTSIDE_IN)}(function(t){t[t.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",t[t.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE"})(r||(r={}));const g=[0,0,1,0];var I;(function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"})(I||(I={}));const Et=I.INFINITE_MIN|I.INFINITE_MAX,ft=I.INFINITE_MAX;export{B as A,K as D,ct as G,it as H,rt as J,Z as L,y as M,$ as O,tt as P,Nt as Q,d as U,O as V,u as a,j as g,w as h,nt as k,z as l,V as m,G as p,ot as q,H as v,st as w,at as x,Y as y,et as z};
