import{c as Z,a as w}from"./devEnvironmentUtils-CxrVv3RG.js";import{s as c,Z as S,eE as N,aZ as u,eF as j,em as D,eG as x,eH as F,eI as O}from"./main-BFDurRCu.js";import{i as z,h as A,p as U,m as _,y as G}from"./styleUtils-DBPDLVBX.js";const $=["web-gltf","web","cim"];function v(t,e,a){const l=t.name;return l==null?Promise.reject(new c("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?k(l,e,a):z(t,e,a).then(s=>f(s,l,e,G,a))}function b(t,e){return e.items.find(a=>a.name===t)}async function f(t,e,a,l,s){const n=a?.portal!=null?a.portal:S.getDefault(),r={portal:n,url:u(t.baseUrl)},m=b(e,t.data);if(!m)throw new c("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});const p=s?.acceptedFormats??$,h=l(m,p);if(!h)throw new c("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${e}' does not have an accepted format (one of ${p})`,{symbolName:e});const{url:P,format:T}=h;let i=D(P,r),y=m.thumbnail?.href??null;const d=m.thumbnail?.imageData;Z()&&(i=w(i)??"",y=w(y));const E={portal:n,url:u(j(i)),origin:"portal-item"};return U(i,s).then(g=>{const I=T==="cim"?_(g.data):g.data,o=N(I,E);if(o&&x(o)){if(y){const M=D(y,r);o.thumbnail=new F({url:M})}else d&&(o.thumbnail=new F({url:`data:image/png;base64,${d}`}));t.styleUrl?o.styleOrigin=new O({portal:a.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(o.styleOrigin=new O({portal:a.portal,styleName:t.styleName,name:e}))}return o})}function k(t,e,a){const l=A.replaceAll(/\{SymbolName\}/gi,t),s=e.portal!=null?e.portal:S.getDefault();return U(l,a).then(n=>{const r=_(n.data);return N(r,{portal:s,url:u(j(l)),origin:"portal-item"})})}const C=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:f,getStyleItemFromStyle:b,resolveWebStyleSymbol:v},Symbol.toStringTag,{value:"Module"}));export{$ as e,b as g,v as h,f as j,C as w};
