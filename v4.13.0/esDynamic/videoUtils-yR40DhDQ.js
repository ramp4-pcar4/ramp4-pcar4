import{bn as c,B as h,v as i,x as a,z as v,c2 as p,am as L,al as y,I as P,H as S}from"./main-BFDurRCu.js";import{k as b}from"./cimSymbolUtils-DCedSSCN.js";import{L as E}from"./utils-Cb2uXNfG.js";const C={type:Boolean,json:{write:!0}};let f=class extends c.ClonableMixin(h){constructor(e){super(e),this.frame=!1,this.frameCenter=!1,this.frameOutline=!0,this.lineOfSight=!0,this.sensorLocation=!0,this.sensorTrail=!0}};i([a(C)],f.prototype,"frame",void 0),i([a(C)],f.prototype,"frameCenter",void 0),i([a(C)],f.prototype,"frameOutline",void 0),i([a(C)],f.prototype,"lineOfSight",void 0),i([a(C)],f.prototype,"sensorLocation",void 0),i([a(C)],f.prototype,"sensorTrail",void 0),f=i([v("esri.layers.support.TelemetryDisplay")],f);let d=class extends c.ClonableMixin(h){constructor(e){super(e),this.frameCenter=null,this.frameOutline=null,this.lineOfSight=null,this.sensorLocation=null,this.sensorTrail=null}};i([a({type:p})],d.prototype,"frameCenter",void 0),i([a({type:L})],d.prototype,"frameOutline",void 0),i([a({type:y})],d.prototype,"lineOfSight",void 0),i([a({type:p})],d.prototype,"sensorLocation",void 0),i([a({type:y})],d.prototype,"sensorTrail",void 0),d=i([v("esri.layers.support.TelemetryData")],d);let l=class extends c.ClonableMixin(h){constructor(e){super(e),this.duration=null,this.end=null,this.start=null,this.timezone="UTC"}readEnd(e,r){return r.end!=null?new Date(r.end):null}writeEnd(e,r){r.end=e?e.getTime():null}readStart(e,r){return r.start!=null?new Date(r.start):null}writeStart(e,r){r.start=e?e.getTime():null}};i([a({type:Number,json:{write:{allowNull:!0}}})],l.prototype,"duration",void 0),i([a({type:Date,json:{write:{allowNull:!0}}})],l.prototype,"end",void 0),i([P("end")],l.prototype,"readEnd",null),i([S("end")],l.prototype,"writeEnd",null),i([a({type:Date,json:{write:{allowNull:!0}}})],l.prototype,"start",void 0),i([P("start")],l.prototype,"readStart",null),i([S("start")],l.prototype,"writeStart",null),i([a({type:String})],l.prototype,"timezone",void 0),l=i([v("esri.layers.support.VideoTimeExtent")],l);const w=l,O="application/x-mpegURL",T="video/mp4",A="video/webm",t={PlatformHeadingAngle:10005,PlatformPitchAngle:10006,PlatformRollAngle:10007,SensorLatitude:10013,SensorLongitude:10014,SensorTrueAltitude:10015,SensorHorizontalFOV:10016,SensorVerticalFOV:10017,SensorAzimuthAngle:10018,SensorElevationAngle:10019,SensorRollAngle:10020,FrameCenterLatitude:10023,FrameCenterLongitude:10024,FrameCenterElevation:10025,OffsetCorner1Latitude:10026,OffsetCorner1Longitude:10027,OffsetCorner2Latitude:10028,OffsetCorner2Longitude:10029,OffsetCorner3Latitude:10030,OffsetCorner3Longitude:10031,OffsetCorner4Latitude:10032,OffsetCorner4Longitude:10033,SensorEllipsoidHeight:10075,FrameCenterAboveEllipsoid:10078,EsriVideoWidth:90001,EsriVideoHeight:90002,EsriFrameCenterLatitude:90050,EsriFrameCenterLongitude:90051,EsriCornerLatitudePt1:90052,EsriCornerLongitudePt1:90053,EsriCornerLatitudePt2:90054,EsriCornerLongitudePt2:90055,EsriCornerLatitudePt3:90056,EsriCornerLongitudePt3:90057,EsriCornerLatitudePt4:90058,EsriCornerLongitudePt4:90059,EsriFrameOutline:90060,EsriSensorPosition:90061,EsriHorizonPixelPack:90063,EsriGroundControlPoints:90064};function H(e,r=1e4){if(!e||!e.length)return[];let n=[],o=[];for(let u=0;u<e.length;u++){const g=e[u],m=g?.text?JSON.parse(g.text):null;m?.source==="EsriVideoServer"&&(n=[...m.data])}const s=n.find(u=>u.tagId===r);return Array.isArray(s?.value)&&(o=[...s.value]),o}function D(e){const{duration:r,end:n,start:o,timezone:s="UTC"}=e||{};return typeof r!="number"?null:new w({duration:r||null,end:typeof n=="number"?new Date(n):null,start:typeof o=="number"?new Date(o):null,timezone:s})}function V(e,r){const n=[...r],o=n.findIndex(s=>s.equals(e));return o>-1&&n.splice(o),n.push(e),n}function k(e){if(!e?.size)return new d;const r=Q(e),n=j(e),o=B(e),s=K(r,n);return new d({frameCenter:n,frameOutline:o,lineOfSight:s,sensorLocation:r})}function N(e){return e?.size?e.get(t.EsriGroundControlPoints)?.value??null??null:null}function M(e){return e?.size?e.get(t.EsriHorizonPixelPack)?.value??null:null}function j(e){return R(e)??q(e)}function I(e){if(!e)return O;const r=e.match(/\.(\w{3,4})(?:$|\?)/i);if(!r)return O;switch(r[1].toLowerCase()){case"mp4":return T;case"webm":return A;default:return O}}function U(e){const r=e?.layers;return r?.length?r.map(n=>({layerId:n.id,posterUrl:n.poster,sourceType:n.serviceType,title:n.name,type:n.type||"Video Layer"})):[]}function G(e,r,n){if(!e)return null;const o=e.clone();switch(o.type){case"simple-fill":E(o,n),o.outline.color=r;break;case"simple-line":E(o,r);break;case"simple-marker":E(o,r),o?.outline?.color&&(o.outline.color=r);break;case"cim":b(o,r)}return o}function J(e){const{cameraAzimuth:r,platformHeading:n,source:o=null,symbolOffset:s=0}=e||{};let u=0;if(!o)return u;u=o==="platformHeading"?n+s:n+r+s;const g=u>360?u-360:u;return Math.round(Math.abs(g))}function R(e){return e&&e.has(t.EsriFrameCenterLatitude)&&e.has(t.EsriFrameCenterLongitude)?new p({x:e.get(t.EsriFrameCenterLongitude).value,y:e.get(t.EsriFrameCenterLatitude).value,z:e.get(t.FrameCenterAboveEllipsoid)?.value??e.get(t.FrameCenterElevation)?.value}):null}function q(e){return e&&e.has(t.FrameCenterLatitude)&&e.has(t.FrameCenterLongitude)?new p({x:e.get(t.FrameCenterLongitude)?.value,y:e.get(t.FrameCenterLatitude)?.value,z:e.get(t.FrameCenterElevation)?.value}):null}function B(e){if(!e)return null;const r=e.get(t.EsriFrameOutline)?.value;return r?L.fromJSON(r.geometry):W(e)??$(e)}function W(e){if(!(e.has(t.EsriCornerLatitudePt1)&&e.has(t.EsriCornerLongitudePt1)&&e.has(t.EsriCornerLatitudePt2)&&e.has(t.EsriCornerLongitudePt2)&&e.has(t.EsriCornerLatitudePt3)&&e.has(t.EsriCornerLongitudePt3)&&e.has(t.EsriCornerLatitudePt4)&&e.has(t.EsriCornerLongitudePt4)))return null;const r=[e.get(t.EsriCornerLongitudePt1)?.value,e.get(t.EsriCornerLatitudePt1)?.value],n=[e.get(t.EsriCornerLongitudePt2)?.value,e.get(t.EsriCornerLatitudePt2)?.value],o=[e.get(t.EsriCornerLongitudePt3)?.value,e.get(t.EsriCornerLatitudePt3)?.value],s=[e.get(t.EsriCornerLongitudePt4)?.value,e.get(t.EsriCornerLatitudePt4)?.value];return new L({rings:[[r,n,o,s]]})}function $(e){if(!(e.has(t.OffsetCorner1Latitude)&&e.has(t.OffsetCorner1Longitude)&&e.has(t.OffsetCorner2Latitude)&&e.has(t.OffsetCorner2Longitude)&&e.has(t.OffsetCorner3Latitude)&&e.has(t.OffsetCorner3Longitude)&&e.has(t.OffsetCorner4Latitude)&&e.has(t.OffsetCorner4Longitude)&&e.has(t.FrameCenterLatitude)&&e.has(t.FrameCenterLongitude)))return null;const r=e.get(t.FrameCenterLatitude)?.value,n=e.get(t.FrameCenterLongitude)?.value,o=r+e.get(t.OffsetCorner1Latitude)?.value,s=n+e.get(t.OffsetCorner1Longitude)?.value,u=r+e.get(t.OffsetCorner2Latitude)?.value,g=n+e.get(t.OffsetCorner2Longitude)?.value,m=r+e.get(t.OffsetCorner3Latitude)?.value,F=n+e.get(t.OffsetCorner3Longitude)?.value,x=r+e.get(t.OffsetCorner4Latitude)?.value,z=n+e.get(t.OffsetCorner4Longitude)?.value;return new L({rings:[[[s,o],[g,u],[F,m],[z,x]]]})}function K(e,r){if(!e||!r)return null;const n=[e.x,e.y,e.z??0],o=[r.x,r.y,r.z??0];return new y({paths:[[n,o]]})}function Q(e){if(!e?.size)return null;if(e.has(t.EsriSensorPosition)){const r=e.get(t.EsriSensorPosition)?.value;if(r)return p.fromJSON(r.geometry)}return e.has(t.SensorLongitude)&&e.has(t.SensorLatitude)?new p({x:e.get(t.SensorLongitude)?.value,y:e.get(t.SensorLatitude)?.value,z:e.get(t.SensorTrueAltitude)?.value}):null}export{k as C,I as E,N as L,U as a,w as b,M as c,t as d,d as e,H as f,D as g,J as h,V as m,f as p,G as v};
