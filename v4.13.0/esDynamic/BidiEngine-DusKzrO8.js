const x=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["\xAB","\xBB"],["\xBB","\xAB"],["\u2039","\u203A"],["\u203A","\u2039"],["\u207D","\u207E"],["\u207E","\u207D"],["\u208D","\u208E"],["\u208E","\u208D"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232A"],["\u232A","\u2329"],["\uFE59","\uFE5A"],["\uFE5A","\uFE59"],["\uFE5B","\uFE5C"],["\uFE5C","\uFE5B"],["\uFE5D","\uFE5E"],["\uFE5E","\uFE5D"],["\uFE64","\uFE65"],["\uFE65","\uFE64"]],v=["\u0622","\u0623","\u0625","\u0627"],X=["\uFEF5","\uFEF7","\uFEF9","\uFEFB"],tt=["\uFEF6","\uFEF8","\uFEFA","\uFEFC"],j=["\u0627","\u0628","\u062A","\u062B","\u062C","\u062D","\u062E","\u062F","\u0630","\u0631","\u0632","\u0633","\u0634","\u0635","\u0636","\u0637","\u0638","\u0639","\u063A","\u0641","\u0642","\u0643","\u0644","\u0645","\u0646","\u0647","\u0648","\u064A","\u0625","\u0623","\u0622","\u0629","\u0649","\u0644","\u0645","\u0646","\u0647","\u0648","\u064A","\u0625","\u0623","\u0622","\u0629","\u0649","\u06CC","\u0626","\u0624"],rt=["\uFE8D","\uFE8F","\uFE95","\uFE99","\uFE9D","\uFEA1","\uFEA5","\uFEA9","\uFEAB","\uFEAD","\uFEAF","\uFEB1","\uFEB5","\uFEB9","\uFEBD","\uFEC1","\uFEC5","\uFEC9","\uFECD","\uFED1","\uFED5","\uFED9","\uFEDD","\uFEE1","\uFEE5","\uFEE9","\uFEED","\uFEF1","\uFE87","\uFE83","\uFE81","\uFE93","\uFEEF","\uFBFC","\uFE89","\uFE85","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE89","\uFE85"],et=["\uFE8E","\uFE90","\uFE96","\uFE9A","\uFE9E","\uFEA2","\uFEA6","\uFEAA","\uFEAC","\uFEAE","\uFEB0","\uFEB2","\uFEB6","\uFEBA","\uFEBE","\uFEC2","\uFEC6","\uFECA","\uFECE","\uFED2","\uFED6","\uFEDA","\uFEDE","\uFEE2","\uFEE6","\uFEEA","\uFEEE","\uFEF2","\uFE88","\uFE84","\uFE82","\uFE94","\uFEF0","\uFBFD","\uFE8A","\uFE86","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE8A","\uFE86"],nt=["\uFE8E","\uFE92","\uFE98","\uFE9C","\uFEA0","\uFEA4","\uFEA8","\uFEAA","\uFEAC","\uFEAE","\uFEB0","\uFEB4","\uFEB8","\uFEBC","\uFEC0","\uFEC4","\uFEC8","\uFECC","\uFED0","\uFED4","\uFED8","\uFEDC","\uFEE0","\uFEE4","\uFEE8","\uFEEC","\uFEEE","\uFEF4","\uFE88","\uFE84","\uFE82","\uFE94","\uFEF0","\uFBFF","\uFE8C","\uFE86","\uFE71","\uFE72","\uFE74","\uFE77","\uFE79","\uFE7B","\uFE7D","\uFE7F","\uFE80","\uFE8C","\uFE86"],at=["\uFE8D","\uFE91","\uFE97","\uFE9B","\uFE9F","\uFEA3","\uFEA7","\uFEA9","\uFEAB","\uFEAD","\uFEAF","\uFEB3","\uFEB7","\uFEBB","\uFEBF","\uFEC3","\uFEC7","\uFECB","\uFECF","\uFED3","\uFED7","\uFEDB","\uFEDF","\uFEE3","\uFEE7","\uFEEB","\uFEED","\uFEF3","\uFE87","\uFE83","\uFE81","\uFE93","\uFEEF","\uFBFE","\uFE8B","\uFE85","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE8B","\uFE85"],W=["\u0621","\u0622","\u0623","\u0624","\u0625","\u0627","\u0629","\u062F","\u0630","\u0631","\u0632","\u0648","\u0649"],lt=["\u064B","\u064B","\u064C","\u061F","\u064D","\u061F","\u064E","\u064E","\u064F","\u064F","\u0650","\u0650","\u0651","\u0651","\u0652","\u0652","\u0621","\u0622","\u0622","\u0623","\u0623","\u0624","\u0624","\u0625","\u0625","\u0626","\u0626","\u0626","\u0626","\u0627","\u0627","\u0628","\u0628","\u0628","\u0628","\u0629","\u0629","\u062A","\u062A","\u062A","\u062A","\u062B","\u062B","\u062B","\u062B","\u062C","\u062C","\u062C","\u062C","\u062D","\u062D","\u062D","\u062D","\u062E","\u062E","\u062E","\u062E","\u062F","\u062F","\u0630","\u0630","\u0631","\u0631","\u0632","\u0632","\u0633","\u0633","\u0633","\u0633","\u0634","\u0634","\u0634","\u0634","\u0635","\u0635","\u0635","\u0635","\u0636","\u0636","\u0636","\u0636","\u0637","\u0637","\u0637","\u0637","\u0638","\u0638","\u0638","\u0638","\u0639","\u0639","\u0639","\u0639","\u063A","\u063A","\u063A","\u063A","\u0641","\u0641","\u0641","\u0641","\u0642","\u0642","\u0642","\u0642","\u0643","\u0643","\u0643","\u0643","\u0644","\u0644","\u0644","\u0644","\u0645","\u0645","\u0645","\u0645","\u0646","\u0646","\u0646","\u0646","\u0647","\u0647","\u0647","\u0647","\u0648","\u0648","\u0649","\u0649","\u064A","\u064A","\u064A","\u064A","\uFEF5","\uFEF6","\uFEF7","\uFEF8","\uFEF9","\uFEFA","\uFEFB","\uFEFC","\u061F","\u061F","\u061F"],Z=["\u0621","\u0641"],it=["\u063A","\u064A"],ct=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ot=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],e=0,i=1,f=2,B=3,t=4,p=5,D=6,r=7,F=8,m=9,_=10,A=11,n=12,st=13,ut=14,ht=15,ft=16,At=17,h=18,Tt=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],S=100,Lt=[S+0,e,e,e,e,S+1,S+2,S+3,i,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,S+4,t,t,t,e,t,e,t,e,t,t,t,e,e,t,t,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,e,e,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,S+5,r,r,S+6,S+7],Ut=[[h,h,h,h,h,h,h,h,h,D,p,D,F,p,h,h,h,h,h,h,h,h,h,h,h,h,h,h,p,p,p,D,F,t,t,A,A,A,t,t,t,t,t,_,m,_,m,m,f,f,f,f,f,f,f,f,f,f,m,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,h,h,h,h,h,h,p,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,m,t,A,A,A,A,t,t,t,t,e,t,t,h,t,t,A,A,f,f,t,e,t,t,t,f,e,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,i,n,i,n,n,i,n,n,i,n,t,t,t,t,t,t,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,t,t,t,t,i,i,i,i,i,t,t,t,t,t,t,t,t,t,t,t],[B,B,B,B,t,t,t,t,r,A,A,r,m,r,t,t,n,n,n,n,n,n,n,n,n,n,n,r,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,B,B,B,B,B,B,B,B,B,B,A,B,B,r,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,B,t,n,n,n,n,n,n,r,r,n,n,t,n,n,n,n,r,r,f,f,f,f,f,f,f,f,f,f,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,n,n,n,n,n,n,n,n,n,i,i,t,t,t,t,i,t,t,t,t,t],[F,F,F,F,F,F,F,F,F,F,F,h,h,h,e,i,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,F,p,st,ut,ht,ft,At,m,A,A,A,A,A,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,F,h,h,h,h,h,t,t,t,t,t,h,h,h,h,h,h,f,e,t,t,f,f,f,f,f,f,_,_,t,t,t,e,f,f,f,f,f,f,f,f,f,f,_,_,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,t,t,t,t,t,i,n,i,i,i,i,i,i,i,i,i,i,_,i,i,i,i,i,i,i,i,i,i,i,i,i,t,i,i,i,i,i,t,i,t,i,i,t,i,i,t,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,t,m,t,t,m,t,t,t,t,t,t,t,t,t,A,t,t,_,_,t,t,t,t,t,A,A,t,t,t,t,t,r,r,r,r,r,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,h],[t,t,t,A,A,A,t,t,t,t,t,_,m,_,m,m,f,f,f,f,f,f,f,f,f,f,m,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,t,t,t,A,A,t,t,t,A,A,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];class dt{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(a,c,o){if(this.sourceToTarget=[],this.targetToSource=[],!a)return"";if(It(this.sourceToTarget,this.targetToSource,a.length),!this.checkParameters(c,o))return a;c=this.inputFormat,o=this.outputFormat;let s=a;const u=jt,L=J(c.charAt(1)),T=J(o.charAt(1)),U=(c.charAt(0)==="I"?"L":c.charAt(0))+L,d=(o.charAt(0)==="I"?"L":o.charAt(0))+T,g=c.charAt(2)+o.charAt(2);u.defInFormat=U,u.defOutFormat=d,u.defSwap=g;const w=V(a,U,d,g,u);let N=!1;return o.charAt(1)==="R"?N=!0:o.charAt(1)!=="C"&&o.charAt(1)!=="D"||(N=this.checkContextual(w)==="rtl"),this.sourceToTarget=R,this.targetToSource=xt(this.sourceToTarget),P=this.targetToSource,s=c.charAt(3)===o.charAt(3)?w:o.charAt(3)==="S"?gt(N,w):Rt(w,N,!0),this.sourceToTarget=R,this.targetToSource=P,this.levels=y,s}_inputFormatSetter(a){if(!Q.test(a))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=a}_outputFormatSetter(a){if(!Q.test(a))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a}checkParameters(a,c){return a?this._inputFormatSetter(a):a=this.inputFormat,c?this._outputFormatSetter(c):c=this.outputFormat,a!==c}checkContextual(a){let c=k(a);if(c!=="ltr"&&c!=="rtl"){try{c=document.dir.toLowerCase()}catch{}c!=="ltr"&&c!=="rtl"&&(c="ltr")}return c}hasBidiChar(a){return Pt.test(a)}}function V(l,a,c,o,s){const u=Bt(l,{inFormat:a,outFormat:c,swap:o},s);if(u.inFormat===u.outFormat)return l;a=u.inFormat,c=u.outFormat,o=u.swap;const L=a.slice(0,1),T=a.slice(1,4),U=c.slice(0,1),d=c.slice(1,4);if(s.inFormat=a,s.outFormat=c,s.swap=o,L==="L"&&c==="VLTR"){if(T==="LTR")return s.dir=E,b(l,s);if(T==="RTL")return s.dir=I,b(l,s)}if(L==="V"&&U==="V")return s.dir=T==="RTL"?I:E,M(l,s);if(L==="L"&&c==="VRTL")return T==="LTR"?(s.dir=E,l=b(l,s)):(s.dir=I,l=b(l,s)),M(l);if(a==="VLTR"&&c==="LLTR")return s.dir=E,b(l,s);if(L==="V"&&U==="L"&&T!==d)return l=M(l),T==="RTL"?V(l,"LLTR","VLTR",o,s):V(l,"LRTL","VRTL",o,s);if(a==="VRTL"&&c==="LRTL")return V(l,"LRTL","VRTL",o,s);if(L==="L"&&U==="L"){const g=s.swap;return s.swap=g.slice(0,1)+"N",T==="RTL"?(s.dir=I,l=b(l,s),s.swap="N"+g.slice(1,3),s.dir=E,l=b(l,s)):(s.dir=E,l=b(l,s),s.swap="N"+g.slice(1,3),l=V(l,"VLTR","LRTL",s.swap,s)),l}return l}function Bt(l,a,c){if(a.inFormat===void 0&&(a.inFormat=c.defInFormat),a.outFormat===void 0&&(a.outFormat=c.defOutFormat),a.swap===void 0&&(a.swap=c.defSwap),a.inFormat===a.outFormat)return a;const o=a.inFormat.slice(0,1),s=a.outFormat.slice(0,1);let u,L=a.inFormat.slice(1,4),T=a.outFormat.slice(1,4);return L.charAt(0)==="C"&&(u=k(l),L=u==="ltr"||u==="rtl"?u.toUpperCase():a.inFormat.charAt(2)==="L"?"LTR":"RTL",a.inFormat=o+L),T.charAt(0)==="C"&&(u=k(l),u==="rtl"?T="RTL":u==="ltr"?(u=mt(l),T=u.toUpperCase()):T=a.outFormat.charAt(2)==="L"?"LTR":"RTL",a.outFormat=s+T),a}function gt(l,a,c){if(a.length===0)return"";l===void 0&&(l=!0);const o=(a=String(a)).split("");let s=0,u=1,L=o.length;l||(s=o.length-1,u=-1,L=1);const T=Ft(o,s,u,L);let U="";for(let d=0;d<o.length;d++)bt(T,T.length,d)>-1?(K(P,d,!l,-1),R.splice(d,1)):U+=o[d];return U}function Ft(l,a,c,o,s){let u=0;const L=[];let T=0;for(let U=a;U*c<o;U+=c)if(q(l[U])||O(l[U])){if(l[U]==="\u0644"&&wt(l,U+c,c,o)){l[U]=Ot(l[U+c],u===0?X:tt),U+=c,Vt(l,U,c,o),L[T]=U,T++,u=0;continue}const d=l[U];u===1?l[U]=G(l,U+c,c,o)?Et(l[U]):z(l[U],et):G(l,U+c,c,o)===!0?l[U]=z(l[U],at):l[U]=z(l[U],rt),O(d)||(u=1),vt(d)===!0&&(u=0)}else u=0;return L}function k(l){const a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(l);return a?a[0]<="z"?"ltr":"rtl":""}function mt(l){const a=l.split("");return a.reverse(),k(a.join(""))}function Rt(l,a,c){if(l.length===0)return"";a===void 0&&(a=!0);let o="";const s=(l=String(l)).split("");for(let u=0;u<l.length;u++){let L=!1;if(s[u]>="\uFE70"&&s[u]<"\uFEFF"){const T=l.charCodeAt(u);s[u]>="\uFEF5"&&s[u]<="\uFEFC"?(a?(u>0&&c&&s[u-1]===" "?o=o.slice(0,-1)+"\u0644":(o+="\u0644",L=!0),o+=v[(T-65269)/2]):(o+=v[(T-65269)/2],o+="\u0644",u+1<l.length&&c&&s[u+1]===" "?u++:L=!0),L&&(K(P,u,!0,1),R.splice(u,0,R[u]))):o+=lt[T-65136]}else o+=s[u]}return o}function b(l,a){const c=l.split(""),o=[];return $(c,o,a),pt(c,o,a),H(2,c,o,a),H(1,c,o,a),y=o,c.join("")}function $(l,a,c){const o=l.length,s=c.dir?ot:ct;let u=0,L=-1;const T=[],U=[];c.hiLevel=c.dir,c.lastArabic=!1,c.hasUbatAl=!1,c.hasUbatB=!1,c.hasUbatS=!1;for(let d=0;d<o;d++)T[d]=St(l[d]);for(let d=0;d<o;d++){const g=u,w=Nt(l,T,U,d,c);U[d]=w,u=s[g][w];const N=240&u;u&=15;const Y=s[u][Dt];if(a[d]=Y,N>0)if(N===16){for(let C=L;C<d;C++)a[C]=1;L=-1}else L=-1;if(s[u][kt])L===-1&&(L=d);else if(L>-1){for(let C=L;C<d;C++)a[C]=Y;L=-1}T[d]===p&&(a[d]=0),c.hiLevel|=Y}c.hasUbatS&&_t(T,a,o,c)}function _t(l,a,c,o){for(let s=0;s<c;s++)if(l[s]===D){a[s]=o.dir;for(let u=s-1;u>=0&&l[u]===F;u--)a[u]=o.dir}}function pt(l,a,c){if(c.hiLevel!==0&&c.swap[0]!==c.swap[1])for(let o=0;o<l.length;o++)a[o]===1&&(l[o]=Ct(l[o]))}function St(l){const a=l.charCodeAt(0),c=Lt[a>>8];return c<S?c:Ut[c-S][255&a]}function M(l,a){const c=l.split("");if(a){const o=[];$(c,o,a),y=o}return c.reverse(),R.reverse(),c.join("")}function bt(l,a,c){for(let o=0;o<a;o++)if(l[o]===c)return o;return-1}function q(l){for(let a=0;a<Z.length;a++)if(l>=Z[a]&&l<=it[a])return!0;return!1}function G(l,a,c,o){for(;a*c<o&&O(l[a]);)a+=c;return!!(a*c<o&&q(l[a]))}function wt(l,a,c,o){for(;a*c<o&&O(l[a]);)a+=c;let s=" ";if(!(a*c<o))return!1;s=l[a];for(let u=0;u<v.length;u++)if(v[u]===s)return!0;return!1}function H(l,a,c,o){if(o.hiLevel<l)return;if(l===1&&o.dir===I&&!o.hasUbatB)return a.reverse(),void R.reverse();const s=a.length;let u,L,T,U,d,g=0;for(;g<s;){if(c[g]>=l){for(u=g+1;u<s&&c[u]>=l;)u++;for(L=g,T=u-1;L<T;L++,T--)U=a[L],a[L]=a[T],a[T]=U,d=R[L],R[L]=R[T],R[T]=d;g=u}g++}}function Nt(l,a,c,o,s){const u=a[o];return{UBAT_L:()=>(s.lastArabic=!1,e),UBAT_R:()=>(s.lastArabic=!1,i),UBAT_ON:()=>t,UBAT_AN:()=>B,UBAT_EN:()=>s.lastArabic?B:f,UBAT_AL:()=>(s.lastArabic=!0,s.hasUbatAl=!0,i),UBAT_WS:()=>t,UBAT_CS:()=>{let L,T;return o<1||o+1>=a.length||(L=c[o-1])!==f&&L!==B||(T=a[o+1])!==f&&T!==B?t:(s.lastArabic&&(T=B),T===L?T:t)},UBAT_ES:()=>(o>0?c[o-1]:p)===f&&o+1<a.length&&a[o+1]===f?f:t,UBAT_ET:()=>{if(o>0&&c[o-1]===f)return f;if(s.lastArabic)return t;let L=o+1;const T=a.length;for(;L<T&&a[L]===A;)L++;return L<T&&a[L]===f?f:t},UBAT_NSM:()=>{if(s.inFormat==="VLTR"){const L=a.length;let T=o+1;for(;T<L&&a[T]===n;)T++;if(T<L){const U=l[o].charCodeAt(0),d=U>=1425&&U<=2303||U===64286,g=a[T];if(d&&(g===i||g===r))return i}}return o<1||a[o-1]===p?t:c[o-1]},UBAT_B:()=>(s.lastArabic=!0,s.hasUbatB=!0,s.dir),UBAT_S:()=>(s.hasUbatS=!0,t),UBAT_LRE:()=>(s.lastArabic=!1,t),UBAT_RLE:()=>(s.lastArabic=!1,t),UBAT_LRO:()=>(s.lastArabic=!1,t),UBAT_RLO:()=>(s.lastArabic=!1,t),UBAT_PDF:()=>(s.lastArabic=!1,t),UBAT_BN:()=>t}[Tt[u]]()}function Ct(l){let a,c=0,o=x.length-1;for(;c<=o;)if(a=Math.floor((c+o)/2),l<x[a][0])o=a-1;else{if(!(l>x[a][0]))return x[a][1];c=a+1}return l}function vt(l){for(let a=0;a<W.length;a++)if(W[a]===l)return!0;return!1}function Et(l){for(let a=0;a<j.length;a++)if(l===j[a])return nt[a];return l}function z(l,a){for(let c=0;c<j.length;c++)if(l===j[c])return a[c];return l}function O(l){return l>="\u064B"&&l<="\u0655"}function J(l){return l==="L"?"LTR":l==="R"?"RTL":l==="C"?"CLR":l==="D"?"CRL":""}function Vt(l,a,c,o){for(;a*c<o&&O(l[a]);)a+=c;return a*c<o&&(l[a]=" ",!0)}function Ot(l,a){for(let c=0;c<v.length;c++)if(l===v[c])return a[c];return l}function It(l,a,c){R=[],y=[];for(let o=0;o<c;o++)l[o]=o,a[o]=o,R[o]=o}function xt(l){const a=new Array(l.length);for(let c=0;c<l.length;c++)a[l[c]]=c;return a}function K(l,a,c,o){for(let s=0;s<l.length;s++)(l[s]>a||!c&&l[s]===a)&&(l[s]+=o)}let R=[],P=[],y=[];const jt={dir:0,defInFormat:"LLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:""},Dt=5,kt=6,E=0,I=1,Q=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,Pt=/[\u0591-\u06ff\ufb1d-\ufefc]/;export{dt as C};
