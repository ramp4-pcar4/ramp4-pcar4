import{bp as j}from"./main-BFDurRCu.js";import{d as O,j as v,a as l,m as k,Y as q}from"./Point2D-CaHJVGk1.js";import{s as I,aL as Y,F as P,E as A}from"./ProjectionTransformation-DQ4GElxa.js";import{Envelope2D as y}from"./Envelope2D-DlBzXkgv.js";import"./jsonConverter-tsQ40CV0.js";import{s as d,t as X}from"./SimpleGeometryCursor-DSF_YyIm.js";import{fromGeometry as g,getSpatialReference as w,fromSpatialReference as b,toGeometry as E}from"./apiConverter-CSuukuP9.js";class z{getOperatorType(){return 10003}supportsCurves(){return!0}accelerateGeometry(e,n,o){return!1}canAccelerateGeometry(e){return!1}executeMany(e,n,o,r){return new B(e,n,o,r)}execute(e,n,o,r){const i=new d([e]),m=new d([n]),s=this.executeMany(i,m,o,r).next();return s||O("null output"),s}}function F(t,e,n,o){const r=t.getDimension(),i=e.getDimension();if(r!==i)return r>i?t:e;if(t.isEmpty())return e;if(e.isEmpty())return t;const m=new y,s=new y,u=new y;t.queryEnvelope(m),e.queryEnvelope(s),u.setCoords({env2D:m}),u.mergeEnvelope2D(s);const c=I(n,u,!0),f=t.getGeometryType(),p=e.getGeometryType();return f===l.enumPoint&&p===l.enumPoint?L(t,e,c):f===l.enumPoint&&p===l.enumMultiPoint?D(e,t,c):f===l.enumMultiPoint&&p===l.enumPoint?D(t,e,c):Y(t,e,n,o)}function L(t,e,n,o){const r=P(n),i=r*r,m=t.getXY(),s=e.getXY(),u=new A({vd:t.getDescription()});return k.sqrDistance(m,s)>i&&(u.add(t),u.add(e)),u}function D(t,e,n,o){const r=t.getImpl().getAttributeStreamRef(0),i=t.getPointCount(),m=e.getXY(),s=t.createInstance(),u=P(n),c=new y;if(t.queryEnvelope(c),c.inflateCoords(u,u),c.contains(m)){const f=u*u;let p=!1;const h=q(i,!1);for(let a=0;a<i;a++){const T=r.read(2*a),R=r.read(2*a+1),x=T-m.x,G=R-m.y;x*x+G*G<=f&&(p=!0,h[a]=!0)}if(p)for(let a=0;a<i;a++)h[a]||s.addPoints(t,a,a+1);else s.addPoints(t,0,i),s.add(e)}else s.addPoints(t,0,i),s.add(e);return s}class B extends X{constructor(e,n,o,r){super(),this.m_progressTracker=r,this.m_index=-1,this.m_inputGeoms=e,this.m_spatialReference=o,this.m_rightGeom=n.next(),this.m_bEmpty=!this.m_rightGeom,v(this.m_rightGeom)}tock(){return!0}getRank(){return 1}next(){if(this.m_bEmpty)return null;const e=this.m_inputGeoms.next();return e?(v(e),this.m_index=this.m_inputGeoms.getGeometryID(),F(e,this.m_rightGeom,this.m_spatialReference,this.m_progressTracker)):null}getGeometryID(){return this.m_index}}const _=new z;function H(t,e,n){return _.execute(t,e,n,null)}function Z(t,e,n){const o=_.executeMany(new d(t),new d([e]),n,null);return Array.from(o)}function $(){return _.supportsCurves()}function M(t,e){const n=w(t);return E(H(g(t),g(e),b(n)),n)}function C(t,e){const n=t.map(g),o=w(t);return Z(n,g(e),b(o)).map(r=>E(r,o)).filter(j)}const S=$(),J=Object.freeze(Object.defineProperty({__proto__:null,execute:M,executeMany:C,supportsCurves:S},Symbol.toStringTag,{value:"Module"})),K=Object.freeze(Object.defineProperty({__proto__:null,execute:M,executeMany:C,supportsCurves:S},Symbol.toStringTag,{value:"Module"}));export{J as i,K as s};
