import{bp as q}from"./main-BFDurRCu.js";import{a as U,d as j,n as B}from"./Point2D-CaHJVGk1.js";import{b as w,aM as F,s as H,u as f,U as x,aN as b,aO as S,aP as k,aQ as R,aR as J,av as D,aS as K}from"./ProjectionTransformation-DQ4GElxa.js";import"./Envelope2D-DlBzXkgv.js";import"./jsonConverter-tsQ40CV0.js";import{t as L}from"./SimpleGeometryCursor-DSF_YyIm.js";import{getSpatialReference as W,fromSpatialReference as X,fromPolyline as Y,fromGeometry as Z,toGeometry as $}from"./apiConverter-CSuukuP9.js";var M=K;function g(l,e){return{m_geometry:l,m_side:e}}function tt(l,e,o,t,i,n){if(e.isEmpty()){const a=g(e,0);return void i.push(a)}if(o.isEmpty()){const a=g(e,0);return void i.push(a)}const s=[],r=new x;{const a=r.createGeometryUserIndex(),C=r.addGeometry(e),P=r.addGeometry(o),d=new R(n);let p=0,u=null;if(r.hasCurves()){u=new M;const h=r.getEnvelope2D(n);p=b(t.total());const _=S(t.total(),h);k(r,_,t.total(),12e3,u,null,n)}r.dbgVerifyCurves(),d.setEditShapeCrackAndCluster(r,t),d.cut(l,a,C,P,s);for(const h of s){u!==null&&u.stitchCurves(r,h,p,!1);const _=g(r.getGeometry(h),J(r.getGeometryUserIndex(h,a)));i.push(_)}u!==null&&u.clearStitcher(r)}}function et(l,e,o,t,i,n){if(e.isEmpty()){const a=g(e,0);return void i.push(a)}if(o.isEmpty()){const a=g(e,0);return void i.push(a)}const s=[],r=new x;{const a=r.createGeometryUserIndex(),C=r.addGeometry(e),P=r.addGeometry(o),d=new R(n);let p=0,u=null;if(r.hasCurves()){u=new M;const c=r.getEnvelope2D(n);p=b(t.total());const y=S(t.total(),c);k(r,y,t.total(),12e3,u,null,n)}r.dbgVerifyCurves(),d.setEditShapeCrackAndCluster(r,t),d.cut(!1,a,C,P,s),u!==null&&u.stitchCurves(r,D,p,!0);let h=r.getGeometry(C);const _=new f,v=new f,E=[];for(let c=0;c<s.length;c++){let y=null;{const m=new x,T=m.addGeometry(h),I=m.addGeometry(r.getGeometry(s[c]));if(m.hasCurves()){const O=m.getEnvelope2D(n);p=b(t.total());const Q=S(t.total(),O);k(m,Q,t.total(),12e3,u,null,n)}d.setEditShapeCrackAndCluster(m,t);const A=d.intersection(T,I);if(u!==null&&u.stitchCurves(m,D,p,!0),y=m.getGeometry(A),y.isEmpty())continue;const G=r.getGeometryUserIndex(s[c],a);G===2?_.add(y,!1):G===1?v.add(y,!1):E.push(y)}{const m=new x,T=m.addGeometry(h),I=m.addGeometry(r.getGeometry(s[c]));if(m.hasCurves()){const G=m.getEnvelope2D(n);p=b(t.total());const O=S(t.total(),G);k(m,O,t.total(),12e3,u,null,n)}d.setEditShapeCrackAndCluster(m,t);const A=d.difference(T,I);u!==null&&u.stitchCurves(m,D,p,!0),h=m.getGeometry(A)}}if(!h.isEmpty()&&s.length>0&&E.push(h),_.isEmpty()&&v.isEmpty())return;if(!_.isEmpty()){const c=g(_,1);i.push(c)}if(!v.isEmpty()){const c=g(v,2);i.push(c)}for(let c=0,y=E.length;c<y;++c){const m=g(E[c],3);i.push(m)}}}class st{getOperatorType(){return 10005}accelerateGeometry(e,o,t){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,o,t,i,n){return new rt(e,o,t,i,n)}}class rt extends L{constructor(e,o,t,i,n){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=n,this.m_cuttee=o.clone(),this.m_cutter=new w({copy:t}),this.m_bConsiderTouch=e;const s=F(o,t);this.m_tolerance=H(i,s,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case U.enumPolyline:this.generatePolylineCuts();break;case U.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){const e=new w,o=new w,t=new w;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(o);const i=[];tt(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,i,this.m_progressTracker);for(let n=0;n<i.length;n++){const s=i[n];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2||s.m_side===4?o.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):j("")}t.isEmpty()||e.isEmpty()&&o.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(t),e.isEmpty()&&o.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){const e=new f,o=new f,t=new f;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(o);const i=[];et(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,i,this.m_progressTracker);for(let n=0;n<i.length;n++){const s=i[n];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2?o.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):j("")}B(t.isEmpty()||i.length===1),e.isEmpty()&&o.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}}const z=new st;function ot(l,e,o){const t=z.execute(!0,l,e,o,null);return Array.from(t)}function nt(){return z.supportsCurves()}function V(l,e){const o=W(l);return ot(Z(l),Y(e),X(o)).map(t=>$(t,o)).filter(q)}const N=nt(),it=Object.freeze(Object.defineProperty({__proto__:null,execute:V,supportsCurves:N},Symbol.toStringTag,{value:"Module"})),mt=Object.freeze(Object.defineProperty({__proto__:null,execute:V,supportsCurves:N},Symbol.toStringTag,{value:"Module"}));export{mt as c,it as i};
