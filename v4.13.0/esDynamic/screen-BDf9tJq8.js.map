{"version":3,"file":"screen-BDf9tJq8.js","sources":["../../src/fixtures/legend/screen.vue"],"sourcesContent":["<template>\n    <panel-screen :panel=\"panel\">\n        <template #header> {{ t('legend.title') }} </template>\n\n        <template #content>\n            <legend-header />\n            <div\n                v-focus-list\n                :content=\"t('panels.controls.items')\"\n                v-tippy=\"{\n                    trigger: 'manual',\n                    placement: 'top-end',\n                    touch: false,\n                    maxWidth: 190\n                }\"\n                ref=\"el\"\n            >\n                <legend-item\n                    v-for=\"item in children\"\n                    :legendItem=\"item\"\n                    :key=\"item.uid\"\n                    @focus-item=\"(focusItem: HTMLElement, legendItem: LegendItem) => applyFocusToItem(focusItem)\"\n                />\n            </div>\n        </template>\n    </panel-screen>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, defineAsyncComponent, inject, onBeforeUnmount, onMounted, ref } from 'vue';\nimport { useI18n } from 'vue-i18n';\n\nimport type { InstanceAPI, PanelInstance } from '@/api';\nimport type { PropType } from 'vue';\nimport type { LegendAPI } from './api/legend';\nimport type { LegendItem } from './store/legend-item';\n\nconst legendHeader = defineAsyncComponent(() => import('./header.vue'));\nconst legendItem = defineAsyncComponent(() => import('./components/item.vue'));\n\nconst { t } = useI18n();\nconst iApi = inject('iApi') as InstanceAPI;\nconst el = ref<Element>();\n\nconst blurEvent = () => {\n    (el.value as any)._tippy.hide();\n};\n\nconst keyupEvent = (e: Event) => {\n    const evt = e as KeyboardEvent;\n    if (evt.key === 'Tab' && el.value?.matches(':focus')) {\n        (el.value as any)._tippy.show();\n    }\n};\n\nconst applyFocusToItem = (focusItem: HTMLElement) => {\n    const focusItemEvent = new CustomEvent('refocusLegendItem', { detail: { focusItem } });\n    el.value?.dispatchEvent(focusItemEvent);\n};\n\nonMounted(() => {\n    el.value?.addEventListener('blur', blurEvent);\n    el.value?.addEventListener('keyup', keyupEvent);\n});\n\nonBeforeUnmount(() => {\n    el.value?.removeEventListener('blur', blurEvent);\n    el.value?.removeEventListener('keyup', keyupEvent);\n});\n\ndefineProps({\n    panel: {\n        type: Object as PropType<PanelInstance>,\n        required: true\n    }\n});\n\nconst children = computed<Array<LegendItem>>(() => {\n    const legendApi = iApi.fixture.get<LegendAPI>('legend');\n    if (legendApi) {\n        return [...legendApi.getLegend()];\n    }\n    return [];\n});\n</script>\n\n<style lang=\"scss\" scoped></style>\n"],"names":["legendHeader","defineAsyncComponent","legendItem","t","useI18n","iApi","inject","el","ref","blurEvent","keyupEvent","e","applyFocusToItem","focusItem","focusItemEvent","onMounted","onBeforeUnmount","children","computed","legendApi"],"mappings":";;;;;;;;;;AAqCA,UAAMA,IAAeC,EAAqB,MAAM,OAAO,sBAAc,CAAC,GAChEC,IAAaD,EAAqB,MAAM,OAAO,oBAAuB,CAAC,GAEvE,EAAE,GAAAE,EAAA,IAAMC,EAAA,GACRC,IAAOC,EAAO,MAAM,GACpBC,IAAKC,EAAA,GAELC,IAAY,MAAM;AACnB,MAAAF,EAAG,MAAc,OAAO,KAAA;AAAA,IAC7B,GAEMG,IAAa,CAACC,MAAa;AAE7B,MADYA,EACJ,QAAQ,SAASJ,EAAG,OAAO,QAAQ,QAAQ,KAC9CA,EAAG,MAAc,OAAO,KAAA;AAAA,IAEjC,GAEMK,IAAmB,CAACC,MAA2B;AACjD,YAAMC,IAAiB,IAAI,YAAY,qBAAqB,EAAE,QAAQ,EAAE,WAAAD,EAAA,GAAa;AACrF,MAAAN,EAAG,OAAO,cAAcO,CAAc;AAAA,IAC1C;AAEA,IAAAC,EAAU,MAAM;AACZ,MAAAR,EAAG,OAAO,iBAAiB,QAAQE,CAAS,GAC5CF,EAAG,OAAO,iBAAiB,SAASG,CAAU;AAAA,IAClD,CAAC,GAEDM,EAAgB,MAAM;AAClB,MAAAT,EAAG,OAAO,oBAAoB,QAAQE,CAAS,GAC/CF,EAAG,OAAO,oBAAoB,SAASG,CAAU;AAAA,IACrD,CAAC;AASD,UAAMO,IAAWC,EAA4B,MAAM;AAC/C,YAAMC,IAAYd,EAAK,QAAQ,IAAe,QAAQ;AACtD,aAAIc,IACO,CAAC,GAAGA,EAAU,WAAW,IAE7B,CAAA;AAAA,IACX,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}