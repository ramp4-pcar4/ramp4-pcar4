import{bh as D,aG as W,ao as T,Y as It,a0 as Gt,s as q,bS as j,i as Vt,fg as ot,iG as Pt,iH as Ft,bs as Nt}from"./main-BFDurRCu.js";import{g as Et,q as it,b as Ut,h as Bt,a as rt,f as Wt,c as Tt,L as _,M as qt,N as _t,y as Ht}from"./utils-Cb2uXNfG.js";import{B as H,U as ct}from"./colorUtils-Eg6lOlXm.js";import{n as k,b as Xt}from"./jsxFactory-Cua8zWVZ.js";import{n as ht}from"./mat2df32-fg3OHsAI.js";import{e as V,c as Yt,a as X,i as Qt,s as Jt}from"./mat2d-BQA-1WB-.js";import{h as Kt}from"./webStyleSymbolUtils-r0H5toyk.js";var S;(function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"})(S||(S={}));const O={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}]};function te(t,e,a){const n=S.size;let l=n,s=n;t<1?l*=.75:t>1&&(s*=1.25);const o=0,c=0;let r=n,h=n;return e&&a&&(l=s=r=h=0),[{type:"path",path:[{command:"M",values:[r,o]},{command:"L",values:[a?r:.875*r,o]},{command:"L",values:[a?l-.5*r:c,s-.5*h]},{command:"L",values:[l-.5*r,s-.5*h]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r,o]},{command:"L",values:[r,e?o:.125*h]},{command:"L",values:[l-.5*r,e?s-.5*h:h]},{command:"L",values:[l-.5*r,s-.5*h]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l-.5*r,s-.5*h]},{command:"L",values:[a?l-.5*r:c,s-.5*h]},{command:"L",values:[a?l-.5*r:c,e?s-.5*h:h]},{command:"L",values:[l-.5*r,e?s-.5*h:h]},{command:"Z",values:[]}]}]}function ee(t){const e=S.size,a=.5*t,n=0,l=0;return[{type:"path",path:[{command:"M",values:[l,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+a]},{command:"L",values:[l,.7*e+a-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+a]},{command:"L",values:[e,a]},{command:"L",values:[e,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,n]},{command:"L",values:[e,n]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[l,.7*e*.5]},{command:"Z",values:[]}]}]}function ae(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function ne(t,e){let a=e?S.tallSymbolWidth:t;const n=t,l=e?4:6;a<=S.size?a-=.5*l:a-=l;const s=0,o=0,c=e?.35*a:.5*a;return[{type:"path",path:[{command:"M",values:[.5*a,s]},{command:"L",values:[a,.5*c]},{command:"L",values:[.5*a,c]},{command:"L",values:[o,.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*c]},{command:"L",values:[.5*a,c]},{command:"L",values:[.5*a,n]},{command:"L",values:[o,n-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*a,c]},{command:"L",values:[.5*a,n]},{command:"L",values:[a,n-.5*c]},{command:"L",values:[a,.5*c]},{command:"Z",values:[]}]}]}function le(t,e){let a=e?S.tallSymbolWidth:t;const n=t,l=e?4:6;a<=S.size?a-=.5*l:a-=l;const s=.5*a,o=.15*a,c=0,r=n-o;return[{type:"ellipse",cx:.5*a,cy:r,rx:s,ry:o},{type:"path",path:[{command:"M",values:[c,o]},{command:"L",values:[c,r]},{command:"L",values:[a,r]},{command:"L",values:[a,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*a,cy:o,rx:s,ry:o}]}function se(t,e){let a=e?S.tallSymbolWidth:t;const n=t,l=e?4:6;a<=S.size?a-=.5*l:a-=l;const s=.15*a,o=n-s;return[{type:"ellipse",cx:.5*a,cy:o,rx:.5*a,ry:s},{type:"path",path:[{command:"M",values:[.5*a,0]},{command:"L",values:[a,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function oe(t){let e=t;const a=t,n=6;e<S.size?e-=.5*n:e-=n;const l=.15*e,s=0;return[{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[e,s]},{command:"L",values:[.5*e,a-l]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:s,rx:.5*e,ry:l}]}function ie(t){let e=t;const a=t,n=4;e<S.size?e-=.5*n:e-=n;const l=0,s=0,o=e,c=a,r=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,l]},{command:"L",values:[o,.5*c-r]},{command:"L",values:[.45*o-r,.5*c+r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,l]},{command:"L",values:[.45*o-r,.5*c+r]},{command:"L",values:[s,.5*c-r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*c-r]},{command:"L",values:[.45*o-r,.5*c+r]},{command:"L",values:[.45*o,a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,a]},{command:"L",values:[o,.5*c-r]},{command:"L",values:[.45*o-r,.5*c+r]},{command:"Z",values:[]}]}]}function re(t){const e=t,a=2;let n=t;n<S.size?n-=.5*a:n-=a;const l=0,s=0;return[{type:"path",path:[{command:"M",values:[.45*e,l]},{command:"L",values:[e,n]},{command:"L",values:[.45*e,.6*n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,l]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[s,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,n]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[e,n]},{command:"Z",values:[]}]}]}function C(t,e){return Math.round(Math.min(Math.max(t+255*e*.75,0),255))}function ce(t,e){if(t==null)return new D;if("type"in t&&(t.type==="linear"||t.type==="pattern"))return t;const a=new D(t);return new D([C(a.r,e),C(a.g,e),C(a.b,e),a.a])}let he=0;function ue(){return he++}let pe=0;function me(){return pe++}let fe=0;function de(){return fe++}const ye="http://www.w3.org/2000/svg",ut=T("android"),ge=T("chrome")||ut&&ut>=4?"auto":"optimizeLegibility",be={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},ve=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let L={},w={};const xe=Math.PI;function Z(t,e){const a=t*(xe/180);return Math.abs(e*Math.sin(a))+Math.abs(e*Math.cos(a))}function pt(t){return t.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function Y(t,e,a,n,l){if(t){if(t.type==="circle")return k("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-dashoffset":a.dashOffset,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width});if(t.type==="ellipse")return k("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width});if(t.type==="rect")return k("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width,width:t.width,x:t.x,y:t.y});if(t.type==="image")return k("image",{alt:l||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if(t.type==="path"){const s=typeof t.path!="string"?pt(t.path):t.path;return k("path",{d:s,fill:e,"fill-rule":"evenodd",stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width})}if(t.type==="text")return W(n),k("text",{"dominant-baseline":n.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":n.font.family,"font-size":n.font.size,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,kerning:n.kerning,rotate:n.rotate,stroke:a.color,"stroke-dasharray":a.dashArray,"stroke-linecap":a.cap,"stroke-linejoin":a.join,"stroke-miterlimit":"4","stroke-width":a.width,"text-anchor":n.align,"text-decoration":n.decoration,"text-rendering":ge,x:t.x,y:t.y},t.text)}return null}function Q(t){if(!t)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in t))return{fill:new D(t).toString(),pattern:null,linearGradient:null};if(t.type==="pattern"){const a=`patternId-${ue()}`;return{fill:`url(#${a})`,pattern:{id:a,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}},linearGradient:null}}const e=`linearGradientId-${me()}`;return{fill:`url(#${e})`,pattern:null,linearGradient:{id:e,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(a=>({offset:a.offset,color:a.color&&new D(a.color).toString()}))}}}function J(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new D(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=Et(t).join(",")||"none")),e}function mt(t,e){const a={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const n=t.alignBaseline,l=n==="baseline"?"auto":n==="top"?"text-top":n==="bottom"?"hanging":n;a.align=t.align,a.dominantBaseline=l,a.decoration=t.decoration,a.kerning=t.kerning?"auto":"0",a.rotate=t.rotated?"90":"0",W(e),a.font.style=e.style||"normal",a.font.variant=e.variant||"normal",a.font.weight=e.weight||"normal",a.font.size=e.size&&e.size.toString()||"10pt",a.font.family=e.family||"serif"}return a}function ft(t){const{pattern:e,linearGradient:a}=t;if(e)return k("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},k("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(a){const n=a.stops.map((l,s)=>k("stop",{key:`${s}-stop`,offset:l.offset,"stop-color":l.color}));return k("linearGradient",{gradientUnits:"userSpaceOnUse",id:a.id,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2},n)}return null}function we(t,e){if(!t||t.length===0)return null;const a=[];for(const n of t){const{shape:l,fill:s,stroke:o,font:c}=n,r=Q(s),h=J(o),m=l.type==="text"?mt(l,c):null,p=Y(l,r.fill,h,m);p&&a.push(p)}return k("mask",{id:e,maskUnits:"userSpaceOnUse"},k("g",null,a))}function dt(t,e,a){return Qt(t,X(t),[e,a])}function yt(t,e,a,n,l){return Yt(t,X(t),[e,a]),t[4]=t[4]*e-n*e+n,t[5]=t[5]*a-l*a+l,t}function ke(t,e,a,n){const l=e%360*Math.PI/180;Jt(t,X(t),l);const s=Math.cos(l),o=Math.sin(l),c=t[4],r=t[5];return t[4]=c*s-r*o+n*o-a*s+a,t[5]=r*s+c*o-a*o-n*s+n,t}function $(t,e){L&&"left"in L?(L.left!=null&&L.left>t&&(L.left=t),(L.right==null||L.right<t)&&(L.right=t),(L.top==null||L.top>e)&&(L.top=e),(L.bottom==null||L.bottom<e)&&(L.bottom=e)):L={left:t,bottom:e,right:t,top:e}}function gt(t){const e=t.args,a=e.length;let n;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(n=0;n<a;n+=2)$(e[n],e[n+1]);w.x=e[a-2],w.y=e[a-1];break;case"H":for(n=0;n<a;++n)$(e[n],w.y);w.x=e[a-1];break;case"V":for(n=0;n<a;++n)$(w.x,e[n]);w.y=e[a-1];break;case"m":{let l=0;for(("x"in w)||($(w.x=e[0],w.y=e[1]),l=2),n=l;n<a;n+=2)$(w.x+=e[n],w.y+=e[n+1]);break}case"l":case"t":for(n=0;n<a;n+=2)$(w.x+=e[n],w.y+=e[n+1]);break;case"h":for(n=0;n<a;++n)$(w.x+=e[n],w.y);break;case"v":for(n=0;n<a;++n)$(w.x,w.y+=e[n]);break;case"c":for(n=0;n<a;n+=6)$(w.x+e[n],w.y+e[n+1]),$(w.x+e[n+2],w.y+e[n+3]),$(w.x+=e[n+4],w.y+=e[n+5]);break;case"s":case"q":for(n=0;n<a;n+=4)$(w.x+e[n],w.y+e[n+1]),$(w.x+=e[n+2],w.y+=e[n+3]);break;case"A":for(n=0;n<a;n+=7)$(e[n+5],e[n+6]);w.x=e[a-2],w.y=e[a-1];break;case"a":for(n=0;n<a;n+=7)$(w.x+=e[n+5],w.y+=e[n+6])}}function bt(t,e,a){const n=be[t.toLowerCase()];let l;typeof n=="number"&&(n?e.length>=n&&(l={action:t,args:e.slice(0,e.length-e.length%n)},a.push(l),gt(l)):(l={action:t,args:[]},a.push(l),gt(l)))}function Le(t){const e=(typeof t.path!="string"?pt(t.path):t.path).match(ve),a=[];if(L={},w={},!e)return null;let n="",l=[];const s=e.length;for(let c=0;c<s;++c){const r=e[c],h=parseFloat(r);isNaN(h)?(n&&bt(n,l,a),l=[],n=r):l.push(h)}bt(n,l,a);const o={x:0,y:0,width:0,height:0};return L&&"left"in L&&(o.x=L.left,o.y=L.top,o.width=L.right-L.left,o.height=L.bottom-L.top),o}function vt(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const a=Le(t);e.x=a.x,e.y=a.y,e.width=a.width,e.height=a.height}return e}function xt(t){const e={x:0,y:0,width:0,height:0};let a=null,n=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(const s of t)a?(a.x=Math.min(a.x,s.x),a.y=Math.min(a.y,s.y),n=Math.max(n,s.x+s.width),l=Math.max(l,s.y+s.height)):(a=e,a.x=s.x,a.y=s.y,n=s.x+s.width,l=s.y+s.height);return a&&(a.width=n-a.x,a.height=l-a.y),a}function wt(t,e,a,n,l,s,o,c,r){let h=(o&&s?Z(s,e):e)/2,m=(o&&s?Z(s,a):a)/2;if(r){const y=r[0],f=r[1];h=(o&&s?Z(s,y):y)/2,m=(o&&s?Z(s,f):f)/2}const p=t.width+n,u=t.height+n,b=ht(),i=ht();let d=!1;if(l&&p!==0&&u!==0){const y=e!==a?e/a:p/u,f=e>a?e:a;let M=1,z=1;isNaN(f)||(y>1?(M=f/p,z=f/y/u):(z=f/u,M=f*y/p)),V(i,i,yt(b,M,z,h,m)),d=!0}const g=t.x+(p-n)/2,v=t.y+(u-n)/2;if(V(i,i,dt(b,h-g,m-v)),!d&&(p>e||u>a)){const y=p/e>u/a,f=(y?e:a)/(y?p:u);V(i,i,yt(b,f,f,g,v))}return c&&V(i,i,dt(b,c[0],c[1])),s&&V(i,i,ke(b,s,g,v)),`matrix(${i[0]},${i[1]},${i[2]},${i[3]},${i[4]},${i[5]})`}function Me(t,e,a){const n=t?.effects.find(h=>h.type==="bloom");if(!n)return null;const{strength:l,radius:s}=n,o=l>0?s:0,c=(l+o)*e,r=4*l+1;return k("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${a}`,width:"300%",x:"-100%",y:"-100%"},k("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(l+.5*o)*(5**(e/100)*(.4+e/100)),result:"dilate"}),k("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:c/25}),k("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:c/50}),k("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},k("feFuncR",{slope:r,type:"linear"}),k("feFuncG",{slope:r,type:"linear"}),k("feFuncB",{slope:r,type:"linear"})),k("feMerge",null,k("feMergeNode",{in:"intensityBlur"}),k("feMergeNode",{in:"intensityBrightness"}),k("feGaussianBlur",{stdDeviation:l/10})))}function kt(t,e,a,n={}){const l=[],s=[],o=de(),c=Me(n.effectView,e,o);let r=null;if(c){const p=n.effectView?.effects.find(d=>d.type==="bloom"),u=n.clipBloomEffect||!p.strength?0:(p.strength+p.radius/2)/3,b=e+e*u,i=a+a*u;r=[Math.max(b,10),Math.max(i,10)]}let h=e,m=a;if(n.useRotationSize)for(let p=0;p<t.length;p++){const u=n.rotations?.[p]??0;h=Math.max(Z(u,e),h),m=Math.max(Z(u,a),m)}for(let p=0;p<t.length;p++){const u=t[p],b=[],i=[];let d=0,g=0,v=0;for(const z of u){const{shape:R,fill:Rt,stroke:lt,font:At,offset:B}=z;n.ignoreStrokeWidth||R.type==="text"||(d+=lt?.width||0);const st=Q(Rt),Dt=J(lt),Ot=R.type==="text"?mt(R,At):null;l.push(ft(st)),b.push(Y(R,st.fill,Dt,Ot,n.ariaLabel)),i.push(vt(R)),B&&(g+=B[0],v+=B[1])}const y=n.rotations?.[p]??0;n.useRotationSize&&(g+=(h-Z(y,e))/2,v+=(m-Z(y,a))/2);const f=wt(xt(i),e,a,d,n.scale??!1,y,n.useRotationSize??!1,[g,v],r);let M=null;if(n.masking){const z=`mask-${p}`,R=n.masking[p];l.push(we(R,z)),M=`url(#${z})`}s.push(M?k("g",{mask:M},k("g",{transform:f},b)):k("g",{transform:f},b))}return c&&(W(r),h=r[0],m=r[1]),k("svg",{"aria-label":n.ariaLabel,focusable:!1,height:m,role:"img",style:"display: block;",width:h,xmlns:ye},c,k("defs",null,l),c?k("g",{filter:`url(#bloom${o})`},s):s)}const Lt=Xt();function Se(t,e){Lt.append(t,e),Lt.detach(e)}function P(t,e,a){const n=Math.ceil(e[0]),l=Math.ceil(e[1]);if(!t.some(o=>!!o.length))return null;const s=a?.node||document.createElement("div");return a.opacity!=null&&(s.style.opacity=a.opacity.toString()),a.effectView!=null&&(s.style.filter=it(a.effectView)),Se(s,()=>kt(t,n,l,a)),s}function ze(t,e){t=Math.ceil(t),e=Math.ceil(e);const a=document.createElement("canvas");a.width=t,a.height=e,a.style.width=t+"px",a.style.height=e+"px";const n=a.getContext("2d");return n.clearRect(0,0,t,e),n}function $e(t,e,a){return t?Gt(t,{responseType:"image"}).then(n=>{const l=n.data,s=l.width,o=l.height,c=s/o;let r=e;if(a){const h=Math.max(s,o);r=Math.min(r,h)}return{image:l,width:c<=1?Math.ceil(r*c):r,height:c<=1?r:Math.ceil(r/c)}}):Promise.reject(new q("renderUtils: imageDataSize","href not provided."))}function je(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function Ce(t,e,a,n,l){switch(l){case"multiply":t[e]*=a[0],t[e+1]*=a[1],t[e+2]*=a[2],t[e+3]*=a[3];break;default:{const s=H({r:t[e],g:t[e+1],b:t[e+2]});s.h=n.h,s.s=n.s,s.v=s.v/100*n.v;const o=ct(s);t[e]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]*=a[3];break}}}function Ze(t,e,a,n,l){return $e(t,e,l).then(s=>{const o=s.width??e,c=s.height??e;if(s.image&&je(a,n)){let r=s.image.width,h=s.image.height;T("edge")&&/\.svg$/i.test(t)&&(r-=1,h-=1);const m=ze(o,c);m.drawImage(s.image,0,0,r,h,0,0,o,c);const p=m.getImageData(0,0,o,c),u=[a.r/255,a.g/255,a.b/255,a.a],b=H(a);for(let i=0;i<p.data.length;i+=4)Ce(p.data,i,u,b,n);m.putImageData(p,0,0),t=m.canvas.toDataURL("image/png")}else{const r=It?.findCredential(t);if(r?.token){const h=t.includes("?")?"&":"?";t=`${t}${h}token=${r.token}`}}return{url:t,width:o,height:c}}).catch(()=>({url:t,width:e,height:e}))}const A=S.size,F=S.maxSize,K=S.maxOutlineSize,Mt=S.lineWidth,tt=S.tallSymbolWidth;function I(t){const e=t.outline,a=t.material!=null?t.material.color:null,n=a!=null?a.toHex():null;if(e==null||"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none")return t.type==="fill"&&n==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const l=j(e.size)||0;return{color:"rgba("+(e.color!=null?e.color.toRgba():"255,255,255,1")+")",width:Math.min(l,K),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?rt(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function Re(t,e){if(t.thumbnail?.url)return t.thumbnail.url;if(e.type==="icon"&&e?.resource?.href)return Tt(e);const a=ot("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const n=await Kt(t.styleOrigin,{portal:t.styleOrigin.portal}).catch(()=>null);if(n&&"thumbnail"in n&&n.thumbnail?.url)return n.thumbnail.url}return a}function et(t,e=1){const a=t.a,n=H(t),l=n.h,s=n.s/e,o=100-(100-n.v)/e,{r:c,g:r,b:h}=ct({h:l,s,v:o});return[c,r,h,a]}function N(t){return t.type==="water"?t.color==null?null:t.color:t.material?.color==null?null:t.material.color}function x(t,e=0){const a=N(t);if(!a){if(t.type==="fill")return null;const l=Ut.r,s=C(l,e);return[s,s,s,100]}const n=a.toRgba();for(let l=0;l<3;l++)n[l]=C(n[l],e);return n}async function St(t,e){const a=t.style;return a==="none"?null:{type:"pattern",x:0,y:0,src:await Wt(ot(`esri/symbols/patterns/${a}.png`),e.toCss(!0)),width:5,height:5}}function zt(t){return t.outline?I(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function at(t,e){const a=N(t);if(!a)return null;let n="rgba(";return n+=C(a.r,e)+",",n+=C(a.g,e)+",",n+=C(a.b,e)+",",n+a.a+");"}function nt(t,e){const a=at(t,e);return a?"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none"?null:{color:a,width:Math.min(t.size?j(t.size):.75,K),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?rt(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?t.join==="miter"?j(2):t.join:null}:{}}function E(t,e,a){const n=a!=null?.75*a:0;return{type:"linear",x1:n?.25*n:0,y1:n?.5*n:0,x2:n||4,y2:n?.5*n:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function Ae(t){const e=t.depth,a=t.height,n=t.width;return n!==0&&e!==0&&a!==0&&n===e&&n!=null&&a!=null&&n<a}function De(t,e,a){const n=[];if(!t)return n;switch(t.type){case"icon":{const l=e,s=e;switch(t.resource?.primitive??Ft){case"circle":n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:x(t,0),stroke:I(t)});break;case"square":n.push({shape:{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[0,0]},{command:"L",values:[l,0]},{command:"L",values:[l,s]},{command:"Z",values:[]}]},fill:x(t,0),stroke:I(t)});break;case"triangle":n.push({shape:{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[.5*l,0]},{command:"L",values:[l,s]},{command:"Z",values:[]}]},fill:x(t,0),stroke:I(t)});break;case"cross":n.push({shape:{type:"path",path:[{command:"M",values:[.5*l,0]},{command:"L",values:[.5*l,s]},{command:"M",values:[0,.5*s]},{command:"L",values:[l,.5*s]}]},stroke:zt(t)});break;case"x":n.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[l,s]},{command:"M",values:[l,0]},{command:"L",values:[0,s]}]},stroke:zt(t)});break;case"kite":n.push({shape:{type:"path",path:[{command:"M",values:[0,.5*s]},{command:"L",values:[.5*l,0]},{command:"L",values:[l,.5*s]},{command:"L",values:[.5*l,s]},{command:"Z",values:[]}]},fill:x(t,0),stroke:I(t)})}break}case"object":switch(t.resource?.primitive??Pt){case"cone":{const l=E(x(t,0),x(t,-.6),a?tt:e),s=se(e,a);n.push({shape:s[0],fill:l},{shape:s[1],fill:l});break}case"inverted-cone":{const l=x(t,0),s=E(l,x(t,-.6),e),o=oe(e);n.push({shape:o[0],fill:s},{shape:o[1],fill:l});break}case"cube":{const l=ne(e,a);n.push({shape:l[0],fill:x(t,0)},{shape:l[1],fill:x(t,-.3)},{shape:l[2],fill:x(t,-.5)});break}case"cylinder":{const l=E(x(t,0),x(t,-.6),a?tt:e),s=le(e,a);n.push({shape:s[0],fill:l},{shape:s[1],fill:l},{shape:s[2],fill:x(t,0)});break}case"diamond":{const l=ie(e);n.push({shape:l[0],fill:x(t,-.3)},{shape:l[1],fill:x(t,0)},{shape:l[2],fill:x(t,-.3)},{shape:l[3],fill:x(t,-.7)});break}case"sphere":{const l=E(x(t,0),x(t,-.6));l.x1=0,l.y1=0,l.x2=.25*e,l.y2=.25*e,n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:l});break}case"tetrahedron":{const l=re(e);n.push({shape:l[0],fill:x(t,-.3)},{shape:l[1],fill:x(t,0)},{shape:l[2],fill:x(t,-.6)});break}}break}return n}function U(t){const e=typeof t?.size=="number"?t?.size:null;return e?j(e):null}function Oe(t){return t.type==="icon"?"multiply":"tint"}async function Ie(t,e){const a=U(e),n=e?.maxSize?j(e.maxSize):null,l=e?.disableUpsampling??!1,s=t.symbolLayers,o=[],c=[];let r=!1,h=0,m=0,p=0;s.forEach(i=>{if(i.type!=="icon"&&i.type!=="object")return;i&&i.type==="icon"&&(p=Math.max(i.size&&j(i.size),p));const d=i.type==="icon"?i.size&&j(i.size):0,g=a||d?Math.ceil(Math.min(a||d,n||F)):A;let v=i.type==="icon"?i.angle:null;if(e?.rotation!=null&&(v=(v??0)+e.rotation),c.push(v),i?.resource?.href){const y=Re(t,i).then(f=>{const M=i?.material?.color,z=Oe(i);return Ze(f,g,M,z,l)}).then(f=>{const M=f.width,z=f.height;return h=Math.max(h,M),m=Math.max(m,z),v&&(r=!0),[{shape:{type:"image",x:0,y:0,width:M,height:z,src:f.url},fill:null,stroke:null}]});o.push(y)}else{let y=g;i.type==="icon"&&a&&(y=g*(d/p));const f=e?.symbolConfig==="tall"||e?.symbolConfig?.isTall||i.type==="object"&&Ae(i);h=Math.max(h,f?tt:y),m=Math.max(m,y),v&&i.resource?.primitive&&["square","triangle","x"].includes(i.resource?.primitive)&&(r=!0),o.push(Promise.resolve(De(i,y,f)))}});const u=await Promise.allSettled(o),b=[];return u.forEach(i=>{i.status==="fulfilled"?b.push(i.value):i.reason&&Vt.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",i.reason)}),P(b,[h,m],{node:e?.node,scale:!1,opacity:e?.opacity,ariaLabel:e?.ariaLabel,rotations:c,useRotationSize:r})}function Ge(t,e){const a=t.symbolLayers,n=[],l=Bt(t),s=U(e),o=(e?.maxSize?j(e.maxSize):null)||K;let c,r=0,h=0;return a.forEach((m,p)=>{if(!m||m.type!=="line"&&m.type!=="path")return;const u=[];switch(m.type){case"line":{const b=nt(m,0);if(b==null)break;const i=b?.width||0;p===0&&(c=i);const d=Math.min(s||i,o),g=p===0?d:s?d*(i/c):d,v=g>Mt/2?2*g:Mt;h=Math.max(h,g),r=Math.max(r,v),b.width=g,u.push({shape:{type:"path",path:[{command:"M",values:[0,.5*h]},{command:"L",values:[r,.5*h]}]},stroke:b});break}case"path":{const b=Math.min(s||A,o),i=x(m,0),d=x(m,-.2),g=at(m,-.4),v=g?{color:g,width:1}:{};if(m.profile==="quad"){const y=m.width,f=m.height,M=te(y&&f?y/f:1,f===0,y===0),z={...v,join:"bevel"};u.push({shape:M[0],fill:d,stroke:z},{shape:M[1],fill:d,stroke:z},{shape:M[2],fill:i,stroke:z})}else u.push({shape:O.pathSymbol3DLayer[0],fill:d,stroke:v},{shape:O.pathSymbol3DLayer[1],fill:i,stroke:v});h=Math.max(h,b),r=h}}n.push(u)}),Promise.resolve(P(n,[r,h],{node:e?.node,scale:l,opacity:e?.opacity,ariaLabel:e?.ariaLabel}))}async function Ve(t,e){const a=t.type==="mesh-3d",n=t.symbolLayers,l=U(e),s=e?.maxSize?j(e.maxSize):null,o=l||A,c=[];let r=0,h=0,m=!1;for(let p=0;p<n.length;p++){const u=n.at(p),b=[];if(!a||u.type==="fill"){switch(u.type){case"fill":{const i=Math.min(o,s||F);if(r=Math.max(r,i),h=Math.max(h,i),m=!0,a){const d=O.meshSymbol3DFill,g=at(u,-.4),v=g?{color:g,width:1,join:"round"}:{};b.push({shape:d[0],fill:x(u,0),stroke:v},{shape:d[1],fill:x(u,-.2),stroke:v},{shape:d[2],fill:x(u,-.6),stroke:v})}else{let d=x(u,0);const g="pattern"in u?u.pattern:null,v=I(u),y=N(u);g!=null&&g.type==="style"&&g.style!=="solid"&&y&&(d=await St(g,y)),b.push({shape:O.fill[0],fill:d,stroke:v})}break}case"line":{const i=nt(u,0);if(i==null)break;const d={stroke:i,shape:O.fill[0]};r=Math.max(r,A),h=Math.max(h,A),b.push(d);break}case"extrude":{const i={join:"round",width:1,...nt(u,-.4)},d=x(u,0),g=x(u,-.2),v=Math.min(o,s||F),y=ee(v);i.width=1,b.push({shape:y[0],fill:g,stroke:i},{shape:y[1],fill:g,stroke:i},{shape:y[2],fill:d,stroke:i});const f=A,M=.7*A+.5*v;r=Math.max(r,f),h=Math.max(h,M);break}case"water":{const i=N(u),d=et(i),g=et(i,2),v=et(i,3),y=ae();m=!0,b.push({shape:y[0],fill:d},{shape:y[1],fill:g},{shape:y[2],fill:v});const f=Math.min(o,s||F);r=Math.max(r,f),h=Math.max(h,f);break}}c.push(b)}}return P(c,[r,h],{node:e?.node,scale:m,opacity:e?.opacity,ariaLabel:e?.ariaLabel})}function Pe(t,e){if(t.symbolLayers.length===0)return Promise.reject(new q("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return Ie(t,e);case"line-3d":return Ge(t,e);case"polygon-3d":case"mesh-3d":return Ve(t,e)}return Promise.reject(new q("symbolPreview: swatchInfo3D","symbol not supported."))}const Fe=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:St,getSizeFromOptions:U,getSymbolLayerFill:x,previewSymbol3D:Pe},Symbol.toStringTag,{value:"Module"}));let G=null;const $t=[255,255,255];function jt(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function Ne(t,e,a){const{backgroundColor:n,outline:l,dotSize:s}=t,o=a?.swatchSize||S.size,c=.8,r=Math.round(o*o/Math.max(s,.5)**2*c),h=window.devicePixelRatio,m=document.createElement("canvas"),p=o*h;m.width=p,m.height=p,m.style.width=m.width/h+"px",m.style.height=m.height/h+"px";const u=m.getContext("2d");if(n&&(u.fillStyle=n.toCss(!0),u.fillRect(0,0,p,p),u.fill()),u.fillStyle=e?.toCss(!0)??"",G&&G.length/2===r)for(let i=0;i<2*r;i+=2){const d=G[i],g=G[i+1];u.fillRect(d,g,s*h,s*h),u.fill()}else{G=[];for(let i=0;i<2*r;i+=2){const d=jt(0,p),g=jt(0,p);G.push(d,g),u.fillRect(d,g,s*h,s*h),u.fill()}}l&&(l.color&&(u.strokeStyle=l.color.toCss(!0)),u.lineWidth=l.width,u.strokeRect(0,0,p,p));const b=new Image(o,o);return b.src=m.toDataURL(),b.ariaLabel=a?.ariaLabel??null,b.alt=a?.ariaLabel??"",b}function Ee(t,e={}){const a=e.radius||40,n=2*Math.PI*a,l=t.length,s=n/l,o=[],c=Ht(e.outline);c?.width!=null&&(c.width*=2),(c||e.backgroundColor)&&o.push({shape:{type:"circle",cx:a,cy:a,r:a},fill:e.backgroundColor,stroke:c,offset:[0,0]});const r=e.values,h=r&&r.length===l&&r.reduce((i,d)=>i+d,0)===100,m=[0];for(let i=0;i<l;i++){let d=null;h&&(d=r[i]*n/100,m.push(d+m[i])),o.push({shape:{type:"circle",cx:a,cy:a,r:a/2},fill:[0,0,0,0],stroke:{width:a,dashArray:`${(d??s)/2} ${n}`,dashoffset:"-"+(h?m[i]/2:i*(s/2)),color:t[i]},offset:[0,0]})}let p=null;const u=2*a+(c?.width||0),b=e.holePercentage;if(b){c&&o.push({shape:{type:"circle",cx:a,cy:a,r:a*b},fill:null,stroke:c,offset:[0,0]});const i=u/2;p=[[{shape:{type:"circle",cx:i,cy:i,r:i},fill:$t,stroke:c?{...c,color:$t}:null,offset:[0,0]},{shape:{type:"circle",cx:i,cy:i,r:a*b},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return P([o],[u,u],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:p,rotations:[-90],ariaLabel:e.ariaLabel})}function Ue(t,e={}){const a=e.align==="horizontal",n=a?75:24,l=a?24:75,s=e.width??n,o=e.height??l,c=e.gradient??!0,r=window.devicePixelRatio,h=s*r,m=o*r,p=document.createElement("canvas");p.width=h,p.height=m,p.ariaLabel=e.ariaLabel??null,p.style.width=`${s}px`,p.style.height=`${o}px`;const u=p.getContext("2d"),b=a?h:0,i=a?0:m;if(c){const g=u.createLinearGradient(0,0,b,i),v=t.length,y=v===1?0:1/(v-1);t.forEach((f,M)=>g.addColorStop(M*y,f.toString())),u.fillStyle=g,u.fillRect(0,0,h,m)}else{const g=a?h/t.length:h,v=a?m:m/t.length;let y=0,f=0;for(const M of t)u.fillStyle=M.toString(),u.fillRect(y,f,g,v),y=a?y+g:0,f=a?0:f+v}const d=document.createElement("div");return d.style.width=`${s}px`,d.style.height=`${o}px`,Be(d,e?.effectList),d.appendChild(p),d}function Be(t,e){if(!e)return;t.style.filter=it(e);const a=e.effects;if(a){for(const n of a)if(n?.type==="drop-shadow"){n.offsetX<0?t.style.marginLeft=`${Math.abs(n.offsetX)}px`:t.style.marginRight=`${n.offsetX}px`;break}}}async function Ct(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:a}=await import("./previewWebStyleSymbol-yyKhlM2D.js");return a(t,Ct,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:a}=await Promise.resolve().then(()=>Fe);return a(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:a}=await import("./previewSymbol2D-BgXgV5g6.js");return a(t,e)}case"cim":{const{previewCIMSymbol:a}=await import("./previewCIMSymbol-CVZYVI5l.js");return a(t,e)}default:return}}function Zt(t){return t&&"opacity"in t?t.opacity*Zt(t.parent):1}async function We(t,e){if(!t)return;const a=t.sourceLayer,n=(e!=null&&e.useSourceLayer?a:t.layer)??a,l=e?.ignoreOpacity?1:Zt(n);if(t.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){const f=t.symbol.type==="web-style"?await t.symbol.fetchSymbol({...e,acceptedFormats:e?.webStyleAcceptedFormats,cache:e?.webStyleCache}):t.symbol.clone();return _(f,null,l),f}const s=e?.renderer??Te(n);let o=s&&"getSymbolAsync"in s?await s.getSymbolAsync(t,e):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...e,acceptedFormats:e?.webStyleAcceptedFormats,cache:e?.webStyleCache}):o.clone(),!s||!("visualVariables"in s)||!s.visualVariables?.length)return _(o,null,l),o;if("arcadeRequiredForVisualVariables"in s&&s.arcadeRequiredForVisualVariables&&e?.arcade==null){const f={...e};f.arcade=await Nt(),e=f}const{getColor:c,getOpacity:r,getAllSizes:h,getRotationAngle:m}=await import("./visualVariableUtils-BTS148WR.js").then(f=>f.b),p=[],u=[],b=[],i=[];for(const f of s.visualVariables)switch(f.type){case"color":p.push(f);break;case"opacity":u.push(f);break;case"rotation":i.push(f);break;case"size":f.target||b.push(f)}const d=!!p.length&&p[p.length-1],g=d?c(d,t,e):null,v=!!u.length&&u[u.length-1];let y=v?r(v,t,e):null;if(l!=null&&(y=y!=null?y*l:l),e?.ignoreOpacity&&(y=1),g!=null&&v&&y!=null&&(g.a=1),_(o,g,y),b.length&&e?.ignoreSizeVariables!==!0){const f=h(b,t,e);await qt(o,f)}if(e?.ignoreRotationVariables!==!0)for(const f of i)_t(o,m(f,t,e),f.axis);return o}function Te(t){if(t)return"renderer"in t?t.renderer:void 0}export{ft as A,vt as E,wt as L,Y as M,J as S,xt as T,kt as V,x as Z,Ue as a,ce as d,O as e,Ne as g,Ct as k,P as l,S as t,Q as v,Ee as w,We as x};
