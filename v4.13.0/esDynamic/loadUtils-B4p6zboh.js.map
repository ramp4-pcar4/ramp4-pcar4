{"version":3,"file":"loadUtils-B4p6zboh.js","sources":["../../node_modules/@arcgis/core/layers/support/LayerLoadContext.js","../../node_modules/@arcgis/core/portal/support/loadUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{fetchArcGISServiceJSON as t}from\"../../support/requestPresets.js\";class e{constructor(){this._serviceMetadatas=new Map,this._itemDatas=new Map}async fetchServiceMetadata(e,a){const s=this._serviceMetadatas.get(e);if(s)return s;const r=await t(e,a);return this._serviceMetadatas.set(e,r),r}async fetchItemData(t){const{id:e}=t;if(!e)return null;const{_itemDatas:a}=this;if(a.has(e))return a.get(e);const s=await t.fetchData();return a.set(e,s),s}async fetchCustomParameters(t,e){const a=await this.fetchItemData(t);return a&&\"object\"==typeof a&&(e?e(a):a.customParameters)||null}}export{e as LayerLoadContext};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{findAssociatedFeatureService as e}from\"../../layers/support/associatedFeatureServiceUtils.js\";import{getLayerModuleType as r}from\"../../layers/support/fetchService.js\";import{getPreferredHost as t}from\"../../layers/support/layerUtils.js\";function a(e){const t={id:e.id,name:e.name},a=r(e.type);return\"FeatureLayer\"!==a&&(t.layerType=a),t}async function l(e,r,l){let n;if(null==e?.layers||null==e?.tables){const u=await l.fetchServiceMetadata(r,{customParameters:s(e)?.customParameters});n=t(),(e=e||{}).layers=e.layers||u?.layers?.map(a),e.tables=e.tables||u?.tables?.map(a)}return{data:e,preferredHost:n}}function s(e){if(!e)return null;const{layers:r,tables:t}=e;return r?.length?r[0]:t?.length?t[0]:null}function n(e,r){if(null==r)return null;return[...e.layers||[],...e.tables||[]].find((e=>e.id===r))}function u(e,r){return[...e.layers||[],...e.tables||[]].filter((({layerType:e})=>e?r.includes(e):r.includes(\"ArcGISFeatureLayer\")))}function c(e){return(e?.layers?.length??0)+(e?.tables?.length??0)}function o(e){switch(e){case\"catalog\":return[\"CatalogLayer\"];case\"feature\":return[\"ArcGISFeatureLayer\"];case\"oriented-imagery\":return[\"OrientedImageryLayer\"];case\"subtype-group\":return[\"SubtypeGroupLayer\",\"SubtypeGroupTable\"]}return null}function i(e){switch(e){case\"CatalogLayer\":return\"CatalogLayer\";case\"OrientedImageryLayer\":return\"OrientedImageryLayer\";case\"SubtypeGroupLayer\":case\"SubtypeGroupTable\":return\"SubtypeGroupLayer\"}return\"FeatureLayer\"}async function y(r,t,l){if(!r?.url)return t??{};if(t??={},!t.layers){const e=await l.fetchServiceMetadata(r.url);t.layers=e.layers?.map(a)}const{serverUrl:n,portalItem:u}=await e(r.url,{sceneLayerItem:r,customParameters:s(t)?.customParameters}).catch((()=>({serverUrl:null,portalItem:null})));if(null==n)return t.tables=[],t;if(!t.tables&&u){const e=await u.fetchData().catch((()=>null));if(e?.tables)t.tables=e.tables.map(a);else{const r=await l.fetchServiceMetadata(n,{customParameters:s(e)?.customParameters}).catch((()=>null));t.tables=r?.tables?.map(a)}}if(t.tables)for(const e of t.tables)e.url=`${n}/${e.id}`;return t}export{a as createSublayerData,s as getFirstLayerOrTable,n as getLayerOrTable,c as getNumLayersAndTables,u as getSublayersByLayerType,o as instanceTypeToLayerTypes,i as layerTypeToLayerModuleType,y as populateSceneServiceItemData,l as preprocessFSItemData};\n"],"names":["e","s","r","t","a","l","n","u","c","o","i","y"],"mappings":"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","x_google_ignoreList":[0,1]}