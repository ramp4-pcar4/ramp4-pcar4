import{gA as st,ah as g,ap as E,hm as ot,dj as p,di as it}from"./main-BFDurRCu.js";import{p as ct}from"./mat4-OOmHNWi7.js";import{s as x,c as f,P as O,u as P,g as _,_ as A,A as T,r as m,o as y,v as at,p as I,I as ut,j as ft,E as ht,q as gt}from"./vec32-Cj8pVsU0.js";import{a as R,L as V}from"./vec42-D8CJyqHG.js";import{n as L,r as N}from"./vec4f64-DD-nkcCV.js";import{e as mt}from"./common-CYWrYyJl.js";import"./mat3-DOnW3DjW.js";import"./mat3f64-BnNZDR5l.js";import{c as u,f as lt,b as dt}from"./vectorStacks-5ZZtmT9E.js";class X{constructor(r){this._allocator=r,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&st(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const r=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*Y);this._items.length=Math.min(r,this._items.length),this._itemsPtr=0}_grow(){for(let r=0;r<Math.max(8,Math.min(this._items.length,Y));r++)this._items.push(this._allocator())}}const Y=1024;function M(t){return t?Z(E(t.origin),E(t.direction)):Z(g(),g())}function Z(t,r){return{origin:t,direction:r}}function _t(t,r){const n=bt.get();return n.origin=t,n.direction=r,n}function Mt(t,r=M()){return pt(t.origin,t.direction,r)}function $(t,r,n=M()){return x(n.origin,t),f(n.direction,r,t),n}function pt(t,r,n=M()){return x(n.origin,t),x(n.direction,r),n}function Pt(t,r){const n=A(u.get(),T(u.get(),t.direction),f(u.get(),r,t.origin));return O(n,n)}function St(t,r,n){const e=O(t.direction,f(n,r,t.origin));return P(n,t.origin,_(n,t.direction,e)),n}const bt=new X(()=>M());function k(t,r){const n=m(t),e=ot(t[2]/n),s=Math.atan2(t[1]/n,t[0]/n);return y(r,n,e,s),r}const z=S();function S(){return L()}const B=V,qt=V;function j(t,r){return R(r,t)}function F(t,r){return N(t[0],t[1],t[2],r)}function H(t){return t}function wt(t){t[0]=t[1]=t[2]=t[3]=0}function xt(t,r){return t[0]=t[1]=t[2]=0,t[3]=r,t}function l(t){return t[3]}function U(t){return t}function D(t,r,n,e){return N(t,r,n,e)}function At(t,r,n){return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=t[3]+r,n}function yt(t,r,n){return t!==n&&j(t,n),n}function Rt(t,r){return r}function b(t,r,n){if(r==null||!J(t,r,q))return!1;let{t0:e,t1:s}=q;if((e<0||s<e&&s>0)&&(e=s),e<0)return!1;if(n){const{origin:o,direction:i}=r;n[0]=o[0]+i[0]*e,n[1]=o[1]+i[1]*e,n[2]=o[2]+i[2]*e}return!0}function G(t,r,n){const e=$(r,n);if(!J(t,e,q))return[];const{origin:s,direction:o}=e,{t0:i,t1:c}=q,a=h=>{const d=g();return gt(d,s,o,h),w(t,d,d)};return Math.abs(i-c)<mt()?[a(i)]:[a(i),a(c)]}const q={t0:0,t1:0};function J(t,r,n){const{origin:e,direction:s}=r,o=jt;o[0]=e[0]-t[0],o[1]=e[1]-t[1],o[2]=e[2]-t[2];const i=s[0]*s[0]+s[1]*s[1]+s[2]*s[2];if(i===0)return!1;const c=2*(s[0]*o[0]+s[1]*o[1]+s[2]*o[2]),a=c*c-4*i*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(a<0)return!1;const h=Math.sqrt(a);return n.t0=(-c-h)/(2*i),n.t1=(-c+h)/(2*i),!0}const jt=g();function K(t,r){return b(t,r,null)}function vt(t,r,n){if(b(t,r,n))return n;const e=Q(t,r,u.get());return P(n,r.origin,_(u.get(),r.direction,I(r.origin,e)/m(r.direction))),n}function Q(t,r,n){const e=u.get(),s=lt.get();A(e,r.origin,r.direction);const o=l(t);A(n,e,r.origin),_(n,n,1/m(n)*o);const i=W(t,r.origin),c=dt(r.origin,n);return ct(s,c+i,e),ht(n,n,s),n}function Ct(t,r,n,e){const s=l(t),o=s*s,i=r+.5*Math.PI,c=n*n+o-2*Math.cos(i)*n*s,a=Math.sqrt(c),h=c-o;if(h<=0)return .5;const d=Math.sqrt(h),et=Math.acos(d/a)-Math.asin(s/(a/Math.sin(i)));return Math.min(1,(et+.5*e)/e)}function Et(t,r,n){return b(t,r,n)?n:(St(r,t,n),w(t,n,n))}function w(t,r,n){const e=f(u.get(),r,t),s=_(u.get(),e,t[3]/m(e));return P(n,s,t)}function Ot(t,r){const n=f(u.get(),r,t),e=ft(n),s=t[3]*t[3];return Math.sqrt(Math.abs(e-s))}function W(t,r){const n=f(u.get(),r,t),e=m(n),s=l(t),o=s+Math.abs(s-e);return it(s/o)}const v=g();function tt(t,r,n,e){const s=f(v,r,t);switch(n){case p.X:{const o=k(s,v)[2];return y(e,-Math.sin(o),Math.cos(o),0)}case p.Y:{const o=k(s,v),i=o[1],c=o[2],a=Math.sin(i);return y(e,-a*Math.cos(c),-a*Math.sin(c),Math.cos(i))}case p.Z:return T(e,s);default:return}}function nt(t,r){const n=f(C,r,t);return m(n)-t[3]}function Tt(t,r,n,e){const s=nt(t,r),o=tt(t,r,p.Z,C),i=_(C,o,n-s);return P(e,r,i)}function rt(t,r){const n=at(t,r),e=l(t);return n<=e*e}function It(t,r,n=L()){const e=I(t,r),s=t[3],o=r[3];return e+o<s?(R(n,t),n):e+s<o?(R(n,r),n):(ut(n,t,r,(e+o-s)/(2*e)),n[3]=(e+s+o)/2,n)}const C=g(),Vt=S(),Lt=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:z,altitudeAt:nt,angleToSilhouette:W,axisAt:tt,cameraFrustumCoverage:Ct,clear:wt,closestPoint:Et,closestPointOnSilhouette:Q,containsPoint:rt,copy:j,create:S,distanceToSilhouette:Ot,elevate:At,equals:qt,exactEquals:B,fromCenterAndRadius:F,fromRadius:xt,fromValues:D,getCenter:U,getExtent:Rt,getRadius:l,intersectLine:G,intersectRay:b,intersectRayClosestSilhouette:vt,intersectsRay:K,projectPoint:w,setAltitudeAt:Tt,setExtent:yt,tmpSphere:Vt,union:It,wrap:H},Symbol.toStringTag,{value:"Module"}));export{w as $,z as C,S as E,K as H,G as I,l as N,F as O,$ as S,H as T,U,D as V,B as _,j as a,M as b,Lt as f,rt as i,_t as k,X as s,Mt as v,Pt as w};
