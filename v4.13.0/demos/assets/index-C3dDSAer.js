const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./point-icon-BCzwlKeA.js","./main-6eEsl9OJ.js","./preload-helper-B76NpbEU.js","./main-B_8sIZOq.css","./polyline-icon-D2kLnXYD.js","./polygon-icon-6nYFnrNA.js","./circle-icon--yHDQ0mm.js","./rectangle-icon-CuEokXtS.js","./edit-icon-BdYlZKCj.js"])))=>i.map(i=>d[i]);
import{dr as F,ds as r,dt as e,eM as L,eN as S,f4 as V,jR as H,eT as D,fb as x,eU as d,eV as C,du as u,gl as f,fc as g,eQ as I,eX as O,eW as M,eS as b,jI as T,hv as Z,eZ as W,aa as $,gn as P,f3 as G,jS as X,f5 as J,eR as N,f6 as w,eY as R,F as K,f9 as ee}from"./main-6eEsl9OJ.js";import{_ as y}from"./preload-helper-B76NpbEU.js";import{u as te}from"./draw-store-DyzvLXpj.js";const oe={},ne={class:"border-b p-0 self-center w-2/3"};function ae(_,a){return e(),r("span",ne)}const Y=F(oe,[["render",ae]]),se=L({__name:"zoom-nav",setup(_){const{t:a}=S(),t=V("iApi"),o=H(400,!0,()=>t.geo.map.zoomIn()),c=H(400,!0,()=>t.geo.map.zoomOut());return(s,n)=>{const l=D("mapnav-button");return e(),r("div",null,[x(l,{onClickFunction:d(o),tooltip:d(a)("mapnav.zoomIn")},{default:C(()=>n[0]||(n[0]=[u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[u("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),u("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),x(Y),x(l,{onClickFunction:d(c),tooltip:d(a)("mapnav.zoomOut")},{default:C(()=>n[1]||(n[1]=[u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[u("path",{d:"M19 13H5v-2h14v2z"}),u("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),ie={class:"mapnav-section bg-white-75 hover:bg-white"},re=L({__name:"draw-nav-section",props:{showOutline:{type:Boolean,default:!1}},setup(_){const a=V("iApi"),{t}=S(),o=te(),c=[{type:"point",icon:f(g(()=>y(()=>import("./point-icon-BCzwlKeA.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)))},{type:"polyline",icon:f(g(()=>y(()=>import("./polyline-icon-D2kLnXYD.js"),__vite__mapDeps([4,1,2,3]),import.meta.url)))},{type:"polygon",icon:f(g(()=>y(()=>import("./polygon-icon-6nYFnrNA.js"),__vite__mapDeps([5,1,2,3]),import.meta.url)))},{type:"circle",icon:f(g(()=>y(()=>import("./circle-icon--yHDQ0mm.js"),__vite__mapDeps([6,1,2,3]),import.meta.url)))},{type:"rectangle",icon:f(g(()=>y(()=>import("./rectangle-icon-CuEokXtS.js"),__vite__mapDeps([7,1,2,3]),import.meta.url)))}],s=I(()=>{const i=c.filter(v=>o.supportedTypes.some(k=>k.type===v.type));return i.push({type:"edit",icon:f(g(()=>y(()=>import("./edit-icon-BdYlZKCj.js"),__vite__mapDeps([8,1,2,3]),import.meta.url)))}),i}),n=i=>{o.activeTool===i?o.setActiveTool(null):o.setActiveTool(i)},l=()=>{a.geo.map.setMouseFocus()};return(i,v)=>{const k=D("mapnav-button");return e(),r("div",ie,[(e(!0),r(O,null,M(s.value,(m,A)=>(e(),b(k,{key:m.type,onMousedown:l,onClickFunction:()=>n(m.type),tooltip:d(t)(`draw.${m.type}.tooltip`),class:W({"active-tool":d(o).activeTool===m.type}),style:Z({marginBottom:A!==s.value.length-1?"0px":"0"}),showOutline:_.showOutline},{default:C(()=>[(e(),b(T(m.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","class","style","showOutline"]))),128))])}}}),j=F(re,[["__scopeId","data-v-fbc17bad"]]),le={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},ce=["content"],pe={class:"mapnav-section bg-white-75 hover:bg-white"},ue={key:1,class:"mapnav-section bg-white-75 hover:bg-white"},ve=["content"],me={key:0},de=L({__name:"mapnav",setup(_){const a=$(void 0),t=V("iApi"),o=P(),{t:c}=S(),s=$(),n=I(()=>t.getConfig().fixtures.mapnav.items.some(p=>p==="draw")),l=$(t.$rootEl?.clientHeight),i=$(!1),v=$(0),k=()=>{l.value=t.$rootEl?.clientHeight},m=()=>{s.value._tippy.hide()},A=p=>{p.key==="Tab"&&s.value?.matches(":focus")&&s.value._tippy.show()};G(()=>{s.value?.addEventListener("blur",m),s.value?.addEventListener("keyup",A),a.value=new ResizeObserver(k),a.value.observe(t.$rootEl),X(()=>{v.value=z.value.length*82})}),J(()=>{s.value?.removeEventListener("blur",m),s.value?.removeEventListener("keyup",A),a.value.disconnect()});const z=I(()=>o.order.map(p=>o.items[p]).filter(p=>p.componentId&&p.id!=="draw"));return(p,h)=>{const Q=D("mapnav-button"),U=R("focus-list"),B=R("tippy");return e(),r("div",le,[N((e(),r("div",{class:"mapnav-section flex flex-col",content:d(c)("panels.controls.items"),ref_key:"el",ref:s},[n.value&&l.value>v.value?(e(),r(O,{key:0},[x(j),h[0]||(h[0]=u("span",{class:"py-1"},null,-1))],64)):w("",!0),x(se,{class:"mapnav-section bg-white-75 hover:bg-white"}),h[2]||(h[2]=u("span",{class:"py-1"},null,-1)),u("div",pe,[l.value<=v.value?(e(),b(Q,{key:0,class:"self-center",onClickFunction:()=>{i.value=!i.value},tooltip:i.value?p.$t("mapnav.closeMenu"):p.$t("mapnav.openMenu")},{default:C(()=>[(e(),r("svg",{xmlns:"http://www.w3.org/2000/svg","shape-rendering":"geometricPrecision","text-rendering":"geometricPrecision","image-rendering":"optimizeQuality","fill-rule":"evenodd","clip-rule":"evenodd",viewBox:"0 0 319 511.61",class:W(["fill-current w-6 mx-auto transition-all transform",{"rotate-180":i.value}])},h[1]||(h[1]=[u("path",{d:"m270.08 5.89 43.04 43.04c7.85 7.86 7.83 20.72 0 28.54L134.77 255.82l178.35 178.35c7.85 7.86 7.8 20.73 0 28.54l-43.04 43.04c-7.83 7.82-20.71 7.82-28.54 0L49.29 313.49l-.37-.36-43.04-43.04c-7.82-7.83-7.86-20.68 0-28.54l43.04-43.04.37-.36L241.54 5.89c7.85-7.85 20.68-7.85 28.54 0z"},null,-1)]),2))]),_:1},8,["onClickFunction","tooltip"])):w("",!0)]),l.value>v.value?(e(),r("div",ue,[(e(!0),r(O,null,M(z.value,(E,q)=>(e(),r(O,{key:E.id+"button"},[(e(),b(T(E.id+"-nav-button"))),q!==z.value.length-1?(e(),b(Y,{key:0,class:"mapnav-divider"})):w("",!0)],64))),128))])):w("",!0)],8,ce)),[[U],[B,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]]),l.value<=v.value&&i.value?N((e(),r("div",{key:0,class:"mapnav-section flex flex-col flex-wrap-reverse shadow-tm absolute right-56 bottom-36 sm:bottom-48 items-start z-50 gap-0.5",style:Z({maxHeight:`${(l.value-70)*.8}px`,height:"fit-content",width:"fit-content"}),content:d(c)("panels.controls.items")},[n.value?(e(),r("div",me,[x(j,{showOutline:""})])):w("",!0),(e(!0),r(O,null,M(z.value,E=>(e(),b(T(E.id+"-nav-button"),{key:E.id+"button",class:"mapnav-section bg-white-75 hover:bg-white",showOutline:""}))),128))],12,ve)),[[B,{trigger:"manual",placement:"top-end",maxWidth:190}]]):w("",!0)])}}}),he=F(de,[["__scopeId","data-v-b75ec8de"]]);class _e extends K{mapnavStore=P(this.$vApp.$pinia);get config(){return super.config}_parseConfig(a){if(!a)return;const t=a.items.map(o=>({id:o}));this.mapnavStore.items=t.reduce((o,c)=>(o[c.id]=c,o),{}),this.mapnavStore.order=t.map(o=>o.id),this._validateItems()}_validateItems(){const a=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(t=>{(this.$iApi.fixture.exists(t)||a.includes(t))&&(this.mapnavStore.items[t].componentId=`${t}-nav-button`)})}}const fe={en:{"mapnav.openMenu":"Open navigation","mapnav.closeMenu":"Close navigation","mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.openMenu":"Ouvrir la navigation","mapnav.closeMenu":"Fermer la navigation","mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arrière","mapnav.home":"Accueil","mapnav.fullscreen":"Plein Écran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refusée. Veuillez vérifier les paramètres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu être trouvé."}};class be extends _e{async added(){Object.entries(fe).forEach(n=>this.$iApi.$i18n.mergeLocaleMessage(...n));const{destroy:a,el:t}=this.mount(he,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(t.childNodes[0]),this._parseConfig(this.config);const c=this.$vApp.$watch(()=>this.config,n=>this._parseConfig(n)),s=this.$iApi.event.on(ee.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{c(),this.$iApi.event.off(s);const n=P(this.$vApp.$pinia),l={...n.items};Object.keys(l).forEach(i=>n.removeItem(i)),n.$reset(),a()}}}export{be as default};
