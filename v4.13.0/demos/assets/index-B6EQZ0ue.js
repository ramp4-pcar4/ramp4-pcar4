import{eM as S,F as _,eO as A,e$ as B,aa as u,eQ as f,f4 as M,f1 as R,f3 as T,f9 as g,f5 as P,ds as k,dt as z,du as h,eR as O,hv as H,hw as N,eY as F,eU as V,dr as W}from"./main-6eEsl9OJ.js";import"./preload-helper-B76NpbEU.js";const D={class:"swipe-container"},G=["id","aria-valuenow","aria-label","content"],U=["swipe-position","view"],Y=S({__name:"swipe",props:{fixture:{type:_,required:!0},message:String},setup(b){const n=M("iApi"),d=A(),a=B("slider"),p=u(45),v=u(0),c=u(0),y=u(50),L=u(),i=u(),x=f(()=>{const r=30+c.value-c.value,s=a.value?.getBoundingClientRect()?a.value?.getBoundingClientRect().right-a.value?.getBoundingClientRect().left:0,t=+p.value/90,e=(s-r)*t,m=(a.value?.getBoundingClientRect().x??0)+e+(r-5.25)/2;return y.value=m/n.$rootEl.clientWidth*100+.2,`${m}px`}),$=f(()=>`${v.value}px`),C=f(()=>`${-v.value/2-18}px`);R(()=>{v.value=n.$rootEl?.clientHeight??1200});const w=()=>{v.value=n.$rootEl?.clientHeight??v.value,c.value++,setTimeout(()=>{c.value++},50)},o=()=>{d.setOpacity(.1),a.value.style.background=""},l=()=>{d.setOpacity(1),a.value.style.background="inherit"};T(async()=>{"ontouchstart"in document.documentElement||!window.matchMedia("(pointer:fine)").matches||(a.value.style.background="inherit"),window.addEventListener("resize",w),a.value?.addEventListener("focus",o),a.value?.addEventListener("blur",l),a.value?.addEventListener("mouseover",o),a.value?.addEventListener("mouseleave",l),a.value?.addEventListener("touchstart",o),a.value?.addEventListener("touchend",l),setTimeout(()=>{c.value++},50),await E();const s=()=>{const t=i.value?.querySelector(".arcgis-swipe__container");return t?(t.removeAttribute("tabindex"),!0):!1};if(!s()){const t=new MutationObserver((e,m)=>{s()&&m.disconnect()});t.observe(i.value,{childList:!0,subtree:!0,attributes:!1}),setTimeout(()=>t.disconnect(),5e3)}n.event.on(g.MAP_BASEMAPCHANGE,async t=>{t.schemaChanged&&(i.value?.trailingLayers.forEach(e=>{i.value?.trailingLayers.remove(e)}),i.value?.leadingLayers.forEach(e=>{i.value?.leadingLayers.remove(e)}),await E())}),n.event.on(g.LAYER_RELOAD_END,t=>{i.value?.trailingLayers.forEach(e=>{e.id===t.id&&(i.value?.trailingLayers.remove(e),i.value?.trailingLayers.add(t.esriLayer))}),i.value?.leadingLayers.forEach(e=>{e.id===t.id&&(i.value?.leadingLayers.remove(e),i.value?.leadingLayers.add(t.esriLayer))})}),n.event.on(g.LAYER_REMOVE,t=>{i.value?.trailingLayers.forEach(e=>{e.id===t.id&&i.value?.trailingLayers.remove(e)}),i.value?.leadingLayers.forEach(e=>{e.id===t.id&&i.value?.leadingLayers.remove(e)})})});const E=async()=>{await n.geo.map.viewPromise,L.value=n.geo.map.esriView;const r=["Nature","WFSLayer"],s=["Water","GeoMet"];r.forEach(t=>{n.geo.layer.awaitLayer(t,!0).then(e=>{e.esriLayer?i.value?.trailingLayers.add(e.esriLayer):console.warn(`Invalid layer instance: ${t}`)})}),s.forEach(t=>{n.geo.layer.awaitLayer(t,!0).then(e=>{e.esriLayer?i.value?.leadingLayers.add(e.esriLayer):console.warn(`Invalid layer instance: ${t}`)})})};return P(()=>{window.removeEventListener("resize",w),a.value?.removeEventListener("focus",()=>o),a.value?.removeEventListener("blur",()=>l),a.value?.removeEventListener("mouseover",o),a.value?.removeEventListener("mouseleave",l),a.value?.removeEventListener("touchstart",o),a.value?.removeEventListener("touchend",l)}),(r,s)=>{const t=F("tippy");return z(),k("div",D,[h("div",{class:"verticalLine",style:H({left:x.value,height:$.value,bottom:C.value})},null,4),O(h("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>p.value=e),id:"layerSlider"+V(n).$element._uid,class:"layerSliderElement",type:"range",ref_key:"slider",ref:a,min:"0","aria-valuemin":"0","aria-valuemax":"90","aria-valuenow":p.value,"aria-label":r.$t("map.layerSwipe.label"),max:"90",step:"0.5",content:r.$t("map.layerSwipe.drag"),style:{"z-index":10}},null,8,G),[[N,p.value],[t,{followCursor:!0,trigger:"mouseenter"}]]),h("arcgis-swipe",{direction:"horizontal","swipe-position":y.value,view:L.value,"auto-destroy-disable":"",ref_key:"swipeComponent",ref:i},null,8,U)])}}}),q=W(Y,[["__scopeId","data-v-20a7c061"]]);class I extends _{async added(){const{el:n,destroy:d}=this.mount(q,{app:this.$element,props:{fixture:this}});n.childNodes[0]&&this.$vApp.$el.appendChild(n.childNodes[0]),this.removed=()=>{d()}}}export{I as default};
