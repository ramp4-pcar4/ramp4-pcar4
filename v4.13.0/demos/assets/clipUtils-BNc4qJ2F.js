const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./intersectsOperator-CcSaVHNX.js","./ProjectionTransformation-BBf9JC5R.js","./Envelope2D-N58wWtPO.js","./Point2D-yI-uny1B.js","./Transformation2D-CZuEM6rU.js","./SimpleGeometryCursor-B92kdZ15.js","./main-6eEsl9OJ.js","./preload-helper-B76NpbEU.js","./main-B_8sIZOq.css","./OperatorDefinitions-DP7_WWTp.js","./jsonConverter-bNZhBr_R.js","./OperatorIntersects-Dybn4yFc.js","./apiConverter-eRO55_cM.js","./containsOperator-e1fVTypd.js"])))=>i.map(i=>d[i]);
import{_ as $}from"./preload-helper-B76NpbEU.js";import{c1 as b,bN as C,c4 as L}from"./main-6eEsl9OJ.js";import{c as R}from"./dataUtils-CHnwz3lm.js";function V(e,r){if(e.spatialReference.equals(r))return e;const t=C(e.spatialReference),i=C(r);if(t===i)return e;const a=t/i;return{x:e.x*a,y:e.y*a}}async function K(e,r,t){if(t.type==="extent")return Z(e,r,t);const{width:i,height:a}=e,n=new Uint8Array(i*a);return(await $(async()=>{const{execute:h}=await import("./intersectsOperator-CcSaVHNX.js").then(x=>x.i);return{execute:h}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url)).execute(r,t)?t.type==="polyline"?B(e,r,t):(await $(async()=>{const{execute:h}=await import("./containsOperator-e1fVTypd.js").then(x=>x.c);return{execute:h}},__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,10,12]),import.meta.url)).execute(t,r)?e:j(e,r,t):new R({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function j(e,r,t){if(!e)return e;const{width:i,height:a}=e,n=q({geometry:t,size:[i,a],srcExtent:r,srcMask:e.mask});return new R({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function q(e){const{geometry:r,size:t,srcExtent:i,srcMask:a}=e,[n,h]=t;let x;const l=i.width/n,u=i.height/h,{xmin:s,ymax:o}=i;if(r.type==="extent"){const f=(r.xmin-s)/l,p=(r.xmax-s)/l,c=(o-r.ymax)/u,y=(o-r.ymin)/u;x=[[[f,c],[f,y],[p,y],[p,c],[f,c]]]}else x=r.rings.map(f=>f.map(([p,c])=>[(p-s)/l,(o-c)/u]));return N(x,t,a)}function N(e,r,t){const[i,a]=r,n=new OffscreenCanvas(i,a).getContext("2d");n.fillStyle="#f00",n.beginPath(),e.forEach(s=>{n.moveTo(s[0][0],s[0][1]);for(let o=0;o<s.length;o++)n.lineTo(s[o][0],s[o][1]);n.closePath()}),n.fill();const h=n.getImageData(0,0,i,a).data,x=i*a,l=new Uint8Array(x);let u=!1;for(let s=0;s<x;s++)t&&!t[s]||(h[4*s+3]>127?l[s]=255:u=!0);return u||t?l:void 0}function Z(e,r,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),h=r.width/i,x=r.height/a;if(t.width/h<.5||t.height/x<.5)return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const{xmin:l,xmax:u,ymin:s,ymax:o}=r,{xmin:f,xmax:p,ymin:c,ymax:y}=t,m=Math.max(l,f),A=Math.min(u,p),g=Math.max(s,c),M=Math.min(o,y),w=.5*h,E=.5*x;if(A-m<w||M-g<E||A<l+w||m>u-w||g>o-E||M<s+E)return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const d=Math.max(0,(m-l)/h),z=Math.min(i,Math.max(0,(A-l)/h)),P=Math.max(0,(o-M)/x),_=Math.min(a,Math.max(0,(o-g)/x)),T=Math.round(d),v=Math.round(z)-1,k=Math.round(P),I=Math.round(_)-1;if(T===v&&d%1>.5&&z%1<.5||k===I&&P%1>.5&&_%1<.5)return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});if(T===0&&k===0&&v===i&&I===a)return e;const D=e.mask;for(let S=k;S<=I;S++)for(let U=T;U<=v;U++){const O=S*i+U;n[O]=D?D[O]:255}return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function B(e,r,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),h=r.width/i,x=r.height/a,{xmin:l,ymax:u}=r,{paths:s}=t,o=e.mask;for(let f=0;f<s.length;f++){const p=s[f];for(let c=0;c<p.length-1;c++){const[y,m]=p[c],[A,g]=p[c+1];let M=Math.floor((u-m)/x),w=Math.floor((u-g)/x);if(w<M){const d=M;M=w,w=d}M=Math.max(0,M),w=Math.min(a-1,w);const E=(A-y)/(g-m);for(let d=M;d<=w;d++){const z=d===M?Math.max(m,g):(a+1-d)*x,P=d===w?Math.min(m,g):z-x;let _=Math.floor(g===m?(y-l)/h:(E*(z-m)+y-l)/h),T=Math.floor(g===m?(A-l)/h:(E*(P-m)+y-l)/h);if(T<_){const k=_;_=T,T=k}const v=d*i;_=Math.max(0,_),T=Math.min(i-1,T);for(let k=v+_;k<=v+T;k++)n[k]=o?o[k]:255}}}return new R({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function Q(e,r){const{extent:t}=F(e,r,new L({x:e.pixelSize.x,y:e.pixelSize.y,spatialReference:e.spatialReference})),{extent:i}=e.extent;if(t.xmax=Math.min(t.xmax,i.xmax),t.ymax=Math.min(t.ymax,i.ymax),t.xmin<t.xmax&&t.ymin<t.ymax){const{x:a,y:n}=e.pixelSize,h=Math.round(t.width/a),x=Math.round(t.height/n);e.extent=t,e.width=h,e.height=x}}function F(e,r,t,i=!0){const{spatialReference:a}=e,{x:n,y:h}=V(t,a);let x,l,u;const s=r.type==="extent"?r:r.extent;let{xmin:o,xmax:f,ymax:p,ymin:c}=s;const{xmin:y,ymax:m}=e.extent;return i?(o=y+(o>y?n*Math.round((o-y)/n):0),p=m-(p<m?h*Math.round((m-p)/h):0),f=y+(f>y?n*Math.round((f-y)/n):0),c=m-(c<m?h*Math.round((m-c)/h):0),x=new b({xmin:o,ymax:p,xmax:f,ymin:c,spatialReference:a}),l=Math.round(x.width/n),u=Math.round(x.height/h)):(l=Math.floor((f-o)/n+.8),u=Math.floor((p-c)/h+.8),o=y+(o>y?n*Math.floor((o-y)/n+.1):0),p=m-(p<m?h*Math.floor((m-p)/h+.1):0),f=o+l*n,c=p-u*h,x=new b({xmin:o,ymax:p,xmax:f,ymin:c,spatialReference:a})),{extent:x,width:l,height:u}}export{Q as l,F as p,K as r,q as x};
