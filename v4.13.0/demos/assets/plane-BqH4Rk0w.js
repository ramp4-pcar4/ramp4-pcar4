import{ah as H,aj as g}from"./main-6eEsl9OJ.js";import{o as h,_ as X,A,P as T,u as L,g as v,c as s,H as P}from"./vec32-BvrGiqaM.js";import"./vec42-CKs01hkn.js";import{r as j,c as f,a as p}from"./vectorStacks-DkJKKYqf.js";function rr(r){const u=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],I=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],n=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(u,I,n))}function ur(r,u){const I=Math.sqrt(u[0]*u[0]+u[4]*u[4]+u[8]*u[8]),n=Math.sqrt(u[1]*u[1]+u[5]*u[5]+u[9]*u[9]),t=Math.sqrt(u[2]*u[2]+u[6]*u[6]+u[10]*u[10]);return h(r,I,n,t),r}function k(r,u,I){Math.abs(r[0])>Math.abs(r[1])?h(u,0,1,0):h(u,1,0,0),X(I,r,u),X(u,I,r),A(I,I),A(u,u)}function x(r=_){return[r[0],r[1],r[2],r[3]]}function Ir(r=_[0],u=_[1],I=_[2],n=_[3]){return d(r,u,I,n,j.get())}function w(r,u){return d(u[0],u[1],u[2],u[3],r)}function nr(r){return r}function d(r,u,I,n,t=x()){return t[0]=r,t[1]=u,t[2]=I,t[3]=n,t}function z(r,u,I){const n=u[0]*u[0]+u[1]*u[1]+u[2]*u[2],t=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return I[0]=u[0]*t,I[1]=u[1]*t,I[2]=u[2]*t,I[3]=-(I[0]*r[0]+I[1]*r[1]+I[2]*r[2]),I}function G(r,u,I,n=x()){const t=I[0]-u[0],c=I[1]-u[1],o=I[2]-u[2],e=r[0]-u[0],D=r[1]-u[1],O=r[2]-u[2],S=c*O-o*D,F=o*e-t*O,R=t*D-c*e,q=S*S+F*F+R*R,b=Math.abs(q-1)>1e-5&&q>1e-12?1/Math.sqrt(q):1;return n[0]=S*b,n[1]=F*b,n[2]=R*b,n[3]=-(n[0]*r[0]+n[1]*r[1]+n[2]*r[2]),n}function y(r,u,I,n=0,t=Math.floor(I*(1/3)),c=Math.floor(I*(2/3))){if(I<3)return!1;u(M,n);let o=t,e=!1;for(;o<I-1&&!e;)u(E,o),o++,e=!P(M,E);if(!e)return!1;for(o=Math.max(o,c),e=!1;o<I&&!e;)u(a,o),o++,s(U,M,E),A(U,U),s(l,E,a),A(l,l),e=!P(M,a)&&!P(E,a)&&Math.abs(T(U,l))<J;return e?(G(M,E,a,r),!0):(n!==0||t!==1||c!==2)&&y(r,u,I,0,1,2)}function tr(r,u,I=!0){const n=u.length/3;return y(r,(t,c)=>h(t,u[3*c+0],u[3*c+1],u[3*c+2]),I?n-1:n)}const J=.99619469809,M=g(),E=g(),a=g(),U=g(),l=g();function er(r,u,I){return u!==r&&w(r,u),r[3]=-T(r,I),r}function or(r,u){return u[0]=-r[0],u[1]=-r[1],u[2]=-r[2],u[3]=-r[3],u}function cr(r,u,I,n){return X(a,u,r),z(I,a,n)}function Nr(r,u,I,n){return $(m(r,u,s(f.get(),I,u),Q,n))}function ir(r,u,I){return u!=null&&$(m(r,u.origin,u.direction,V,I))}function fr(r,u,I){return $(m(r,u.origin,u.vector,i.NONE,I))}function ar(r,u,I){return $(m(r,u.origin,u.vector,i.CLAMP,I))}function Er(r,u){return C(r,u)>=0}function sr(r,u){const I=T(r,u.ray.direction),n=-C(r,u.ray.origin);if(I>-1e-6&&I<1e-6)return n>0;const t=n/I;return I>0?t<u.c1&&(u.c1=t):t>u.c0&&(u.c0=t),u.c0<=u.c1}function Tr(r,u,I){const n=v(f.get(),r,-r[3]),t=K(r,s(f.get(),u,n),f.get());return L(I,t,n),I}function Sr(r,u,I,n){const t=r,c=f.get(),o=f.get();k(t,c,o);const e=s(f.get(),I,u),D=p(c,e),O=p(o,e),S=p(t,e);return h(n,D,O,S)}function K(r,u,I){const n=v(f.get(),r,T(r,u));return s(I,u,n),I}function Mr(r,u){return Math.abs(C(r,u))}function C(r,u){return T(r,u)+r[3]}var N;function $(r){return r===N.INTERSECTS_INSIDE_OUT||r===N.INTERSECTS_OUTSIDE_IN}function m(r,u,I,n,t){const c=T(r,I),o=C(r,u);if(c===0)return o>=0?N.INSIDE:N.OUTSIDE;let e=-o/c;return n&i.CLAMP&&(e=H(e,0,1)),!(n&i.INFINITE_MIN)&&e<0||!(n&i.INFINITE_MAX)&&e>1?o>=0?N.INSIDE:N.OUTSIDE:(L(t,u,v(t,I,e)),o>=0?N.INTERSECTS_INSIDE_OUT:N.INTERSECTS_OUTSIDE_IN)}(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE"})(N||(N={}));const _=[0,0,1,0];var i;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(i||(i={}));const Q=i.INFINITE_MIN|i.INFINITE_MAX,V=i.INFINITE_MAX;export{tr as A,Ir as D,sr as G,Tr as H,Sr as J,or as L,x as M,nr as O,cr as P,Mr as Q,d as U,C as V,k as a,ur as g,w as h,Nr as k,z as l,rr as m,G as p,ir as q,y as v,ar as w,fr as x,er as y,Er as z};
