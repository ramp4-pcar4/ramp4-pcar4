import{p as P,y as f,r as h,b as _,h as Q,o as a,U as F,m as R,T as l,F as y,d as m,x as v,E as w,A as b,g,a as S,f as o,B as E,I as $,w as M,z as T,C as A,J as B,j as C,L,M as U,v as x,s as W,O as k,V as K,S as N,k as V,q as j,D as q,G as D,H as G,K as H,N as I,P as J,Q as X,R as Y,W as Z}from"./BufferView-r56Foetm.js";import{e as c}from"./types-BKo2foNY.js";class d{constructor(t,e){this.layout=t,this.buffer=typeof e=="number"?new ArrayBuffer(e*t.stride):e;for(const s of t.fields.keys()){const i=t.fields.get(s);this[s]=new i.constructor(this.buffer,i.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(t,e){const s=this[t];return s&&s.elementCount===e.ElementCount&&s.elementType===e.ElementType?s:null}slice(t,e){return new d(this.layout,this.buffer.slice(t*this.stride,e*this.stride))}copyFrom(t,e=0,s=0,i=t.count){const r=this.stride;if(r%4==0){const u=new Uint32Array(t.buffer,e*r,i*r/4);new Uint32Array(this.buffer,s*r,i*r/4).set(u)}else{const u=new Uint8Array(t.buffer,e*r,i*r);new Uint8Array(this.buffer,s*r,i*r).set(u)}return this}get cachedMemory(){return this.byteLength}dispose(){}}class p{constructor(t){this._stride=0,this._fields=new Map,t&&(this._stride=t.stride,t.fields.forEach(e=>this._fields.set(e[0],{...e[1],constructor:et(e[1].constructor)})))}freeze(){return this}vec2f16(t,e){return this._appendField(t,h?P:f,e),this}vec2f(t,e){return this._appendField(t,f,e),this}vec2f64(t,e){return this._appendField(t,_,e),this}vec3f16(t,e){return this._appendField(t,h?Q:a,e),this}vec3f(t,e){return this._appendField(t,a,e),this}vec3f64(t,e){return this._appendField(t,F,e),this}vec4f16(t,e){return this._appendField(t,h?R:l,e),this}vec4f(t,e){return this._appendField(t,l,e),this}vec4f64(t,e){return this._appendField(t,y,e),this}mat3f(t,e){return this._appendField(t,m,e),this}mat3f64(t,e){return this._appendField(t,v,e),this}mat4f(t,e){return this._appendField(t,w,e),this}mat4f64(t,e){return this._appendField(t,b,e),this}vec4u8(t,e){return this._appendField(t,g,e),this}f16(t,e){return this._appendField(t,h?S:o,e),this}f32(t,e){return this._appendField(t,o,e),this}f64(t,e){return this._appendField(t,E,e),this}u8(t,e){return this._appendField(t,$,e),this}u16(t,e){return this._appendField(t,M,e),this}i8(t,e){return this._appendField(t,T,e),this}vec2i8(t,e){return this._appendField(t,A,e),this}vec2i16(t,e){return this._appendField(t,B,e),this}vec2u8(t,e){return this._appendField(t,C,e),this}vec2u16(t,e){return this._appendField(t,L,e),this}vec4u16(t,e){return this._appendField(t,U,e),this}u32(t,e){return this._appendField(t,x,e),this}_appendField(t,e,s){this._fields.has(t)&&W(!1,`${t} already added to vertex buffer layout`);const i=e.ElementCount*c(e.ElementType),r=this._stride;this._fields.set(t,{constructor:e,size:i,offset:r,optional:s}),this._alignFields()}_alignFields(){let t=0,e=1;this._fields.forEach(s=>{const i=c(s.constructor.ElementType);t=Math.floor((t+i-1)/i)*i,s.offset=t,t+=s.size,e=Math.max(e,i)}),t=Math.floor((t+e-1)/e)*e,this._stride=t}createBuffer(t){return new d(this,t)}createView(t){return new d(this,t)}clone(){const t=new p;return t._stride=this._stride,t._fields=new Map,this._fields.forEach((e,s)=>t._fields.set(s,e)),t.BufferType=this.BufferType,t}get stride(){return this._stride}get fields(){return this._fields}}function rt(){return new p}class nt{constructor(t){this.fields=new Array,t.fields.forEach((e,s)=>{const i={...e,constructor:z(e.constructor)};this.fields.push([s,i])}),this.stride=t.stride}}const tt=[o,f,a,l,m,w,E,_,F,y,v,b,$,C,k,g,M,L,K,U,x,N,V,j,T,A,q,D,G,B,H,I,J,X,Y,Z];function z(n){return`${n.ElementType}_${n.ElementCount}`}function et(n){return O.get(n)}const O=new Map;tt.forEach(n=>O.set(z(n),n));export{p as N,rt as O,nt as P};
