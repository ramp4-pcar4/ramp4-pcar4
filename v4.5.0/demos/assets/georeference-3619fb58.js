import { di as r$1, iA as b$3, iB as m$1, e as e$1, y as y$1, k as a$1, dA as l$1, aW as n$1, aX as r$2, iC as P$1, iD as h$1, iE as O$2, iF as Zn, iG as c$1, fA as xn, iH as C$1, bh as w$2, r as r$3, iI as F, iJ as B$3, dh as t$1, p as s$1, iK as a$2, fg as o$1, ff as S$2, iL as c$2, aV as z$1, iM as u, b1 as P$2, b2 as s, t as t$2, er as g$2, iN as B$4, iO as f, bD as $, iP as L$3, iQ as N$2 } from './main-5658cd6e.js';
import { e as e$4 } from './mat3f64-f0e5b33e.js';
import { e as e$2, o } from './mat4f64-151d6b53.js';
import { c } from './spatialReferenceEllipsoidUtils-44af14ac.js';
import { v as v$2, y, x as x$3 } from './quat-1e678ab0.js';
import { e } from './quatf64-3a66031a.js';
import { T as T$1, i } from './BufferView-280c2f14.js';
import { t, e as e$3, r as r$4, o as o$2 } from './vec33-10cb0362.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
function a(n=b$2){return [n[0],n[1],n[2],n[3]]}function k$2(n,r,t=a()){return r$1(g$1(t),n),t[3]=r,t}function v$1(r,c,f=a()){return v$2(d,g$1(r),x$2(r)),v$2(w$1,g$1(c),x$2(c)),y(d,w$1,d),U$2(f,b$3(x$3(g$1(f),d)))}function g$1(n){return n}function x$2(n){return m$1(n[3])}function U$2(n,r){return n[3]=r,n}const b$2=[0,0,1,0],d=e(),w$1=e();a();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
var T;let q$1=T=class extends l$1{constructor(r){super(r),this.origin=n$1(),this.translation=n$1(),this.rotation=a(),this.scale=r$2(1,1,1),this.geographic=!0;}get localMatrix(){const r=e$2();return v$2(B$2,g$1(this.rotation),x$2(this.rotation)),P$1(r,B$2,this.translation,this.scale),r}get localMatrixInverse(){return h$1(e$2(),this.localMatrix)}applyLocal(r,o){return O$2(o,r,this.localMatrix)}applyLocalInverse(r,o){return O$2(o,r,this.localMatrixInverse)}project(r,o$1){const t$1=new Float64Array(r.length),s=T$1.fromTypedArray(t$1),e=T$1.fromTypedArray(r);if(this.geographic){const r=c(o$1),i=e$2();return Zn(o$1,this.origin,i,r),c$1(i,i,this.localMatrix),t(s,e,i),xn(t$1,r,0,t$1,o$1,0,t$1.length/3),t$1}const{localMatrix:i,origin:a}=this;C$1(i,o)?e$3(s,e):t(s,e,i);for(let n=0;n<t$1.length;n+=3)t$1[n+0]+=a[0],t$1[n+1]+=a[1],t$1[n+2]+=a[2];return t$1}getOriginPoint(r){const[o,t,s]=this.origin;return new w$2({x:o,y:t,z:s,spatialReference:r})}equals(r){return r$3(r)&&this.geographic===r.geographic&&F(this.origin,r.origin)&&B$3(this.localMatrix,r.localMatrix)}clone(){const r={origin:t$1(this.origin),translation:t$1(this.translation),rotation:a(this.rotation),scale:t$1(this.scale),geographic:this.geographic};return new T(r)}};e$1([y$1({type:[Number],nonNullable:!0,json:{write:!0}})],q$1.prototype,"origin",void 0),e$1([y$1({type:[Number],nonNullable:!0,json:{write:!0}})],q$1.prototype,"translation",void 0),e$1([y$1({type:[Number],nonNullable:!0,json:{write:!0}})],q$1.prototype,"rotation",void 0),e$1([y$1({type:[Number],nonNullable:!0,json:{write:!0}})],q$1.prototype,"scale",void 0),e$1([y$1({type:Boolean,nonNullable:!0,json:{write:!0}})],q$1.prototype,"geographic",void 0),e$1([y$1()],q$1.prototype,"localMatrix",null),e$1([y$1()],q$1.prototype,"localMatrixInverse",null),q$1=T=e$1([a$1("esri.geometry.support.MeshTransform")],q$1);const B$2=e(),L$2=q$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
function r(r,e){return r.isGeographic||r.isWebMercator&&(e?.geographic??!0)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
const g=s$1.getLogger("esri.geometry.support.meshUtils.normalProjection");function j(r,e,o,t,n){return B$1(t)?(b$1(U$1.TO_PCPF,i.fromTypedArray(r),T$1.fromTypedArray(e),T$1.fromTypedArray(o),t,i.fromTypedArray(n)),n):(g.error("Cannot convert spatial reference to PCPF"),n)}function h(r,e,o,t,n){return B$1(t)?(b$1(U$1.FROM_PCPF,i.fromTypedArray(r),T$1.fromTypedArray(e),T$1.fromTypedArray(o),t,i.fromTypedArray(n)),n):(g.error("Cannot convert to spatial reference from PCPF"),n)}function M$1(r,e,o){return xn(r,e,0,o,c(e),0,r.length/3),o}function R(r,e,o){return xn(r,c(o),0,e,o,0,r.length/3),e}function O$1(r,o,t$1){if(t$2(r))return o;const n=T$1.fromTypedArray(r),f=T$1.fromTypedArray(o);return t(f,n,t$1),o}function v(r,n,f){if(t$2(r))return n;g$2(x$1,f);const a=i.fromTypedArray(r),s=i.fromTypedArray(n);return r$4(s,a,x$1),B$4(x$1)||o$2(s,s),n}function V$1(r,n,f){if(t$2(r))return n;g$2(x$1,f);const a=i.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),s=i.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT);if(r$4(s,a,x$1),B$4(x$1)||o$2(s,s),r!==n)for(let e=3;e<r.length;e+=4)n[e]=r[e];return n}function k$1(r,e,o,t,n){if(!B$1(t))return g.error("Cannot convert spatial reference to PCPF"),n;b$1(U$1.TO_PCPF,i.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),T$1.fromTypedArray(e),T$1.fromTypedArray(o),t,i.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT));for(let f=3;f<r.length;f+=4)n[f]=r[f];return n}function L$1(r,e,o,t,n){if(!B$1(t))return g.error("Cannot convert to spatial reference from PCPF"),n;b$1(U$1.FROM_PCPF,i.fromTypedArray(r,16),T$1.fromTypedArray(e),T$1.fromTypedArray(o),t,i.fromTypedArray(n,16));for(let f=3;f<r.length;f+=4)n[f]=r[f];return n}function b$1(r,e,o,t,a,s){if(!e)return;const i=o.count,y=c(a);if(S$1(a))for(let m=0;m<i;m++)t.getVec(m,Y$1),e.getVec(m,w),Zn(y,Y$1,W,y),a$2(x$1,W),r===U$1.FROM_PCPF&&o$1(x$1,x$1),S$2(w,w,x$1),s.setVec(m,w);else for(let u=0;u<i;u++){t.getVec(u,Y$1),e.getVec(u,w),Zn(y,Y$1,W,y),a$2(x$1,W);const a=c$2(o.get(u,1));let i=Math.cos(a);r===U$1.TO_PCPF&&(i=1/i),x$1[0]*=i,x$1[1]*=i,x$1[2]*=i,x$1[3]*=i,x$1[4]*=i,x$1[5]*=i,r===U$1.FROM_PCPF&&o$1(x$1,x$1),S$2(w,w,x$1),z$1(w,w),s.setVec(u,w);}return s}function B$1(r){return S$1(r)||N$1(r)}function S$1(r){return r.isWGS84||u(r)||P$2(r)||s(r)}function N$1(r){return r.isWebMercator}var U$1;!function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF";}(U$1||(U$1={}));const Y$1=n$1(),w=n$1(),W=e$2(),x$1=e$4();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
function x(n,r$1,t){return r(r$1.spatialReference,t)?B(n,r$1,t):P(n,r$1,t)}function k(t,o,e){const{position:a,normal:i,tangent:l}=t;if(t$2(o))return {position:a,normal:i,tangent:l};const s=o.localMatrix;return x({position:O$1(a,new Float64Array(a.length),s),normal:r$3(i)?v(i,new Float32Array(i.length),s):null,tangent:r$3(l)?V$1(l,new Float32Array(l.length),s):null},o.getOriginPoint(e),{geographic:o.geographic})}function _(n,r$1,t){if(t?.useTransform){const{position:o,normal:e,tangent:a}=n;return {vertexAttributes:{position:o,normal:e,tangent:a},transform:new L$2({origin:[r$1.x,r$1.y,r$1.z??0],geographic:r(r$1.spatialReference,t)})}}return {vertexAttributes:x(n,r$1,t),transform:null}}function b(n,r$1,t){return r(r$1.spatialReference,t)?Y(n,r$1,t):U(n,r$1,t)}function M(r,t,o,e){if(t$2(t))return b(r,o,e);const a=k(r,t,o.spatialReference);return o.equals(t.getOriginPoint(o.spatialReference))?U(a,o,e):b(a,o,e)}function P(n,r,t){const o=new Float64Array(n.position.length),e=n.position,a=r.x,i=r.y,l=r.z||0,{horizontal:s,vertical:f}=C(t?t.unit:null,r.spatialReference);for(let c=0;c<e.length;c+=3)o[c+0]=e[c+0]*s+a,o[c+1]=e[c+1]*s+i,o[c+2]=e[c+2]*f+l;return {position:o,normal:n.normal,tangent:n.tangent}}function B(n,r,t){const o=r.spatialReference,e=G(r,t,D),a=new Float64Array(n.position.length),i=L(n.position,e,o,a),l=g$2(I,e);return {position:i,normal:N(i,a,n.normal,l,o),tangent:S(i,a,n.tangent,l,o)}}function L(n,r,t$1,o){t(T$1.fromTypedArray(o),T$1.fromTypedArray(n),r);const e=new Float64Array(n.length);return R(o,e,t$1)}function N(r,t,o,e,a){if(t$2(o))return null;const i$1=new Float32Array(o.length);return r$4(i.fromTypedArray(i$1),i.fromTypedArray(o),e),h(i$1,r,t,a,i$1),i$1}function S(r,t,o,e,a){if(t$2(o))return null;const i$1=new Float32Array(o.length);r$4(i.fromTypedArray(i$1,4*Float32Array.BYTES_PER_ELEMENT),i.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT),e);for(let n=3;n<i$1.length;n+=4)i$1[n]=o[n];return L$1(i$1,r,t,a,i$1),i$1}function U(n,r,t){const o=new Float64Array(n.position.length),e=n.position,a=r.x,i=r.y,l=r.z||0,{horizontal:s,vertical:f}=C(t?t.unit:null,r.spatialReference);for(let c=0;c<e.length;c+=3)o[c+0]=(e[c+0]-a)/s,o[c+1]=(e[c+1]-i)/s,o[c+2]=(e[c+2]-l)/f;return {position:o,normal:n.normal,tangent:n.tangent}}function Y(n,r,t){const o=r.spatialReference;G(r,t,D);const e=h$1(H,D),a=new Float64Array(n.position.length),l=O(n.position,o,e,a),s=g$2(I,e);return {position:l,normal:q(n.normal,n.position,a,o,s),tangent:V(n.tangent,n.position,a,o,s)}}function G(n,r,t){Zn(n.spatialReference,[n.x,n.y,n.z||0],t,c(n.spatialReference));const{horizontal:o,vertical:e}=C(r?r.unit:null,n.spatialReference);return f(t,t,[o,o,e]),t}function O(n,r,t$1,o){const e=M$1(n,r,o),a=T$1.fromTypedArray(e),i=new Float64Array(e.length),l=T$1.fromTypedArray(i);return t(l,a,t$1),i}function q(r,t,o,e,a){if(t$2(r))return null;const i$1=j(r,t,o,e,new Float32Array(r.length)),l=i.fromTypedArray(i$1);return r$4(l,l,a),i$1}function V(r,t,o,e,a){if(t$2(r))return null;const i$1=k$1(r,t,o,e,new Float32Array(r.length)),l=i.fromTypedArray(i$1,4*Float32Array.BYTES_PER_ELEMENT);return r$4(l,l,a),i$1}function C(r,a){if(t$2(r))return J;const i=a.isGeographic?1:$(a),l=a.isGeographic?1:L$3(a),s=N$2(1,r,"meters");return {horizontal:s*i,vertical:s*l}}const D=e$2(),H=e$2(),I=e$4(),J={horizontal:1,vertical:1};

export { L$2 as L, M, R, _, M$1 as a, b, k$1 as c, L$1 as d, a as e, x$2 as f, g$1 as g, h, k$2 as i, j, k, r, v$1 as v, x };
