import { ft as p$1, ab as R, bh as w$1, b as e$1, cw as i, f as f$1, eW as u, fu as y$1, fv as m } from './main-5658cd6e.js';
import { O } from './quantizationUtils-ec270d9a.js';
import { c as c$1, D, m as m$1, f, d as d$1, T, y as y$2, x, z as z$1, S, M } from './utils-fe8b3668.js';
import './preload-helper-a4975f27.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
let y=null;function $(e,t,n){return e.x<0?e.x+=t:e.x>n&&(e.x-=t),e}function I(e,n,r,i){const a=p$1(r)?R(r):null,u=a?Math.round((a.valid[1]-a.valid[0])/n.scale[0]):null;return e.map((e=>{const r=new w$1(e$1(e.geometry));return O(n,r,r,r.hasZ,r.hasM),e.geometry=a?$(r,u,i[0]):r,e}))}function g(e,t=18,n,i,o,s){const l=new Float64Array(o*s);t=Math.round(u(t));let a=Number.POSITIVE_INFINITY,u$1=Number.NEGATIVE_INFINITY,m$1=0,d=0,p=0,h=0;const y=y$1(i,n);for(const{geometry:r,attributes:c}of e){const{x:e,y:n}=r,i=Math.max(0,e-t),$=Math.max(0,n-t),I=Math.min(s,n+t),g=Math.min(o,e+t),j=+y(c);for(let r=$;r<I;r++)for(let s=i;s<g;s++){const i=r*o+s,c=m(s-e,r-n,t),y=l[i];m$1=l[i]+=c*j;const $=m$1-y;d+=$,p+=$*$,m$1<a&&(a=m$1),m$1>u$1&&(u$1=m$1),h++;}}if(!h)return {mean:0,stddev:0,min:0,max:0,mid:0,count:0};const $=(u$1-a)/2;return {mean:d/h,stdDev:Math.sqrt((p-d*d/h)/h),min:a,max:u$1,mid:$,count:h}}async function j(e,t){if(!t)return [];const{field:n,field2:r,field3:o,fieldDelimiter:s}=e,l=e.valueExpression,a=e.normalizationType,u=e.normalizationField,f=e.normalizationTotal,c=[],h=e.viewInfoParams;let $=null,I=null;if(l){if(!y){const{arcadeUtils:e}=await i();y=e;}$=y.createFunction(l),I=h&&y.getViewInfo({viewingMode:h.viewingMode,scale:h.scale,spatialReference:new f$1(h.spatialReference)});}const g=e.fieldInfos,j=!(t[0]&&"declaredClass"in t[0]&&"esri.Graphic"===t[0].declaredClass)&&g?{fields:g}:null;return t.forEach((e=>{const t=e.attributes;let i;if(l){const t=j?{...e,layer:j}:e,n=y.createExecContext(t,I);i=y.executeFunction($,n);}else t&&(i=t[n],r&&(i=`${c$1(i)}${s}${c$1(t[r])}`,o&&(i=`${i}${s}${c$1(t[o])}`)));if(a&&"number"==typeof i&&isFinite(i)){const e=t&&parseFloat(t[u]);i=D(i,a,e,f);}c.push(i);})),c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
async function d(i){const{attribute:e,features:s}=i,{normalizationType:r,normalizationField:m,minValue:f$1,maxValue:u,fieldType:d}=e,p=await j({field:e.field,valueExpression:e.valueExpression,normalizationType:r,normalizationField:m,normalizationTotal:e.normalizationTotal,viewInfoParams:e.viewInfoParams,fieldInfos:e.fieldInfos},s),v=m$1({normalizationType:r,normalizationField:m,minValue:f$1,maxValue:u}),c={value:.5,fieldType:d},z="esriFieldTypeString"===d?f({values:p,supportsNullCount:v,percentileParams:c}):d$1({values:p,minValue:f$1,maxValue:u,useSampleStdDev:!r,supportsNullCount:v,percentileParams:c});return T(z,"esriFieldTypeDate"===d)}async function p(i){const{attribute:e,features:n}=i,l=await j({field:e.field,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,valueExpression:e.valueExpression,viewInfoParams:e.viewInfoParams,fieldInfos:e.fieldInfos},n),t=y$2(l);return x(t,e.domains,e.returnAllCodedValues,e.fieldDelimiter)}async function v(i){const{attribute:e,features:n}=i,{field:l,normalizationType:t,normalizationField:o,normalizationTotal:s,classificationMethod:r}=e,u=await j({field:l,valueExpression:e.valueExpression,normalizationType:t,normalizationField:o,normalizationTotal:s,viewInfoParams:e.viewInfoParams,fieldInfos:e.fieldInfos},n),d=z$1(u,{field:l,normalizationType:t,normalizationField:o,normalizationTotal:s,classificationMethod:r,standardDeviationInterval:e.standardDeviationInterval,numClasses:e.numClasses,minValue:e.minValue,maxValue:e.maxValue});return S(d,r)}async function c(i){const{attribute:e,features:n}=i,{field:l,normalizationType:t,normalizationField:o,normalizationTotal:s,classificationMethod:r}=e,m=await j({field:l,valueExpression:e.valueExpression,normalizationType:t,normalizationField:o,normalizationTotal:s,viewInfoParams:e.viewInfoParams,fieldInfos:e.fieldInfos},n);return M(m,{field:l,normalizationType:t,normalizationField:o,normalizationTotal:s,classificationMethod:r,standardDeviationInterval:e.standardDeviationInterval,numBins:e.numBins,minValue:e.minValue,maxValue:e.maxValue})}async function z(a){const{attribute:n,features:l}=a,{field:t,radius:o,fieldOffset:s,transform:r,spatialReference:m,size:f}=n,u=I(l,r,m,f),{count:d,min:p,max:v,mean:c,stdDev:z}=g(u,o,s,t,f[0],f[1]);return {count:d,min:p,max:v,avg:c,stddev:z}}

export { v as classBreaks, z as heatmapStatistics, c as histogram, d as summaryStatistics, p as uniqueValues };
