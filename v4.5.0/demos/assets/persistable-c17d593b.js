import { _ as __vitePreload } from './preload-helper-a4975f27.js';
import { i } from './multiOriginJSONSupportUtils-c87c995a.js';
import { e2 as d, e3 as c, e4 as p, e5 as m, e6 as R, e7 as t, e8 as Y, e9 as U$1, ea as Z, eb as d$1, ec as n, V, aF as Jt, ed as x$1 } from './main-5658cd6e.js';
import { t as t$1 } from './resourceExtension-23790ddb.js';

function g(t){const r=t?.origins??[void 0];return (e,o)=>{const s=h(t,e,o);for(const t of r){const r=d(e,t,o);for(const t in s)r[t]=s[t];}}}function h(t,r,e){if("resource"===t?.type)return v(t,r,e);switch(t?.type??"other"){case"other":return {read:!0,write:!0};case"url":{const{read:t,write:r}=x$1;return {read:t,write:r}}}}function v(o,s,n){const p$1=c(s,n);return {type:String,read:(t,r,e)=>{const o=p(t,r,e);return p$1.type===String?o:"function"==typeof p$1.type?new p$1.type({url:o}):void 0},write:{writer(s,i$1,u,c){if(!c||!c.resources)return "string"==typeof s?void(i$1[u]=m(s,c)):void(i$1[u]=s.write({},c));const y=x(s),d=m(y,{...c,verifyItemRelativeUrls:c&&c.verifyItemRelativeUrls?{writtenUrls:c.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},R.NO),g=p$1.type!==String&&(!i(this)||c&&c.origin&&this.originIdOf(n)>t(c.origin)),h={object:this,propertyName:n,value:s,targetUrl:d,dest:i$1,targetPropertyName:u,context:c,params:o};c&&c.portalItem&&d&&!Y(d)?g?w(h):j(h):c&&c.portalItem&&(null==d||null!=U$1(d)||Z(d)||g)?U(h):i$1[u]=d;}}}}function U(t){const{targetUrl:r,params:s,value:i,context:a,dest:p,targetPropertyName:c}=t;if(!a.portalItem)return;const l=d$1(r),m=l?.filename??n(),f=s?.prefix??l?.prefix,d=N(i,r,a),g=V(f,m),h=`${g}.${t$1(d)}`,v=a.portalItem.resourceFromPath(h);Z(r)&&a.resources&&a.resources.pendingOperations.push(P(r).then((t=>{v.path=`${g}.${t$1(t)}`,p[c]=v.itemRelativeUrl;})).catch((()=>{})));const U=s?.compress??!1;a.resources&&I({...t,resource:v,content:d,compress:U,updates:a.resources.toAdd}),p[c]=v.itemRelativeUrl;}function w(t){const{context:r,targetUrl:e,params:o,value:n,dest:i,targetPropertyName:a}=t;if(!r.portalItem)return;const p=r.portalItem.resourceFromPath(e),c=N(n,e,r),l=t$1(c),m=Jt(p.path),f=o?.compress??!1;l===m?(r.resources&&I({...t,resource:p,content:c,compress:f,updates:r.resources.toUpdate}),i[a]=e):U(t);}function j({context:t,targetUrl:r,dest:e,targetPropertyName:o}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(r),compress:!1}),e[o]=r);}function I({object:t,propertyName:r,updates:e,resource:o,content:s,compress:n}){e.push({resource:o,content:s,compress:n,finish:e=>{O(t,r,e);}});}function N(t,r,e){return "string"==typeof t?{url:r}:new Blob([JSON.stringify(t.toJSON(e))],{type:"application/json"})}async function P(t){const r=(await __vitePreload(() => import('./main-5658cd6e.js').then(n => n.oI),true?["./main-5658cd6e.js","./preload-helper-a4975f27.js","./main-2af48127.css"]:void 0,import.meta.url)).default,{data:e}=await r(t,{responseType:"blob"});return e}function x(t){return null==t?null:"string"==typeof t?t:t.url}function O(t,r,e){"string"==typeof t[r]?t[r]=e.url:t[r].url=e.url;}

export { g };
