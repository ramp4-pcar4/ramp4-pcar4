import { eu as p$1, w, bj as m$1, bh as w$2, bi as v, bk as u, v as v$2, ev as a$1, bD as $ } from './main-5658cd6e.js';
import { u as be, B, U, r as re, J, V, d as ce, w as c, G, x as r, y as Z, S as Se, E as a, H as Ne, I as Te, l as le, K as fe, M as l, O as u$1, P as t$1, b as T, Q as Ze, W as s$1, X as e$1 } from './arcadeUtils-3774d10c.js';
import { A, h, S, m, x, p, O, g, R, D, b, E, k, y, w as w$1, W, K, F, M, d, C, U as U$1, B as B$1, L, P, v as v$1, H, N, J as J$1, j } from './geometryEngineAsync-fc9d31c2.js';
import { t, e } from './executionError-ed2c63c0.js';
import { t as t$2, s } from './portalUtils-6edc6c88.js';
import './preload-helper-a4975f27.js';
import './arcadeTimeUtils-53abd942.js';
import './number-88191db7.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
function wn(t){return 0===a$1.indexOf("4.")?v.fromExtent(t):new v({spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]})}function hn(n,t$1,e$1){if(B(n,2,2,t$1,e$1),n[0]instanceof p$1&&n[1]instanceof p$1);else if(n[0]instanceof p$1&&null===n[1]);else if(n[1]instanceof p$1&&null===n[0]);else if(null!==n[0]||null!==n[1])throw new t(t$1,e.InvalidParameter,e$1)}async function yn(n,t){if("polygon"!==n.type&&"polyline"!==n.type&&"extent"!==n.type)return 0;let e=1;if(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid){e=s$1(n.spatialReference)/$(n.spatialReference);}let r=0;if("polyline"===n.type)for(const a of n.paths)for(let n=1;n<a.length;n++)r+=e$1(a[n],a[n-1],e);else if("polygon"===n.type)for(const a of n.rings){for(let n=1;n<a.length;n++)r+=e$1(a[n],a[n-1],e);(a[0][0]!==a[a.length-1][0]||a[0][1]!==a[a.length-1][1]||void 0!==a[0][2]&&a[0][2]!==a[a.length-1][2])&&(r+=e$1(a[0],a[a.length-1],e));}else "extent"===n.type&&(r+=2*e$1([n.xmin,n.ymin,0],[n.xmax,n.ymin,0],e),r+=2*e$1([n.xmin,n.ymin,0],[n.xmin,n.ymax,0],e),r*=2,r+=4*Math.abs(Z(n.zmax,0)*e-Z(n.zmin,0)*e));const i=new m$1({hasZ:!1,hasM:!1,spatialReference:n.spatialReference,paths:[[0,0],[0,r]]});return F(i,t)}function pn(n){"async"===n.mode&&(n.functions.disjoint=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(hn(a=be(a),t,e),null===a[0]||null===a[1]||A(a[0],a[1]))))},n.functions.intersects=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(hn(a=be(a),t,e),null!==a[0]&&null!==a[1]&&h(a[0],a[1]))))},n.functions.touches=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(hn(a=be(a),t,e),null!==a[0]&&null!==a[1]&&S(a[0],a[1]))))},n.functions.crosses=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(hn(a=be(a),t,e),null!==a[0]&&null!==a[1]&&m(a[0],a[1]))))},n.functions.within=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(hn(a=be(a),t,e),null!==a[0]&&null!==a[1]&&x(a[0],a[1]))))},n.functions.contains=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(hn(a=be(a),t,e),null!==a[0]&&null!==a[1]&&p(a[0],a[1]))))},n.functions.overlaps=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(hn(a=be(a),t,e),null!==a[0]&&null!==a[1]&&O(a[0],a[1]))))},n.functions.equals=function(t,e){return n.standardFunctionAsync(t,e,((n,r,i)=>(B(i,2,2,t,e),i[0]===i[1]||(i[0]instanceof p$1&&i[1]instanceof p$1?g(i[0],i[1]):!(!U(i[0])||!U(i[1]))&&i[0].equals(i[1])))))},n.functions.relate=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=be(o),B(o,3,3,t$1,e$1),o[0]instanceof p$1&&o[1]instanceof p$1)return R(o[0],o[1],re(o[2]));if(o[0]instanceof p$1&&null===o[1])return !1;if(o[1]instanceof p$1&&null===o[0])return !1;if(null===o[0]&&null===o[1])return !1;throw new t(t$1,e.InvalidParameter,e$1)}))},n.functions.intersection=function(t,e){return n.standardFunctionAsync(t,e,((n,r,a)=>(hn(a=be(a),t,e),null===a[0]||null===a[1]?null:D(a[0],a[1]))))},n.functions.union=function(e$1,r){return n.standardFunctionAsync(e$1,r,((n,a,o)=>{const s=[];if(0===(o=be(o)).length)throw new t(e$1,e.WrongNumberOfParameters,r);if(1===o.length)if(J(o[0])){const n=be(o[0]);for(let t$1=0;t$1<n.length;t$1++)if(null!==n[t$1]){if(!(n[t$1]instanceof p$1))throw new t(e$1,e.InvalidParameter,r);s.push(n[t$1]);}}else {if(!V(o[0])){if(o[0]instanceof p$1)return ce(c(o[0]),e$1.spatialReference);if(null===o[0])return null;throw new t(e$1,e.InvalidParameter,r)}{const n=be(o[0].toArray());for(let t$1=0;t$1<n.length;t$1++)if(null!==n[t$1]){if(!(n[t$1]instanceof p$1))throw new t(e$1,e.InvalidParameter,r);s.push(n[t$1]);}}}else for(let t$1=0;t$1<o.length;t$1++)if(null!==o[t$1]){if(!(o[t$1]instanceof p$1))throw new t(e$1,e.InvalidParameter,r);s.push(o[t$1]);}return 0===s.length?null:b(s)}))},n.functions.difference=function(e,r){return n.standardFunctionAsync(e,r,((n,a,o)=>(hn(o=be(o),e,r),null!==o[0]&&null===o[1]?c(o[0]):null===o[0]?null:E(o[0],o[1]))))},n.functions.symmetricdifference=function(e,r){return n.standardFunctionAsync(e,r,((n,a,o)=>(hn(o=be(o),e,r),null===o[0]&&null===o[1]?null:null===o[0]?c(o[1]):null===o[1]?c(o[0]):k(o[0],o[1]))))},n.functions.clip=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=be(o),B(o,2,2,t$1,e$1),!(o[1]instanceof w)&&null!==o[1])throw new t(t$1,e.InvalidParameter,e$1);if(null===o[0])return null;if(!(o[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);return null===o[1]?null:y(o[0],o[1])}))},n.functions.cut=function(e$1,r){return n.standardFunctionAsync(e$1,r,((n,o,s)=>{if(s=be(s),B(s,2,2,e$1,r),!(s[1]instanceof m$1)&&null!==s[1])throw new t(e$1,e.InvalidParameter,r);if(null===s[0])return [];if(!(s[0]instanceof p$1))throw new t(e$1,e.InvalidParameter,r);return null===s[1]?[c(s[0])]:w$1(s[0],s[1])}))},n.functions.area=function(t$1,r$1){return n.standardFunctionAsync(t$1,r$1,(async(n,o,s)=>{if(B(s,1,2,t$1,r$1),null===(s=be(s))[0])return 0;if(G(s[0])){const n=await s[0].sumArea(r(Z(s[1],-1)),!1,t$1.abortSignal);if(t$1.abortSignal.aborted)throw new t(t$1,e.Cancelled,r$1);return n}if(J(s[0])||V(s[0])){const n=Se(s[0],t$1.spatialReference);return null===n?0:W(n,r(Z(s[1],-1)))}if(!(s[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,r$1);return W(s[0],r(Z(s[1],-1)))}))},n.functions.areageodetic=function(t$1,r$1){return n.standardFunctionAsync(t$1,r$1,(async(n,o,s)=>{if(B(s,1,2,t$1,r$1),null===(s=be(s))[0])return 0;if(G(s[0])){const n=await s[0].sumArea(r(Z(s[1],-1)),!0,t$1.abortSignal);if(t$1.abortSignal.aborted)throw new t(t$1,e.Cancelled,r$1);return n}if(J(s[0])||V(s[0])){const n=Se(s[0],t$1.spatialReference);return null===n?0:K(n,r(Z(s[1],-1)))}if(!(s[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,r$1);return K(s[0],r(Z(s[1],-1)))}))},n.functions.length=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,(async(n,o,s)=>{if(B(s,1,2,t$1,e$1),null===(s=be(s))[0])return 0;if(G(s[0])){const n=await s[0].sumLength(a(Z(s[1],-1)),!1,t$1.abortSignal);if(t$1.abortSignal.aborted)throw new t(t$1,e.Cancelled,e$1);return n}if(J(s[0])||V(s[0])){const n=Ne(s[0],t$1.spatialReference);return null===n?0:F(n,a(Z(s[1],-1)))}if(!(s[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);return F(s[0],a(Z(s[1],-1)))}))},n.functions.length3d=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,s)=>{if(B(s,1,2,t$1,e$1),null===(s=be(s))[0])return 0;if(J(s[0])||V(s[0])){const n=Ne(s[0],t$1.spatialReference);return null===n?0:!0===n.hasZ?yn(n,a(Z(s[1],-1))):F(n,a(Z(s[1],-1)))}if(!(s[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);return !0===s[0].hasZ?yn(s[0],a(Z(s[1],-1))):F(s[0],a(Z(s[1],-1)))}))},n.functions.lengthgeodetic=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,(async(n,o,s)=>{if(B(s,1,2,t$1,e$1),null===(s=be(s))[0])return 0;if(G(s[0])){const n=await s[0].sumLength(a(Z(s[1],-1)),!0,t$1.abortSignal);if(t$1.abortSignal.aborted)throw new t(t$1,e.Cancelled,e$1);return n}if(J(s[0])||V(s[0])){const n=Ne(s[0],t$1.spatialReference);return null===n?0:M(n,a(Z(s[1],-1)))}if(!(s[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);return M(s[0],a(Z(s[1],-1)))}))},n.functions.distance=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,s)=>{s=be(s),B(s,2,3,t$1,e$1);let c=s[0];(J(s[0])||V(s[0]))&&(c=Te(s[0],t$1.spatialReference));let f=s[1];if((J(s[1])||V(s[1]))&&(f=Te(s[1],t$1.spatialReference)),!(c instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);if(!(f instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);return d(c,f,a(Z(s[2],-1)))}))},n.functions.distancegeodetic=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,s)=>{s=be(s),B(s,2,3,t$1,e$1);const l=s[0],u=s[1];if(!(l instanceof w$2))throw new t(t$1,e.InvalidParameter,e$1);if(!(u instanceof w$2))throw new t(t$1,e.InvalidParameter,e$1);const c=new m$1({paths:[],spatialReference:l.spatialReference});return c.addPath([l,u]),M(c,a(Z(s[2],-1)))}))},n.functions.densify=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,s)=>{if(s=be(s),B(s,2,3,t$1,e$1),null===s[0])return null;if(!(s[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);const l=le(s[1]);if(isNaN(l))throw new t(t$1,e.InvalidParameter,e$1);if(l<=0)throw new t(t$1,e.InvalidParameter,e$1);return s[0]instanceof v||s[0]instanceof m$1?C(s[0],l,a(Z(s[2],-1))):s[0]instanceof w?C(wn(s[0]),l,a(Z(s[2],-1))):s[0]}))},n.functions.densifygeodetic=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,s)=>{if(s=be(s),B(s,2,3,t$1,e$1),null===s[0])return null;if(!(s[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);const l=le(s[1]);if(isNaN(l))throw new t(t$1,e.InvalidParameter,e$1);if(l<=0)throw new t(t$1,e.InvalidParameter,e$1);return s[0]instanceof v||s[0]instanceof m$1?U$1(s[0],l,a(Z(s[2],-1))):s[0]instanceof w?U$1(wn(s[0]),l,a(Z(s[2],-1))):s[0]}))},n.functions.generalize=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,s)=>{if(s=be(s),B(s,2,4,t$1,e$1),null===s[0])return null;if(!(s[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);const l=le(s[1]);if(isNaN(l))throw new t(t$1,e.InvalidParameter,e$1);return B$1(s[0],l,fe(Z(s[2],!0)),a(Z(s[3],-1)))}))},n.functions.buffer=function(e$1,o){return n.standardFunctionAsync(e$1,o,((n,s,l)=>{if(l=be(l),B(l,2,3,e$1,o),null===l[0])return null;if(!(l[0]instanceof p$1))throw new t(e$1,e.InvalidParameter,o);const u=le(l[1]);if(isNaN(u))throw new t(e$1,e.InvalidParameter,o);return 0===u?c(l[0]):L(l[0],u,a(Z(l[2],-1)))}))},n.functions.buffergeodetic=function(e$1,o){return n.standardFunctionAsync(e$1,o,((n,s,l)=>{if(l=be(l),B(l,2,3,e$1,o),null===l[0])return null;if(!(l[0]instanceof p$1))throw new t(e$1,e.InvalidParameter,o);const u=le(l[1]);if(isNaN(u))throw new t(e$1,e.InvalidParameter,o);return 0===u?c(l[0]):P(l[0],u,a(Z(l[2],-1)))}))},n.functions.offset=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,o,l)=>{if(l=be(l),B(l,2,6,t$1,e$1),null===l[0])return null;if(!(l[0]instanceof v||l[0]instanceof m$1))throw new t(t$1,e.InvalidParameter,e$1);const u=le(l[1]);if(isNaN(u))throw new t(t$1,e.InvalidParameter,e$1);const c=le(Z(l[4],10));if(isNaN(c))throw new t(t$1,e.InvalidParameter,e$1);const f=le(Z(l[5],0));if(isNaN(f))throw new t(t$1,e.InvalidParameter,e$1);return v$1(l[0],u,a(Z(l[2],-1)),re(Z(l[3],"round")).toLowerCase(),c,f)}))},n.functions.rotate=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{o=be(o),B(o,2,3,t$1,e$1);let s=o[0];if(null===s)return null;if(!(s instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);s instanceof w&&(s=v.fromExtent(s));const l=le(o[1]);if(isNaN(l))throw new t(t$1,e.InvalidParameter,e$1);const u=Z(o[2],null);if(null===u)return H(s,l);if(u instanceof w$2)return H(s,l,u);throw new t(t$1,e.InvalidParameter,e$1)}))},n.functions.centroid=function(e$1,r){return n.standardFunctionAsync(e$1,r,((n,o,s)=>{if(s=be(s),B(s,1,1,e$1,r),null===s[0])return null;let f=s[0];if((J(s[0])||V(s[0]))&&(f=Te(s[0],e$1.spatialReference)),null===f)return null;if(!(f instanceof p$1))throw new t(e$1,e.InvalidParameter,r);return f instanceof w$2?ce(c(s[0]),e$1.spatialReference):f instanceof v?f.centroid:f instanceof m$1?l(f):f instanceof u?u$1(f):f instanceof w?f.center:null}))},n.functions.multiparttosinglepart=function(e$1,r){return n.standardFunctionAsync(e$1,r,(async(n,o,s)=>{s=be(s),B(s,1,1,e$1,r);const l=[];if(null===s[0])return null;if(!(s[0]instanceof p$1))throw new t(e$1,e.InvalidParameter,r);if(s[0]instanceof w$2)return [ce(c(s[0]),e$1.spatialReference)];if(s[0]instanceof w)return [ce(c(s[0]),e$1.spatialReference)];const u$1=await N(s[0]);if(u$1 instanceof v){const n=[],t=[];for(let e=0;e<u$1.rings.length;e++)if(u$1.isClockwise(u$1.rings[e])){const t=v$2({rings:[u$1.rings[e]],hasZ:!0===u$1.hasZ,hazM:!0===u$1.hasM,spatialReference:u$1.spatialReference.toJSON()});n.push(t);}else t.push({ring:u$1.rings[e],pt:u$1.getPoint(e,0)});for(let e=0;e<t.length;e++)for(let r=0;r<n.length;r++)if(n[r].contains(t[e].pt)){n[r].addRing(t[e].ring);break}return n}if(u$1 instanceof m$1){const n=[];for(let t=0;t<u$1.paths.length;t++){const e=v$2({paths:[u$1.paths[t]],hasZ:!0===u$1.hasZ,hazM:!0===u$1.hasM,spatialReference:u$1.spatialReference.toJSON()});n.push(e);}return n}if(s[0]instanceof u){const n=ce(c(s[0]),e$1.spatialReference);for(let t=0;t<n.points.length;t++)l.push(n.getPoint(t));return l}return null}))},n.functions.issimple=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=be(o),B(o,1,1,t$1,e$1),null===o[0])return !0;if(!(o[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);return J$1(o[0])}))},n.functions.simplify=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=be(o),B(o,1,1,t$1,e$1),null===o[0])return null;if(!(o[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);return N(o[0])}))},n.functions.convexhull=function(t$1,e$1){return n.standardFunctionAsync(t$1,e$1,((n,r,o)=>{if(o=be(o),B(o,1,1,t$1,e$1),null===o[0])return null;if(!(o[0]instanceof p$1))throw new t(t$1,e.InvalidParameter,e$1);return j(o[0])}))},n.functions.getuser=function(t$3,e$1){return n.standardFunctionAsync(t$3,e$1,(async(n,r,i)=>{B(i,0,2,t$3,e$1);let o=Z(i[1],""),l=!0===o;if(o=!0===o||!1===o?"":re(o),0===i.length||i[0]instanceof t$1){let n=null;t$3.services&&t$3.services.portal&&(n=t$3.services.portal),i.length>0&&(n=t$2(i[0],n));const e=await s(n,o,l);if(e){const n=JSON.parse(JSON.stringify(e));for(const t of ["lastLogin","created","modified"])void 0!==n[t]&&null!==n[t]&&(n[t]=new Date(n[t]));return T.convertObjectToArcadeDictionary(n,Ze(t$3))}return null}let u=null;if(G(i[0])&&(u=i[0]),u){if(l=!1,o)return null;await u.load();const n=await u.getOwningSystemUrl();if(!n){if(!o){const n=await u.getIdentityUser();return n?T.convertObjectToArcadeDictionary({username:n},Ze(t$3)):null}return null}let e=null;t$3.services&&t$3.services.portal&&(e=t$3.services.portal),e=t$2(new t$1(n),e);const r=await s(e,o,l);if(r){const n=JSON.parse(JSON.stringify(r));for(const t of ["lastLogin","created","modified"])void 0!==n[t]&&null!==n[t]&&(n[t]=new Date(n[t]));return T.convertObjectToArcadeDictionary(n,Ze(t$3))}return null}throw new t(t$3,e.InvalidParameter,e$1)}))});}

export { pn as registerFunctions };
