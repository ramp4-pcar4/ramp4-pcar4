import{d_ as hi,V as fi,_ as d,Y as p,Z as di,i as pi,of as vs,e7 as gs,cU as K,dn as _s,aJ as lr,aB as g,gA as mi,gy as Ci,lb as ys,hh as Ae,C as xs,cZ as $s,s as yt,aK as rt,l4 as te,og as bs,oh as ws,de as Ss,oi as Ms,c$ as X,oj as Ts,cV as cr,eE as Pi,am as Cs,hP as et,g4 as Ps,cc as zs,nV as nt,ok as tt,gs as As,eX as vi,ol as Os,e2 as Ve,ja as Es,o4 as Is,gR as Rs,om as Fs,d6 as zi,md as Ds,d7 as Fe,e3 as ei,cj as ur,ck as oe,aI as ti,gY as hr,hu as Et,hT as Ls,D as Vs,e$ as ks,aA as fr,aw as Ns,ff as Bs,hX as ii,d$ as Ai}from"./main-CtmwM019.js";import{Y as Vt,D as kt,C as Nt,U as Hs,_ as js,A as Us,R as dr}from"./enums-DQOO6RKE.js";import{A as qs,a as ri}from"./Texture-QG2FbAaW.js";import{I as St,v as Ws,o as k,u as ae,g as W,W as Gs,E as ge,R as ve,s as U,_ as fe,A as Te,r as Y,q as we,c as Se,p as pr,H as Oe,P as ue,Z as Oi,X as si,K as mr,y as vr}from"./vec32-gK3TWme0.js";import{e as Xs,A as Ys}from"./Indices-X2rQqBWt.js";import{l as Ks,s as B,g as gr,h as Zs,o as xt,m as Js,T as Ei,f as Ii,J as Ri,p as Qs,y as en}from"./BufferView-CESi4vtr.js";import{S as tn}from"./triangle-InVEiR1q.js";import{c as rn,e as sn,l as _r,r as nn,T as an,d as on}from"./renderState-CKc66y4x.js";import{h as $t,s as ni,n as qe,c as Mt,H as yr,G as xr,i as Tt,r as ln,f as cn,o as un,x as hn,l as $r,m as fn,A as dn,C as pn,X as mn,R as vn,p as gn,b as _n}from"./mat4-Ba1tXzxc.js";import{t as v,n as se}from"./glsl-B5bJgrnA.js";import{s as Ct,a as He,m as Fi,L as Di,E as Bt,x as Li,z as at,p as yn}from"./vec42-DZ0sp4MX.js";import{n as Re,i as xn,r as Vi}from"./vec4f64-DPb6J-GU.js";import{m as ki}from"./lengthUtils-CPuXsfCi.js";import"./projectBuffer-C2_ZDxbj.js";import"./projectionUtils-DKBF6_Ma.js";import{n as Ni}from"./projectVectorToVector-PMDI3BQJ.js";import{r as br,n as gi,t as Bi}from"./vec2f64-Cgb6qxNH.js";import{h as wr,x as $n,y as Sr,k as bn,S as wn,w as Sn,O as Mn,d as Tn,q as Cn,A as Pn}from"./frustum-DgTrRaDo.js";import{P as It,I as Mr,V as Tr,b as Cr,k as Pr,e as zn,d as An}from"./sphere-DCy-S0e6.js";import{f as On}from"./vectorStacks-Du2BB1wg.js";import{G as En,K as In}from"./orientedBoundingBox-inghVrgq.js";import{i as Hi}from"./projectPointToVector-BeWU3FqC.js";import{m as Rn,v as Fn,b as Dn}from"./lineSegment-CeFx4PPK.js";import{L as Ln,U as ji,j as Ui,b as Vn,O as qi,Z as kn,k as Nn}from"./plane-Dey3oqKO.js";import{r as Bn}from"./Cyclical-BjYazOTz.js";import{A as Hn}from"./normalizeUtils-dN75LHyP.js";import{n as zr}from"./VertexAttributeLocations-BfZbt_DV.js";import{t as Ar}from"./VertexElementDescriptor-BLyltQyJ.js";function Pc(t,e=!1){return t<=hi?e?new Array(t).fill(0):new Array(t):new Float32Array(t)}function zc(t){return(Array.isArray(t)?t.length:t.byteLength/8)<=hi?Array.from(t):new Float32Array(t)}function Ac(t,e,i){return Array.isArray(t)?t.slice(e,e+i):t.subarray(e,e+i)}let H=class extends fi{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1}};d([p()],H.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),d([p()],H.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),d([p()],H.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),d([p()],H.prototype,"DECONFLICTOR_SHOW_GRID",void 0),d([p()],H.prototype,"LABELS_SHOW_BORDER",void 0),d([p()],H.prototype,"TEXT_SHOW_BASELINE",void 0),d([p()],H.prototype,"TEXT_SHOW_BORDER",void 0),d([p()],H.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),d([p()],H.prototype,"OVERLAY_SHOW_CENTER",void 0),d([p()],H.prototype,"SHOW_POI",void 0),d([p()],H.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),d([p()],H.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),d([p()],H.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),d([p()],H.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),d([p()],H.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),d([p()],H.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),d([p()],H.prototype,"I3S_TREE_SHOW_TILES",void 0),d([p()],H.prototype,"I3S_SHOW_MODIFICATIONS",void 0),d([p()],H.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),d([p()],H.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),d([p()],H.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),d([p()],H.prototype,"LINE_WIREFRAMES",void 0),H=d([di("esri.views.3d.support.debugFlags")],H);const jn=new H,ot=()=>pi.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),Un=542327876,qn=131072,Wn=4;function _i(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}function Gn(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}const Xn=_i("DXT1"),Yn=_i("DXT3"),Kn=_i("DXT5"),Zn=31,Jn=0,Qn=1,ea=2,ta=3,ia=4,ra=7,sa=20,na=21;function Ec(t,e,i){const r=aa(i,e.hasMipmap??!1);if(r==null)throw new Error("DDS texture data is null");const{textureData:s,internalFormat:n,width:a,height:o}=r;return e.samplingMode=s.levels.length>1?9987:9729,e.hasMipmap=s.levels.length>1,e.internalFormat=n,e.width=a,e.height=o,new qs(t,e,s)}function aa(t,e){const i=new Int32Array(t.buffer,t.byteOffset,Zn);if(i[Jn]!==Un)return ot().error("Invalid magic number in DDS header"),null;if(!(i[sa]&Wn))return ot().error("Unsupported format, must contain a FourCC code"),null;const r=i[na];let s,n;switch(r){case Xn:s=8,n=Vt.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case Yn:s=16,n=Vt.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case Kn:s=16,n=Vt.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return ot().error("Unsupported FourCC code:",Gn(r)),null}let a=1,o=i[ia],l=i[ta];(3&o||3&l)&&(ot().warn("Rounding up compressed texture size to nearest multiple of 4."),o=o+3&-4,l=l+3&-4);const u=o,c=l;let h,m;i[ea]&qn&&e!==!1&&(a=Math.max(1,i[ra]));let _=t.byteOffset+i[Qn]+4;const f=[];for(let b=0;b<a;++b)m=(o+3>>2)*(l+3>>2)*s,h=new Uint8Array(t.buffer,_,m),f.push(h),_+=m,o=Math.max(1,o>>1),l=Math.max(1,l>>1);return{textureData:{type:"compressed",levels:f},internalFormat:n,width:u,height:c}}function oa(t){if(t.length<hi)return Array.from(t);if(Array.isArray(t))return Float64Array.from(t);if(!("BYTES_PER_ELEMENT"in t))return Array.from(t);switch(t.BYTES_PER_ELEMENT){case 1:return Uint8Array.from(t);case 2:return vs(t)?Ks().from(t):gs(t)?Uint16Array.from(t):Int16Array.from(t);case 4:return Float32Array.from(t);default:return Float64Array.from(t)}}let la=class Or{get center(){return K(this._data[0],this._data[1],this._data[2])}get radius(){return this._data[3]}get bbMin(){return K(this._data[4],this._data[5],this._data[6])}get bbMax(){return K(this._data[7],this._data[8],this._data[9])}constructor(e,i,r){this.primitiveIndices=e,this._numIndexPerPrimitive=i,this.position=r,this._data=[.1,0,0,0,0,0,0,0,0,0],this._children=void 0,B(e.length>=1),B(r.size===3||r.size===4);const{data:s,size:n,indices:a}=r;B(a.length%this._numIndexPerPrimitive===0),B(a.length>=e.length*this._numIndexPerPrimitive);const o=e.length;let l=n*a[this._numIndexPerPrimitive*e[0]];Ee.clear(),Ee.push(l);const u=K(s[l],s[l+1],s[l+2]),c=lr(u);for(let f=0;f<o;++f){const b=this._numIndexPerPrimitive*e[f];for(let $=0;$<this._numIndexPerPrimitive;++$){l=n*a[b+$],Ee.push(l);let z=s[l];u[0]=Math.min(z,u[0]),c[0]=Math.max(z,c[0]),z=s[l+1],u[1]=Math.min(z,u[1]),c[1]=Math.max(z,c[1]),z=s[l+2],u[2]=Math.min(z,u[2]),c[2]=Math.max(z,c[2])}}for(let f=0;f<3;++f)this._data[4+f]=u[f],this._data[7+f]=c[f];const h=St(g(),this.bbMin,this.bbMax,.5);let m=.5*Math.max(Math.max(c[0]-u[0],c[1]-u[1]),c[2]-u[2]),_=m*m;for(let f=0;f<Ee.length;++f){l=Ee.at(f);const b=s[l]-h[0],$=s[l+1]-h[1],z=s[l+2]-h[2],A=b*b+$*$+z*z;if(A<=_)continue;const C=Math.sqrt(A),O=.5*(C-m);m+=O,_=m*m;const R=O/C;h[0]+=b*R,h[1]+=$*R,h[2]+=z*R}this._data[3]=m;for(let f=0;f<3;++f)this._data[0+f]=h[f];Ee.clear()}getChildren(){if(this._children||Ws(this.bbMin,this.bbMax)<=1)return this._children;const e=St(g(),this.bbMin,this.bbMax,.5),i=this.primitiveIndices.length,r=new Uint8Array(i),s=new Array(8);for(let c=0;c<8;++c)s[c]=0;const{data:n,size:a,indices:o}=this.position;for(let c=0;c<i;++c){let h=0;const m=this._numIndexPerPrimitive*this.primitiveIndices[c];let _=a*o[m],f=n[_],b=n[_+1],$=n[_+2];for(let z=1;z<this._numIndexPerPrimitive;++z){_=a*o[m+z];const A=n[_],C=n[_+1],O=n[_+2];A<f&&(f=A),C<b&&(b=C),O<$&&($=O)}f<e[0]&&(h|=1),b<e[1]&&(h|=2),$<e[2]&&(h|=4),r[c]=h,++s[h]}let l=0;for(let c=0;c<8;++c)s[c]>0&&++l;if(l<2)return;const u=new Array(8);for(let c=0;c<8;++c)u[c]=s[c]>0?new Uint32Array(s[c]):void 0;for(let c=0;c<8;++c)s[c]=0;for(let c=0;c<i;++c){const h=r[c];u[h][s[h]++]=this.primitiveIndices[c]}this._children=new Array;for(let c=0;c<8;++c)u[c]!==void 0&&this._children.push(new Or(u[c],this._numIndexPerPrimitive,this.position));return this._children}static prune(){Ee.prune()}};const Ee=new _s({deallocator:null});let ca=class{constructor(e){this.id=mi(),this._attributes=new Map;for(const[i,r]of e)this._attributes.set(i,{...r,indices:Xs(r.indices)})}get attributes(){return this._attributes}};function ua(t,e){if(!t)return!1;const{size:i,data:r,indices:s}=t;k(e,0,0,0),k(ne,0,0,0);let n=0,a=0;for(let o=0;o<s.length-2;o+=3){const l=s[o]*i,u=s[o+1]*i,c=s[o+2]*i;k(G,r[l],r[l+1],r[l+2]),k($e,r[u],r[u+1],r[u+2]),k(lt,r[c],r[c+1],r[c+2]);const h=tn(G,$e,lt);h?(ae(G,G,$e),ae(G,G,lt),W(G,G,1/3*h),ae(e,e,G),n+=h):(ae(ne,ne,G),ae(ne,ne,$e),ae(ne,ne,lt),a+=3)}return(a!==0||n!==0)&&(n!==0?(W(e,e,1/n),!0):a!==0&&(W(e,ne,1/a),!0))}function ha(t,e){if(!t)return!1;const{size:i,data:r,indices:s}=t;k(e,0,0,0);let n=-1,a=0;for(let o=0;o<s.length;o++){const l=s[o]*i;n!==l&&(e[0]+=r[l],e[1]+=r[l+1],e[2]+=r[l+2],a++),n=l}return a>1&&W(e,e,1/a),a>0}function fa(t,e,i){if(!t)return!1;k(i,0,0,0),k(ne,0,0,0);let r=0,s=0;const{size:n,data:a,indices:o}=t,l=o.length-1,u=l+(e?2:0);for(let c=0;c<u;c+=2){const h=c<l?c+1:0,m=o[c<l?c:l]*n,_=o[h]*n;G[0]=a[m],G[1]=a[m+1],G[2]=a[m+2],$e[0]=a[_],$e[1]=a[_+1],$e[2]=a[_+2],W(G,ae(G,G,$e),.5);const f=Gs(G,$e);f>0?(ae(i,i,W(G,G,f)),r+=f):r===0&&(ae(ne,ne,G),s++)}return r!==0?(W(i,i,1/r),!0):s!==0&&(W(i,ne,1/s),!0)}const G=g(),$e=g(),lt=g(),ne=g();let Er=class{constructor(){this.uid=mi()}},da=class extends Er{constructor(e){super(),this.highlightName=e,this.channel=0}},Dc=class extends Er{constructor(){super(...arguments),this.channel=1}},Vc=class Ir extends ca{constructor(e,i,r=null,s=0,n=null,a=-1,o){super(i),this.material=e,this.mapPositions=r,this.type=s,this.olidColor=n,this.edgeIndicesLength=a,this.baseGeometry=o,this._highlights=null,this._highlightOptionsCounts=null,this.visible=!0,this._boundingInfo=null;const l=this.positionAttribute;l!=null&&this.edgeIndicesLength<0&&(this.edgeIndicesLength=l.indices.length)}instantiate(e={}){const i=new Ir(e.material||this.material,[],this.mapPositions,this.type,this.olidColor,this.edgeIndicesLength,this.baseGeometry);return this._attributes.forEach((r,s)=>{r.exclusive=!1,i._attributes.set(s,r)}),i._boundingInfo=this._boundingInfo,i.transformation=e.transformation||this.transformation,i}getMutableAttribute(e){let i=this._attributes.get(e);return i&&!i.exclusive&&(i={...i,exclusive:!0,data:oa(i.data)},this._attributes.set(e,i)),i}setAttributeData(e,i){const r=this._attributes.get(e);r?this._attributes.set(e,{...r,exclusive:!0,data:i}):ri()&&console.warn(`Setting undefined attribute ${e} data`)}get positionAttribute(){return this.attributes.get("position")??this.baseGeometry?.attributes.get("position")}get indexCount(){return this._attributes.values().next().value?.indices?.length??0}get faceCount(){return this.indexCount/3}get boundingInfo(){return this._boundingInfo??=this._calculateBoundingInfo(),this._boundingInfo}computeAttachmentOrigin(e){return!!(this.type===0?this._computeAttachmentOriginTriangles(e):this.type===2?this._computeAttachmentOriginLines(e):this._computeAttachmentOriginPoints(e))&&(this._transformation!=null&&ge(e,e,this._transformation),!0)}_computeAttachmentOriginTriangles(e){const i=this.positionAttribute;return ua(i,e)}_computeAttachmentOriginLines(e){const i=this.positionAttribute;return fa(i,pa(this.material.parameters,i),e)}_computeAttachmentOriginPoints(e){const i=this.positionAttribute;return ha(i,e)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const e=this.positionAttribute;if(!e||e.indices.length===0)return null;const i=this.type===0?3:1;B(e.indices.length%i===0,"Indexing error: "+e.indices.length+" not divisible by "+i);const r=Ys(e.indices.length/i);return new la(r,i,e)}get transformation(){return this._transformation??Ci}set transformation(e){this._transformation=e&&e!==Ci?ys(e):null}get highlights(){return this._highlights||ma}get hasHighlights(){return(this._highlightOptionsCounts?.size??0)>0}foreachHighlightOptions(e){this._highlightOptionsCounts?.forEach((i,r)=>e(r))}allocateIdAndHighlight(e){const i=new da(e);return this.addHighlight(i)}addHighlight(e){this._ensureHighlights().add(e);const{highlightName:i}=e,r=(this._highlightOptionsCounts?.get(i)??0)+1;return this._ensureHighlightOptionsCounts().set(i,r),e}_ensureHighlights(){let e=this._highlights;return e||(e=new Set,this._highlights=e),e}_ensureHighlightOptionsCounts(){let e=this._highlightOptionsCounts;return e||(e=new Map,this._highlightOptionsCounts=e),e}removeHighlight(e){if(this._highlights?.delete(e)){const{highlightName:i}=e,r=this._highlightOptionsCounts?.get(i)??0;r<=1?this._highlightOptionsCounts?.delete(i):this._ensureHighlightOptionsCounts().set(i,r-1)}}};function pa(t,e){return!(!("isClosed"in t)||!t.isClosed)&&e.indices.length>2}const ma=new Set;function va(t){return t===4||t===5||t===6||t===7||t===8}function kc(t){return _a(t)||t===3}function Rr(t){return t===9||t===10}function Nc(t){return Fr(t)||Rr(t)}function Fr(t){return t===0}function it(t){return Fr(t)||yi(t)}function Bc(t){return it(t)||t===10}function ga(t){return it(t)||Rr(t)}function _a(t){return ga(t)||Dr(t)}function Dr(t){return t===2}function yi(t){return t===1}function ya(t){return Dr(t)||va(t)}let xa=class{constructor(e){this._material=e.material,this._techniques=e.techniques,this._output=e.output}dispose(){}get _stippleTextures(){return this._techniques.context?.stippleTextures}get _markerTextures(){return this._techniques.context?.markerTextures}getTechnique(e,i){return this._techniques.get(e,this._material.getConfiguration(this._output,i))}ensureResources(e){return 2}},$a=class{};const Rt=$a;let Uc=class extends xa{constructor(e){super(e),this._numLoading=0,this._disposed=!1,this._textures=e.textures,this.updateTexture(e.textureId),this._acquire(e.normalTextureId,i=>this._textureNormal=i),this._acquire(e.emissiveTextureId,i=>this._textureEmissive=i),this._acquire(e.occlusionTextureId,i=>this._textureOcclusion=i),this._acquire(e.metallicRoughnessTextureId,i=>this._textureMetallicRoughness=i)}dispose(){super.dispose(),this._texture=Ae(this._texture),this._textureNormal=Ae(this._textureNormal),this._textureEmissive=Ae(this._textureEmissive),this._textureOcclusion=Ae(this._textureOcclusion),this._textureMetallicRoughness=Ae(this._textureMetallicRoughness),this._disposed=!0}ensureResources(e){return this._numLoading===0?2:1}get textureBindParameters(){return new wa(this._texture?.glTexture??null,this._textureNormal?.glTexture??null,this._textureEmissive?.glTexture??null,this._textureOcclusion?.glTexture??null,this._textureMetallicRoughness?.glTexture??null)}updateTexture(e){this._texture!=null&&e===this._texture.id||(this._texture=Ae(this._texture),this._acquire(e,i=>this._texture=i))}_acquire(e,i){if(e==null)return void i(null);const r=this._textures.acquire(e);if(xs(r))return++this._numLoading,void r.then(s=>{if(this._disposed)return Ae(s),void i(null);i(s)}).finally(()=>--this._numLoading);i(r)}},ba=class extends Rt{constructor(e=null){super(),this.textureEmissive=e}},wa=class extends ba{constructor(e,i,r,s,n,a,o){super(r),this.texture=e,this.textureNormal=i,this.textureOcclusion=s,this.textureMetallicRoughness=n,this.scale=a,this.normalTextureTransformMatrix=o}},Sa=class{constructor(e){this._bits=[...e]}equals(e){return $s(this._bits,e.bits)}get code(){return this._code??=String.fromCharCode(...this._bits),this._code}get bits(){return this._bits}},Ma=class extends Rt{constructor(){super(),this._parameterBits=this._parameterBits?.map(()=>0)??[],this._parameterNames??=[]}get key(){return this._key??=new Sa(this._parameterBits),this._key}decode(e=this.key){const i=this._parameterBits;this._parameterBits=[...e.bits];const r=this._parameterNames.map(s=>`    ${s}: ${this[s]}`).join(`
`);return this._parameterBits=i,r}};function ct(t={}){return(e,i)=>{e.hasOwnProperty("_parameterNames")||Object.defineProperty(e,"_parameterNames",{value:e._parameterNames?.slice()??[],configurable:!0,writable:!0}),e.hasOwnProperty("_parameterBits")||Object.defineProperty(e,"_parameterBits",{value:e._parameterBits?.slice()??[0],configurable:!0,writable:!0}),e._parameterNames.push(i);const r=t.count||2,s=Math.ceil(Math.log2(r)),n=e._parameterBits;let a=0;for(;n[a]+s>16;)a++,a>=n.length&&n.push(0);const o=n[a],l=(1<<s)-1<<o;n[a]+=s,t.count?Object.defineProperty(e,i,{get(){return(this._parameterBits[a]&l)>>o},set(u){if(this[i]!==u){if(this._key=null,this._parameterBits[a]=this._parameterBits[a]&~l|+u<<o&l,typeof u!="number")throw new yt("internal:invalid-shader-configuration",`Configuration value for ${i} must be a number, got ${typeof u}`);if(t.count==null)throw new yt("internal:invalid-shader-configuration",`Configuration value for ${i} must provide a count option`)}}}):Object.defineProperty(e,i,{get(){return!!((this._parameterBits[a]&l)>>o)},set(u){if(this[i]!==u&&(this._key=null,this._parameterBits[a]=this._parameterBits[a]&~l|+u<<o&l,typeof u!="boolean"))throw new yt("internal:invalid-shader-configuration",`Configuration value for ${i} must be boolean, got ${typeof u}`)}})}}let Ta=class extends Ma{constructor(){super(...arguments),this.instancedDoublePrecision=!1,this.hasModelTransformation=!1}},Je=class extends Ta{constructor(){super(...arguments),this.output=0,this.oitPass=0,this.hasSlicePlane=!1,this.hasHighlightMixTexture=!1,this.bindType=1,this.instanced=!1,this.writeDepth=!0}};d([ct({count:11})],Je.prototype,"output",void 0),d([ct({count:3})],Je.prototype,"oitPass",void 0),d([ct()],Je.prototype,"hasSlicePlane",void 0),d([ct()],Je.prototype,"hasHighlightMixTexture",void 0);let ai=class{constructor(){this._scale=0,this._angleFactor=0,this._minScale=0}update(e,i,r,s){r?(this._scale=Math.min(r.divisor/(i-r.offset),1),this._angleFactor=Ca(e),this._minScale=s!=null?Math.min(r.minPixelSize/s,1):0):(this._scale=1,this._minScale=1,this._angleFactor=1)}apply(e){const{_scale:i,_angleFactor:r,_minScale:s}=this;return e*rt(te(i,1,r),s,1)}applyVec2(e,i){e[0]=this.apply(i[0]),e[1]=this.apply(i[1])}},Qc=class{constructor(){this.evaluator=new ai,this.alignmentEvaluator=new ai}update(e,i,r,s,n,a){this.evaluator.update(e,i,r,s),this.alignmentEvaluator.update(e,i,n??r,(n?a:null)??s)}};function Ca(t){return Math.abs(t)**3}function tu(t){return!!t&&!0}function iu(t,e,i,r,s,n){let a=i.screenLength*t.pixelRatio;s!=null&&(Gi.update(r,e,s,n),a=Gi.apply(a));const o=a*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return rt(o*e,i.minWorldLength,i.maxWorldLength)}const Pa=bs();function Wi(t,e){let i=!1;for(const r in e){const s=e[r];s!==void 0&&(Array.isArray(s)?Array.isArray(t[r])&&Pa(s,t[r])||(t[r]=s.slice(),i=!0):t[r]!==s&&(i=!0,t[r]=s))}return i}const ru={multiply:1,ignore:2,replace:3,tint:4},Gi=new ai;let su=class{constructor(e,i){this.id=mi(),this.supportsEdges=!1,this._renderPriority=0,this._parameters=new i,Wi(this._parameters,e),this.validateParameters(this._parameters)}get parameters(){return this._parameters}update(e){return!1}setParameters(e,i=!0){Wi(this._parameters,e)&&(this.validateParameters(this._parameters),i&&this._parametersChanged())}validateParameters(e){}shouldRender(e){return this.visible&&this.isVisibleForOutput(e.output)&&(!this.parameters.isDecoration||e.bind.decorations)&&(this.parameters.renderOccluded&e.renderOccludedMask)!==0}isVisibleForOutput(e){return!0}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this._parametersChanged())}_parametersChanged(){this.repository?.materialChanged(this)}get renderOccludedFlags(){return this.visible?this.parameters.renderOccluded:0}get hasEmissions(){return!1}getConfiguration(e,i,r=new Je){return r.output=e,r.hasHighlightMixTexture=e===9&&i.highlightMixTexture!=null,r}},au=class extends Rt{constructor(){super(...arguments),this.renderOccluded=1,this.isDecoration=!1}};const za=sn(1,0,1,771);function lu(t,e=!1){switch(t){case 0:return e?_r:nn;case 1:return za;case 2:case 3:return null}}function cu(t){if(t.draped)return null;switch(t.oitPass){case 0:case 2:return t.writeDepth?rn:null;case 1:case 3:return null}}const uu=5e5,Aa={factor:-1,units:-2};function hu({oitPass:t,enableOffset:e}){return e&&t===1?Aa:null}function fu(t,e=513){return t===0||t===2?e:515}function du(t,e){const i=yi(e);return t===1?i?{buffers:[kt,Nt,Hs]}:{buffers:[kt,Nt]}:i?{buffers:[kt,Nt]}:null}let Oa=class{constructor(e=0,i=!1,r=!0){this.tolerance=e,this.isVerticalRay=i,this.normalRequired=r}};const ut=Ss();function mu(t,e,i,r,s,n){if(!t.visible)return;const a=ve(Br,r,i),o=(c,h,m)=>n(c,m,h),{tolerance:l}=e,u=new Oa(l,!1,e.options.normalRequired);if(t.boundingInfo)B(t.type===0),Lr(t.boundingInfo,i,a,l,s,u,o);else{const c=t.positionAttribute,h=c.indices;Vr(i,a,0,h.length/3,h,c.data,c.stride,s,u,o)}}const Ea=g();function Lr(t,e,i,r,s,n,a){if(t==null)return;const o=Na(i,Ea);if(ws(ut,t.bbMin),Ms(ut,t.bbMax),s?.applyToAabb(ut),Ba(ut,e,o,r)){const{primitiveIndices:l,position:u}=t,c=l?l.length:u.indices.length/3;if(c>ja){const h=t.getChildren();if(h!==void 0){for(const m of h)Lr(m,e,i,r,s,n,a);return}}Fa(e,i,0,c,u.indices,u.data,u.stride,l,s,n,a)}}const je=g();function vu(t,e,i,r,s,n,a,o,l){const{data:u,stride:c}=n;Vr(t,ve(Br,e,t),i,r,s,u,c,a,o,l)}function gu(t,e,i,r){if(!i.visible)return;const s=(l,u,c)=>r(l,c,u),{boundingInfo:n}=i;if(n){const{bbMin:l,bbMax:u}=n;if(t<l[0]||t>u[0]||e<l[1]||e>u[1])return}const a=i.positionAttribute,o=a.indices;Ia(t,e,0,o.length/3,o,a,s)}function Ia(t,e,i,r,s,n,a){const{data:o,stride:l}=n;for(let u=i;u<r;++u){const c=3*u,h=l*s[c],m=l*s[c+1],_=l*s[c+2],f=o[h+0]-t,b=o[h+1]-e,$=o[m+0]-t,z=o[m+1]-e,A=o[_+0]-t,C=o[_+1]-e,O=A*z-C*$,R=f*C-b*A,D=$*b-z*f;(O<0||R<0||D<0)&&(O>0||R>0||D>0)||a(0,u,null)}}function Ra(t,e,i,r,s,n,a,o){const l=t[0],u=t[1],c=t[2],h=e[0],m=e[1],_=e[2];for(let f=i;f<r;++f){const b=3*f,$=b+1,z=b+2,A=n*b,C=s[A],O=s[A+1],R=s[A+2],D=n*$,T=n*z,w=s[D]-C,x=s[D+1]-O,E=s[D+2]-R,y=s[T]-C,S=s[T+1]-O,M=s[T+2]-R,F=m*M-S*_,L=_*y-M*h,V=h*S-y*m,N=w*F+x*L+E*V;if(Math.abs(N)<=Nr)continue;const Z=l-C,ie=u-O,le=c-R,Q=Z*F+ie*L+le*V;if(N>0){if(Q<0||Q>N)continue}else if(Q>0||Q<N)continue;const re=ie*E-x*le,de=le*w-E*Z,pe=Z*x-w*ie,ce=h*re+m*de+_*pe;if(N>0){if(ce<0||Q+ce>N)continue}else if(ce>0||Q+ce<N)continue;const ee=(y*re+S*de+M*pe)/N;ee>=0&&o(ee,f,a?kr(w,x,E,y,S,M,je):null)}}function Fa(t,e,i,r,s,n,a,o,l,u,c){const h=t[0],m=t[1],_=t[2],f=e[0],b=e[1],$=e[2],{normalRequired:z}=u;for(let A=i;A<r;++A){const C=o[A],O=3*C,R=a*s[O];let D=n[R],T=n[R+1],w=n[R+2];const x=a*s[O+1];let E=n[x],y=n[x+1],S=n[x+2];const M=a*s[O+2];let F=n[M],L=n[M+1],V=n[M+2];l!=null&&([D,T,w]=l.applyToVertex(D,T,w,A),[E,y,S]=l.applyToVertex(E,y,S,A),[F,L,V]=l.applyToVertex(F,L,V,A));const N=E-D,Z=y-T,ie=S-w,le=F-D,Q=L-T,re=V-w,de=b*re-Q*$,pe=$*le-re*f,ce=f*Q-le*b,ee=N*de+Z*pe+ie*ce;if(Math.abs(ee)<=Nr)continue;const De=h-D,Dt=m-T,Lt=_-w,Le=De*de+Dt*pe+Lt*ce;if(ee>0){if(Le<0||Le>ee)continue}else if(Le>0||Le<ee)continue;const wi=Dt*ie-Z*Lt,Si=Lt*N-ie*De,Mi=De*Z-N*Dt,st=f*wi+b*Si+$*Mi;if(ee>0){if(st<0||Le+st>ee)continue}else if(st>0||Le+st<ee)continue;const Ti=(le*wi+Q*Si+re*Mi)/ee;Ti>=0&&c(Ti,C,z?kr(N,Z,ie,le,Q,re,je):null)}}function Vr(t,e,i,r,s,n,a,o,l,u){const c=e,h=Ua,m=Math.abs(c[0]),_=Math.abs(c[1]),f=Math.abs(c[2]),b=m>=_?m>=f?0:2:_>=f?1:2,$=b,z=c[$]<0?2:1,A=(b+z)%3,C=(b+(3-z))%3,O=c[A]/c[$],R=c[C]/c[$],D=1/c[$],T=Da,w=La,x=Va,{normalRequired:E}=l;for(let y=i;y<r;++y){const S=3*y,M=a*s[S];k(h[0],n[M+0],n[M+1],n[M+2]);const F=a*s[S+1];k(h[1],n[F+0],n[F+1],n[F+2]);const L=a*s[S+2];k(h[2],n[L+0],n[L+1],n[L+2]),o&&(U(h[0],o.applyToVertex(h[0][0],h[0][1],h[0][2],y)),U(h[1],o.applyToVertex(h[1][0],h[1][1],h[1][2],y)),U(h[2],o.applyToVertex(h[2][0],h[2][1],h[2][2],y))),ve(T,h[0],t),ve(w,h[1],t),ve(x,h[2],t);const V=T[A]-O*T[$],N=T[C]-R*T[$],Z=w[A]-O*w[$],ie=w[C]-R*w[$],le=x[A]-O*x[$],Q=x[C]-R*x[$],re=le*ie-Q*Z,de=V*Q-N*le,pe=Z*N-ie*V;if((re<0||de<0||pe<0)&&(re>0||de>0||pe>0))continue;const ce=re+de+pe;if(ce===0)continue;const ee=re*(D*T[$])+de*(D*w[$])+pe*(D*x[$]);if(ee*Math.sign(ce)<0)continue;const De=ee/ce;De>=0&&u(De,y,E?ka(h):null)}}const Da=g(),La=g(),Va=g();function kr(t,e,i,r,s,n,a){return k(Pt,t,e,i),k(zt,r,s,n),fe(a,Pt,zt),Te(a,a),a}function ka(t){return ve(Pt,t[1],t[0]),ve(zt,t[2],t[0]),fe(je,Pt,zt),Te(je,je),je}const Pt=g(),zt=g();function Na(t,e){return k(e,1/t[0],1/t[1],1/t[2])}function Ba(t,e,i,r){return Ha(t,e,i,r,1/0)}function Ha(t,e,i,r,s){const n=(t[0]-r-e[0])*i[0],a=(t[3]+r-e[0])*i[0];let o=Math.min(n,a),l=Math.max(n,a);const u=(t[1]-r-e[1])*i[1],c=(t[4]+r-e[1])*i[1];if(l=Math.min(l,Math.max(u,c)),l<0||(o=Math.max(o,Math.min(u,c)),o>l))return!1;const h=(t[2]-r-e[2])*i[2],m=(t[5]+r-e[2])*i[2];return l=Math.min(l,Math.max(h,m)),!(l<0)&&(o=Math.max(o,Math.min(h,m)),!(o>l)&&o<s)}const ja=1e3,Nr=1e-7,Br=g(),Ua=[g(),g(),g()];let _u=class{constructor(){this._transform=X(),this._transformInverse=new ht({value:this._transform},$t,X),this._transformInverseTranspose=new ht(this._transformInverse,ni,X),this._transformTranspose=new ht({value:this._transform},ni,X),this._transformInverseRotation=new ht({value:this._transform},Ts,cr)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){qe(this._transform,e)}multiplyTransform(e){Mt(this._transform,this._transform,e)}set(e){qe(this._transform,e),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,i){this.setTransformMatrix(e),this.multiplyTransform(i),this._invalidateLazyTransforms()}},ht=class{constructor(e,i,r){this._original=e,this._update=i,this._dirty=!0,this._transform=r()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}},qa=class{constructor(e=0){this.componentLocalOriginLength=0,this._totalOffset=0,this._offset=0,this._tmpVertex=g(),this._tmpMbs=It(),this._tmpObb=new En,this._resetOffset(e)}_resetOffset(e){this._offset=e,this._totalOffset=e}set offset(e){this._resetOffset(e)}get offset(){return this._offset}set componentOffset(e){this._totalOffset=this._offset+e}set localOrigin(e){this.componentLocalOriginLength=Y(e)}applyToVertex(e,i,r){const s=k(Hr,e,i,r),n=k(Ga,e,i,r+this.componentLocalOriginLength),a=this._totalOffset/Y(n);return we(this._tmpVertex,s,n,a),this._tmpVertex}applyToAabb(e){const i=this.componentLocalOriginLength,r=e[0],s=e[1],n=e[2]+i,a=e[3],o=e[4],l=e[5]+i,u=Math.abs(r),c=Math.abs(s),h=Math.abs(n),m=Math.abs(a),_=Math.abs(o),f=Math.abs(l),b=.5*(1+Math.sign(r*a))*Math.min(u,m),$=.5*(1+Math.sign(s*o))*Math.min(c,_),z=.5*(1+Math.sign(n*l))*Math.min(h,f),A=Math.max(u,m),C=Math.max(c,_),O=Math.max(h,f),R=Math.sqrt(b*b+$*$+z*z),D=Math.sign(u+r),T=Math.sign(c+s),w=Math.sign(h+n),x=Math.sign(m+a),E=Math.sign(_+o),y=Math.sign(f+l),S=this._totalOffset;if(R<S)return e[0]-=(1-D)*S,e[1]-=(1-T)*S,e[2]-=(1-w)*S,e[3]+=x*S,e[4]+=E*S,e[5]+=y*S,e;const M=S/Math.sqrt(A*A+C*C+O*O),F=S/R,L=F-M,V=-L;return e[0]+=r*(D*V+F),e[1]+=s*(T*V+F),e[2]+=n*(w*V+F),e[3]+=a*(x*L+M),e[4]+=o*(E*L+M),e[5]+=l*(y*L+M),e}applyToMbs(e){const i=Mr(e),r=Y(i),s=this._totalOffset/r,n=we(jr,i,i,s),a=e[3]+e[3]*this._totalOffset/r;return Tr(this._tmpMbs,n,a),this._tmpMbs}applyToObb(e){return In(e,this._totalOffset,this._totalOffset,1,this._tmpObb),this._tmpObb}},Wa=class{constructor(e=0){this.offset=e,this.sphere=It(),this.tmpVertex=g()}applyToVertex(e,i,r){const s=this.objectTransform.transform,n=k(Hr,e,i,r),a=ge(n,n,s),o=this.offset/Y(a);we(a,a,a,o);const l=this.objectTransform.inverse;return ge(this.tmpVertex,a,l),this.tmpVertex}applyToMinMax(e,i){const r=this.offset/Y(e);we(e,e,e,r);const s=this.offset/Y(i);we(i,i,i,s)}applyToAabb(e){const i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;const r=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*r,e[4]+=e[4]*r,e[5]+=e[5]*r,e}applyToBoundingSphere(e){const i=Mr(e),r=Y(i),s=this.offset/r,n=we(jr,i,i,s),a=e[3]+e[3]*this.offset/r;return Tr(this.sphere,n,a),this.sphere}};const Xi=new Wa;function wu(t){return t!=null?(Xi.offset=t,Xi):null}new qa;const Hr=g(),Ga=g(),jr=g();function Su(t,e,i,r=1){const{data:s,indices:n}=t,a=e.typedBuffer,o=e.typedBufferStride,l=n.length;if(i*=o,r===1)for(let u=0;u<l;++u)a[i]=s[n[u]],i+=o;else for(let u=0;u<l;++u){const c=s[n[u]];for(let h=0;h<r;h++)a[i]=c,i+=o}}function Ht(t,e,i){const{data:r,indices:s}=t,n=e.typedBuffer,a=e.typedBufferStride,o=s.length;i*=a;for(let l=0;l<o;++l){const u=2*s[l];n[i]=r[u],n[i+1]=r[u+1],i+=a}}function xi(t,e,i,r=1){const{data:s,indices:n}=t,a=e.typedBuffer,o=e.typedBufferStride,l=n.length;if(i*=o,r===1)for(let u=0;u<l;++u){const c=3*n[u];a[i]=s[c],a[i+1]=s[c+1],a[i+2]=s[c+2],i+=o}else for(let u=0;u<l;++u){const c=3*n[u];for(let h=0;h<r;++h)a[i]=s[c],a[i+1]=s[c+1],a[i+2]=s[c+2],i+=o}}function Ur(t,e,i,r=1){const{data:s,indices:n}=t,a=e.typedBuffer,o=e.typedBufferStride,l=n.length;if(i*=o,r===1)for(let u=0;u<l;++u){const c=4*n[u];a[i]=s[c],a[i+1]=s[c+1],a[i+2]=s[c+2],a[i+3]=s[c+3],i+=o}else for(let u=0;u<l;++u){const c=4*n[u];for(let h=0;h<r;++h)a[i]=s[c],a[i+1]=s[c+1],a[i+2]=s[c+2],a[i+3]=s[c+3],i+=o}}function Mu(t,e,i){const r=t.typedBuffer,s=t.typedBufferStride;e*=s;for(let n=0;n<i;++n)r[e]=0,r[e+1]=0,r[e+2]=0,r[e+3]=0,e+=s}function Xa(t,e,i,r,s=1){if(!e)return void xi(t,i,r,s);const{data:n,indices:a}=t,o=i.typedBuffer,l=i.typedBufferStride,u=a.length,c=e[0],h=e[1],m=e[2],_=e[4],f=e[5],b=e[6],$=e[8],z=e[9],A=e[10],C=e[12],O=e[13],R=e[14];r*=l;let D=0,T=0,w=0;const x=yr(e)?E=>{D=n[E]+C,T=n[E+1]+O,w=n[E+2]+R}:E=>{const y=n[E],S=n[E+1],M=n[E+2];D=c*y+_*S+$*M+C,T=h*y+f*S+z*M+O,w=m*y+b*S+A*M+R};if(s===1)for(let E=0;E<u;++E)x(3*a[E]),o[r]=D,o[r+1]=T,o[r+2]=w,r+=l;else for(let E=0;E<u;++E){x(3*a[E]);for(let y=0;y<s;++y)o[r]=D,o[r+1]=T,o[r+2]=w,r+=l}}function Ya(t,e,i,r,s=1){if(!e)return void xi(t,i,r,s);const{data:n,indices:a}=t,o=e,l=i.typedBuffer,u=i.typedBufferStride,c=a.length,h=o[0],m=o[1],_=o[2],f=o[4],b=o[5],$=o[6],z=o[8],A=o[9],C=o[10],O=!xr(o),R=1e-6,D=1-R;r*=u;let T=0,w=0,x=0;const E=yr(o)?y=>{T=n[y],w=n[y+1],x=n[y+2]}:y=>{const S=n[y],M=n[y+1],F=n[y+2];T=h*S+f*M+z*F,w=m*S+b*M+A*F,x=_*S+$*M+C*F};if(s===1)if(O)for(let y=0;y<c;++y){E(3*a[y]);const S=T*T+w*w+x*x;if(S<D&&S>R){const M=1/Math.sqrt(S);l[r]=T*M,l[r+1]=w*M,l[r+2]=x*M}else l[r]=T,l[r+1]=w,l[r+2]=x;r+=u}else for(let y=0;y<c;++y)E(3*a[y]),l[r]=T,l[r+1]=w,l[r+2]=x,r+=u;else for(let y=0;y<c;++y){if(E(3*a[y]),O){const S=T*T+w*w+x*x;if(S<D&&S>R){const M=1/Math.sqrt(S);T*=M,w*=M,x*=M}}for(let S=0;S<s;++S)l[r]=T,l[r+1]=w,l[r+2]=x,r+=u}}function Ka(t,e,i,r,s=1){if(!e)return void Ur(t,i,r,s);const{data:n,indices:a}=t,o=e,l=i.typedBuffer,u=i.typedBufferStride,c=a.length,h=o[0],m=o[1],_=o[2],f=o[4],b=o[5],$=o[6],z=o[8],A=o[9],C=o[10],O=!xr(o),R=1e-6,D=1-R;if(r*=u,s===1)for(let T=0;T<c;++T){const w=4*a[T],x=n[w],E=n[w+1],y=n[w+2],S=n[w+3];let M=h*x+f*E+z*y,F=m*x+b*E+A*y,L=_*x+$*E+C*y;if(O){const V=M*M+F*F+L*L;if(V<D&&V>R){const N=1/Math.sqrt(V);M*=N,F*=N,L*=N}}l[r]=M,l[r+1]=F,l[r+2]=L,l[r+3]=S,r+=u}else for(let T=0;T<c;++T){const w=4*a[T],x=n[w],E=n[w+1],y=n[w+2],S=n[w+3];let M=h*x+f*E+z*y,F=m*x+b*E+A*y,L=_*x+$*E+C*y;if(O){const V=M*M+F*F+L*L;if(V<D&&V>R){const N=1/Math.sqrt(V);M*=N,F*=N,L*=N}}for(let V=0;V<s;++V)l[r]=M,l[r+1]=F,l[r+2]=L,l[r+3]=S,r+=u}}function Za(t,e,i,r,s=1){const{data:n,indices:a}=t,o=i.typedBuffer,l=i.typedBufferStride,u=a.length;if(r*=l,e===n.length&&e===4){o[r]=n[0],o[r+1]=n[1],o[r+2]=n[2],o[r+3]=n[3];const c=new Uint32Array(i.typedBuffer.buffer,i.start),h=l/4,m=c[r/=4];r+=h;const _=u*s;for(let f=1;f<_;++f)c[r]=m,r+=h;return}if(s!==1)if(e!==4)for(let c=0;c<u;++c){const h=3*a[c];for(let m=0;m<s;++m)o[r]=n[h],o[r+1]=n[h+1],o[r+2]=n[h+2],o[r+3]=255,r+=l}else for(let c=0;c<u;++c){const h=4*a[c];for(let m=0;m<s;++m)o[r]=n[h],o[r+1]=n[h+1],o[r+2]=n[h+2],o[r+3]=n[h+3],r+=l}else{if(e===4){for(let c=0;c<u;++c){const h=4*a[c];o[r]=n[h],o[r+1]=n[h+1],o[r+2]=n[h+2],o[r+3]=n[h+3],r+=l}return}for(let c=0;c<u;++c){const h=3*a[c];o[r]=n[h],o[r+1]=n[h+1],o[r+2]=n[h+2],o[r+3]=255,r+=l}}}function Ja(t,e,i){const{data:r,indices:s}=t,n=e.typedBuffer,a=e.typedBufferStride,o=s.length,l=r[0];i*=a;for(let u=0;u<o;++u)n[i]=l,i+=a}function Tu(t,e,i,r){Se(Ie,t,e);const s=Math.max(Math.sqrt(Y(Ie)),1e-4);W(Ie,Ie,1/s),i[r++]=Ie[0],i[r++]=Ie[1],i[r++]=Ie[2],i[r++]=s}const Ie=g();function Qa(t,e,i,r,s=1){const n=e.typedBuffer,a=e.typedBufferStride;if(r*=a,s===1)for(let o=0;o<i;++o)n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],n[r+3]=t[3],r+=a;else for(let o=0;o<i;++o)for(let l=0;l<s;++l)n[r]=t[0],n[r+1]=t[1],n[r+2]=t[2],n[r+3]=t[3],r+=a}function eo(t,e,i,r,s,n,a){let o={numItems:0,numVerticesPerItem:0};for(const l of i.fields.keys()){const u=t.get(l),c=u?.indices;if(u&&c)l==="position"&&(o={numItems:1,numVerticesPerItem:c.length}),to(l,u,r,s,n,a);else if(l==="olidColor"&&e!=null){const h=t.get("position")?.indices;if(h){const m=h.length;Qa(e,n.getField(l,gr),m,a)}}}return o}function to(t,e,i,r,s,n){switch(t){case"position":{B(e.size===3);const a=s.getField(t,xt);B(!!a,`No buffer view for ${t}`),Xa(e,i,a,n);break}case"normal":{B(e.size===3);const a=s.getField(t,xt);B(!!a,`No buffer view for ${t}`),Ya(e,r,a,n);break}case"normalCompressed":case"profileRight":case"profileUp":{B(e.size===2);const a=s.getField(t,Ri);B(!!a,`No buffer view for ${t}`),Ht(e,a,n);break}case"uv0":{B(e.size===2);const a=s.getField(t,Qs)??s.getField(t,en);B(!!a,`No buffer view for ${t}`),Ht(e,a,n);break}case"uvi":{B(e.size===2);const a=s.getField(t,Ri);B(!!a,`No buffer view for ${t}`),Ht(e,a,n);break}case"color":case"symbolColor":{const a=s.getField(t,gr);B(!!a,`No buffer view for ${t}`),B(e.size===3||e.size===4),Za(e,e.size,a,n);break}case"colorFeatureAttribute":case"opacityFeatureAttribute":case"sizeFeatureAttribute":{const a=s.getField(t,Ii)??s.getField(t,Ii);B(!!a,`No buffer view for ${t}`),B(e.size===1),Ja(e,a,n);break}case"tangent":{B(e.size===4);const a=s.getField(t,Ei);B(!!a,`No buffer view for ${t}`),Ka(e,i,a,n);break}case"profileVertexAndNormal":{B(e.size===4);const a=s.getField(t,Js)??s.getField(t,Ei);B(!!a,`No buffer view for ${t}`),Ur(e,a,n);break}case"profileAuxData":{B(e.size===3);const a=s.getField(t,Zs)??s.getField(t,xt);B(!!a,`No buffer view for ${t}`),xi(e,a,n);break}}}let Cu=class{constructor(e){this.layout=e}elementCount(e){return e.get("position").indices.length}write(e,i,r,s,n,a){return eo(r,s,this.layout,e,i,n,a)}intersect(e,i,r,s,n,a,o){const l=this.layout.createView(e).getField("position",xt);if(l==null)return;const u=ve(io,a,n),c=0,h=l.count/3,m=s.options.normalRequired,_=(f,b,$)=>o(f,$,b);Ra(n,u,c,h,l.typedBuffer,l.typedBufferStride,m,_)}};const io=g();let j=class{constructor(e,i,r,s,n=null){if(this.name=e,this.type=i,this.arraySize=n,this.bind={0:null,1:null,2:null},s)switch(r){case void 0:break;case 0:this.bind[0]=s;break;case 1:this.bind[1]=s;break;case 2:this.bind[2]=s}}equals(e){return this.type===e.type&&this.name===e.name&&this.arraySize===e.arraySize}},ro=class extends j{constructor(e,i,r){super(e,"float",0,(s,n)=>s.setUniform1f(e,i(n),r))}},Me=class extends j{constructor(e,i,r){super(e,"vec3",2,(s,n,a,o)=>s.setUniform3fv(e,i(n,a,o),r))}},xe=class extends j{constructor(e,i,r){super(e,"vec3",1,(s,n,a)=>s.setUniform3fv(e,i(n,a),r))}},so=class extends j{constructor(e,i,r){super(e,"mat3",1,(s,n,a)=>s.setUniformMatrix3fv(e,i(n,a),r))}},Ru=class extends j{constructor(e,i,r){super(e,"mat4",1,(s,n,a)=>s.setUniformMatrix4fv(e,i(n,a),r))}},Du=class{constructor(e,i){this._module=e,this._load=i}get(){return this._module}async reload(){return this._module=await this._load(),this._module}},Yi=class{constructor(e,i,r){this._context=e,this.locations=r,this._textures=new Map,this.source=ri()?i:null,i.attributeNames.forEach(s=>{r.has(s)||console.error(`Missing VertexAttributeLocation for ${s} used in shader`)}),this._glProgram=e.programCache.acquire(i.generate("vertex",!0),i.generate("fragment",!0),r),this._glProgram.stop=()=>{throw new Error("Wrapped _glProgram used directly")},this.bind=i.generateBind(this),this.bindPass=i.generateBindPass(this),this.bindDraw=i.generateBindDraw(this)}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get hasTransformFeedbackVaryings(){return this._glProgram.hasTransformFeedbackVaryings}get compiled(){return this._glProgram.compiled}setUniform1b(e,i){this._glProgram.setUniform1i(e,i?1:0)}setUniform1i(e,i){this._glProgram.setUniform1i(e,i)}setUniform1f(e,i,r){this._glProgram.setUniform1f(e,i,r)}setUniform2fv(e,i,r){this._glProgram.setUniform2fv(e,i,r)}setUniform3fv(e,i,r){this._glProgram.setUniform3fv(e,i,r)}setUniform4fv(e,i,r){this._glProgram.setUniform4fv(e,i,r)}setUniformMatrix3fv(e,i,r){this._glProgram.setUniformMatrix3fv(e,i,!1,r)}setUniformMatrix4fv(e,i,r){this._glProgram.setUniformMatrix4fv(e,i,!1,r)}setUniformMatrices4fv(e,i,r){this._glProgram.setUniformMatrices4fv(e,i,!1,r)}setUniform1fv(e,i,r){this._glProgram.setUniform1fv(e,i,r)}setUniform1iv(e,i){this._glProgram.setUniform1iv(e,i)}setUniform2iv(e,i){this._glProgram.setUniform2iv(e,i)}setUniform3iv(e,i){this._glProgram.setUniform3iv(e,i)}setUniform4iv(e,i){this._glProgram.setUniform4iv(e,i)}assertCompatibleVertexAttributeLocations(e,i){let r=e.locations;if(i){const s=new Map(r);i.forEach((n,a)=>s.set(a,r.size+n)),r=s}r.size!==this.locations.size&&console.error(`VertexAttributeLocations are incompatible: ${r}, ${this.locations}`),this.locations.forEach((s,n)=>{r.get(n)!==s&&console.error(`VertexAttributeLocations are incompatible: Program has ${n} at position ${s}, VAO has it at position ${r.get(n)}.`)})}stop(){this._textures.clear()}bindTexture(e,i){i?.glName||(ri()&&console.error(`Texture sampler ${e} has no given Texture in ${new Error().stack} `),i=this._context.emptyTexture);const r=this._ensureTextureUnit(e,i);this._context.useProgram(this),this.setUniform1i(e,r.unit),this._context.bindTexture(i,r.unit)}_ensureTextureUnit(e,i){let r=this._textures.get(e);return r==null?(r={texture:i,unit:this._textures.size},this._textures.set(e,r)):r.texture=i,r}};const no=()=>pi.getLogger("esri.views.3d.webgl.ShaderTechnique");let ku=class{constructor(e,i,r,s){this.primitiveType=js.TRIANGLES,this.key=i.key,this._program=new Yi(e.rctx,r.get().build(i),s),this._pipeline=this.initializePipeline(i),this.reload=async n=>{n&&await r.reload(),this.key.equals(i.key)||no().warn("Configuration was changed after construction, cannot reload shader.",r),Pi(this._program),this._program=new Yi(e.rctx,r.get().build(i),s),this._pipeline=this.initializePipeline(i)}}destroy(){this._program=Pi(this._program),this._pipeline=null}get program(){return this._program}get compiled(){return this.program.compiled}ensureAttributeLocations(e){this.program.assertCompatibleVertexAttributeLocations(e)}getPipeline(e,i){return this._pipeline}initializePipeline(e){return an({blending:_r,colorWrite:on})}};function Bu(t,e){return ya(t)?{buffers:[Us]}:e??null}function ao(){return!!Cs("enable-feature:objectAndLayerId-rendering")}const Hu={func:513},ju={func:519},Uu={mask:255},qu={mask:0},Wu={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},Gu={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},Xu={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},Yu={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};function Ku(t,e){lo(t,e,new Me("slicePlaneOrigin",(i,r)=>Yr(e,i,r)),new Me("slicePlaneBasis1",(i,r)=>At(e,i,r,r.slicePlane?.basis1)),new Me("slicePlaneBasis2",(i,r)=>At(e,i,r,r.slicePlane?.basis2)))}function Zu(t,e){qr(t,e,new Me("slicePlaneOrigin",(i,r)=>Yr(e,i,r)),new Me("slicePlaneBasis1",(i,r)=>At(e,i,r,r.slicePlane?.basis1)),new Me("slicePlaneBasis2",(i,r)=>At(e,i,r,r.slicePlane?.basis2)))}const oo=v`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
bool rejectBySlice(vec3 pos) {
return sliceByPlane(pos);
}`;function qr(t,e,...i){e.hasSlicePlane?(t.uniforms.add(...i),t.code.add(oo)):t.code.add("bool rejectBySlice(vec3 pos) { return false; }")}function lo(t,e,...i){qr(t,e,...i),e.hasSlicePlane?t.code.add(`
    void discardBySlice(vec3 pos) {
      if (sliceByPlane(pos)) {
        discard;
      }
    }

    vec4 applySliceOutline(vec4 color, vec3 pos) {
      SliceFactors factors = calculateSliceFactors(pos);

      factors.front /= 2.0 * fwidth(factors.front);
      factors.side0 /= 2.0 * fwidth(factors.side0);
      factors.side1 /= 2.0 * fwidth(factors.side1);
      factors.side2 /= 2.0 * fwidth(factors.side2);
      factors.side3 /= 2.0 * fwidth(factors.side3);

      // return after calling fwidth, to avoid aliasing caused by discontinuities in the input to fwidth
      if (sliceByFactors(factors)) {
        return color;
      }

      float outlineFactor = (1.0 - step(0.5, factors.front))
        * (1.0 - step(0.5, factors.side0))
        * (1.0 - step(0.5, factors.side1))
        * (1.0 - step(0.5, factors.side2))
        * (1.0 - step(0.5, factors.side3));

      return mix(color, vec4(vec3(0.0), color.a), outlineFactor * 0.3);
    }

    vec4 applySlice(vec4 color, vec3 pos) {
      return sliceEnabled() ? applySliceOutline(color, pos) : color;
    }
  `):t.code.add(v`void discardBySlice(vec3 pos) { }
vec4 applySlice(vec4 color, vec3 pos) { return color; }`)}function Wr(t,e,i){return t.instancedDoublePrecision?k(co,i.camera.viewInverseTransposeMatrix[3],i.camera.viewInverseTransposeMatrix[7],i.camera.viewInverseTransposeMatrix[11]):e.slicePlaneLocalOrigin}function Gr(t,e){return t!=null?Se(Ot,e.origin,t):e.origin}function Xr(t,e,i){return t.hasSliceTranslatedView?e!=null?Tt(uo,i.camera.viewMatrix,e):i.camera.viewMatrix:null}function Yr(t,e,i){if(i.slicePlane==null)return et;const r=Wr(t,e,i),s=Gr(r,i.slicePlane),n=Xr(t,r,i);return n!=null?ge(Ot,s,n):s}function At(t,e,i,r){if(r==null||i.slicePlane==null)return et;const s=Wr(t,e,i),n=Gr(s,i.slicePlane),a=Xr(t,s,i);return a!=null?(ae(Ge,r,n),ge(Ot,n,a),ge(Ge,Ge,a),Se(Ge,Ge,Ot)):r}const co=g(),Ot=g(),Ge=g(),uo=X();let $i=class extends j{constructor(e,i,r){super(e,"vec2",0,(s,n)=>s.setUniform2fv(e,i(n),r))}};function Qu(t){t.vertex.uniforms.add(new $i("nearFar",e=>e.camera.nearFar))}function ho(t){t.vertex.code.add(v`float calculateLinearDepth(vec2 nearFar,float z) {
return (-z - nearFar[0]) / (nearFar[1] - nearFar[0]);
}`)}function eh(t){ho(t),t.vertex.code.add(v`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = calculateLinearDepth(nearFar,eye.z);
return proj * eye;
}`),t.vertex.code.add(v`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}function Ft(t){t.code.add(v`struct MaskedColor {
vec4 color;
bvec4 mask;
};`)}function th(t){t.include(Ft),t.code.add(v`
    MaskedColor createMaskedFromUInt8NaNColor(vec4 color) {
      return MaskedColor(color * ${v.float(1/254)}, equal(color, vec4(255)));
    }
  `)}function fo(t){t.include(Ft),t.code.add(v`vec4 maskedColorSelectOrOne(MaskedColor color) {
return vec4(
color.mask.r ? 1.0 : color.color.r,
color.mask.g ? 1.0 : color.color.g,
color.mask.b ? 1.0 : color.color.b,
color.mask.a ? 1.0 : color.color.a
);
}
MaskedColor multiplyMaskedColors(MaskedColor color1, MaskedColor color2) {
vec4 masked1 = maskedColorSelectOrOne(color1);
vec4 masked2 = maskedColorSelectOrOne(color2);
return MaskedColor(masked1 * masked2, bvec4(ivec4(color1.mask) & ivec4(color2.mask)));
}`)}function po(t){t.include(Ft),t.code.add(v`MaskedColor createMaskedFromNaNColor(vec4 color) {
return MaskedColor(color, isnan(color));
}`)}let mo=class extends j{constructor(e,i,r){super(e,"vec3",0,(s,n)=>s.setUniform3fv(e,i(n),r))}},bt=class extends j{constructor(e,i,r){super(e,"mat4",0,(s,n)=>s.setUniformMatrix4fv(e,i(n),r))}},vo=class extends j{constructor(e,i,r){super(e,"mat4",2,(s,n,a)=>s.setUniformMatrix4fv(e,i(n,a),r))}};function go(t,e){e.instancedDoublePrecision?t.constants.add("cameraPosition","vec3",et):t.uniforms.add(new Me("cameraPosition",(i,r)=>k(Kr,r.camera.viewInverseTransposeMatrix[3]-i.origin[0],r.camera.viewInverseTransposeMatrix[7]-i.origin[1],r.camera.viewInverseTransposeMatrix[11]-i.origin[2])))}function nh(t,e){if(!e.instancedDoublePrecision)return void t.uniforms.add(new bt("proj",r=>r.camera.projectionMatrix),new vo("view",(r,s)=>Tt(Ki,s.camera.viewMatrix,r.origin)),new Me("localOrigin",r=>r.origin));const i=({camera:r})=>k(Kr,r.viewInverseTransposeMatrix[3],r.viewInverseTransposeMatrix[7],r.viewInverseTransposeMatrix[11]);t.uniforms.add(new bt("proj",r=>r.camera.projectionMatrix),new bt("view",r=>Tt(Ki,r.camera.viewMatrix,i(r))),new mo("localOrigin",r=>i(r)))}const Ki=X(),Kr=g();function ah(t){t.uniforms.add(new bt("viewNormal",e=>e.camera.viewInverseTransposeMatrix))}function oh(t){t.uniforms.add(new ro("pixelRatio",e=>e.camera.pixelRatio/e.overlayStretch))}function lh(t,e,i){for(let r=0;r<i;++r)e[2*r]=t[r],e[2*r+1]=t[r]-e[2*r]}function ch(t,e){const i=t.length;for(let r=0;r<i;++r)Ue[0]=t[r],e[r]=Ue[0];return e}function uh(t,e){const i=t.length;for(let r=0;r<i;++r)Ue[0]=t[r],Ue[1]=t[r]-Ue[0],e[r]=Ue[1];return e}const Ue=new Float32Array(2);let hh=class extends j{constructor(e,i){super(e,"int",1,(r,s,n)=>r.setUniform1i(e,i(s,n)))}};function _o(t,e){switch(e.textureCoordinateType){case 1:return t.attributes.add("uv0","vec2"),t.varyings.add("vuv0","vec2"),void t.vertex.code.add(v`void forwardTextureCoordinates() { vuv0 = uv0; }`);case 2:return t.attributes.add("uv0","vec2"),t.attributes.add("uvRegion","vec4"),t.varyings.add("vuv0","vec2"),t.varyings.add("vuvRegion","vec4"),void t.vertex.code.add(v`void forwardTextureCoordinates() {
vuv0 = uv0;
vuvRegion = uvRegion;
}`);default:Ps(e.textureCoordinateType);case 0:return void t.vertex.code.add(v`void forwardTextureCoordinates() {}`);case 3:return}}function dh(t,e){e.hasVertexColors?(t.attributes.add("color","vec4"),t.varyings.add("vColor","vec4"),t.vertex.code.add(v`void forwardVertexColor() { vColor = color; }`),t.vertex.code.add(v`
      void forwardNormalizedVertexColor() { vColor = color * ${v.float(1/255)}; }
    `)):t.vertex.code.add(v`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}function yo(t){t.vertex.code.add(v`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`),t.vertex.code.add(v`vec3 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec3 params) {
return vec3(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z
);
}`),t.vertex.code.add(v`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec3 factor) {
return size * clamp(mix(factor.x, 1.0, factor.y), factor.z, 1.0);
}`),t.vertex.code.add(v`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec3 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`),t.vertex.code.add(v`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec3 factor) {
return size * clamp(mix(factor.x, 1.0, factor.y), factor.z, 1.0);
}`),t.vertex.code.add(v`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec3 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)}function ph(t){t.uniforms.add(new xe("screenSizePerspective",e=>Zr(e.screenSizePerspective,e.screenSizePerspectiveMinPixelReferenceSize)))}function xo(t){t.uniforms.add(new xe("screenSizePerspectiveAlignment",e=>Zr(e.screenSizePerspectiveAlignment||e.screenSizePerspective,e.screenSizePerspectiveAlignment?null:e.screenSizePerspectiveMinPixelReferenceSize)))}function Zr(t,e){const i=e!=null&&t!=null?Math.min(t.minPixelSize/e,1):0;return t?k(Zi,t.divisor,t.offset,i):k(Zi,0,0,0)}const Zi=g();let Jr=class extends j{constructor(e,i,r){super(e,"vec4",1,(s,n,a)=>s.setUniform4fv(e,i(n,a),r))}},vh=class{constructor(e){this.screenLength=zs(e.screenLength),this.minWorldLength=e.minWorldLength??0,this.maxWorldLength=e.maxWorldLength??1/0}};function _h(t,e){const i=t.vertex;e.hasVerticalOffset?(bo(i),e.hasScreenSizePerspective&&(t.include(yo),xo(i),go(t.vertex,e)),i.code.add(v`
      vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
        ${e.spherical?v`vec3 worldNormal = normalize(worldPos + localOrigin);`:v`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
        ${e.hasScreenSizePerspective?v`
            float cosAngle = dot(worldNormal, normalize(worldPos - cameraPosition));
            float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:v`
            float verticalOffsetScreenHeight = verticalOffset.x;`}
        // Screen sized offset in world space, used for example for line callouts
        float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
        return worldNormal * worldOffset;
      }

      vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        return worldPos + calculateVerticalOffset(worldPos, localOrigin);
      }
    `)):i.code.add(v`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}const $o=Re();function bo(t){t.uniforms.add(new Jr("verticalOffset",(e,i)=>{const{minWorldLength:r,maxWorldLength:s,screenLength:n}=e.verticalOffset,a=Math.tan(.5*i.camera.fovY)/(.5*i.camera.fullViewport[3]),o=i.camera.pixelRatio||1;return Ct($o,n*o,a,r,s)}))}function yh(t,e){if(e.output!==10)return t.vertex.code.add(v`void forwardObjectAndLayerIdColor() {}`),void t.fragment.code.add(v`void outputObjectAndLayerIdColor() {}`);const i=e.instanced;t.varyings.add("objectAndLayerIdColorVarying","vec4");const r=i?"instanceOlidColor":"olidColor";t.attributes.add(r,"vec4"),t.vertex.code.add(v`
    void forwardObjectAndLayerIdColor() {
      objectAndLayerIdColorVarying = ${r} * 0.003921568627451;
    }`),t.fragment.code.add(v`void outputObjectAndLayerIdColor() {
fragColor = objectAndLayerIdColorVarying;
}`)}function wo(t){const{fragment:e}=t;e.code.add(v`uint readChannelBits(uint channel, int highlightLevel) {
int llc = (highlightLevel & 3) << 1;
return (channel >> llc) & 3u;
}
uint readChannel(uvec2 texel, int highlightLevel) {
int lic = (highlightLevel >> 2) & 1;
return texel[lic];
}
uint readLevelBits(uvec2 texel, int highlightLevel) {
return readChannelBits(readChannel(texel, highlightLevel), highlightLevel);
}`)}let So=class extends j{constructor(e,i){super(e,"ivec2",0,(r,s)=>r.setUniform2iv(e,i(s)))}},Mo=class extends j{constructor(e,i){super(e,"int",0,(r,s)=>r.setUniform1i(e,i(s)))}},Qr=class extends j{constructor(e,i){super(e,"sampler2D",0,(r,s)=>r.bindTexture(e,i(s)))}},To=class extends j{constructor(e,i){super(e,"usampler2D",0,(r,s)=>r.bindTexture(e,i(s)))}};function Co(t,e){const{fragment:i}=t,{output:r,draped:s,hasHighlightMixTexture:n}=e;r===9?(i.uniforms.add(new Mo("highlightLevel",a=>a.highlightLevel??0),new So("highlightMixOrigin",a=>a.highlightMixOrigin)),t.outputs.add("fragHighlight","uvec2",0),t.include(wo),n?i.uniforms.add(new To("highlightMixTexture",a=>a.highlightMixTexture)).code.add(v`uvec2 getAccumulatedHighlight() {
return texelFetch(highlightMixTexture, ivec2(gl_FragCoord.xy) - highlightMixOrigin, 0).rg;
}
void outputHighlight(bool occluded) {
if (highlightLevel == 0) {
uint bits = occluded ? 3u : 1u;
fragHighlight = uvec2(bits, 0);
} else {
int ll = (highlightLevel & 3) << 1;
int li = (highlightLevel >> 2) & 3;
uint bits;
if (occluded) {
bits = 3u << ll;
} else {
bits = 1u << ll;
}
uvec2 combinedHighlight = getAccumulatedHighlight();
combinedHighlight[li] |= bits;
fragHighlight = combinedHighlight;
}
}`):i.code.add(v`void outputHighlight(bool occluded) {
uint bits = occluded ? 3u : 1u;
fragHighlight = uvec2(bits, 0);
}`),s?i.code.add(v`bool isHighlightOccluded() {
return false;
}`):i.uniforms.add(new Qr("depthTexture",a=>a.mainDepth)).code.add(v`bool isHighlightOccluded() {
float sceneDepth = texelFetch(depthTexture, ivec2(gl_FragCoord.xy), 0).x;
return gl_FragCoord.z > sceneDepth + 5e-7;
}`),i.code.add(v`void calculateOcclusionAndOutputHighlight() {
outputHighlight(isHighlightOccluded());
}`)):i.code.add(v`void calculateOcclusionAndOutputHighlight() {}`)}let Po=class extends j{constructor(e,i,r,s){super(e,"vec4",1,(n,a,o)=>n.setUniform4fv(e,i(a,o),s),r)}},zo=class extends j{constructor(e,i,r,s){super(e,"float",1,(n,a,o)=>n.setUniform1fv(e,i(a,o),s),r)}},bi=class{constructor(e){this.field=e}},Ao=class extends bi{constructor(e){super(e),this.minSize=[0,0,0],this.maxSize=[0,0,0],this.offset=[0,0,0],this.factor=[0,0,0],this.type=[0,0,0],this.fallback=[0,0,0]}},Ji=class extends bi{constructor(e){super(e),this.colors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.values=[0,0,0,0,0,0,0,0],this.fallback=[0,0,0,0]}};class Oo extends bi{constructor(e,i=0){super(e),this.fallback=i,this.values=[0,0,0,0,0,0,0,0],this.opacityValues=[0,0,0,0,0,0,0,0]}}class Eo{}function Xe(t){return t!=null}function Io(t,e,i,r=X()){const s=t||0,n=e||0,a=i||0;return s!==0&&hn(r,r,-s/180*Math.PI),n!==0&&$r(r,r,n/180*Math.PI),a!==0&&fn(r,r,a/180*Math.PI),r}function Ce(t,e,i,r,s){const n=t.minSize,a=t.maxSize;if(t.useSymbolValue){const o=r.symbolSize[i];return e.minSize[i]=o,e.maxSize[i]=o,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=1,!0}if(Xe(t.field))return Xe(t.stops)?t.stops.length===2&&Ve(t.stops[0].size)&&Ve(t.stops[1].size)?(Qi(t.stops[0].size,t.stops[1].size,t.stops[0].value,t.stops[1].value,e,i),e.type[i]=1,!0):!1:Ve(n)&&Ve(a)&&Xe(t.minDataValue)&&Xe(t.maxDataValue)?(Qi(n,a,t.minDataValue,t.maxDataValue,e,i),e.type[i]=1,!0):t.valueUnit==="unknown"?!1:ki[t.valueUnit]!=null?(e.minSize[i]=-1/0,e.maxSize[i]=1/0,e.offset[i]=0,e.factor[i]=1/ki[t.valueUnit],e.type[i]=1,!0):!1;if(!Xe(t.field)){if(t.stops?.[0]&&Ve(t.stops[0].size))return e.minSize[i]=t.stops[0].size,e.maxSize[i]=t.stops[0].size,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=1,!0;if(Ve(n))return e.minSize[i]=n,e.maxSize[i]=n,e.offset[i]=n,e.factor[i]=0,e.type[i]=1,!0}return!1}function Qi(t,e,i,r,s,n){const a=Math.abs(r-i)>0?(e-t)/(r-i):0;s.minSize[n]=a>0?t:e,s.maxSize[n]=a>0?e:t,s.offset[n]=t-i*a,s.factor[n]=a}function Ro(t,e,i,r){if(t.normalizationField||t.valueRepresentation||!Os(t.field))return null;if(e.size){if(t.field)if(e.size.field){if(t.field!==e.size.field)return null}else e.size.field=t.field}else e.size=new Ao(t.field),U(e.size.fallback,i.fallbackSize);let s;switch(t.axis){case"width":return s=Ce(t,e.size,0,i),s?e:null;case"height":return s=Ce(t,e.size,2,i),s?e:null;case"depth":return s=Ce(t,e.size,1,i),s?e:null;case"width-and-depth":return s=Ce(t,e.size,0,i),s&&Ce(t,e.size,1,i),s?e:null;case null:case void 0:case"all":return s=Ce(t,e.size,0,i),s=s&&Ce(t,e.size,1,i),s=s&&Ce(t,e.size,2,i),s?e:null;default:return`${t.axis}`,null}}function Fo(t,e,i){for(let s=0;s<3;++s){let n=e.unitInMeters;t.type[s]===1&&(n*=e.modelSize[s],t.type[s]=2),t.minSize[s]=t.minSize[s]/n,t.maxSize[s]=t.maxSize[s]/n,t.offset[s]=t.offset[s]/n,t.factor[s]=t.factor[s]/n}let r;if(t.type[0]!==0)r=0;else if(t.type[1]!==0)r=1;else{if(t.type[2]===0)return!1;r=2}for(let s=0;s<3;++s)t.type[s]===0&&(t.minSize[s]=t.minSize[r],t.maxSize[s]=t.maxSize[r],t.offset[s]=t.offset[r],t.factor[s]=t.factor[r],t.type[s]=t.type[r]);return!0}function er(t,e,i){t[4*e]=i.r/255,t[4*e+1]=i.g/255,t[4*e+2]=i.b/255,t[4*e+3]=i.a}function Do(t,e,i,r){if(t.normalizationField)return null;if(vi(t.field)){if(!t.stops)return null;{if(t.stops.length>8)return null;e.color=new Ji(t.field);const s=t.stops;for(let n=0;n<8;++n){const a=s[Math.min(n,s.length-1)];e.color.values[n]=a.value,er(e.color.colors,n,a.color)}He(e.color.fallback,i.fallbackColor)}}else{if(!(t.stops&&t.stops.length>=0))return null;{const s=t.stops&&t.stops.length>=0&&t.stops[0].color;e.color=new Ji(null);for(let n=0;n<8;n++)e.color.values[n]=1/0,er(e.color.colors,n,s);He(e.color.fallback,i.fallbackColor)}}return e}function Lo(t,e,i,r){if(t.normalizationField)return null;if(vi(t.field)){if(!t.stops)return null;{if(t.stops.length>8)return null;e.opacity=new Oo(t.field,i.fallbackColor[3]);const s=t.stops;for(let n=0;n<8;++n){const a=s[Math.min(n,s.length-1)];e.opacity.values[n]=a.value,e.opacity.opacityValues[n]=a.opacity}}}else{if(!(t.stops&&t.stops.length>=0))return null;{const s=t.stops&&t.stops.length>=0?t.stops[0].opacity:0;e.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0],fallback:i.fallbackColor[3]};for(let n=0;n<8;n++)e.opacity.values[n]=1/0,e.opacity.opacityValues[n]=s}}return e}function jt(t,e,i){const r=i===2&&t.rotationType==="arithmetic";e.offset[i]=r?90:0,e.factor[i]=r?-1:1,e.type[i]=1}function Vo(t,e,i){if(!vi(t.field))return null;if(e.rotation){if(t.field)if(e.rotation.field){if(t.field!==e.rotation.field)return null}else e.rotation.field=t.field}else e.rotation={field:t.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(t.axis){case"tilt":return jt(t,e.rotation,0),e;case"roll":return jt(t,e.rotation,1),e;case null:case void 0:case"heading":return jt(t,e.rotation,2),e;default:return`${t.axis}`,null}}class zh{constructor({supports:e,modelSize:i,symbolSize:r,unitInMeters:s,anchor:n,scale:a,rotation:o,fallbackColor:l,fallbackSize:u}){this.supports=e,this.modelSize=i??nt(),this.symbolSize=r??nt(),this.unitInMeters=s??1,this.anchor=n??tt(),this.scale=a??nt(),this.rotation=o??tt(),this.fallbackColor=l??xn(),this.fallbackSize=u??nt()}}function es(t,e,i){if(!t)return null;const r=t.reduce((s,n)=>{if(!s)return s;if(n.valueExpression)return null;switch(n.type){case"size":return e.supports.size?Ro(n,s,e,i):s;case"color":return e.supports.color?Do(n,s,e):s;case"opacity":return e.supports.opacity?Lo(n,s,e):null;case"rotation":return e.supports.rotation?Vo(n,s,i):s;default:return null}},new Eo);return!(t.length>0&&r)||r.size||r.color||r.opacity||r.rotation?r?.size&&!Fo(r.size,e)?null:r:null}class ko{constructor(e,i,r){this.visualVariables=e,this.materialParameters=i,this.requiresShaderTransformation=r}}function Ah(t,e){if(!t||ao()||jn.TESTS_DISABLE_FAST_UPDATES)return null;const i=es(t.visualVariables,e);return i?new ko(i,is(i,e),!!i.size):null}function Oh(t,e,i){if(!e||!t)return!1;const r=t.visualVariables,s=es(e.visualVariables,i);return!!s&&!!(ft(r.size,s.size,"size")&&ft(r.color,s.color,"color")&&ft(r.rotation,s.rotation,"rotation")&&ft(r.opacity,s.opacity,"opacity"))&&(t.visualVariables=s,t.materialParameters=is(s,i),t.requiresShaderTransformation=!!s.size,!0)}function ft(t,e,i){if(!!t!=!!e||t&&t.field!==e?.field)return!1;if(t&&i==="rotation"){const r=t,s=e;for(let n=0;n<3;n++)if(r.type[n]!==s.type[n]||r.offset[n]!==s.offset[n]||r.factor[n]!==s.factor[n])return!1}return!0}class ts extends Rt{constructor(e){super(),this.vvSize=e?.size??null,this.vvColor=e?.color??null,this.vvOpacity=e?.opacity??null}get hasVVSize(){return!!this.vvSize}get hasVVColor(){return!!this.vvColor}get hasVVOpacity(){return!!this.vvOpacity}}function is(t,e){const i=new ts(t);return i.vvSize&&(i.vvSymbolAnchor=e.anchor,un(Qe),Io(e.rotation[2],e.rotation[0],e.rotation[1],Qe),i.vvSymbolRotationMatrix=i.vvSymbolRotationMatrix||cr(),As(i.vvSymbolRotationMatrix,Qe)),i}function Eh(t,e,i){if(!t.vvSize)return i;qe(Pe,i);const r=t.vvSymbolRotationMatrix;return ln(Qe,r[0],r[1],r[2],0,r[3],r[4],r[5],0,r[6],r[7],r[8],0,0,0,0,1),Mt(Pe,Pe,Qe),No(tr,t,e),cn(Pe,Pe,tr),Tt(Pe,Pe,t.vvSymbolAnchor),Pe}function No(t,e,i){if(!e.vvSize)return k(t,1,1,1),t;if(Number.isNaN(i[0]))return U(t,e.vvSize.fallback);for(let r=0;r<3;++r){const s=e.vvSize.offset[r]+i[0]*e.vvSize.factor[r];t[r]=rt(s,e.vvSize.minSize[r],e.vvSize.maxSize[r])}return t}function Ih(t,e){const i=t==null?0:e.attributes[t];return typeof i=="number"&&isFinite(i)?i:NaN}const Pe=X(),tr=g(),Qe=X();let Rh=class extends ts{constructor(){super(...arguments),this.renderOccluded=1,this.isDecoration=!1}};const Ut=8;function Dh(t,e){const{vertex:i,attributes:r}=t;e.hasVVInstancing&&(e.hasVVSize||e.hasVVColor)&&r.add("instanceFeatureAttribute","vec4"),e.hasVVSize?(i.uniforms.add(new xe("vvSizeMinSize",s=>s.vvSize.minSize)),i.uniforms.add(new xe("vvSizeMaxSize",s=>s.vvSize.maxSize)),i.uniforms.add(new xe("vvSizeOffset",s=>s.vvSize.offset)),i.uniforms.add(new xe("vvSizeFactor",s=>s.vvSize.factor)),i.uniforms.add(new xe("vvSizeFallback",s=>s.vvSize.fallback)),i.uniforms.add(new so("vvSymbolRotationMatrix",s=>s.vvSymbolRotationMatrix)),i.uniforms.add(new xe("vvSymbolAnchor",s=>s.vvSymbolAnchor)),i.code.add(v`vec3 vvScale(vec4 _featureAttribute) {
if (isnan(_featureAttribute.x)) {
return vvSizeFallback;
}
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),i.code.add(v`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 scale = max(vvScale(_featureAttribute), eps);
        return vec4(vvSymbolRotationMatrix * _normal / scale, 1.0);
      }

      ${e.hasVVInstancing?v`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):i.code.add(v`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),t.vertex.include(Ft),e.hasVVColor?(i.constants.add("vvColorNumber","int",Ut),i.uniforms.add(new zo("vvColorValues",s=>s.vvColor.values,Ut),new Po("vvColorColors",s=>s.vvColor.colors,Ut),new Jr("vvColorFallback",s=>s.vvColor.fallback,{supportsNaN:!0})),e.hasVVInstancing&&(t.vertex.include(fo),t.vertex.include(po)),i.code.add(v`
      vec4 interpolateVVColor(float value) {
        if (isnan(value)) {
          return vvColorFallback;
        }

        if (value <= vvColorValues[0]) {
          return vvColorColors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (vvColorValues[i] >= value) {
            float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);
            return mix(vvColorColors[i-1], vvColorColors[i], f);
          }
        }
        return vvColorColors[vvColorNumber - 1];
      }

      vec4 vvGetColor(vec4 featureAttribute) {
        return interpolateVVColor(featureAttribute.y);
      }

      ${e.hasVVInstancing?v`
            vec4 vvColor() {
              return vvGetColor(instanceFeatureAttribute);
            }

            MaskedColor applyVVColor(MaskedColor color) {
              return multiplyMaskedColors(color, createMaskedFromNaNColor(vvColor()));
            }
            `:v`
            vec4 vvColor() {
              return vec4(1.0);
            }

            MaskedColor applyVVColor(MaskedColor color) {
              return color;
            }
            `}
    `)):i.code.add(v`vec4 vvColor() {
return vec4(1.0);
}
MaskedColor applyVVColor(MaskedColor color) {
return color;
}`)}let Bo=class extends j{constructor(e,i,r){super(e,"float",2,(s,n,a)=>s.setUniform1f(e,i(n,a),r))}},Ho=class extends j{constructor(e,i,r){super(e,"float",1,(s,n,a)=>s.setUniform1f(e,i(n,a),r))}};const jo=1/255.5;let Uo=class extends j{constructor(e,i){super(e,"sampler2D",1,(r,s,n)=>r.bindTexture(e,i(s,n)))}};function qo(t){t.fragment.code.add(v`vec4 textureAtlasLookup(sampler2D tex, vec2 textureCoordinates, vec4 atlasRegion) {
vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;
vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;
float maxdUV = 0.125;
vec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
vec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
return textureGrad(tex, uvAtlas, dUVdx, dUVdy);
}`)}function Wo(t,e){const{textureCoordinateType:i}=e;if(i===0||i===3)return;t.include(_o,e);const r=i===2;r&&t.include(qo),t.fragment.code.add(v`
    vec4 textureLookup(sampler2D tex, vec2 uv) {
      return ${r?"textureAtlasLookup(tex, uv, vuvRegion)":"texture(tex, uv)"};
    }
  `)}let Nh=class extends j{constructor(e,i,r){super(e,"vec2",1,(s,n,a)=>s.setUniform2fv(e,i(n,a),r))}},Go=class extends j{constructor(e,i){super(e,"sampler2D",2,(r,s,n)=>r.bindTexture(e,i(s,n)))}};function Xo(t,e,i){return 2*Math.atan(Math.sqrt(e*e+i*i)*Math.tan(.5*t)/e)}function Yo(t,e,i){return 2*Math.atan(Math.sqrt(e*e+i*i)*Math.tan(.5*t)/i)}function Ko(t,e,i){return 2*Math.atan(e*Math.tan(.5*t)/Math.sqrt(e*e+i*i))}function Zo(t,e,i){return 2*Math.atan(i*Math.tan(.5*t)/Math.sqrt(e*e+i*i))}var oi;let P=oi=class extends fi{constructor(t){super(t),this._ray=Cr(),this._viewport=Vi(0,0,1,1),this._padding=Vi(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=br(1,1e3),this._viewDirty=!0,this._viewMatrix=X(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=X(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=X(),this._frustumDirty=!0,this._frustum=wr(),this._fullViewport=Re(),this._pixelRatio=1,this.row=0,this.column=0,this._rows=1,this._columns=1,this._center=g(),this._up=g(),this.relativeElevation=0}get pixelRatio(){return this._pixelRatio}set pixelRatio(t){this._pixelRatio=t>0?t:1}get rows(){return this._rows}set rows(t){this._rows=Math.max(1,t)}get columns(){return this._columns}set columns(t){this._columns=Math.max(1,t)}get eye(){return this._ray.origin}set eye(t){this._compareAndSetView(t,this._ray.origin)}get center(){return this._center}set center(t){this._compareAndSetView(t,this._center,"_center")}get ray(){return Se(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(t){this._compareAndSetView(t,this._up,"_up")}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(t){qe(this._viewMatrix,t),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),k(g(),-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10])}get viewUp(){return this._ensureViewClean(),k(g(),this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9])}get viewRight(){return this._ensureViewClean(),k(g(),this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8])}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(t){this._nearFar[0]!==t&&(this._nearFar[0]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get far(){return this._nearFar[1]}set far(t){this._nearFar[1]!==t&&(this._nearFar[1]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get viewport(){return this._viewport}set viewport(t){this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]}get screenViewport(){if(this.pixelRatio===1)return this._viewport;const t=Fi(Re(),this._viewport,1/this.pixelRatio),e=this._get("screenViewport");return e&&Di(t,e)?e:t}get screenPadding(){if(this.pixelRatio===1)return this._padding;const t=Fi(Re(),this._padding,1/this.pixelRatio),e=this._get("screenPadding");return e&&Di(t,e)?e:t}get x(){return this._viewport[0]}set x(t){t+=this._padding[3],this._viewport[0]!==t&&(this._viewport[0]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get y(){return this._viewport[1]}set y(t){t+=this._padding[2],this._viewport[1]!==t&&(this._viewport[1]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get width(){return this._viewport[2]}set width(t){this._viewport[2]!==t&&(this._viewport[2]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get height(){return this._viewport[3]}set height(t){this._viewport[3]!==t&&(this._viewport[3]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get fullWidth(){return this._viewport[2]+this._padding[1]+this._padding[3]}set fullWidth(t){this.width=t-(this._padding[1]+this._padding[3])}get fullHeight(){return this._viewport[3]+this._padding[0]+this._padding[2]}set fullHeight(t){this.height=t-(this._padding[0]+this._padding[2])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get _aspect(){return this.width/this.height}get padding(){return this._padding}set padding(t){Bt(this._padding,t)||(this._viewport[0]+=t[3]-this._padding[3],this._viewport[1]+=t[2]-this._padding[2],this._viewport[2]-=t[1]+t[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=t[0]+t[2]-(this._padding[0]+this._padding[2]),He(this._padding,t),this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_padding"),this.notifyChange("_viewport"))}get viewProjectionMatrix(){return this._viewProjectionDirty&&(Mt(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){return this._projectionMatrixInternal}get inverseProjectionMatrix(){return $t(X(),this.projectionMatrix)||this._get("inverseProjectionMatrix")||X()}get fov(){return this._fov}set fov(t){this._fov=t,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return Ko(this._fov,this.width,this.height)}set fovX(t){this._fov=Xo(t,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return Zo(this._fov,this.width,this.height)}set fovY(t){this._fov=Yo(t,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return pr(this.center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&($t(this._viewInverseTransposeMatrix,this.viewMatrix),ni(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(t){const{near:e,far:i}=this;return 2*e*i/(i+e-t*(i-e))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this.pixelRatio}get aboveGround(){return this.relativeElevation!=null&&this.relativeElevation>=0}get _projectionMatrixInternal(){const t=this.width,e=this.height,i=this.near*Math.tan(this.fovY/2)*2,r=i*this._aspect,s=i/this.rows,n=r/this.columns,a=-r/2+this.column*n,o=a+n,l=-i/2+this.row*s,u=l+s,c=dn(X(),a*(1+2*this._padding[3]/t),o*(1+2*this._padding[1]/t),l*(1+2*this._padding[2]/e),u*(1+2*this._padding[0]/e),this.near,this.far),h=this._get("projectionMatrix");return h&&pn(h,c)?h:c}copyFrom(t){U(this._ray.origin,t.eye),this.center=t.center,this.up=t.up,He(this._viewport,t.viewport),this.notifyChange("_viewport"),He(this._padding,t.padding),this.notifyChange("_padding"),Es(this._nearFar,t.nearFar),this.notifyChange("_nearFar"),this._fov=t.fov,this.row=t.row,this.column=t.column,this.rows=t.rows,this.columns=t.columns,this.relativeElevation=t.relativeElevation;const e=t;return this._viewDirty=e._viewDirty,this._viewDirty||(qe(this._viewMatrix,t.viewMatrix),this.notifyChange("_viewMatrix")),this._viewProjectionDirty=!0,this._frustumDirty=e._frustumDirty,this._frustumDirty||($n(this._frustum,t.frustum),this._frustumDirty=!1),e._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(qe(this._viewInverseTransposeMatrix,t.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),He(this._fullViewport,t.fullViewport),this.pixelRatio=t.pixelRatio,this}copyViewFrom(t){this.eye=t.eye,this.center=t.center,this.up=t.up,this.fov=t.fov}clone(){return new oi().copyFrom(this)}equals(t){return Oe(this.eye,t.eye)&&Oe(this.center,t.center)&&Oe(this.up,t.up)&&Bt(this._viewport,t.viewport)&&Bt(this._padding,t.padding)&&Is(this.nearFar,t.nearFar)&&this._fov===t.fov&&this.pixelRatio===t.pixelRatio&&this.relativeElevation===t.relativeElevation&&this.row===t.row&&this.column===t.column&&this.rows===t.rows&&this.columns===t.columns}almostEquals(t){const e=Math.max(1,1/this.pixelRatio,1/t.pixelRatio);if(Math.abs(t.fov-this._fov)>=.001||Li(t.screenPadding,this.screenPadding)>=e||Li(this.screenViewport,t.screenViewport)>=e||this.row!==t.row||this.column!==t.column||this.rows!==t.rows||this.columns!==t.columns)return!1;ve(q,t.eye,t.center),ve(me,this.eye,this.center);const i=ue(q,me),r=Oi(q),s=Oi(me),n=5e-4;return i*i>=(1-1e-10)*r*s&&si(t.eye,this.eye)<Math.max(r,s)*n*n}computeRenderPixelSizeAt(t){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(t))}computeRenderPixelSizeAtDist(t){return t*this.perRenderPixelRatio}computeScreenPixelSizeAt(t){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(t))}_viewDirectionDistance(t){return Math.abs(On(this.viewForward,Se(q,t,this.eye)))}computeScreenPixelSizeAtDist(t){return t*this.perScreenPixelRatio}computeDistanceFromRadius(t,e){return t/Math.tan(Math.min(this.fovX,this.fovY)/(2*(e||1)))}getScreenCenter(t=Rs()){return t[0]=(this.padding[3]+this.width/2)/this.pixelRatio,t[1]=(this.padding[0]+this.height/2)/this.pixelRatio,t}getRenderCenter(t,e=.5,i=.5){return t[0]=this.padding[3]+this.width*e,t[1]=this.padding[2]+this.height*i,t[2]=.5,t}setGLViewport(t){const e=this.viewport,i=this.padding;t.setViewport(e[0]-i[3],e[1]-i[2],e[2]+i[1]+i[3],e[3]+i[0]+i[2])}applyProjection(t,e){t!==I&&U(I,t),I[3]=1,at(I,I,this.projectionMatrix);const i=Math.abs(I[3]);W(I,I,1/i);const r=this.fullViewport;e[0]=te(0,r[0]+r[2],.5+.5*I[0]),e[1]=te(0,r[1]+r[3],.5+.5*I[1]),e[2]=.5*(I[2]+1),e[3]=i}unapplyProjection(t,e){const i=this.fullViewport;I[0]=(t[0]/(i[0]+i[2])*2-1)*t[3],I[1]=(t[1]/(i[1]+i[3])*2-1)*t[3],I[2]=(2*t[2]-1)*t[3],I[3]=t[3],this.inverseProjectionMatrix!=null&&(at(I,I,this.inverseProjectionMatrix),e[0]=I[0],e[1]=I[1],e[2]=I[2])}projectToScreen(t,e){return this.projectToRenderScreen(t,qt),this.renderToScreen(qt,e),e}projectToRenderScreen(t,e){if(I[0]=t[0],I[1]=t[1],I[2]=t[2],I[3]=1,at(I,I,this.viewProjectionMatrix),I[3]===0)return null;const i=I;W(i,i,1/Math.abs(I[3]));const r=this.fullViewport,s=te(0,r[0]+r[2],.5+.5*i[0]),n=te(0,r[1]+r[3],.5+.5*i[1]);return"x"in e?(e.x=s,e.y=n):(e[0]=s,e[1]=n,e.length>2&&(e[2]=.5*(i[2]+1))),e}unprojectFromScreen(t,e){return this.unprojectFromRenderScreen(this.screenToRender(t,qt),e)}unprojectFromRenderScreen(t,e){if(Mt(dt,this.projectionMatrix,this.viewMatrix),!$t(dt,dt))return null;const i=this.fullViewport;return I[0]=2*(t[0]-i[0])/i[2]-1,I[1]=2*(t[1]-i[1])/i[3]-1,I[2]=2*t[2]-1,I[3]=1,at(I,I,dt),I[3]===0?null:(e[0]=I[0]/I[3],e[1]=I[1]/I[3],e[2]=I[2]/I[3],e)}constrainWindowSize(t,e,i,r){const s=t*this.pixelRatio,n=e*this.pixelRatio,a=Math.max(s-i/2,0),o=Math.max(this.fullHeight-n-r/2,0),l=-Math.min(s-i/2,0),u=-Math.min(this.fullHeight-n-r/2,0),c=i-l- -Math.min(this.fullWidth-s-i/2,0),h=r-u- -Math.min(n-r/2,0);return[Math.round(a),Math.round(o),Math.round(c),Math.round(h)]}computeUp(t){t===1?this._computeUpGlobal():this._computeUpLocal()}screenToRender(t,e){const i=t[0]*this.pixelRatio,r=this.fullHeight-t[1]*this.pixelRatio;return e[0]=i,e[1]=r,e}renderToScreen(t,e){const i=t[0]/this.pixelRatio,r=(this.fullHeight-t[1])/this.pixelRatio;e[0]=i,e[1]=r}_computeUpGlobal(){Se(q,this.center,this.eye);const t=Y(this.center);t<1?Oe(this._up,zi)&&(U(this._up,zi),this._markViewDirty(),this.notifyChange("_up")):Math.abs(ue(q,this.center))>.9999*Y(q)*t||(fe(me,q,this.center),fe(me,me,q),Te(me,me),Oe(this._up,me)||(U(this._up,me),this.notifyChange("_up"),this._markViewDirty()))}_computeUpLocal(){mr(q,this.eye,this.center),Math.abs(q[2])<=.9999&&(W(q,q,q[2]),k(q,-q[0],-q[1],1-q[2]),Te(q,q),Oe(this._up,q)||(U(this._up,q),this.notifyChange("_up"),this._markViewDirty()))}_compareAndSetView(t,e,i=""){typeof t[0]=="number"&&isFinite(t[0])&&typeof t[1]=="number"&&isFinite(t[1])&&typeof t[2]=="number"&&isFinite(t[2])?Oe(t,e)||(U(e,t),this._markViewDirty(),i.length&&this.notifyChange(i)):pi.getLogger("esri.views.3d.webgl-engine.lib.RenderCamera").warn("RenderCamera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(Sr(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(mn(this._viewMatrix,this.eye,this.center,this.up),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};d([p()],P.prototype,"_viewport",void 0),d([p()],P.prototype,"_padding",void 0),d([p()],P.prototype,"_fov",void 0),d([p()],P.prototype,"_nearFar",void 0),d([p()],P.prototype,"_viewDirty",void 0),d([p()],P.prototype,"_viewMatrix",void 0),d([p()],P.prototype,"_pixelRatio",void 0),d([p()],P.prototype,"pixelRatio",null),d([p()],P.prototype,"row",void 0),d([p()],P.prototype,"column",void 0),d([p()],P.prototype,"_rows",void 0),d([p()],P.prototype,"rows",null),d([p()],P.prototype,"_columns",void 0),d([p()],P.prototype,"columns",null),d([p()],P.prototype,"eye",null),d([p()],P.prototype,"center",null),d([p()],P.prototype,"_center",void 0),d([p()],P.prototype,"up",null),d([p()],P.prototype,"_up",void 0),d([p()],P.prototype,"viewMatrix",null),d([p({readOnly:!0})],P.prototype,"viewForward",null),d([p({readOnly:!0})],P.prototype,"viewUp",null),d([p({readOnly:!0})],P.prototype,"viewRight",null),d([p({readOnly:!0})],P.prototype,"nearFar",null),d([p()],P.prototype,"near",null),d([p()],P.prototype,"far",null),d([p()],P.prototype,"viewport",null),d([p({readOnly:!0})],P.prototype,"screenViewport",null),d([p({readOnly:!0})],P.prototype,"screenPadding",null),d([p()],P.prototype,"x",null),d([p()],P.prototype,"y",null),d([p()],P.prototype,"width",null),d([p()],P.prototype,"height",null),d([p()],P.prototype,"fullWidth",null),d([p()],P.prototype,"fullHeight",null),d([p({readOnly:!0})],P.prototype,"_aspect",null),d([p()],P.prototype,"padding",null),d([p({readOnly:!0})],P.prototype,"projectionMatrix",null),d([p({readOnly:!0})],P.prototype,"inverseProjectionMatrix",null),d([p()],P.prototype,"fov",null),d([p()],P.prototype,"fovX",null),d([p()],P.prototype,"fovY",null),d([p()],P.prototype,"viewInverseTransposeMatrix",null),d([p({readOnly:!0})],P.prototype,"_projectionMatrixInternal",null),d([p()],P.prototype,"relativeElevation",void 0),P=oi=d([di("esri.views.3d.webgl.RenderCamera")],P);const jh=P,I=Re(),dt=X(),q=g(),me=g(),qt=Fs();let Uh=class li{constructor(e=1/0,i=-1/0){this.near=e,this.far=i}set(e,i){this.near=e,this.far=i}union(e){e!=null&&(this.near=Math.min(this.near,e.near),this.far=Math.max(this.far,e.far))}within(e){return this.near<=e&&e<=this.far}equals(e){return this.near===e.near&&this.far===e.far}static{this.Zero=new li(0,0)}static{this.Infinite=new li}};function Jo(t,e){const i=[],r=[];return pt(i,t,e,0),pt(r,i,e,1),pt(i,r,e,2),pt(r,i,e,3),r}function pt(t,e,i,r){const s=Qo(i,r);if(t.length=0,e.length){s(mt,e[0],e[0])===1&&Ye(t,e[0]);for(let n=0;n<e.length;n++){const a=e[n===e.length-1?0:n+1];switch(s(mt,e[n],a)){case 1:Ye(t,a);break;case 3:Ye(t,Bi(mt));break;case 2:Ye(t,Bi(mt)),Ye(t,a)}}}}function Ye(t,e){t.length!==0&&Ds(t.at(-1),e)||t.push(e)}function Qo(t,e){const i=e===0||e===2?0:1,r=t[e],s=e===0||e===1?1:-1,n=i===0?1:0;return(a,o,l)=>{if(o[i]<r&&l[i]<r)return s===1?0:1;if(o[i]>r&&l[i]>r)return s===1?1:0;const u=(l[n]-o[n])/(l[i]-o[i]),c=o[n]+u*(r-o[i]);return a[i]=r,a[n]=c,(o[i]<r?1:-1)*s>0?2:3}}const mt=gi(),el=g(),vt=g();function rs(){return{direction:g(),up:g()}}function ss(t,e,i,r,s){let n=Te(el,t),a=ue(n,r);const o=a>0;a=Math.abs(a),a>.99&&(a=Math.abs(ue(e,r)),a<.99?(U(n,e),o&&W(n,n,-1)):n=null);let l=0;if(n){W(vt,r,ue(r,n)),Se(n,n,vt);const c=ue(n,s)/(Y(n)*Y(s));fe(vt,n,s),l=(ue(vt,r)>0?1:-1)*Fe(ei(c))}const u=Fe(ei(-ue(r,t)/Y(t)));return i?(i.heading=l,i.tilt=u,i):{heading:l,tilt:u}}function ns(t,e,i,r){Se(ir,i,e),Ln(r,Rn(e,ir),t)||t===i||U(t,i)}const ir=g(),as=K(0,1,0),os=K(0,0,1),Ke=X(),_e=g(),ye=g();function ls(t,e,i,r=rs()){const{direction:s,up:n}=r;return vn(Ke,-oe(e)),$r(Ke,Ke,oe(i)),ge(s,os,Ke),W(s,s,-1),ge(n,as,Ke),r}function tl(t,e,i,r){return ss(e,i,r,os,as)}function il(t,e,i,r){const s=ls(t,i,r),n=g();return W(n,s.direction,-e),ae(n,n,t),{up:s.up,eye:n,heading:i,tilt:r}}function rl(t){return Fe(t)}function sl(t){return oe(t)}function nl(t,e,i,r,s){const n=t.renderSpatialReference,a=t.spatialReference??e.spatialReference;return Hi(e,_e,n),Hi(e,ye,n),_e[0]-=i/2,ye[0]+=i/2,_e[1]-=r/2,ye[1]+=r/2,Ni(_e,n,_e,a),Ni(ye,n,ye,a),s?(s.xmin=_e[0],s.ymin=_e[1],s.xmax=ye[0],s.ymax=ye[1],s.spatialReference=a):s=new ur(_e[0],_e[1],ye[0],ye[1],a),s}function al(t,e){const i=t.frustum,{renderCoordsHelper:r}=t,s=r.getAltitude(e),n=t.spatialReference,a=t.state.camera.eye,o=[],l=i.planes[5];for(let u=0;u<4;u++){const c=i.lines[u];r.intersectInfiniteManifold(Pr(c.origin,c.direction),s,he)||ol(he,i,r,c.endpoint,s),ns(he,a,he,l),o.push(br(he[0],he[1]))}return ll(Jo(o,r.extent),r,n)}function ol(t,e,i,r,s){const n=e.lines[11].direction,a=(s-i.getAltitude(r))/n[2];we(t,r,n,a)}function ll(t,e,i){const r=t.map(s=>(k(he,s[0],s[1],0),e.fromRenderCoords(he,he,i),[he[0],he[1]]));return r.length<=2?new ti({spatialReference:i}):(r.push(r[0].slice()),hr(r)||r.reverse(),new ti({rings:[r],spatialReference:i}))}const he=g();Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:tl,eyeForCenterWithHeadingTilt:il,eyeTiltToLookAtTilt:sl,headingTiltToDirectionUp:ls,lookAtTiltToEyeTilt:rl,toArea:al,toExtent:nl},Symbol.toStringTag,{value:"Module"}));let cl=class{get planes(){return this.frustum}get points(){return this._points}get mutablePoints(){return this._points}get direction(){return this._direction}get origin(){return this._origin}constructor(e){this.renderCoordsHelper=e,this.frustum=wr(),this._points=bn(),this.lines=new Array(12),this._origin=g(),this._direction=g(),this._altitude=null;for(let i=0;i<12;i++)this.lines[i]={origin:null,direction:g(),endpoint:null}}update(e){Sr(e.viewMatrix,e.projectionMatrix,this.frustum,this._points),U(this._origin,e.eye),U(this._direction,e.viewForward),this._altitude=this.renderCoordsHelper.getAltitude(this._origin),this._updateLines()}updatePoints(e){for(let i=0;i<this._points.length;i++)U(this._points[i],e[i]);wn(this.frustum,this._points),this._updateLines()}get altitude(){return this._altitude}intersectsSphere(e){return Sn(this.frustum,e)}intersectsRay(e){return Mn(this.frustum,e)}intersectsLineSegment(e,i){return Tn(this.frustum,e,i)}intersectsPoint(e){return Cn(this.frustum,e)}_updateLines(){const e=this._points;for(let i=0;i<4;i++){const r=i+4;Wt(this.lines[i],e[i],e[r]),Wt(this.lines[i+4],e[i],i===3?e[0]:e[i+1]),Wt(this.lines[i+8],e[r],i===3?e[4]:e[r+1])}}static{this.planePointIndices=Pn}static{this.nearFarLineIndices=[[0,4],[1,5],[2,6],[3,7]]}};function Wt(t,e,i){t.origin=e,t.endpoint=i,mr(t.direction,e,i)}const Gt=K(parseFloat(5802e-9.toFixed(6)),parseFloat(13558e-9.toFixed(6)),parseFloat(331e-7.toFixed(6))),Xt=3,Yt=K(Xt*parseFloat(65e-8.toFixed(6)),Xt*parseFloat(1881e-9.toFixed(6)),Xt*parseFloat(85e-9.toFixed(6)));K(parseFloat(Number(Gt[0]+Yt[0]).toFixed(6)),parseFloat(Number(Gt[1]+Yt[1]).toFixed(6)),parseFloat(Number(Gt[2]+Yt[2]).toFixed(6)));const ul=2;It();Cr();function hl(t,e,i){t.worldUpAtPosition(e,rr),Se(Kt,i,e);const r=Y(Kt);return r===0?0:ei(ue(Kt,rr)/r)}const rr=g(),Kt=g();function fl(t,e,i){const r=e/i,s=oe(t),n=Math.sin(r/2),a=Math.cos(s),o=2*Et(Math.sqrt(n*n/(a*a)));return Fe(o)}const cs=K(0,0,1),us=Te(g(),K(1,1,1)),Ze=X(),ze=g(),ke=g();function hs(t,e,i,r=rs()){fe(ze,t,cs),ue(ze,ze)===0&&fe(ze,t,us),gn(Ze,-oe(e),t),_n(Ze,Ze,-oe(i),ze);const{up:s,direction:n}=r;return fe(s,ze,t),Te(s,s),ge(s,s,Ze),Te(n,t),vr(n,n),ge(n,n,Ze),r}function dl(t,e,i,r){const s=ze,n=ke;return Te(s,t),fe(ke,s,cs),ue(ke,ke)===0&&fe(ke,s,us),fe(n,ke,s),ss(e,i,r,s,n)}function pl(t,e,i,r){const s={eye:g(),up:null,tilt:r,heading:i},n=ze;n[0]=t[0],n[1]=t[2],n[2]=-t[1];const a=e,o=oe(i),l=oe(r),u=Math.sin(o),c=Math.cos(o),h=Math.sin(l),m=Math.cos(l),_=Y(n);let f;if(Math.abs(l)<1e-8)f=a+_;else{const V=_/h,N=Et(a/V),Z=Math.PI-l-N;f=V*Math.sin(Z)}const b=m*a,$=a*a*(h*h),z=c*c*$,A=f-b,C=A*A,O=z*(z+C-n[1]*n[1]);if(O<0)return W(s.eye,n,f/_),s.tilt=0,gt(s,t);const R=Math.sqrt(O),D=n[1]*A,T=z+C;let w;if(w=c>0?-R+D:R+D,Math.abs(T)<1e-8)return _<1e-8?(s.eye[0]=0,s.eye[1]=0,s.eye[2]=a):W(s.eye,n,f/_),s.tilt=0,Zt(s.eye),gt(s,t);s.eye[1]=w/T;const x=u*u*$,E=h*a,y=c*E*s.eye[1],S=s.eye[1]*s.eye[1],M=1-S,F=Math.sqrt(M),L=z*S+x-2*y*F*A+M*C;return Math.abs(L)<1e-8?(W(s.eye,n,f/_),s.tilt=0,Zt(s.eye),gt(s,t)):(s.eye[0]=(M*(f*n[0]-b*n[0])-E*F*(n[0]*s.eye[1]*c+n[2]*u))/L,s.eye[2]=(M*(f*n[2]-b*n[2])-E*F*(n[2]*s.eye[1]*c-n[0]*u))/L,W(s.eye,s.eye,f),Zt(s.eye),gt(s,t))}function Zt(t){const e=t[1];t[1]=-t[2],t[2]=e}function gt(t,e){const i=hs(e,t.heading,t.tilt);return t.up=i.up,t}function ml(t,e,i){const r=Y(e),s=Math.sqrt(i*i+r*r-2*i*r*Math.cos(Math.PI-t)),n=Et(i/(s/Math.sin(t)));return Fe(t-n)}function vl(t,e,i){const r=oe(t),s=Y(e);return Et(i/(s/Math.sin(r)))+r}function gl(t,e,i,r,s){let n,a,o,l;const u=e.latitude,c=Ls(t.spatialReference).radius,h=e.longitude,m=fl(u,i,c)/2;n=h-m,a=h+m;const _=oe(u),f=(1+Math.sin(_))/(1-Math.sin(_)),b=(f+1)*Math.tan(r/c/2),$=b*b;function z(C){const O=Math.PI/2;return(C=Bn.normalize(C,-O))>O&&(C=Math.PI-C),C}if(o=1.5*Math.PI-2*Math.atan(.5*(b+Math.sqrt(4*f+$))),l=o+r/c,o=z(o),l=z(l),l<o){const C=l;l=o,o=C}if(o=Math.max(Fe(o),-90),l=Math.min(Fe(l),90),a=Hn.monotonic(n,a),a-n>180){const C=(a-n-180)/2;n+=C,a-=C}const A=t.spatialReference&&t.spatialReference.isGeographic?t.spatialReference:Vs.WGS84;return s?(s.xmin=n,s.ymin=o,s.xmax=a,s.ymax=l,s.spatialReference=A):s=new ur(n,o,a,l,A),t.spatialReference&&t.spatialReference.isWebMercator&&ks(s,!1,s),s}function _l(t,e){const{renderCoordsHelper:i}=t,r=t.state.camera.clone(),s=new cl(i);r.near=ul,s.update(r);const n=i.getAltitude(e),a=t.spatialReference,o=i.referenceEllipsoid.radius,l=r.eye,u=1+pr(l,e)/(o+n),c=Math.sqrt(u*u-1),{minCurvature:h,maxCurvature:m,minSamples:_,maxSamples:f}=bl,b=$l(t),$=rt((c-h)/(m-h),0,1),z=Math.round(te(_,f,$)),A=r.aboveGround,C=s.planes[5],O=[],R=ji(et,wl,Ui()),D=ji(et,Sl,Ui());Ct(Jt,0,0,0,0);const T=x=>{};for(let x=0;x<4;x++){const E=x===1&&!A||x===3&&A?1-b:0,y=x===1&&A||x===3&&!A?b:1,S=s.lines[x],M=s.lines[x===3?0:x+1];for(let F=0;F<z;F++){const L=F/z,V=F===0?0:te(E,y,x===1?1-(1-L)**2:x===3?L**2:L),N=St(Tl,S.origin,M.origin,V),Z=Vn(S.direction,M.direction,V,Ml);i.intersectManifoldClosestSilhouette(Pr(N,Z),n,J),ns(J,l,J,C),O.push(lr(J)),O.length!==0&&T(si(O.at(-1),J));const ie=(qi(R,J)?1:0)|(qi(D,J)?2:0);Jt[ie]=1}}O.length>2&&T(si(O[0],O.at(-1)));const w=yl(yn(Jt)>1?xl(fs(O,R),D):[O],i,a);return new ti({rings:w,spatialReference:a})}function yl(t,e,i){const r=2*fr();return t.map(s=>{const n=[];let a=!1;for(const o of s)e.fromRenderCoords(o,J,i),Math.abs(o[0])<r&&Math.abs(o[1])<r?(n.push([null,J[1]]),n.push([null,J[1]]),a=!0):n.push([J[0],J[1]]);if(a)for(let o=0;o<n.length;o++){const l=n[o];if(l[0]!=null)continue;const u=n[o+1],c=n.at(o===0?-1:o-1);l[0]=c[0],o++;const h=n.at(o===n.length-1?0:o+1);u[0]=h[0]}return n.push(n[0]),hr(n)||n.reverse(),n})}function xl(t,e){const i=[];for(const r of t)i.push(...fs(r,e));return i}function fs(t,e){const i=[],r=[],s=fr();for(let a=0;a<t.length;a++){const o=t[a],l=a===t.length-1?t[0]:t[a+1],u=Dn(o,l,Cl),c=kn(e,u.origin,u.vector,0,J);switch(c){case 2:i.push(o);break;case 3:r.push(o);break;case 0:case 1:{const[h,m,_]=c===0?[1,i,r]:[-1,r,i],f=Nn(e),b=we(g(),J,f,h*s),$=we(g(),J,f,h*-s);m.push(o),m.push(b),_.push($)}}}const n=[];return i.length&&n.push(i),r.length&&n.push(r),n}function $l(t){const{renderCoordsHelper:e,state:{camera:i}}=t,{center:r,eye:s}=i,n=Math.abs(e.getAltitude(r)),a=Math.abs(Math.PI/2-hl(e,r,s));return An(sr,e.referenceEllipsoid.radius+n),zn(sr,a,i.distance,i.fovY)}const bl={minCurvature:oe(5),maxCurvature:oe(50),minSamples:1,maxSamples:6},wl=K(1,0,0),Sl=K(0,1,0),Ml=g(),Tl=g(),J=g(),sr=It(),Cl=Fn(),Jt=Re();Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:dl,eyeForCenterWithHeadingTilt:pl,eyeTiltToLookAtTilt:vl,headingTiltToDirectionUp:hs,lookAtTiltToEyeTilt:ml,toArea:_l,toExtent:gl},Symbol.toStringTag,{value:"Module"}));const Pl={COMPOSITE:"composite-color"},Wh={SSAO:"ssao",LASERLINES:"laserline-color",HIGHLIGHTS:"highlight-color"};let Ne=class extends fi{constructor(e){super(e),this.view=null,this.consumes={required:[]},this.produces=Pl.COMPOSITE,this.requireGeometryDepth=!1,this._dirty=!0}initialize(){this.addHandles([Ns(()=>this.view.ready,e=>{e&&this.view.stage?.renderer.addRenderNode(this)},Bs)])}destroy(){this.view.stage?.renderer?.removeRenderNode(this)}precompile(){}render(){throw new yt("RenderNode:render-function-not-implemented","render() is not implemented.")}get camera(){return this.view.state.camera.clone()}get sunLight(){return this.bindParameters.lighting.legacy}get gl(){return this.view.stage.renderView.renderingContext.gl}get techniques(){return this.view.stage.renderView.techniques}acquireOutputFramebuffer(){const e=this._frameBuffer?.getTexture()?.descriptor,i=this.view.stage.renderer.fboCache.acquire(e?.width??640,e?.height??480,this.produces);return i.fbo?.initializeAndBind(),i}bindRenderTarget(){return this._frameBuffer?.fbo?.initializeAndBind(),this._frameBuffer}requestRender(e){switch(e){case 2:this.view.state.fading=!0;case 1:this.view.stage?.renderView.requestRender(e);case 0:case void 0:this._dirty=!0}}resetWebGLState(){this.renderingContext.resetState(),this.renderingContext.bindFramebuffer(this._frameBuffer?.fbo)}get fboCache(){return this.view.stage.renderer.fboCache}get bindParameters(){return this.renderContext.bind}get renderingContext(){return this.view.stage.renderView.renderingContext}get renderContext(){return this.view.stage?.renderer.renderContext}updateAnimation(e){return!!this._dirty&&(this._dirty=!1,!0)}doRender(e){this._frameBuffer=e.find(({name:i})=>i===this.produces);try{return this.render(e)}finally{this._frameBuffer=null}}};d([p({constructOnly:!0})],Ne.prototype,"view",void 0),d([p({constructOnly:!0})],Ne.prototype,"consumes",void 0),d([p()],Ne.prototype,"produces",void 0),d([p({readOnly:!0})],Ne.prototype,"techniques",null),Ne=d([di("esri.views.3d.webgl.RenderNode")],Ne);const Xh=[],zl=[new Ar("position",3,dr.FLOAT,0,12)],Al=[new Ar("position",2,dr.FLOAT,0,8)],Yh=zr(Al);zr(zl);function Kh(t,e=!0){t.attributes.add("position","vec2"),e&&t.varyings.add("uv","vec2"),t.vertex.main.add(v`
      gl_Position = vec4(position, 0.0, 1.0);
      ${e?v`uv = position * 0.5 + vec2(0.5);`:""}
  `)}function Ol(t){t.uniforms.add(new $i("zProjectionMap",e=>El(e.camera))),t.code.add(v`float linearizeDepth(float depth) {
float depthNdc = depth * 2.0 - 1.0;
float c1 = zProjectionMap[0];
float c2 = zProjectionMap[1];
return -(c1 / (depthNdc + c2 + 1e-7));
}`),t.code.add(v`float delinearizeDepth(float linearDepth) {
float c1 = zProjectionMap[0];
float c2 = zProjectionMap[1];
float depthNdc = (-c1/linearDepth) - c2 - 1e-7;
float depthNonlinear01 = (depthNdc + 1.0 ) / 2.0;
return depthNonlinear01;
}`),t.code.add(v`float depthFromTexture(sampler2D depthTexture, vec2 uv) {
ivec2 iuv = ivec2(uv * vec2(textureSize(depthTexture, 0)));
float depth = texelFetch(depthTexture, iuv, 0).r;
return depth;
}`),t.code.add(v`float linearDepthFromTexture(sampler2D depthTexture, vec2 uv) {
return linearizeDepth(depthFromTexture(depthTexture, uv));
}`)}function El(t){const e=t.projectionMatrix;return ii(Il,e[14],e[10])}const Il=gi();let Zh=class extends j{constructor(e,i,r){super(e,"vec2",2,(s,n,a,o)=>s.setUniform2fv(e,i(n,a,o),r))}},Rl=class extends j{constructor(e,i,r){super(e,"vec4",0,(s,n)=>s.setUniform4fv(e,i(n),r))}};function ef(t){t.fragment.uniforms.add(new Rl("projInfo",e=>Fl(e.camera))),t.fragment.uniforms.add(new $i("zScale",e=>Dl(e.camera))),t.fragment.code.add(v`vec3 reconstructPosition(vec2 fragCoord, float depth) {
return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
}`)}function Fl(t){const e=t.projectionMatrix;return e[11]===0?Ct(nr,2/(t.fullWidth*e[0]),2/(t.fullHeight*e[5]),(1+e[12])/e[0],(1+e[13])/e[5]):Ct(nr,-2/(t.fullWidth*e[0]),-2/(t.fullHeight*e[5]),(1-e[8])/e[0],(1-e[9])/e[5])}const nr=Re();function Dl(t){return t.projectionMatrix[11]===0?ii(ar,0,1):ii(ar,1,0)}const ar=gi();function tf(t){const e=3.141592653589793,i=.3183098861837907;t.constants.add("PI","float",e),t.constants.add("LIGHT_NORMALIZATION","float",i),t.constants.add("INV_PI","float",i),t.constants.add("HALF_PI","float",1.570796326794897),t.constants.add("TWO_PI","float",6.28318530717958)}let rf=class extends j{constructor(e,i){super(e,"bool",0,(r,s)=>r.setUniform1b(e,i(s)))}},Ll=class{constructor(e=tt()){this.intensity=e}};class Vl{constructor(e=tt(),i=K(.57735,.57735,.57735)){this.intensity=e,this.direction=i}}class ci{constructor(e=tt(),i=K(.57735,.57735,.57735),r=!0,s=1,n=1){this.intensity=e,this.direction=i,this.castShadows=r,this.specularStrength=s,this.environmentStrength=n}}let ds=class{constructor(){this.r=[0],this.g=[0],this.b=[0]}};function kl(t,e,i){(i=i||t).length=t.length;for(let r=0;r<t.length;r++)i[r]=t[r]*e[r];return i}function Qt(t,e,i){(i=i||t).length=t.length;for(let r=0;r<t.length;r++)i[r]=t[r]*e;return i}function We(t,e,i){(i=i||t).length=t.length;for(let r=0;r<t.length;r++)i[r]=t[r]+e[r];return i}function ps(t){return(t+1)*(t+1)}function Nl(t){return rt(Math.floor(Math.sqrt(t)-1),0,2)}function ms(t,e,i){const r=t[0],s=t[1],n=t[2],a=i||[];return a.length=ps(e),e>=0&&(a[0]=.28209479177),e>=1&&(a[1]=.4886025119*r,a[2]=.4886025119*n,a[3]=.4886025119*s),e>=2&&(a[4]=1.09254843059*r*s,a[5]=1.09254843059*s*n,a[6]=.31539156525*(3*n*n-1),a[7]=1.09254843059*r*n,a[8]=.54627421529*(r*r-s*s)),a}function Bl(t,e){const i=ps(t),r=e||{r:[],g:[],b:[]};r.r.length=r.g.length=r.b.length=i;for(let s=0;s<i;s++)r.r[s]=r.g[s]=r.b[s]=0;return r}function Hl(t,e){const i=Nl(e.r.length);for(const r of t)vr(ui,r.direction),ms(ui,i,be),kl(be,wt),Qt(be,r.intensity[0],Be),We(e.r,Be),Qt(be,r.intensity[1],Be),We(e.g,Be),Qt(be,r.intensity[2],Be),We(e.b,Be);return e}function jl(t,e){ms(ui,0,be);for(const i of t)e.r[0]+=be[0]*wt[0]*i.intensity[0]*4*Math.PI,e.g[0]+=be[0]*wt[0]*i.intensity[1]*4*Math.PI,e.b[0]+=be[0]*wt[0]*i.intensity[2]*4*Math.PI;return e}function Ul(t,e,i,r){Bl(e,r),k(i.intensity,0,0,0);let s=!1;const n=ql,a=Wl,o=Gl;n.length=0,a.length=0,o.length=0;for(const l of t)l instanceof ci&&!s?(U(i.direction,l.direction),U(i.intensity,l.intensity),i.specularStrength=l.specularStrength,i.environmentStrength=l.environmentStrength,i.castShadows=l.castShadows,s=!0):l instanceof ci||l instanceof Vl?n.push(l):l instanceof Ll?a.push(l):l instanceof ds&&o.push(l);Hl(n,r),jl(a,r);for(const l of o)We(r.r,l.r),We(r.g,l.g),We(r.b,l.b)}const ql=[],Wl=[],Gl=[],be=[0],Be=[0],ui=g(),wt=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398];class or{constructor(){this.color=g(),this.intensity=1}}class Xl{constructor(){this.direction=g(),this.ambient=new or,this.diffuse=new or}}const Yl=.4;class of{constructor(){this._shOrder=2,this._legacy=new Xl,this.globalFactor=.5,this.noonFactor=.5,this._sphericalHarmonics=new ds,this._mainLight=new ci(g(),K(1,0,0),!1)}get legacy(){return this._legacy}get sh(){return this._sphericalHarmonics}get mainLight(){return this._mainLight}set(e){Ul(e,this._shOrder,this._mainLight,this._sphericalHarmonics),this.updateLegacy()}updateLegacy(){U(this._legacy.direction,this._mainLight.direction);const e=1/Math.PI;this._legacy.ambient.color[0]=.282095*this._sphericalHarmonics.r[0]*e,this._legacy.ambient.color[1]=.282095*this._sphericalHarmonics.g[0]*e,this._legacy.ambient.color[2]=.282095*this._sphericalHarmonics.b[0]*e,W(this._legacy.diffuse.color,this._mainLight.intensity,e),U(_t,this._legacy.diffuse.color),W(_t,_t,Yl*this.globalFactor),ae(this._legacy.ambient.color,this._legacy.ambient.color,_t)}copyFrom(e){this._sphericalHarmonics.r=Array.from(e.sh.r),this._sphericalHarmonics.g=Array.from(e.sh.g),this._sphericalHarmonics.b=Array.from(e.sh.b),U(this._mainLight.direction,e.mainLight.direction),U(this._mainLight.intensity,e.mainLight.intensity),this._mainLight.castShadows=e.mainLight.castShadows,this._mainLight.specularStrength=e.mainLight.specularStrength,this._mainLight.environmentStrength=e.mainLight.environmentStrength,this.globalFactor=e.globalFactor,this.noonFactor=e.noonFactor}lerpLighting(e,i,r){if(St(this._mainLight.intensity,e.mainLight.intensity,i.mainLight.intensity,r),this._mainLight.environmentStrength=te(e.mainLight.environmentStrength,i.mainLight.environmentStrength,r),this._mainLight.specularStrength=te(e.mainLight.specularStrength,i.mainLight.specularStrength,r),U(this._mainLight.direction,i.mainLight.direction),this._mainLight.castShadows=i.mainLight.castShadows,this.globalFactor=te(e.globalFactor,i.globalFactor,r),this.noonFactor=te(e.noonFactor,i.noonFactor,r),e.sh.r.length===i.sh.r.length)for(let s=0;s<i.sh.r.length;s++)this._sphericalHarmonics.r[s]=te(e.sh.r[s],i.sh.r[s],r),this._sphericalHarmonics.g[s]=te(e.sh.g[s],i.sh.g[s],r),this._sphericalHarmonics.b[s]=te(e.sh.b[s],i.sh.b[s],r);else for(let s=0;s<i.sh.r.length;s++)this._sphericalHarmonics.r[s]=i.sh.r[s],this._sphericalHarmonics.g[s]=i.sh.g[s],this._sphericalHarmonics.b[s]=i.sh.b[s];this.updateLegacy()}}const _t=g();function lf(t,{occlusionPass:e,terrainDepthTest:i,cullAboveTerrain:r}){const{vertex:s,fragment:n,varyings:a}=t;if(!i)return s.code.add("void forwardViewPosDepth(vec3 pos) {}"),void n.code.add(`${e?"bool":"void"} discardByTerrainDepth() { ${se(e,"return false;")}}`);a.add("viewPosDepth","float",{invariant:!0}),s.code.add(`void forwardViewPosDepth(vec3 pos) {
    viewPosDepth = pos.z;
  }`),n.include(Ol),n.uniforms.add(new Qr("terrainDepthTexture",o=>o.terrainDepth?.attachment)).code.add(v`
    ${e?"bool":"void"} discardByTerrainDepth() {
      float depth = texelFetch(terrainDepthTexture, ivec2(gl_FragCoord.xy), 0).r;
      float linearDepth = linearizeDepth(depth);
      ${e?"return viewPosDepth < linearDepth && depth < 1.0;":`if(viewPosDepth ${r?">":"<="} linearDepth) discard;`}
    }`)}function Kl(t){t.code.add(v`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}function Zl(t){t.code.add(v`
    const float GAMMA = ${v.float(Ai)};
    const float INV_GAMMA = ${v.float(1/Ai)};

    vec4 delinearizeGamma(vec4 color) {
      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.a);
    }

    vec3 linearizeGamma(vec3 color) {
      return pow(color, vec3(GAMMA));
    }
  `)}const Jl=1;function Ql(t,e){if(!it(e.output))return;t.fragment.include(Zl);const{emissionSource:i,hasEmissiveTextureTransform:r,bindType:s}=e,n=i===3||i===4||i===5;n&&(t.include(Wo,e),t.fragment.uniforms.add(s===1?new Uo("texEmission",h=>h.textureEmissive):new Go("texEmission",h=>h.textureEmissive)));const a=i===2||n;a&&t.fragment.uniforms.add(s===1?new xe("emissiveBaseColor",h=>h.emissiveBaseColor):new Me("emissiveBaseColor",h=>h.emissiveBaseColor));const o=i!==0;o&&!(i===7||i===6||i===4||i===5)&&t.fragment.uniforms.add(s===1?new Ho("emissiveStrength",h=>h.emissiveStrength):new Bo("emissiveStrength",h=>h.emissiveStrength));const l=i===7,u=i===5,c=i===1||i===6||l;t.fragment.code.add(v`
    vec4 getEmissions(vec3 symbolColor) {
      vec4 emissions = ${a?u?"emissiveSource == 0 ? vec4(emissiveBaseColor, 1.0): vec4(linearizeGamma(symbolColor), 1.0)":"vec4(emissiveBaseColor, 1.0)":c?l?"emissiveSource == 0 ? vec4(0.0): vec4(linearizeGamma(symbolColor), 1.0)":"vec4(linearizeGamma(symbolColor), 1.0)":"vec4(0.0)"};
      ${se(n,`${se(u,`if(emissiveSource == 0) {
              vec4 emissiveFromTex = textureLookup(texEmission, ${r?"emissiveUV":"vuv0"});
              emissions *= vec4(linearizeGamma(emissiveFromTex.rgb), emissiveFromTex.a);
           }`,`vec4 emissiveFromTex = textureLookup(texEmission, ${r?"emissiveUV":"vuv0"});
           emissions *= vec4(linearizeGamma(emissiveFromTex.rgb), emissiveFromTex.a);`)}
        emissions.w = emissions.rgb == vec3(0.0) ? 0.0: emissions.w;`)}
      ${se(o,`emissions.rgb *= emissiveStrength * ${v.float(Jl)};`)}
      return emissions;
    }
  `)}function cf(t,e){t.include(Co,e),t.include(Ql,e),t.fragment.include(Kl);const{output:i,oitPass:r,discardInvisibleFragments:s,snowCover:n}=e,a=i===10,o=yi(i),l=it(i)&&r===1,u=it(i)&&r!==1;let c=0;(u||o||l)&&t.outputs.add("fragColor","vec4",c++),o&&t.outputs.add("fragEmission","vec4",c++),l&&t.outputs.add("fragAlpha","float",c++),t.fragment.code.add(v`
    void outputColorHighlightOID(vec4 finalColor, const in vec3 vWorldPosition, vec3 emissiveSymbolColor ${se(n,", float snow")}) {
      ${se(a,"finalColor.a = 1.0;")}

      ${se(s,`if (finalColor.a < ${v.float(jo)}) { discard; }`)}

      finalColor = applySlice(finalColor, vWorldPosition);
      ${se(l,v`fragColor = premultiplyAlpha(finalColor);
             fragAlpha = finalColor.a;`)}
      ${se(u,"fragColor = finalColor;")}
      ${se(o,`fragEmission = ${se(n,"mix(finalColor.a * getEmissions(emissiveSymbolColor), vec4(0.0), snow);","finalColor.a * getEmissions(emissiveSymbolColor);")}`)}
      calculateOcclusionAndOutputHighlight();
      ${se(a,"outputObjectAndLayerIdColor();")}
    }
  `)}export{Dr as $,su as A,mu as B,gu as C,nh as D,eh as E,dh as F,Dh as G,yh as H,Ku as I,cf as J,lf as K,Jr as L,Kl as M,hu as N,Gu as O,Wu as P,Uu as Q,Bu as R,Ec as S,cu as T,fu as U,lu as V,du as W,it as X,Je as Y,Bc as Z,of as _,ao as a,vo as a$,Nc as a0,uu as a1,jo as a2,Cu as a3,Rh as a4,xa as a5,ro as a6,so as a7,Ft as a8,th as a9,va as aA,iu as aB,wu as aC,Uc as aD,ca as aE,zc as aF,yo as aG,bo as aH,oh as aI,xo as aJ,Zu as aK,ph as aL,ga as aM,Qc as aN,wa as aO,No as aP,Xa as aQ,Ya as aR,Za as aS,Ht as aT,Su as aU,Ur as aV,Mu as aW,Qa as aX,lh as aY,Dc as aZ,da as a_,fo as aa,Ru as ab,mo as ac,ch as ad,uh as ae,ah as af,ru as ag,_o as ah,Co as ai,Qu as aj,Wo as ak,Nh as al,Ol as am,ef as an,$i as ao,Qr as ap,Rl as aq,tf as ar,rf as as,Yl as at,Me as au,Mo as av,_h as aw,go as ax,po as ay,kc as az,Uo as b,zo as b0,bt as b1,Aa as b2,Yu as b3,ju as b4,Xu as b5,qu as b6,Hu as b7,Rr as b8,_a as b9,Tu as ba,_u as bb,Ih as bc,au as bd,tu as be,vh as bf,Ah as bg,Oh as bh,zh as bi,Uh as bj,Eh as bk,Ac as bl,vu as bm,Ut as bn,Po as bo,Oa as bp,Ba as bq,eo as br,Zl as bs,Wi as bt,Fr as bu,to as bv,xe as c,Rt as d,oa as e,hh as f,Zh as g,la as h,j as i,ku as j,Du as k,wo as l,Vc as m,Pc as n,Kh as o,Xh as p,Go as q,Ho as r,Yh as s,jn as t,Ne as u,Wh as v,jh as w,ct as x,Ma as y,Ll as z};
