import{eM as C,F as b,eO as R,e$ as S,r as u,eQ as m,f4 as M,f1 as O,f3 as k,eC as p,f5 as B,dp as N,dq as z,dr as g,eR as q,hs as H,ht as P,eY as T,eU as V,dn as W}from"./main-CnDVnExo.js";const Y={class:"swipe-container"},D=["id","aria-valuenow","aria-label","content"],F=["swipe-position","view"],G=C({__name:"swipe",props:{fixture:{type:b,required:!0},message:String},setup($){const r=M("iApi"),c=R(),t=S("slider"),y=u(45),v=u(0),d=u(0),L=u(50),h=u(),i=u(),_=m(()=>{const s=30+d.value-d.value,a=t.value?.getBoundingClientRect()?t.value?.getBoundingClientRect().right-t.value?.getBoundingClientRect().left:0,e=+y.value/90,n=(a-s)*e,f=(t.value?.getBoundingClientRect().x??0)+n+(s-5.25)/2;return L.value=f/r.$rootEl.clientWidth*100+.2,`${f}px`}),x=m(()=>`${v.value}px`),A=m(()=>`${-v.value/2-18}px`);O(()=>{v.value=r.$rootEl?.clientHeight??1200});const E=()=>{v.value=r.$rootEl?.clientHeight??v.value,d.value++,setTimeout(()=>{d.value++},50)},l=()=>{c.setOpacity(.1),t.value.style.background=""},o=()=>{c.setOpacity(1),t.value.style.background="inherit"};k(async()=>{"ontouchstart"in document.documentElement||!window.matchMedia("(pointer:fine)").matches||(t.value.style.background="inherit"),window.addEventListener("resize",E),t.value?.addEventListener("focus",l),t.value?.addEventListener("blur",o),t.value?.addEventListener("mouseover",l),t.value?.addEventListener("mouseleave",o),t.value?.addEventListener("touchstart",l),t.value?.addEventListener("touchend",o),setTimeout(()=>{d.value++},50),await w();const s=()=>{const a=i.value?.querySelector(".arcgis-swipe__container");return a?(a.removeAttribute("tabindex"),!0):!1};if(!s()){const a=new MutationObserver((e,n)=>{s()&&n.disconnect()});a.observe(i.value,{childList:!0,subtree:!0,attributes:!1}),setTimeout(()=>a.disconnect(),5e3)}r.event.on(p.MAP_BASEMAPCHANGE,async a=>{a.schemaChanged&&(i.value?.trailingLayers.forEach(e=>{i.value?.trailingLayers.remove(e)}),i.value?.leadingLayers.forEach(e=>{i.value?.leadingLayers.remove(e)}),await w())}),r.event.on(p.LAYER_RELOAD_END,a=>{i.value?.trailingLayers.forEach(e=>{e.id===a.id&&(i.value?.trailingLayers.remove(e),i.value?.trailingLayers.add(a.esriLayer))}),i.value?.leadingLayers.forEach(e=>{e.id===a.id&&(i.value?.leadingLayers.remove(e),i.value?.leadingLayers.add(a.esriLayer))})}),r.event.on(p.LAYER_REMOVE,a=>{i.value?.trailingLayers.forEach(e=>{e.id===a.id&&i.value?.trailingLayers.remove(e)}),i.value?.leadingLayers.forEach(e=>{e.id===a.id&&i.value?.leadingLayers.remove(e)})})});const w=async()=>{await r.geo.map.viewPromise,h.value=r.geo.map.esriView;const s=["Nature","WFSLayer"],a=["Water","GeoMet"];s.forEach(e=>{r.geo.layer.awaitLayer(e,!0).then(n=>{n.esriLayer?i.value?.trailingLayers.add(n.esriLayer):console.warn(`Invalid layer instance: ${e}`)})}),a.forEach(e=>{r.geo.layer.awaitLayer(e,!0).then(n=>{n.esriLayer?i.value?.leadingLayers.add(n.esriLayer):console.warn(`Invalid layer instance: ${e}`)})})};return B(()=>{window.removeEventListener("resize",E),t.value?.removeEventListener("focus",()=>l),t.value?.removeEventListener("blur",()=>o),t.value?.removeEventListener("mouseover",l),t.value?.removeEventListener("mouseleave",o),t.value?.removeEventListener("touchstart",l),t.value?.removeEventListener("touchend",o)}),(s,a)=>{const e=T("tippy");return z(),N("div",Y,[g("div",{class:"verticalLine",style:H({left:_.value,height:x.value,bottom:A.value})},null,4),q(g("input",{"onUpdate:modelValue":a[0]||(a[0]=n=>y.value=n),id:"layerSlider"+V(r).$element._uid,class:"layerSliderElement",type:"range",ref_key:"slider",ref:t,min:"0","aria-valuemin":"0","aria-valuemax":"90","aria-valuenow":y.value,"aria-label":s.$t("map.layerSwipe.label"),max:"90",step:"0.5",content:s.$t("map.layerSwipe.drag"),style:{"z-index":10}},null,8,D),[[P,y.value],[e,{followCursor:!0,trigger:"mouseenter"}]]),g("arcgis-swipe",{direction:"horizontal","swipe-position":L.value,view:h.value,"auto-destroy-disable":"",ref_key:"swipeComponent",ref:i},null,8,F)])}}}),I=W(G,[["__scopeId","data-v-4d9acbf1"]]);class U extends b{async added(){const{el:r,destroy:c}=this.mount(I,{app:this.$element,props:{fixture:this}});r.childNodes[0]&&this.$vApp.$el.appendChild(r.childNodes[0]),this.removed=()=>{c()}}}export{U as default};
