import{hh as Be,bT as Ge,s as v,hi as He,hj as Ue,hk as Ve,hl as We}from"./main-CnDVnExo.js";import{e as Mt}from"./mat4f32-BdRMyjXW.js";import{r as N,s as X}from"./mat4-i0cPq9AY.js";const Ze=(n,r)=>{const t=N(n,r,0,0,0,0,r,0,0,0,0,r,0,0,0,0,1);return X(t,t)},Ke=(n,r)=>{const t=N(n,r,0,0,.5-.5*r,0,r,0,.5-.5*r,0,0,r,.5-.5*r,0,0,0,1);return X(t,t)},Qe=(n,r)=>{const t=1-r,a=N(n,.2126+.7874*t,.7152-.7152*t,.0722-.0722*t,0,.2126-.2126*t,.7152+.2848*t,.0722-.0722*t,0,.2126-.2126*t,.7152-.7152*t,.0722+.9278*t,0,0,0,0,1);return X(a,a)},tn=(n,r)=>{const t=Math.sin(r*Math.PI/180),a=Math.cos(r*Math.PI/180),g=N(n,.213+.787*a-.213*t,.715-.715*a-.715*t,.072-.072*a+.928*t,0,.213-.213*a+.143*t,.715+.285*a+.14*t,.072-.072*a-.283*t,0,.213-.213*a-.787*t,.715-.715*a+.715*t,.072+.928*a+.072*t,0,0,0,0,1);return X(g,g)},en=(n,r)=>{const t=1-2*r,a=N(n,t,0,0,r,0,t,0,r,0,0,t,r,0,0,0,1);return X(a,a)},nn=(n,r)=>{const t=N(n,.213+.787*r,.715-.715*r,.072-.072*r,0,.213-.213*r,.715+.285*r,.072-.072*r,0,.213-.213*r,.715-.715*r,.072+.928*r,0,0,0,0,1);return X(t,t)},rn=(n,r)=>{const t=1-r,a=N(n,.393+.607*t,.769-.769*t,.189-.189*t,0,.349-.349*t,.686+.314*t,.168-.168*t,0,.272-.272*t,.534-.534*t,.131+.869*t,0,0,0,0,1);return X(a,a)};class W{constructor(r,t,a){this.strength=r,this.radius=t,this.threshold=a,this.type="bloom"}interpolate(r,t,a){this.strength=A(r.strength,t.strength,a),this.radius=A(r.radius,t.radius,a),this.threshold=A(r.threshold,t.threshold,a)}clone(){return new W(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:L(this.radius),strength:this.strength,threshold:this.threshold}}}let $t=class Pt{constructor(r){this.radius=r,this.type="blur"}interpolate(r,t,a){this.radius=Math.round(A(r.radius,t.radius,a))}clone(){return new Pt(this.radius)}toJSON(){return{type:"blur",radius:L(this.radius)}}};class G{constructor(r,t){this.type=r,this.amount=t,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(r,t,a){this.amount=A(r.amount,t.amount,a),this._updateMatrix()}clone(){return new G(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const r=this._colorMatrix||Mt();switch(this.type){case"brightness":this._colorMatrix=Ze(r,this.amount);break;case"contrast":this._colorMatrix=Ke(r,this.amount);break;case"grayscale":this._colorMatrix=Qe(r,this.amount);break;case"invert":this._colorMatrix=en(r,this.amount);break;case"saturate":this._colorMatrix=nn(r,this.amount);break;case"sepia":this._colorMatrix=rn(r,this.amount)}}}let Et=class kt{constructor(r,t,a,g){this.offsetX=r,this.offsetY=t,this.blurRadius=a,this.color=g,this.type="drop-shadow"}interpolate(r,t,a){this.offsetX=A(r.offsetX,t.offsetX,a),this.offsetY=A(r.offsetY,t.offsetY,a),this.blurRadius=A(r.blurRadius,t.blurRadius,a),this.color[0]=Math.round(A(r.color[0],t.color[0],a)),this.color[1]=Math.round(A(r.color[1],t.color[1],a)),this.color[2]=Math.round(A(r.color[2],t.color[2],a)),this.color[3]=A(r.color[3],t.color[3],a)}clone(){return new kt(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const r=[...this.color];return r[3]*=255,{type:"drop-shadow",xoffset:L(this.offsetX),yoffset:L(this.offsetY),blurRadius:L(this.blurRadius),color:r}}},Ct=class Jt{constructor(r){this.angle=r,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(r,t,a){this.angle=A(r.angle,t.angle,a),this._updateMatrix()}clone(){return new Jt(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const r=this._colorMatrix||Mt();this._colorMatrix=tn(r,this.angle)}};class Z{constructor(r){this.amount=r,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(r,t,a){this.amount=A(r.amount,t.amount,a)}clone(){return new Z(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function A(n,r,t){return n+(r-n)*t}function L(n){return Math.round(1e3*Ge(n))/1e3}function on(n){switch(n.type){case"grayscale":case"sepia":case"invert":return new G(n.type,0);case"saturate":case"brightness":case"contrast":return new G(n.type,1);case"opacity":return new Z(1);case"hue-rotate":return new Ct(0);case"blur":return new $t(0);case"drop-shadow":return new Et(0,0,0,[...Be("transparent")]);case"bloom":return new W(0,0,1)}}function Ft(n,r){const t=n.length>r.length?n:r;return(n.length>r.length?r:n).every((a,g)=>a.type===t[g].type)}function Rt(n,r){const t=n.length>r.length?n:r,a=n.length>r.length?r:n;for(let g=a.length;g<t.length;g++)a.push(on(t[g]))}function sn(n){const r=n[0];return!!r&&"type"in r}class _t extends SyntaxError{constructor(r,t,a,g){super(r),this.expected=t,this.found=a,this.location=g,this.name="SyntaxError"}format(r){let t="Error: "+this.message;if(this.location){let a=null;const g=r.find(_=>_.source===this.location.source);g&&(a=g.text.split(/\r\n|\n|\r/g));const M=this.location.start,R=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(M):M,S=this.location.source+":"+R.line+":"+R.column;if(a){const _=this.location.end,q="".padEnd(R.line.toString().length," "),j=a[M.line-1],I=(M.line===_.line?_.column:j.length+1)-M.column||1;t+=`
 --> `+S+`
`+q+` |
`+R.line+" | "+j+`
`+q+" | "+"".padEnd(M.column-1," ")+"".padEnd(I,"^")}else t+=`
 at `+S}return t}static buildMessage(r,t){function a(p){return p.codePointAt(0).toString(16).toUpperCase()}const g=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function M(p){return g?p.replace(g,h=>"\\u{"+a(h)+"}"):p}function R(p){return M(p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,h=>"\\x0"+a(h)).replace(/[\x10-\x1F\x7F-\x9F]/g,h=>"\\x"+a(h)))}function S(p){return M(p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,h=>"\\x0"+a(h)).replace(/[\x10-\x1F\x7F-\x9F]/g,h=>"\\x"+a(h)))}const _={literal:p=>'"'+R(p.text)+'"',class(p){const h=p.parts.map(E=>Array.isArray(E)?S(E[0])+"-"+S(E[1]):S(E));return"["+(p.inverted?"^":"")+h.join("")+"]"+(p.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:p=>p.description};function q(p){return _[p.type](p)}function j(p){const h=p.map(q);if(h.sort(),h.length>0){let E=1;for(let O=1;O<h.length;O++)h[O-1]!==h[O]&&(h[E]=h[O],E++);h.length=E}switch(h.length){case 1:return h[0];case 2:return h[0]+" or "+h[1];default:return h.slice(0,-1).join(", ")+", or "+h[h.length-1]}}function I(p){return p?'"'+R(p)+'"':"end of input"}return"Expected "+j(r)+" but "+I(t)+" found."}}function un(n,r){const t={},a=(r=r!==void 0?r:{}).grammarSource,g={start:bt};let M=bt;const R="none",S=")",_=",",q="(",j="%",I="px",p="cm",h="mm",E="in",O="pt",ot="pc",st="deg",ut="rad",at="grad",it="turn",Nt="#",Xt=".",qt="e",ct=/^[ \t\n\r]/,lt=/^[a-z\-]/,ht=/^[0-9a-fA-F]/,ft=/^[+\-]/,P=/^[0-9]/,jt=J("none"),It=w("none",!1),Yt=w(")",!1),pt=w(",",!1),gt=D([" ","	",`
`,"\r"],!1,!1,!1),zt=J("function"),Tt=w("(",!1),Dt=J("identifier"),mt=D([["a","z"],"-"],!1,!1,!1),Lt=J("percentage"),Bt=w("%",!1),Gt=J("length"),Ht=w("px",!1),Ut=w("cm",!1),Vt=w("mm",!1),Wt=w("in",!1),Zt=w("pt",!1),Kt=w("pc",!1),Qt=J("angle"),te=w("deg",!1),ee=w("rad",!1),ne=w("grad",!1),re=w("turn",!1),oe=J("number"),se=J("color"),ue=w("#",!1),dt=D([["0","9"],["a","f"],["A","F"]],!1,!1,!1),yt=D(["+","-"],!1,!1,!1),k=D([["0","9"]],!1,!1,!1),ae=w(".",!1),ie=w("e",!1);function ce(){return[]}function le(e,o){return{type:"function",name:e,parameters:o||[]}}function he(e,o){return o.length>0?Le(e,o,3):[e]}function fe(e){return{type:"quantity",value:e.value,unit:e.unit}}function pe(e){return{type:"color",colorType:e.type,value:e.value}}function Cn(e){return e}function ge(){return U()}function me(e){return{value:e,unit:"%"}}function de(e){return{value:e,unit:"px"}}function ye(e){return{value:e,unit:"cm"}}function we(e){return{value:e,unit:"mm"}}function xe(e){return{value:e,unit:"in"}}function be(e){return{value:e,unit:"pt"}}function ve(e){return{value:e,unit:"pc"}}function Ae(e){return{value:e,unit:"deg"}}function Me(e){return{value:e,unit:"rad"}}function $e(e){return{value:e,unit:"grad"}}function Ee(e){return{value:e,unit:"turn"}}function Ce(e){return{value:e,unit:null}}function Fe(){return{type:"hex",value:U()}}function Re(e){return{type:"function",value:e}}function _e(){return{type:"named",value:U()}}function Se(){return parseFloat(U())}let s=0|r.peg$currPos,m=s;const Y=[{line:1,column:1}];let T,C=s,H=r.peg$maxFailExpected||[],i=0|r.peg$silentFails;if(r.startRule){if(!(r.startRule in g))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');M=g[r.startRule]}function U(){return n.substring(m,s)}function Oe(e=s){const o=n.codePointAt(e);return o===void 0?"":String.fromCodePoint(o)}function w(e,o){return{type:"literal",text:e,ignoreCase:o}}function D(e,o,u,c){return{type:"class",parts:e,inverted:o,ignoreCase:u,unicode:c}}function Pe(){return{type:"end"}}function J(e){return{type:"other",description:e}}function wt(e){let o,u=Y[e];if(u)return u;if(e>=Y.length)o=Y.length-1;else for(o=e;!Y[--o];);for(u=Y[o],u={line:u.line,column:u.column};o<e;)n.charCodeAt(o)===10?(u.line++,u.column=1):u.column++,o++;return Y[e]=u,u}function xt(e,o,u){const c=wt(e),f=wt(o);return{source:a,start:{offset:e,line:c.line,column:c.column},end:{offset:o,line:f.line,column:f.column}}}function l(e){s<C||(s>C&&(C=s,H=[]),H.push(e))}function ke(e,o,u){return new _t(_t.buildMessage(e,o),e,o,u)}function bt(){let e;return e=Je(),e===t&&(e=Ne()),e}function Je(){let e,o;return i++,e=s,x(),n.substr(s,4)===R?(o=R,s+=4):(o=t,i===0&&l(It)),o!==t?(x(),m=e,e=ce()):(s=e,e=t),i--,e===t&&i===0&&l(jt),e}function Ne(){let e,o;if(e=[],o=K(),o!==t)for(;o!==t;)e.push(o),o=K();else e=t;return e}function K(){let e,o,u,c;return e=s,x(),o=qe(),o!==t?(x(),u=Xe(),u===t&&(u=null),x(),n.charCodeAt(s)===41?(c=S,s++):(c=t,i===0&&l(Yt)),c!==t?(x(),m=e,e=le(o,u)):(s=e,e=t)):(s=e,e=t),e}function Xe(){let e,o,u,c,f,d,y,b;if(e=s,o=Q(),o!==t){for(u=[],c=s,f=x(),n.charCodeAt(s)===44?(d=_,s++):(d=t,i===0&&l(pt)),d===t&&(d=null),y=x(),b=Q(),b!==t?(f=[f,d,y,b],c=f):(s=c,c=t);c!==t;)u.push(c),c=s,f=x(),n.charCodeAt(s)===44?(d=_,s++):(d=t,i===0&&l(pt)),d===t&&(d=null),y=x(),b=Q(),b!==t?(f=[f,d,y,b],c=f):(s=c,c=t);m=e,e=he(o,u)}else s=e,e=t;return e}function Q(){let e,o;return e=s,o=je(),o===t&&(o=Ie(),o===t&&(o=Ye(),o===t&&(o=ze()))),o!==t&&(m=e,o=fe(o)),e=o,e===t&&(e=s,o=Te(),o!==t&&(m=e,o=pe(o)),e=o),e}function x(){let e,o;for(i++,e=[],o=n.charAt(s),ct.test(o)?s++:(o=t,i===0&&l(gt));o!==t;)e.push(o),o=n.charAt(s),ct.test(o)?s++:(o=t,i===0&&l(gt));return i--,e}function qe(){let e,o,u;return i++,e=s,o=vt(),o!==t?(n.charCodeAt(s)===40?(u=q,s++):(u=t,i===0&&l(Tt)),u!==t?(m=e,e=o):(s=e,e=t)):(s=e,e=t),i--,e===t&&(o=t,i===0&&l(zt)),e}function vt(){let e,o,u;if(i++,e=s,o=[],u=n.charAt(s),lt.test(u)?s++:(u=t,i===0&&l(mt)),u!==t)for(;u!==t;)o.push(u),u=n.charAt(s),lt.test(u)?s++:(u=t,i===0&&l(mt));else o=t;return o!==t&&(m=e,o=ge()),e=o,i--,e===t&&(o=t,i===0&&l(Dt)),e}function je(){let e,o,u;return i++,e=s,x(),o=$(),o!==t?(n.charCodeAt(s)===37?(u=j,s++):(u=t,i===0&&l(Bt)),u!==t?(m=e,e=me(o)):(s=e,e=t)):(s=e,e=t),i--,e===t&&i===0&&l(Lt),e}function Ie(){let e,o,u;return i++,e=s,x(),o=$(),o!==t?(n.substr(s,2)===I?(u=I,s+=2):(u=t,i===0&&l(Ht)),u!==t?(m=e,e=de(o)):(s=e,e=t)):(s=e,e=t),e===t&&(e=s,x(),o=$(),o!==t?(n.substr(s,2)===p?(u=p,s+=2):(u=t,i===0&&l(Ut)),u!==t?(m=e,e=ye(o)):(s=e,e=t)):(s=e,e=t),e===t&&(e=s,x(),o=$(),o!==t?(n.substr(s,2)===h?(u=h,s+=2):(u=t,i===0&&l(Vt)),u!==t?(m=e,e=we(o)):(s=e,e=t)):(s=e,e=t),e===t&&(e=s,x(),o=$(),o!==t?(n.substr(s,2)===E?(u=E,s+=2):(u=t,i===0&&l(Wt)),u!==t?(m=e,e=xe(o)):(s=e,e=t)):(s=e,e=t),e===t&&(e=s,x(),o=$(),o!==t?(n.substr(s,2)===O?(u=O,s+=2):(u=t,i===0&&l(Zt)),u!==t?(m=e,e=be(o)):(s=e,e=t)):(s=e,e=t),e===t&&(e=s,x(),o=$(),o!==t?(n.substr(s,2)===ot?(u=ot,s+=2):(u=t,i===0&&l(Kt)),u!==t?(m=e,e=ve(o)):(s=e,e=t)):(s=e,e=t)))))),i--,e===t&&i===0&&l(Gt),e}function Ye(){let e,o,u;return i++,e=s,o=$(),o!==t?(n.substr(s,3)===st?(u=st,s+=3):(u=t,i===0&&l(te)),u!==t?(m=e,e=Ae(o)):(s=e,e=t)):(s=e,e=t),e===t&&(e=s,o=$(),o!==t?(n.substr(s,3)===ut?(u=ut,s+=3):(u=t,i===0&&l(ee)),u!==t?(m=e,e=Me(o)):(s=e,e=t)):(s=e,e=t),e===t&&(e=s,o=$(),o!==t?(n.substr(s,4)===at?(u=at,s+=4):(u=t,i===0&&l(ne)),u!==t?(m=e,e=$e(o)):(s=e,e=t)):(s=e,e=t),e===t&&(e=s,o=$(),o!==t?(n.substr(s,4)===it?(u=it,s+=4):(u=t,i===0&&l(re)),u!==t?(m=e,e=Ee(o)):(s=e,e=t)):(s=e,e=t)))),i--,e===t&&(o=t,i===0&&l(Qt)),e}function ze(){let e,o;return i++,e=s,x(),o=$(),o!==t?(m=e,e=Ce(o)):(s=e,e=t),i--,e===t&&i===0&&l(oe),e}function Te(){let e,o,u,c;if(i++,e=s,n.charCodeAt(s)===35?(o=Nt,s++):(o=t,i===0&&l(ue)),o!==t){if(u=[],c=n.charAt(s),ht.test(c)?s++:(c=t,i===0&&l(dt)),c!==t)for(;c!==t;)u.push(c),c=n.charAt(s),ht.test(c)?s++:(c=t,i===0&&l(dt));else u=t;u!==t?(m=e,e=Fe()):(s=e,e=t)}else s=e,e=t;return e===t&&(e=s,o=K(),o!==t&&(m=e,o=Re(o)),e=o,e===t&&(e=s,o=vt(),o!==t&&(m=e,o=_e()),e=o)),i--,e===t&&(o=t,i===0&&l(se)),e}function $(){let e,o,u,c,f,d,y,b;for(e=s,o=n.charAt(s),ft.test(o)?s++:(o=t,i===0&&l(yt)),o===t&&(o=null),u=s,c=[],f=n.charAt(s),P.test(f)?s++:(f=t,i===0&&l(k));f!==t;)c.push(f),f=n.charAt(s),P.test(f)?s++:(f=t,i===0&&l(k));if(n.charCodeAt(s)===46?(f=Xt,s++):(f=t,i===0&&l(ae)),f!==t){if(d=[],y=n.charAt(s),P.test(y)?s++:(y=t,i===0&&l(k)),y!==t)for(;y!==t;)d.push(y),y=n.charAt(s),P.test(y)?s++:(y=t,i===0&&l(k));else d=t;d!==t?(c=[c,f,d],u=c):(s=u,u=t)}else s=u,u=t;if(u===t)if(u=[],c=n.charAt(s),P.test(c)?s++:(c=t,i===0&&l(k)),c!==t)for(;c!==t;)u.push(c),c=n.charAt(s),P.test(c)?s++:(c=t,i===0&&l(k));else u=t;if(u!==t){if(c=s,n.charCodeAt(s)===101?(f=qt,s++):(f=t,i===0&&l(ie)),f!==t){if(d=n.charAt(s),ft.test(d)?s++:(d=t,i===0&&l(yt)),d===t&&(d=null),y=[],b=n.charAt(s),P.test(b)?s++:(b=t,i===0&&l(k)),b!==t)for(;b!==t;)y.push(b),b=n.charAt(s),P.test(b)?s++:(b=t,i===0&&l(k));else y=t;y!==t?(f=[f,d,y],c=f):(s=c,c=t)}else s=c,c=t;c===t&&(c=null),m=e,e=Se()}else s=e,e=t;return e}function De(e,o){return e.map(function(u){return u[o]})}function Le(e,o,u){return[e].concat(De(o,u))}T=M();const tt=T!==t&&s===n.length;function At(){throw T!==t&&s<n.length&&l(Pe()),ke(H,C<n.length?Oe(C):null,C<n.length?xt(C,C+1):xt(C,C))}return r.peg$library?{peg$result:T,peg$currPos:s,peg$FAILED:t,peg$maxFailExpected:H,peg$maxFailPos:C,peg$success:tt,peg$throw:tt?void 0:At}:tt?T:void At()}function an(n){if(!n||n.length===0)return null;if(typeof n=="string"){const t=St(n);return t&&t.length!==0?t:null}const r=n.map(t=>{if(!Number.isFinite(t.scale)||t.scale<=0)throw new v("effect:invalid-scale","scale must be finite and greater than 0",{stop:t});return{scale:t.scale,effects:St(t.value)}});r.sort((t,a)=>a.effects.length-t.effects.length);for(let t=0;t<r.length-1;t++){if(!Ft(r[t].effects,r[t+1].effects))throw new v("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:r[t].effects,b:r[t+1].effects});Rt(r[t].effects,r[t+1].effects)}return r.sort((t,a)=>a.scale-t.scale),r}function St(n){let r;if(!n)return[];try{r=un(n)}catch(t){throw new v("effect:invalid-syntax","Invalid effect syntax",{value:n,error:t})}return r.map(t=>cn(t))}function cn(n){try{switch(n.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return ln(n);case"opacity":return hn(n);case"hue-rotate":return fn(n);case"blur":return pn(n);case"drop-shadow":return gn(n);case"bloom":return mn(n)}}catch(r){throw r.details.filter=n,r}throw new v("effect:unknown-effect",`Effect '${n.name}' is not supported`,{effect:n})}function ln(n){let r=1;return z(n.parameters,1),n.parameters.length===1&&(r=F(n.parameters[0])),new G(n.name,r)}function hn(n){let r=1;return z(n.parameters,1),n.parameters.length===1&&(r=F(n.parameters[0])),new Z(r)}function fn(n){let r=0;return z(n.parameters,1),n.parameters.length===1&&(r=vn(n.parameters[0])),new Ct(r)}function pn(n){let r=0;return z(n.parameters,1),n.parameters.length===1&&(r=rt(n.parameters[0]),B(r,n.parameters[0])),new $t(r)}function gn(n){const r=[];let t=null;for(const a of n.parameters)if(a.type==="color"){if(r.length&&Object.freeze(r),t)throw new v("effect:type-error","Accepts only one color",{});t=An(a)}else{const g=rt(a);if(Object.isFrozen(r))throw new v("effect:type-error","<length> parameters not consecutive",{lengths:r});r.push(g),r.length===3&&B(g,a)}if(r.length<2||r.length>3)throw new v("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${r.length}}`,{lengths:r});return new Et(r[0],r[1],r[2]||0,t||Ot("black"))}function mn(n){let r=1,t=0,a=0;return z(n.parameters,3),n.parameters[0]&&(r=F(n.parameters[0])),n.parameters[1]&&(t=rt(n.parameters[1]),B(t,n.parameters[1])),n.parameters[2]&&(a=F(n.parameters[2])),new W(r,t,a)}function z(n,r){if(n.length>r)throw new v("effect:type-error",`Function supports up to ${r} parameters, Actual: ${n.length}`,{parameters:n})}function V(n){if(n.type==="color")return"<color>";if(n.unit){if(n.unit in nt)return"<length>";if(n.unit in et)return"<angle>";if(n.unit==="%")return"<percentage>"}return"<double>"}function B(n,r){if(n<0)throw new v("effect:type-error",`Negative values are not allowed, Actual: ${n}`,{term:r})}function dn(n){if(n.type!=="quantity"||n.unit!==null)throw new v("effect:type-error",`Expected <double>, Actual: ${V(n)}`,{term:n})}function yn(n){if(n.type!=="quantity"||n.unit!==null&&n.unit!=="%")throw new v("effect:type-error",`Expected <double> or <percentage>, Actual: ${V(n)}`,{term:n})}const et={deg:1,grad:.9,rad:180/Math.PI,turn:360};function wn(n){if(n.type!=="quantity"||!(n.value===0&&n.unit===null||n.unit&&et[n.unit]!=null))throw new v("effect:type-error",`Expected <angle>, Actual: ${V(n)}`,{term:n})}const nt={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function xn(n){if(n.type!=="quantity"||!(n.value===0&&n.unit===null||n.unit&&nt[n.unit]!=null))throw new v("effect:type-error",`Expected <length>, Actual: ${V(n)}`,{term:n})}function F(n){yn(n);const r=n.value;return B(r,n),n.unit==="%"?.01*r:r}function bn(n){return dn(n),B(n.value,n),n.value}function vn(n){return wn(n),n.value*et[n.unit]||0}function rt(n){return xn(n),n.value*nt[n.unit]||0}function An(n){switch(n.colorType){case"hex":return He(n.value);case"named":return Ot(n.value);case"function":return En(n.value)}}function Ot(n){if(!Ue(n))throw new v("effect:unknown-color",`color '${n}' isn't valid`,{namedColor:n});return Ve(n)}const Mn=/^rgba?/i,$n=/^hsla?/i;function En(n){if(z(n.parameters,4),Mn.test(n.name))return[F(n.parameters[0]),F(n.parameters[1]),F(n.parameters[2]),n.parameters[3]?F(n.parameters[3]):1];if($n.test(n.name))return We(bn(n.parameters[0]),F(n.parameters[1]),F(n.parameters[2]),n.parameters[3]?F(n.parameters[3]):1);throw new v("effect:syntax-error",`Invalid color function '${n.name}'`,{colorFunction:n})}export{Rt as e,an as g,sn as l,Ft as t};
