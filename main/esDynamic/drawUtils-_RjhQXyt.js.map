{"version":3,"file":"drawUtils-_RjhQXyt.js","sources":["../../node_modules/@arcgis/core/views/draw/support/drawUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{equals as t}from\"../../../core/arrayUtils.js\";import{rad2deg as n}from\"../../../core/mathUtils.js\";import{create as r,center as o}from\"../../../geometry/support/aaBoundingRect.js\";import{getRingsOrPathsBounds as e}from\"../../../geometry/support/boundsUtils.js\";import{geometryToCoordinates as i}from\"../../../geometry/support/coordsUtils.js\";import{toEllipticArc7 as s}from\"../../../geometry/support/curves/circularArcUtils.js\";import{isCurvedGeometry as c,getEndpoint as u,isCoordinate as a,isBezierCurve as m,isCircularArc as l}from\"../../../geometry/support/curves/curveUtils.js\";import{transformEllipticArc as p}from\"../../../geometry/support/curves/ellipticArc7Utils.js\";import{getScaleTransform as f}from\"../../interactive/editGeometry/operations/curveOperationUtils.js\";function y(t,n,r,o){if(null==o||t.hasZ||(o=void 0),\"point\"===t.type)return t.x+=n,t.y+=r,t.hasZ&&null!=o&&(t.z+=o),t;if(\"multipoint\"===t.type){const e=t.points;for(let t=0;t<e.length;t++)e[t]=g(e[t],n,r,o);return t}if(\"extent\"===t.type)return t.xmin+=n,t.xmax+=n,t.ymin+=r,t.ymax+=r,null!=o&&(t.zmin??=0,t.zmin+=o,t.zmax??=0,t.zmax+=o),t;const e=\"polyline\"===t.type?t.curvePaths??t.paths:t.curveRings??t.rings,i=c(t);for(let s=0;s<e.length;s++){const t=e[s];for(let e=0;e<t.length;e++)t[e]=v(t[e],n,r,o)}return\"paths\"in t?i?t.curvePaths=e:t.paths=e:i?t.curveRings=e:t.rings=e,t}function x(t,n,r,o,e){const i=t.clone();if(e){const{resolution:t}=o;y(i,n*t,-r*t)}else{const{dxMap:t,dyMap:e}=h(n,r,o);y(i,t,e)}return i}function h(t,n,r){const o=r.state.inverseTransform;return{dxMap:o[0]*t+o[2]*n,dyMap:o[1]*t+o[3]*n}}function g(t,n,r,o){return z(t,t[0]+n,t[1]+r,null!=t[2]&&null!=o?t[2]+o:void 0)}function v(t,n,r,o){const e=g(u(t),n,r,o);if(a(t))return e;if(m(t)){const[,o,i]=t.b;return{b:[e,[o[0]+n,o[1]+r],[i[0]+n,i[1]+r]]}}if(l(t)){const[,o]=t.c;return{c:[e,[o[0]+n,o[1]+r]]}}const[,i,...s]=t.a;return{a:[e,[i[0]+n,i[1]+r],...s]}}function M(n,s,c,a){if(\"point\"===n.type){const{x:t,y:r}=n,o=a?a[0]:t,e=a?a[1]:r,i=n.clone(),u=(t-o)*s+o,m=(r-e)*c+e;return i.x=u,i.y=m,i}if(\"extent\"===n.type){const{xmin:t,xmax:r,ymin:o,ymax:e}=n,i=a?a[0]:(t+r)/2,u=a?a[1]:(e+o)/2,m=n.clone();if(m.xmin=(t-i)*s+i,m.ymax=(e-u)*c+u,m.xmax=(r-i)*s+i,m.ymin=(o-u)*c+u,m.xmin>m.xmax){const t=m.xmin,n=m.xmax;m.xmin=n,m.xmax=t}if(m.ymin>m.ymax){const t=m.ymin,n=m.ymax;m.ymin=n,m.ymax=t}return m}let m=null;if(!a){m=i(n);const t=r(),o=e(t,m);if(!o)return n.clone();const[s,c,u,l]=o;a=[(s+u)/2,(c+l)/2]}const[l,p]=a;if(\"multipoint\"===n.type){const t=n.clone(),r=t.points;for(let n=0;n<r.length;n++){const t=r[n],[o,e]=t,i=(o-l)*s+l,u=(e-p)*c+p;r[n]=z(t,i,u,void 0)}return t.points=r,t}const f=n.clone();m??=i(n);const y=\"polygon\"===f.type,x=y?f.curveRings??f.rings:f.curvePaths??f.paths;if(!a){const t=r(),n=e(t,x,!1,!1);if(!n)return f;a=o(n)}for(const r of x){let n=null;const o=y&&r.length>0&&t(u(r[0]),u(r.at(-1)));for(let t=0;t<r.length;t++){const o=r[t];r[t]=j(o,s,c,l,p,n),n=o}o&&(r[0]=[...u(r.at(-1))])}return f}function d(t,n,r,o,e){const[i,s,...c]=t;return[(i-o)*n+o,(s-e)*r+e,...c]}function j(t,n,r,o,e,i){if(a(t))return d(t,n,r,o,e);if(m(t)){const[i,s,c]=t.b.map(t=>d(t,n,r,o,e));return{b:[i,s,c]}}if(!i)return t;const c=u(i),y=l(t)?s(c,t):t,[x,h,g,v,M,j,U]=y.a,b=M??0,z=j??Math.hypot(x[0]-h[0],x[1]-h[1]),R=U??1,P=f(o,e,1,0,0,1,n,r);return p(c,{a:[[...x],[...h],g,v,b,z,R]},P)}function U(t,n,r,o,e,i){const s=Math.sqrt((r-t)*(r-t)+(o-n)*(o-n));return Math.sqrt((e-t)*(e-t)+(i-n)*(i-n))/s}function b(t,r,o,e=!1){const i=Math.atan2(r.y-o.y,r.x-o.x)-Math.atan2(t.y-o.y,t.x-o.x),s=Math.atan2(Math.sin(i),Math.cos(i));return e?s:n(s)}function z(t,n,r,o){const e=[n,r];return t.length>2&&e.push(null!=o?o:t[2]),t.length>3&&e.push(t[3]),e}export{x as cloneMove,b as getRotationAngle,U as getScaleRatio,y as move,M as scale,h as screenDeltaToMapDelta};\n"],"names":["y","t","n","r","o","e","g","i","c","s","v","x","h","z","u","a","m","l","M","p","f","j","d","U","b","R","P"],"mappings":"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","x_google_ignoreList":[0]}