import{m as p}from"./Field-CY14G2Qc.js";const w="Raster.",s="Raster.Dim.",d=".Max",l={servicePixelValue:"Raster.ServicePixelValue",rawServicePixelValue:"Raster.ServicePixelValue.Raw",itemPixelValue:"Raster.ItemPixelValue",magnitude:"Raster.Magnitude",direction:"Raster.Direction",variable:"Raster.Variable"},V=new Map([["quarters","Quarter"],["months","Month"],["weeks","Week of the year"],["days","Day of the year"]]);function m(e,a){return new p({name:e,alias:a,domain:null,editable:!1,length:50,type:"string"})}function $(e,a){return new p({name:e,alias:a,domain:null,editable:!1,type:"double"})}function b(e,a){return new p({name:e,alias:a,domain:null,editable:!1,type:"date"})}function g(e){return m(l.servicePixelValue,e??"Service Pixel Value")}function P(e){return m(l.rawServicePixelValue,e??"Raw Service Pixel Value")}function S(){return m(l.itemPixelValue,"Item Pixel Value")}function y(e){return m(`${l.servicePixelValue}.${e}`,e)}function R(e){return $(`${l.magnitude}`,"Magnitude"+(e?` (${e})`:""))}function M(){return $(`${l.direction}`,"Direction (\xB0)")}function I(e){return e.fields.filter(a=>a.type!=="oid"&&a.name.toLowerCase()!=="value").map(a=>{const n=a.clone();return n.name=`${w}${a.name}`,n})}function D(e){const a=new Set,n=new Set,t=new Map;return e.variables.forEach(({dimensions:i})=>{i.forEach(r=>{if(r.recurring)t.set(r.name,r.unit);else{const o=r.unit?.trim()==="ISO8601"||r.name?.trim()?.toLowerCase()==="stdtime"?a:n;o.add(r.name),r.hasRanges&&o.add(`${r.name}${d}`)}})}),[m(l.variable,"Variable"),...[...a].map(i=>b(`${s}${i}`,h(i))),...[...n].map(i=>$(`${s}${i}`,h(i))),...[...t].map(([i,r])=>$(`${s}${i}`,E(i,r)))]}function E(e,a){return a=a?.toLowerCase(),a&&V.has(a)?V.get(a):h(e)}function h(e){const a=e.endsWith(d),n=a?e.slice(0,-4):e,t=n==="StdTime"?"Standard Time":n==="StdZ"?"Standard Z":n;return a?`${t} Max`:t}function x(e,a){return a?new Date(e):e}function N(e,a,n){n?.length&&(a[l.variable]=n[0].variableName,n.forEach(({dimensionName:t,values:i})=>{if(t&&i?.length){const r=`${s}${t}`,o=e.find(({name:f})=>f===r);if(!o)return;const u=o.type==="date",c=i[0];if(Array.isArray(c)){if(a[`${s}${t}`]=x(c[0],u),c[1]!=null){const f=`${s}${t}${d}`;if(e.some(({name:v})=>v===f)){const v=x(c[1],u);a[f]=v}}}else a[`${s}${t}`]=x(c,u)}}))}function W(e,a){if(a.pixelType.startsWith("f")&&e.forEach(({format:n,fieldName:t})=>{n&&t&&/^raster\.(item|service)pixelvalue/i.test(t)&&(n.places=2)}),a.multidimensionalInfo){const n=a.multidimensionalInfo.variables.flatMap(({dimensions:t})=>t);e.forEach(({format:t,fieldName:i})=>{if(t&&i?.startsWith(s)){const r=i.slice(s.length),o=`${r}${d}`;n.find(({name:u})=>u===r||u===o)?.values?.every(u=>Number.isInteger(u))&&(t.places=0)}})}}export{M as $,N as V,w as a,W as b,P as c,R as d,y as f,l as i,S as m,s as n,g as o,D as p,I as v};
