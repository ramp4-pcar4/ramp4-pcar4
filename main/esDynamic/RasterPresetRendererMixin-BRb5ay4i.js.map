{"version":3,"file":"RasterPresetRendererMixin-BRb5ay4i.js","sources":["../../node_modules/@arcgis/core/rest/imageService/fetchRasterInfo.js","../../node_modules/@arcgis/core/renderers/support/RasterPresetRenderer.js","../../node_modules/@arcgis/core/layers/mixins/RasterPresetRendererMixin.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import t from\"../../geometry/Extent.js\";import a from\"../../geometry/Point.js\";import i from\"../../geometry/SpatialReference.js\";import l from\"../../layers/support/RasterInfo.js\";import n from\"../../layers/support/RasterStorageInfo.js\";import{parseUrl as s,encode as r,asValidOptions as o}from\"../utils.js\";import u from\"../support/FeatureSet.js\";async function m(m,f,p){const c=s(m),{rasterFunction:d,sourceJSON:h}=f||{},g=d?JSON.stringify(d.rasterFunctionDefinition||d):null,y=r({...c.query,renderingRule:g,f:\"json\"}),x=o(y,p);m=c.path;const S=h||await e(m,x).then(e=>e.data),b=S.hasRasterAttributeTable?e(`${m}/rasterAttributeTable`,x):null,v=S.hasColormap?e(`${m}/colormap`,x):null,V=S.hasHistograms?e(`${m}/histograms`,x):null,D=S.currentVersion>=10.3?e(`${m}/keyProperties`,x):null,I=S.hasMultidimensions?e(`${m}/multidimensionalInfo`,x):null,T=await Promise.allSettled([b,v,V,D,I]);let R=null;if(S.minValues&&S.minValues.length===S.bandCount){R=[];for(let e=0;e<S.minValues.length;e++)R.push({min:S.minValues[e],max:S.maxValues[e],avg:S.meanValues[e],stddev:S.stdvValues[e]})}const j=t.fromJSON(S.extent),w=Math.ceil(j.width/S.pixelSizeX-.1),M=Math.ceil(j.height/S.pixelSizeY-.1),N=i.fromJSON(S.spatialReference||S.extent.spatialReference),O=\"fulfilled\"===T[0].status?T[0].value?.data:null,J=O?.features?.length?u.fromJSON(O):null,k=\"fulfilled\"===T[1].status?T[1].value?.data.colormap:null,C=k?.length?k:null,P=\"fulfilled\"===T[2].status?T[2].value?.data.histograms:null,z=P?.[0]?.counts?.length?P:null,F=\"fulfilled\"===T[3].status?T[3].value?.data??{}:{},$=\"fulfilled\"===T[4].status?T[4].value?.data.multidimensionalInfo:null,E=$?.variables?.length?$:null;E&&E.variables.forEach(e=>{e.statistics?.length&&e.statistics.forEach(e=>{e.avg=e.mean,e.stddev=e.standardDeviation}),e.dimensions?.forEach(e=>{\"StdTime\"!==e.name||e.recurring||e.unit||(e.unit=\"ISO8601\")})});const{defaultVariable:H,serviceDataType:L}=S;H&&H!==F.DefaultVariable&&(F.DefaultVariable=H),L?.includes(\"esriImageServiceDataTypeVector\")&&!L.includes(F.DataType)&&(F.DataType=L.replace(\"esriImageServiceDataType\",\"\"));let A=S.noDataValue;S.noDataValues?.length&&S.noDataValues.some(e=>e!==A)&&(A=S.noDataValues);const q=S.transposeInfo?new n({blockWidth:256,blockHeight:256,pyramidBlockWidth:256,pyramidBlockHeight:256,pyramidScalingFactor:2,compression:\"lerc\",origin:new a({x:S.extent.xmin,y:S.extent.ymax,spatialReference:N}),firstPyramidLevel:1,maximumPyramidLevel:Math.max(0,Math.round(Math.log(Math.max(w,M))/Math.LN2-8)),transposeInfo:S.transposeInfo}):void 0;return new l({width:w,height:M,bandCount:S.bandCount,extent:t.fromJSON(S.extent),spatialReference:N,pixelSize:new a({x:S.pixelSizeX,y:S.pixelSizeY,spatialReference:N}),pixelType:S.pixelType.toLowerCase(),statistics:R,attributeTable:J,colormap:C,histograms:z,keyProperties:F,noDataValue:A,multidimensionalInfo:E,storageInfo:q})}function f(e,t,a){return m(e,{sourceJSON:t},a)}function p(e,t,a){return m(e,{rasterFunction:t},a)}function c(e,t){e.attributeTable||(t.hasRasterAttributeTable=!1),e.histograms||(t.hasHistograms=!1),e.colormap||(t.hasColormap=!1),e.multidimensionalInfo||(t.hasMultidimensions=!1)}export{f as fetchServiceRasterInfo,p as generateRasterInfo,c as patchServiceInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{ClonableMixin as r}from\"../../core/Clonable.js\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{Integer as s}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/has.js\";import\"../../core/RandomLCG.js\";import{enumeration as i}from\"../../core/accessorSupport/decorators/enumeration.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{websceneRasterRendererTypes as n,rasterRendererTypes as a}from\"./rasterTypeUtils.js\";let d=class extends(r(o)){constructor(e){super(e),this.name=void 0,this.method=\"none\",this.value=void 0,this.bandIds=void 0,this.renderer=void 0}};e([t({type:String,json:{write:{isRequired:!0}}})],d.prototype,\"name\",void 0),e([t({type:[\"raster-function-template\",\"variable\",\"none\"],json:{write:{isRequired:!0}}}),i({rasterFunctionTemplate:\"raster-function-template\",variable:\"variable\",none:\"none\"})],d.prototype,\"method\",void 0),e([t({type:String,json:{write:{isRequired:!0}}})],d.prototype,\"value\",void 0),e([t({type:[s],json:{write:{isRequired:!0}}})],d.prototype,\"bandIds\",void 0),e([t({types:a,json:{write:!0,origins:{\"web-scene\":{types:n,write:{overridePolicy:e=>({enabled:e&&\"vector-field\"!==e.type})}}}}})],d.prototype,\"renderer\",void 0),d=e([p(\"esri.renderers.support.RasterPresetRenderer\")],d);export{d as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import s from\"../../renderers/support/RasterPresetRenderer.js\";const o=o=>{const i=o;let n=class extends i{constructor(){super(...arguments),this.activePresetRendererName=null,this.presetRenderers=null}};return e([r({type:String,json:{name:\"layerDefinition.activePresetRendererName\",write:{allowNull:!0}}})],n.prototype,\"activePresetRendererName\",void 0),e([r({type:[s],json:{name:\"layerDefinition.presetRenderers\",write:!0}})],n.prototype,\"presetRenderers\",void 0),n=e([t(\"esri.layers.mixins.RasterPresetRendererMixin\")],n),n};export{o as RasterPresetRendererMixin};\n"],"names":["m","f","p","c","s","d","h","g","y","r","x","o","S","e","b","v","V","D","I","T","R","j","t","w","M","N","i","O","J","u","k","C","P","z","F","$","E","H","L","A","q","n","a","l"],"mappings":"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","x_google_ignoreList":[0,1,2]}