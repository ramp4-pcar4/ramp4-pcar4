import{e7 as A,e8 as i,e9 as o,fy as M,fz as F,fS as I,lH as V,fF as H,fW as g,fG as v,fH as E,ea as m,fN as J,hg as w,fX as y,fC as L,fL as T,fJ as k,fI as N,fE as b,ly as S,iG as Z,ar as z,hi as B,fR as K,jm as Q,fT as X,fD as j,fU as x,fK as W,F as U,fq as ee}from"./main-6gYsRPh_.js";import{u as te}from"./draw-store-DiyYGnDy.js";import{k as oe}from"./keyboard-O-FN7ZtD.js";const ae={},ne={class:"border-b p-0 self-center w-2/3"};function ie(d,n){return o(),i("span",ne)}const q=A(ae,[["render",ie]]),se=M({__name:"zoom-nav",setup(d){const{t:n}=F(),a=I("iApi"),e=V(400,!0,()=>a.geo.map.zoomIn()),r=V(400,!0,()=>a.geo.map.zoomOut());return(t,p)=>{const s=H("mapnav-button");return o(),i("div",null,[g(s,{onClickFunction:v(e),tooltip:v(n)("mapnav.zoomIn")},{default:E(()=>p[0]||(p[0]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),g(q),g(s,{onClickFunction:v(r),tooltip:v(n)("mapnav.zoomOut")},{default:E(()=>p[1]||(p[1]=[m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[m("path",{d:"M19 13H5v-2h14v2z"}),m("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),le=M({__name:"draw-nav-section",props:{showOutline:{type:Boolean,default:!1}},setup(d){const n=I("iApi"),{t:a}=F(),e=te();e.mapNavEl=J("mapNavEl");const r=[{type:"point",icon:w(y(()=>import("./point-icon-5wWrBoxA.js")))},{type:"polyline",icon:w(y(()=>import("./polyline-icon-BWRJ8nl9.js")))},{type:"polygon",icon:w(y(()=>import("./polygon-icon-CV_tVWdR.js")))},{type:"circle",icon:w(y(()=>import("./circle-icon-D1s6aq5r.js")))},{type:"rectangle",icon:w(y(()=>import("./rectangle-icon-C_eA1re1.js")))}],t=L(()=>{const l=r.filter(u=>e.supportedTypes.some(_=>_.type===u.type));return l.push({type:"edit",icon:w(y(()=>import("./edit-icon-Bvy5yElH.js")))}),l}),p=l=>{e.activeTool===l?e.setActiveTool(null):e.setActiveTool(l)},s=()=>{n.geo.map.setMouseFocus()};return(l,u)=>{const _=H("mapnav-button");return o(),i("div",{class:T([{active:v(e).activeTool||v(e).activeTool==""},"mapnav-section bg-white-75 hover:bg-white"])},[(o(!0),i(k,null,N(t.value,(h,C)=>(o(),b(_,{key:h.type,onMousedown:s,onClickFunction:()=>p(h.type),tooltip:v(a)(`draw.${h.type}.tooltip`),style:Z({marginBottom:C!==t.value.length-1?"0px":"0"}),showOutline:d.showOutline,class:T({"active-tool":v(e).activeTool===h.type}),ref_for:!0,ref:"mapNavEl"},{default:E(()=>[(o(),b(S(h.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","style","showOutline","class"]))),128))],2)}}}),D=A(le,[["__scopeId","data-v-2036016d"]]),re={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},pe=["content"],ce={class:"mapnav-section bg-white-75 hover:bg-white"},ve={key:1,class:"mapnav-section bg-white-75 hover:bg-white"},me=["content"],ue={key:0},he=M({__name:"mapnav",setup(d){const n=z(void 0),a=I("iApi"),e=B(),{t:r}=F(),t=z(),p=L(()=>a.getConfig().fixtures.mapnav.items.some(c=>c==="draw")),s=z(a.$rootEl?.clientHeight),l=z(!1),u=z(0),_=()=>{s.value=a.$rootEl?.clientHeight},h=()=>{t.value._tippy.hide()},C=c=>{oe(c,t.value)&&t.value._tippy.show()};K(()=>{t.value?.addEventListener("blur",h),t.value?.addEventListener("keyup",C),n.value=new ResizeObserver(_),n.value.observe(a.$rootEl),Q(()=>{u.value=O.value.length*82})}),X(()=>{t.value?.removeEventListener("blur",h),t.value?.removeEventListener("keyup",C),n.value.disconnect()});const O=L(()=>e.order.map(c=>e.items[c]).filter(c=>c.componentId&&c.id!=="draw"));return(c,f)=>{const G=H("mapnav-button"),R=W("focus-list"),P=W("tippy");return o(),i("div",re,[j((o(),i("div",{class:"mapnav-section flex flex-col",content:v(r)("panels.controls.items"),ref_key:"el",ref:t},[p.value&&s.value>u.value?(o(),i(k,{key:0},[g(D),f[0]||(f[0]=m("span",{class:"py-1"},null,-1))],64)):x("",!0),g(se,{class:"mapnav-section bg-white-75 hover:bg-white"}),f[2]||(f[2]=m("span",{class:"py-1"},null,-1)),m("div",ce,[s.value<=u.value?(o(),b(G,{key:0,class:"self-center",onClickFunction:()=>{l.value=!l.value},tooltip:l.value?c.$t("mapnav.closeMenu"):c.$t("mapnav.openMenu")},{default:E(()=>[(o(),i("svg",{xmlns:"http://www.w3.org/2000/svg","shape-rendering":"geometricPrecision","text-rendering":"geometricPrecision","image-rendering":"optimizeQuality","fill-rule":"evenodd","clip-rule":"evenodd",viewBox:"0 0 319 511.61",class:T(["fill-current w-6 mx-auto transition-all transform",{"rotate-180":l.value}])},f[1]||(f[1]=[m("path",{d:"m270.08 5.89 43.04 43.04c7.85 7.86 7.83 20.72 0 28.54L134.77 255.82l178.35 178.35c7.85 7.86 7.8 20.73 0 28.54l-43.04 43.04c-7.83 7.82-20.71 7.82-28.54 0L49.29 313.49l-.37-.36-43.04-43.04c-7.82-7.83-7.86-20.68 0-28.54l43.04-43.04.37-.36L241.54 5.89c7.85-7.85 20.68-7.85 28.54 0z"},null,-1)]),2))]),_:1},8,["onClickFunction","tooltip"])):x("",!0)]),s.value>u.value?(o(),i("div",ve,[(o(!0),i(k,null,N(O.value,($,Y)=>(o(),i(k,{key:$.id+"button"},[(o(),b(S($.id+"-nav-button"))),Y!==O.value.length-1?(o(),b(q,{key:0,class:"mapnav-divider"})):x("",!0)],64))),128))])):x("",!0)],8,pe)),[[R],[P,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]]),s.value<=u.value&&l.value?j((o(),i("div",{key:0,class:"mapnav-section flex flex-col flex-wrap-reverse shadow-tm absolute right-56 bottom-36 sm:bottom-48 items-start z-50 gap-0.5",style:Z({maxHeight:`${(s.value-70)*.8}px`,height:"fit-content",width:"fit-content"}),content:v(r)("panels.controls.items")},[p.value?(o(),i("div",ue,[g(D,{showOutline:""})])):x("",!0),(o(!0),i(k,null,N(O.value,$=>(o(),b(S($.id+"-nav-button"),{key:$.id+"button",class:"mapnav-section bg-white-75 hover:bg-white",showOutline:""}))),128))],12,me)),[[P,{trigger:"manual",placement:"top-end",maxWidth:190}]]):x("",!0)])}}}),de=A(he,[["__scopeId","data-v-7a8c17a8"]]);class fe extends U{mapnavStore=B(this.$vApp.$pinia);get config(){return super.config}_parseConfig(n){if(!n)return;const a=n.items.map(e=>({id:e}));this.mapnavStore.items=a.reduce((e,r)=>(e[r.id]=r,e),{}),this.mapnavStore.order=a.map(e=>e.id),this._validateItems()}_validateItems(){const n=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(a=>{(this.$iApi.fixture.exists(a)||n.includes(a))&&(this.mapnavStore.items[a].componentId=`${a}-nav-button`)})}}const ge={en:{"mapnav.openMenu":"Open navigation","mapnav.closeMenu":"Close navigation","mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.openMenu":"Ouvrir la navigation","mapnav.closeMenu":"Fermer la navigation","mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arri\xE8re","mapnav.home":"Accueil","mapnav.fullscreen":"Plein \xC9cran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refus\xE9e. Veuillez v\xE9rifier les param\xE8tres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu \xEAtre trouv\xE9."}};class we extends fe{async added(){Object.entries(ge).forEach(t=>this.$iApi.$i18n.mergeLocaleMessage(...t));const{destroy:n,el:a}=this.mount(de,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(a.childNodes[0]),this._parseConfig(this.config);const e=this.$vApp.$watch(()=>this.config,t=>this._parseConfig(t)),r=this.$iApi.event.on(ee.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{e(),this.$iApi.event.off(r);const t=B(this.$vApp.$pinia),p={...t.items};Object.keys(p).forEach(s=>t.removeItem(s)),t.$reset(),n()}}}export{we as default};
