import{e as _}from"./memoryEstimations-HljZip0q.js";import{e as p}from"./OptimizedGeometry-BBZXbf77.js";function O(n,t){return n?t?4:3:t?3:2}function V(n,t,e,s){if(!t?.lengths.length)return null;n.lengths.length&&(n.lengths.length=0),n.coords.length&&(n.coords.length=0);const r=n.coords,o=[],I=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:l,coords:u}=t,g=O(e,s);let m=0;for(const i of l){const c=w(I,u,m,i,e,s);c&&o.push(c),m+=i*g}if(o.sort((i,c)=>{let f=i[2]-c[2];return f===0&&e&&(f=i[4]-c[4]),f}),o.length){let i=6*o[0][2];r[0]=o[0][0]/i,r[1]=o[0][1]/i,e&&(i=6*o[0][4],r[2]=i!==0?o[0][3]/i:0),(r[0]<I[0]||r[0]>I[1]||r[1]<I[2]||r[1]>I[3]||e&&(r[2]<I[4]||r[2]>I[5]))&&(r.length=0)}if(!r.length){const i=t.lengths[0]?A(u,0,l[0],e,s):null;if(!i)return null;r[0]=i[0],r[1]=i[1],e&&i.length>2&&(r[2]=i[2])}return n}function w(n,t,e,s,r,o){const I=O(r,o);let l=e,u=e+I,g=0,m=0,i=0,c=0,f=0;for(let E=0,Y=s-1;E<Y;E++,l+=I,u+=I){const h=t[l],N=t[l+1],a=t[l+2],d=t[u],b=t[u+1],S=t[u+2];let y=h*b-d*N;c+=y,g+=(h+d)*y,m+=(N+b)*y,r&&(y=h*S-d*a,i+=(a+S)*y,f+=y),h<n[0]&&(n[0]=h),h>n[1]&&(n[1]=h),N<n[2]&&(n[2]=N),N>n[3]&&(n[3]=N),r&&(a<n[4]&&(n[4]=a),a>n[5]&&(n[5]=a))}if(c>0&&(c*=-1),f>0&&(f*=-1),!c)return null;const T=[g,m,.5*c];return r&&(T[3]=i,T[4]=.5*f),T}function A(n,t,e,s,r){const o=O(s,r);let I=t,l=t+o,u=0,g=0,m=0,i=0;for(let c=0,f=e-1;c<f;c++,I+=o,l+=o){const T=n[I],E=n[I+1],Y=n[I+2],h=n[l],N=n[l+1],a=n[l+2],d=s?M(T,E,Y,h,N,a):G(T,E,h,N);if(d)if(u+=d,s){const b=j(T,E,Y,h,N,a);g+=d*b[0],m+=d*b[1],i+=d*b[2]}else{const b=P(T,E,h,N);g+=d*b[0],m+=d*b[1]}}return u>0?s?[g/u,m/u,i/u]:[g/u,m/u]:e>0?s?[n[t],n[t+1],n[t+2]]:[n[t],n[t+1]]:null}function G(n,t,e,s){const r=e-n,o=s-t;return Math.sqrt(r*r+o*o)}function M(n,t,e,s,r,o){const I=s-n,l=r-t,u=o-e;return Math.sqrt(I*I+l*l+u*u)}function P(n,t,e,s){return[n+.5*(e-n),t+.5*(s-t)]}function j(n,t,e,s,r,o){return[n+.5*(s-n),t+.5*(r-t),e+.5*(o-e)]}class F{constructor(t=null,e={},s,r,o=0){this.geometry=t,this.attributes=e,this.centroid=s,this.objectId=r,this.displayId=o}static fromJSON(t){const e=t.geometry?p.fromJSON(t.geometry):null,s=t.centroid?p.fromJSON(t.centroid):null,r=t.objectId;return new F(e,t.attributes,s,r)}weakClone(){const t=new F(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t}clone(){const t=this.geometry?.clone(),e=new F(t,{...this.attributes},this.centroid?.clone(),this.objectId);return e.displayId=this.displayId,e}ensureCentroid(t){return this.centroid??=V(new p,this.geometry,t.hasZ,t.hasM),this.centroid}get usedMemory(){return 128+_(this.attributes)+(this.geometry?.usedMemory??0)}}function q(n){return!!n.geometry?.coords?.length}export{V as n,q as o,F as s};
