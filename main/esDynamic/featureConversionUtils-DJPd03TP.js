import{i as ce,s as z,aB as ie,aC as ae,aD as fe,aE as he,aF as F,aG as ge,aH as de,aI as me,aJ as ye}from"./main-CnDVnExo.js";import{s as k}from"./OptimizedFeature-Ch3Mnc5k.js";import{e as pe}from"./OptimizedFeatureSet-Dz5hF8Qm.js";import{e as P}from"./OptimizedGeometry-BBZXbf77.js";function w(e,t){return e?t?4:3:t?3:2}const L=()=>ce.getLogger("esri.layers.graphics.featureConversionUtils"),S={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},we=(e,t,o,n,u,s)=>{e[o]=u,e[o+1]=s},ee=(e,t,o,n,u,s)=>{e[o]=u,e[o+1]=s,e[o+2]=t[n+2]},Me=(e,t,o,n,u,s)=>{e[o]=u,e[o+1]=s,e[o+2]=t[n+3]},Ge=(e,t,o,n,u,s)=>{e[o]=u,e[o+1]=s,e[o+2]=t[n+2],e[o+3]=t[n+3]};function C(e,t,o,n){if(e){if(o)return t&&n?Ge:ee;if(t&&n)return Me}else if(t&&n)return ee;return we}function R({scale:e,translate:t},o){return Math.round((o-t[0])/e[0])}function U({scale:e,translate:t},o){return Math.round((t[1]-o)/e[1])}function V({scale:e,translate:t},o){return Math.round((o-t[0])/e[0])}function Y({scale:e,translate:t},o){return Math.round((o-t[1])/e[1])}function _({scale:e,translate:t},o,n){return o*e[n]+t[n]}function be(e,t,o){return e?t?o?D(e):q(e):o?A(e):$(e):null}function $(e){const t=e.coords;return{x:t[0],y:t[1]}}function te(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function q(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function Pe(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function A(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function Te(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function D(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function Ie(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function xe(e,t,o,n){let u=$;o&&n?u=D:o?u=q:n&&(u=A);for(const s of t){const{geometry:r,attributes:l}=s,i=r!=null?u(r):null;e.push({attributes:l,geometry:i})}return e}function O(e,t){return e&&t?Ie:e?Pe:t?Te:te}function Ze(e,t,o,n,u){const s=O(o,n);for(const r of t){const l=r.geometry!=null?s(new P,r.geometry):null;e.push(new k(l,r.attributes,null,F(r,u)))}return e}function oe(e,t,o=O(t.z!=null,t.m!=null)){return o(e,t)}function Ne(e,t,o,n){for(const{geometry:u,attributes:s}of t)e.push({attributes:s,geometry:u!=null?B(u,o,n):null});return e}function B(e,t,o){if(e==null)return null;const n=w(t,o),u=[];for(let s=0;s<e.coords.length;s+=n){const r=[];for(let l=0;l<n;l++)r.push(e.coords[s+l]);u.push(r)}return t?o?{points:u,hasZ:t,hasM:o}:{points:u,hasZ:t}:o?{points:u,hasM:o}:{points:u}}function ke(e,t,o,n,u){const s=w(o,n);for(const r of t){const l=r.geometry!=null?ne(new P,r.geometry,s):null;e.push(new k(l,r.attributes,null,F(r,u)))}return e}function ne(e,t,o=w(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const n=e.coords;let u=0;for(const s of t.points)for(let r=0;r<o;r++)n[u++]=s[r];return e}function Ee(e,t,o,n){for(const{geometry:u,attributes:s}of t)e.push({attributes:s,geometry:u!=null?H(u,o,n):null});return e}function H(e,t,o){if(!e)return null;const n=w(t,o),{coords:u,lengths:s}=e,r=[];let l=0;for(const i of s){const c=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<n;h++)f.push(u[l++]);c.push(f)}r.push(c)}return t?o?{paths:r,hasZ:t,hasM:o}:{paths:r,hasZ:t}:o?{paths:r,hasM:o}:{paths:r}}function Fe(e,t,o,n,u){const s=w(o,n);for(const r of t){const l=r.geometry!=null?se(new P,r.geometry,s):null,i=r.centroid!=null?oe(new P,r.centroid):null;e.push(new k(l,r.attributes,i,F(r,u)))}return e}function se(e,t,o=w(t.hasZ,t.hasM)){const{lengths:n,coords:u}=e;let s=0;for(const r of t.paths){for(const l of r)for(let i=0;i<o;i++)u[s++]=l[i];n.push(r.length)}return e}function ve(e,t,o,n){for(const{geometry:u,attributes:s,centroid:r}of t){const l=u!=null?J(u,o,n):null;if(r!=null){const i=$(r);e.push({attributes:s,centroid:i,geometry:l})}else e.push({attributes:s,geometry:l})}return e}function J(e,t,o){if(!e)return null;const n=w(t,o),{coords:u,lengths:s}=e,r=[];let l=0;for(const i of s){const c=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<n;h++)f.push(u[l++]);c.push(f)}r.push(c)}return t?o?{rings:r,hasZ:t,hasM:o}:{rings:r,hasZ:t}:o?{rings:r,hasM:o}:{rings:r}}function ze(e,t,o,n,u){for(const s of t){const r=s.geometry!=null?Q(new P,s.geometry,o,n):null,l=F(s,u);s.centroid!=null?e.push(new k(r,s.attributes,te(new P,s.centroid),l)):e.push(new k(r,s.attributes,null,l))}return e}function Q(e,t,o=t.hasZ,n=t.hasM){return re(e,t.rings,o,n)}function re(e,t,o,n){const u=w(o,n),{lengths:s,coords:r}=e;let l=0;x(e);for(const i of t){for(const c of i)for(let a=0;a<u;a++)r[l++]=c[a];s.push(i.length)}return e}const E=[],v=[];function Le(e,t,o,n,u){E[0]=e;const[s]=X(v,E,t,o,n,u);return T(E),T(v),s}function X(e,t,o,n,u,s){if(T(e),!o){for(const r of t){const l=F(r,s);e.push(new k(null,r.attributes,null,l))}return e}switch(o){case"esriGeometryPoint":return Ze(e,t,n,u,s);case"esriGeometryMultipoint":return ke(e,t,n,u,s);case"esriGeometryPolyline":return Fe(e,t,n,u,s);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return ze(e,t,n,u,s);default:L().error("convertToFeatureSet:unknown-geometry",new z("internal:geometry",`Unable to parse unknown geometry type '${o}'`)),T(e)}return e}function Re(e,t,o,n){v[0]=e,le(E,v,t,o,n);const u=E[0];return T(E),T(v),u}function Ue(e,t,o){if(e==null)return null;const n=new P;return"hasZ"in e&&t==null&&(t=e.hasZ),"hasM"in e&&o==null&&(o=e.hasM),ie(e)?O(t??e.z!=null,o??e.m!=null)(n,e):ae(e)?Q(n,e,t,o):fe(e)?se(n,e,w(t,o)):he(e)?ne(n,e,w(t,o)):void L().error("convertFromGeometry:unknown-geometry",new z("internal:geometry",`Unable to parse unknown geometry type '${e}'`))}function ue(e,t,o,n){const u=e&&("coords"in e?e:e.geometry);if(u==null)return null;switch(t){case"esriGeometryPoint":{let s=$;return o&&n?s=D:o?s=q:n&&(s=A),s(u)}case"esriGeometryMultipoint":return B(u,o,n);case"esriGeometryPolyline":return H(u,o,n);case"esriGeometryPolygon":return J(u,o,n);default:return L().error("convertToGeometry:unknown-geometry",new z("internal:geometry",`Unable to parse unknown geometry type '${t}'`)),null}}function $e(e,t){for(const o of t)e.push({attributes:o.attributes});return e}function le(e,t,o,n,u){if(T(e),o==null)return $e(e,t);switch(o){case"esriGeometryPoint":return xe(e,t,n,u);case"esriGeometryMultipoint":return Ne(e,t,n,u);case"esriGeometryPolyline":return Ee(e,t,n,u);case"esriGeometryPolygon":return ve(e,t,n,u);default:L().error("convertToFeatureSet:unknown-geometry",new z("internal:geometry",`Unable to parse unknown geometry type '${o}'`))}return e}function Se(e){const{spatialReference:t,transform:o,fields:n,hasM:u,hasZ:s,features:r,geometryType:l,exceededTransferLimit:i,queryGeometry:c,queryGeometryType:a}=e,f={features:le([],r,l,s,u),fields:n,geometryType:l,spatialReference:t,queryGeometry:ue(c,a,!1,!1)};return o&&(f.transform=o),i&&(f.exceededTransferLimit=i),u&&(f.hasM=u),s&&(f.hasZ=s),f}function Ce(e,t){const o=new pe,{hasM:n,hasZ:u,features:s,spatialReference:r,geometryType:l,exceededTransferLimit:i,transform:c,fields:a}=e;return a&&(o.fields=a),o.geometryType=l??null,o.spatialReference=r??null,s&&X(o.features,s,l,u,n,t),i&&(o.exceededTransferLimit=i),n&&(o.hasM=n),u&&(o.hasZ=u),c&&(o.transform=c),o}function Ve(e){const{transform:t,features:o,hasM:n,hasZ:u}=e;if(!t)return e;for(const s of o)s.geometry!=null&&W(s.geometry,s.geometry,n,u,t),s.centroid!=null&&W(s.centroid,s.centroid,n,u,t);return e.transform=null,e}function Ye(e,t){const{geometryType:o,features:n,hasM:u,hasZ:s}=t;if(!e)return t;for(let r=0;r<n.length;r++){const l=n[r],i=l.weakClone();i.geometry=new P,j(i.geometry,l.geometry,u,s,o,e),l.centroid&&(i.centroid=new P,j(i.centroid,l.centroid,u,s,"esriGeometryPoint",e)),n[r]=i}return t.transform=e,t}function j(e,t,o,n,u,s,r=o,l=n){if(x(e),!t?.coords.length)return null;const i=S[u],{coords:c,lengths:a}=t,f=w(o,n),h=w(o&&r,n&&l),d=C(o,n,r,l);if(!a.length)return d(e.coords,c,0,0,R(s,c[0]),U(s,c[1])),x(e,f,0),e;let g,y,M,b,p=0,m=0,G=m;for(const Z of a){if(Z<i)continue;let I=0;m=G,M=g=R(s,c[p]),b=y=U(s,c[p+1]),d(e.coords,c,m,p,M,b),I++,p+=f,m+=h;for(let N=1;N<Z;N++,p+=f)M=R(s,c[p]),b=U(s,c[p+1]),M===g&&b===y||(d(e.coords,c,m,p,M-g,b-y),m+=h,I++,g=M,y=b);I>=i&&(e.lengths.push(I),G=m)}return T(e.coords,G),e.coords.length?e:null}function _e(e,t,o,n,u,s,r=o,l=n){if(x(e),!t?.coords.length)return null;const i=S[u],{coords:c,lengths:a}=t,f=w(o,n),h=w(o&&r,n&&l),d=C(o,n,r,l);if(!a.length)return d(e.coords,c,0,0,c[0],c[1]),x(e,f,0),e;let g=0;const y=s*s;for(const M of a){if(M<i){g+=M*f;continue}const b=e.coords.length/h,p=g,m=g+(M-1)*f;d(e.coords,c,e.coords.length,p,c[p],c[p+1]),K(e.coords,c,f,y,d,p,m),d(e.coords,c,e.coords.length,m,c[m],c[m+1]);const G=e.coords.length/h-b;G>=i?e.lengths.push(G):T(e.coords,b*h),g+=M*f}return e.coords.length?e:null}function qe(e,t,o,n){const u=e[t],s=e[t+1],r=e[o],l=e[o+1],i=e[n],c=e[n+1];let a=r,f=l,h=i-a,d=c-f;if(h!==0||d!==0){const g=((u-a)*h+(s-f)*d)/(h*h+d*d);g>1?(a=i,f=c):g>0&&(a+=h*g,f+=d*g)}return h=u-a,d=s-f,h*h+d*d}function K(e,t,o,n,u,s,r){let l,i=n,c=0;for(let a=s+o;a<r;a+=o)l=qe(t,a,s,r),l>i&&(c=a,i=l);i>n&&(c-s>o&&K(e,t,o,n,u,s,c),u(e,t,e.length,c,t[c],t[c+1]),r-c>o&&K(e,t,o,n,u,c,r))}function Ae(e,t,o,n){if(!t?.coords?.length)return null;const u=w(o,n);let s=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(t&&t.coords){const c=t.coords;for(let a=0;a<c.length;a+=u){const f=c[a],h=c[a+1];s=Math.min(s,f),l=Math.max(l,f),r=Math.min(r,h),i=Math.max(i,h)}}return de(e)?me(e,s,r,l,i):ye(s,r,l,i,e),e}function W(e,t,o,n,u){const{coords:s,lengths:r}=t,l=w(o,n);if(!s.length)return e!==t&&x(e),e;ge(u);const{originPosition:i,scale:c,translate:a}=u,f=Qe;f.originPosition=i;const h=f.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;const d=f.translate;if(d[0]=a[0]??0,d[1]=a[1]??0,d[2]=a[2]??0,d[3]=a[3]??0,!r.length){for(let y=0;y<l;++y)e.coords[y]=_(f,s[y],y);return e!==t&&x(e,l,0),e}let g=0;for(let y=0;y<r.length;y++){const M=r[y];e.lengths[y]=M;for(let m=0;m<l;++m)e.coords[g+m]=_(f,s[g+m],m);let b=e.coords[g],p=e.coords[g+1];g+=l;for(let m=1;m<M;m++,g+=l){b+=s[g]*h[0],p+=s[g+1]*h[1],e.coords[g]=b,e.coords[g+1]=p;for(let G=2;G<l;++G)e.coords[g+G]=_(f,s[g+G],G)}}return e!==t&&x(e,s.length,r.length),e}function De(e,t,o,n,u,s){if(x(e),e.lengths.push(...t.lengths),o===u&&n===s)for(let r=0;r<t.coords.length;r++)e.coords.push(t.coords[r]);else{const r=w(o,n),l=C(o,n,u,s),i=t.coords;for(let c=0;c<i.length;c+=r)l(e.coords,i,e.coords.length,c,i[c],i[c+1])}return e}function Oe(e,t,o,n){let u=0,s=e[n*t],r=e[n*(t+1)];for(let l=1;l<o;l++){const i=s+e[n*(t+l)],c=r+e[n*(t+l)+1],a=(i-s)*(c+r);s=i,r=c,u+=a}return .5*u}function Be(e,t){const{coords:o,lengths:n}=e;let u=0,s=0;for(let r=0;r<n.length;r++){const l=n[r];s+=Oe(o,u,l,t),u+=l}return Math.abs(s)}function He(e,t,o,n){return e*n-o*t===0&&e*o+t*n>0}function Je(e,t,o,n,u){const s=w(n,u);if(!e.lengths.length){if(e.coords.length<2)return null;const[f,h]=e.coords,d=V(t,f),g=Y(t,h);return new P([],[d,g])}const r=new P([],[0,0]),l=S[o],i=o==="esriGeometryPolygon"||o==="esriGeometryPolyline";let c=0,a=0;for(let f=0;f<e.lengths.length;f++){const h=e.lengths[f],d=a;let g=V(t,e.coords[s*c]),y=Y(t,e.coords[s*c+1]);r.coords[a++]=g,r.coords[a++]=y;let M=0,b=0,p=1;for(let m=1;m<h;m++){const G=V(t,e.coords[s*(m+c)]),Z=Y(t,e.coords[s*(m+c)+1]);if(G!==g||Z!==y){const I=G-g,N=Z-y;i&&He(M,b,I,N)?(r.coords[a-2]+=I,r.coords[a-1]+=N,g+=I,y+=N):(r.coords[a++]=G,r.coords[a++]=Z,g=G,y=Z,M=I,b=N,p+=1)}}p<l?a=d:r.lengths.push(p),c+=h}return r.lengths.length===0?null:r}function x(e,t=0,o=0){T(e.lengths,o),T(e.coords,t)}function T(e,t=0){e.length!==t&&(e.length=t)}const Qe={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{B as $,H as D,be as E,De as G,Ae as M,Be as N,J as Q,oe as R,U as T,Q as X,Ce as a,R as b,_e as d,Se as f,j as g,Ve as h,ue as l,Ye as m,Le as o,X as r,Re as s,re as t,Ue as u,W as w,Je as x};
