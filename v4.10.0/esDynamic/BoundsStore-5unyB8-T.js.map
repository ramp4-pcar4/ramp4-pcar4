{"version":3,"file":"BoundsStore-5unyB8-T.js","sources":["../../node_modules/@arcgis/core/layers/graphics/data/BoundsStore.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport has from\"../../../core/has.js\";import{PooledRBush as i}from\"../../../core/libs/rbush/PooledRBush.js\";import{empty as s}from\"../../../geometry/support/aaBoundingRect.js\";const d=5e4,n={minX:0,minY:0,maxX:0,maxY:0};function t(i){n.minX=i[0],n.minY=i[1],n.maxX=i[2],n.maxY=i[3]}function e(i,s,d){t(s),i.search(n,d)}class o{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new i(9,has(\"esri-csp-restrictions\")?i=>({minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]}):[\"[0]\",\"[1]\",\"[2]\",\"[3]\"]),this._loadIndex=()=>{if(this._indexInvalid){const i=new Array(this._idByBounds.size);let s=0;this._idByBounds.forEach(((d,n)=>{i[s++]=n})),this._indexInvalid=!1,this._index.clear(),this._index.load(i)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((i=>this._idByBounds.has(i)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const i=s();for(const s of this._boundsById.values())s&&(i[0]=Math.min(s[0],i[0]),i[1]=Math.min(s[1],i[1]),i[2]=Math.max(s[2],i[2]),i[3]=Math.max(s[3],i[3]));return i}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(i){const s=this._boundsById.get(i);this._boundsById.delete(i),s&&(this._idByBounds.delete(s),this._indexInvalid||this._index.remove(s))}forEachInBounds(i,s){this._loadIndex(),e(this._index,i,(i=>s(this._idByBounds.get(i))))}get(i){return this._boundsById.get(i)}has(i){return this._boundsById.has(i)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(i,s){if(!this._indexInvalid){const s=this._boundsById.get(i);s&&(this._index.remove(s),this._idByBounds.delete(s))}this._boundsById.set(i,s),s&&(this._idByBounds.set(s,i),this._indexInvalid||(this._boundsToLoad.push(s),this._boundsToLoad.length>d&&this._loadIndex()))}}export{o as BoundsStore};\n"],"names":["d","n","t","e","o","i","has","s"],"mappings":";;AAIgL,MAAMA,IAAE,KAAIC,IAAE,EAAC,MAAK,GAAE,MAAK,GAAE,MAAK,GAAE,MAAK,EAAC;AAAE,SAASC,EAAE,GAAE;AAAC,EAAAD,EAAE,OAAK,EAAE,CAAC,GAAEA,EAAE,OAAK,EAAE,CAAC,GAAEA,EAAE,OAAK,EAAE,CAAC,GAAEA,EAAE,OAAK,EAAE,CAAC;AAAC;AAAC,SAASE,EAAE,GAAE,GAAE,GAAE;AAAC,EAAAD,EAAE,CAAC,GAAE,EAAE,OAAOD,GAAE,CAAC;AAAC;AAAC,MAAMG,EAAC;AAAA,EAAC,cAAa;AAAC,SAAK,gBAAc,IAAG,KAAK,gBAAc,CAAE,GAAC,KAAK,cAAY,oBAAI,OAAI,KAAK,cAAY,oBAAI,OAAI,KAAK,SAAO,IAAIC,EAAE,GAAEC,EAAI,uBAAuB,IAAE,CAAAD,OAAI,EAAC,MAAKA,EAAE,CAAC,GAAE,MAAKA,EAAE,CAAC,GAAE,MAAKA,EAAE,CAAC,GAAE,MAAKA,EAAE,CAAC,EAAC,KAAG,CAAC,OAAM,OAAM,OAAM,KAAK,CAAC,GAAE,KAAK,aAAW,MAAI;AAAC,UAAG,KAAK,eAAc;AAAC,cAAMA,IAAE,IAAI,MAAM,KAAK,YAAY,IAAI;AAAE,YAAIE,IAAE;AAAE,aAAK,YAAY,QAAS,CAACP,GAAEC,MAAI;AAAC,UAAAI,EAAEE,GAAG,IAAEN;AAAA,QAAC,CAAG,GAAC,KAAK,gBAAc,IAAG,KAAK,OAAO,MAAO,GAAC,KAAK,OAAO,KAAKI,CAAC;AAAA,MAAC,MAAM,MAAK,cAAc,WAAS,KAAK,OAAO,KAAK,MAAM,KAAK,IAAI,IAAI,KAAK,cAAc,OAAQ,CAAAA,MAAG,KAAK,YAAY,IAAIA,CAAC,EAAG,CAAC,CAAC,GAAE,KAAK,cAAc,SAAO;AAAA,IAAE;AAAA,EAAC;AAAA,EAAC,IAAI,aAAY;AAAC,QAAG,CAAC,KAAK,YAAY,KAAK,QAAO;AAAK,UAAMA,IAAEE;AAAI,eAAUA,KAAK,KAAK,YAAY,SAAS,CAAAA,MAAIF,EAAE,CAAC,IAAE,KAAK,IAAIE,EAAE,CAAC,GAAEF,EAAE,CAAC,CAAC,GAAEA,EAAE,CAAC,IAAE,KAAK,IAAIE,EAAE,CAAC,GAAEF,EAAE,CAAC,CAAC,GAAEA,EAAE,CAAC,IAAE,KAAK,IAAIE,EAAE,CAAC,GAAEF,EAAE,CAAC,CAAC,GAAEA,EAAE,CAAC,IAAE,KAAK,IAAIE,EAAE,CAAC,GAAEF,EAAE,CAAC,CAAC;AAAG,WAAOA;AAAA,EAAC;AAAA,EAAC,IAAI,QAAO;AAAC,WAAM,CAAC,KAAK;AAAA,EAAa;AAAA,EAAC,QAAO;AAAC,SAAK,gBAAc,IAAG,KAAK,cAAc,SAAO,GAAE,KAAK,YAAY,MAAO,GAAC,KAAK,YAAY,MAAK,GAAG,KAAK,OAAO,MAAO;AAAA,EAAA;AAAA,EAAC,OAAOA,GAAE;AAAC,UAAME,IAAE,KAAK,YAAY,IAAIF,CAAC;AAAE,SAAK,YAAY,OAAOA,CAAC,GAAEE,MAAI,KAAK,YAAY,OAAOA,CAAC,GAAE,KAAK,iBAAe,KAAK,OAAO,OAAOA,CAAC;AAAA,EAAE;AAAA,EAAC,gBAAgBF,GAAEE,GAAE;AAAC,SAAK,WAAU,GAAGJ,EAAE,KAAK,QAAOE,GAAG,CAAAA,MAAGE,EAAE,KAAK,YAAY,IAAIF,CAAC,CAAC;EAAG;AAAA,EAAC,IAAIA,GAAE;AAAC,WAAO,KAAK,YAAY,IAAIA,CAAC;AAAA,EAAC;AAAA,EAAC,IAAIA,GAAE;AAAC,WAAO,KAAK,YAAY,IAAIA,CAAC;AAAA,EAAC;AAAA,EAAC,kBAAiB;AAAC,SAAK,kBAAgB,KAAK,gBAAc,IAAG,KAAK,cAAc,SAAO;AAAA,EAAE;AAAA,EAAC,IAAIA,GAAEE,GAAE;AAAC,QAAG,CAAC,KAAK,eAAc;AAAC,YAAMA,IAAE,KAAK,YAAY,IAAIF,CAAC;AAAE,MAAAE,MAAI,KAAK,OAAO,OAAOA,CAAC,GAAE,KAAK,YAAY,OAAOA,CAAC;AAAA,IAAE;AAAC,SAAK,YAAY,IAAIF,GAAEE,CAAC,GAAEA,MAAI,KAAK,YAAY,IAAIA,GAAEF,CAAC,GAAE,KAAK,kBAAgB,KAAK,cAAc,KAAKE,CAAC,GAAE,KAAK,cAAc,SAAOP,KAAG,KAAK,WAAY;AAAA,EAAE;AAAC;","x_google_ignoreList":[0]}