import{n as q,a as z,m as Yi}from"./TimeOnly-BR6daUyu.js";import{as as ji,bm as U,jY as Bi,jX as qe,n$ as Ye,o0 as pe,bp as Qi,o1 as Gi,Q as ur,jZ as Wi}from"./main-DCIX61zy.js";var d;(function(a){a.InvalidFunctionParameters="InvalidFunctionParameters",a.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",a.UnsupportedSqlFunction="UnsupportedSqlFunction",a.UnsupportedOperator="UnsupportedOperator",a.UnsupportedSyntax="UnsupportedSyntax",a.UnsupportedIsRhs="UnsupportedIsRhs",a.UnsupportedIsLhs="UnsupportedIsLhs",a.InvalidDataType="InvalidDataType",a.CannotCastValue="CannotCastValue",a.FunctionNotRecognized="FunctionNotRecognized",a.InvalidTime="InvalidTime",a.InvalidParameterCount="InvalidParameterCount",a.InvalidTimeStamp="InvalidTimeStamp",a.InvalidDate="InvalidDate",a.InvalidOperator="InvalidOperator",a.IllegalInterval="IllegalInterval",a.YearMonthIntervals="YearMonthIntervals",a.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",a.MissingStatisticParameters="MissingStatisticParameters"})(d||(d={}));const Xi={[d.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[d.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.UnsupportedOperator]:"Unsupported operator - {operator}",[d.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.UnsupportedSqlFunction]:"Sql function not found = {function}",[d.InvalidDataType]:"Invalid sql data type",[d.InvalidDate]:"Invalid date encountered",[d.InvalidOperator]:"Invalid operator encountered",[d.InvalidTime]:"Invalid time encountered",[d.IllegalInterval]:"Illegal interval",[d.FunctionNotRecognized]:"Function not recognized",[d.InvalidTimeStamp]:"Invalid timestamp encountered",[d.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[d.YearMonthIntervals]:"Year-Month Intervals not supported",[d.CannotCastValue]:"Cannot cast value to the required data type"};let m=class Cr extends Error{constructor(o,u){super(ji(Xi[o],u)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,Cr)}};function ir(a){return Number.isNaN(a)||a===0?a:Math.trunc(a)}let Y=class le{constructor(o){this._timeStampOffset=o,this._date=null}toDateTime(){return this._date??=U.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return ir(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return ir(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return le.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(o){return new le(U.fromJSDate(o).toISO({includeOffset:!0}))}static fromDateTime(o){return new le(o.toISO({includeOffset:!0}))}static fromParts(o,u,t=0,l=0,h=0,g=0,T=0,O=!1,S=0,x=0){const D=`${o.toString().padStart(4,"0")}-${u.toString().padStart(2,"0")}-${t.toString().padStart(2,"0")}`;let b="";g<10&&(b="0");let K=`${l.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}:${b+g.toString()}`;T!==0&&(K+="."+T.toString().padStart(3,"0"));const ee=`${O?"-":"+"}${S.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`;return new le(D+"T"+K+ee)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let o=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return o&&(o=o.replace(".000","")),o}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(o){const u=this.toDateTime().plus(o);return le.fromDateTime(u)}};function lr(a,o){const u=fr[a.toLowerCase()];if(u==null)throw new m(d.FunctionNotRecognized);if(o.length<u.minParams||o.length>u.maxParams)throw new m(d.InvalidParameterCount,{name:a.toUpperCase()});return u.evaluate(o)}function cr(a,o){const u=fr[a.toLowerCase()];return u!=null&&o>=u.minParams&&o<=u.maxParams}const fr={min:{minParams:1,maxParams:1,evaluate:a=>pr(a[0],"min")},max:{minParams:1,maxParams:1,evaluate:a=>pr(a[0],"max")},avg:{minParams:1,maxParams:1,evaluate:a=>dr(a[0])},sum:{minParams:1,maxParams:1,evaluate:a=>Ki(a[0])},stddev:{minParams:1,maxParams:1,evaluate:a=>el(a[0])},count:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].length},var:{minParams:1,maxParams:1,evaluate:a=>mr(a[0])}};function dr(a){if(a===null)return null;let o=0,u=0;for(let t=0;t<a.length;t++){const l=a[t];if(l!==null){if(!je(l))throw new m(d.InvalidValueForAggregateFunction);u++,o+=l}}return u===0?null:o/a.length}function je(a){return typeof a=="number"}function pr(a,o){if(a===null)return null;let u=null,t=null;for(const l of a){let h=l;h=l instanceof q||l instanceof z?l.toNumber():l instanceof U?l.toMillis():l instanceof Y?l.toMilliseconds():l,(u===null||o==="max"&&t!==null&&h!==null&&t<=h||o==="min"&&t!==null&&h!==null&&t>=h)&&(u=l,t=h)}return u}function Ki(a){if(a===null)return null;let o=0;for(let u=0;u<a.length;u++){const t=a[u];if(t!==null){if(!je(t))throw new m(d.InvalidValueForAggregateFunction);o+=t}}return o}function el(a){if(a===null)return null;const o=mr(a);return o===null?null:Math.sqrt(o)}function mr(a){if(a===null||(a=a.filter(t=>t!==null)).length===0)return null;const o=dr(a);if(o===null)return null;let u=0;for(const t of a){if(!je(t))throw new m(d.InvalidValueForAggregateFunction);u+=(o-t)**2}return u/(a.length-1)}class E{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static _fixDefaults(o){if(o.precision!==null||o.secondary!==null)throw new m(d.PrimarySecondaryQualifiers)}static _parseSecondsComponent(o,u){if(u.includes(".")){const t=u.split(".");o.second=parseFloat(t[0]),o.millis=parseInt(t[1],10)}else o.second=parseFloat(u)}static createFromMilliseconds(o){const u=new E;return u.second=o/1e3,u}static createFromValueAndQualifier(o,u,t){let l=null;const h=new E;if(h.op=t==="-"?"-":"+",u.type==="interval-period"){E._fixDefaults(u);const g=new RegExp("^[0-9]{1,}$");if(u.period==="year"||u.period==="month")throw new m(d.YearMonthIntervals);if(u.period==="second"){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(o))throw new m(d.IllegalInterval);E._parseSecondsComponent(h,o)}else{if(!g.test(o))throw new m(d.IllegalInterval);h[u.period]=parseFloat(o)}}else{if(E._fixDefaults(u.start),E._fixDefaults(u.end),u.start.period==="year"||u.start.period==="month"||u.end.period==="year"||u.end.period==="month")throw new m(d.YearMonthIntervals);switch(u.start.period){case"day":switch(u.end.period){case"hour":if(l=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!l.test(o))throw new m(d.IllegalInterval);h[u.start.period]=parseFloat(o.split(" ")[0]),h[u.end.period]=parseFloat(o.split(" ")[1]);break;case"minute":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!l.test(o))throw new m(d.IllegalInterval);{h[u.start.period]=parseFloat(o.split(" ")[0]);const g=o.split(" ")[1].split(":");h.hour=parseFloat(g[0]),h.minute=parseFloat(g[1])}break;case"second":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(o))throw new m(d.IllegalInterval);{h[u.start.period]=parseFloat(o.split(" ")[0]);const g=o.split(" ")[1].split(":");h.hour=parseFloat(g[0]),h.minute=parseFloat(g[1]),E._parseSecondsComponent(h,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"hour":switch(u.end.period){case"minute":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!l.test(o))throw new m(d.IllegalInterval);h.hour=parseFloat(o.split(":")[0]),h.minute=parseFloat(o.split(":")[1]);break;case"second":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(o))throw new m(d.IllegalInterval);{const g=o.split(":");h.hour=parseFloat(g[0]),h.minute=parseFloat(g[1]),E._parseSecondsComponent(h,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"minute":if(u.end.period!=="second")throw new m(d.IllegalInterval);if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(o))throw new m(d.IllegalInterval);{const g=o.split(":");h.minute=parseFloat(g[0]),E._parseSecondsComponent(h,g[1])}break;default:throw new m(d.IllegalInterval)}}return h}valueInMilliseconds(){return(this.op==="-"?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}const tl=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,rl=/^(\d{1,2}):(\d{1,2})$/,nl=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,hr=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,ol=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,al=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,sl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,ul=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function be(a,o){if(o instanceof Bi)return o===qe.instance?U.fromMillis(a.getTime(),{zone:qe.instance}):U.fromJSDate(a,{zone:o});switch(o){case"system":case"local":case null:return U.fromJSDate(a);default:return o?.toLowerCase()==="unknown"?U.fromMillis(a.getTime(),{zone:qe.instance}):U.fromJSDate(a,{zone:o})}}function J(a){return typeof a=="number"}function V(a){return typeof a=="string"||a instanceof String}function X(a){return a instanceof E}function j(a){return a instanceof Date}function F(a){return a instanceof U}function A(a){return a instanceof q}function L(a){return a instanceof z}function P(a){return a instanceof Y}function Be(a){let o=tl.exec(a);if(o!==null){const[,u,t,l]=o,h=z.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),0);if(h!==null)return h;throw new m(d.InvalidTime)}if(o=rl.exec(a),o!==null){const[,u,t]=o,l=z.fromParts(parseInt(u,10),parseInt(t,10),0,0);if(l!==null)return l;throw new m(d.InvalidTime)}if(o=nl.exec(a),o!==null){const[,u,t,l,h]=o,g=z.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),parseInt(h,10));if(g!==null)return g;throw new m(d.InvalidTime)}throw new m(d.InvalidTime)}function Fe(a,o,u=!1){let t=ol.exec(a);if(t!==null){const[,l,h,g,T,O,S,x]=t,D=U.fromObject({year:parseInt(l,10),month:parseInt(h,10),day:parseInt(g,10),hour:parseInt(T,10),minute:parseInt(O,10),second:parseInt(S,10),millisecond:x?parseInt(x.replace(".",""),10):0},{zone:Ye(o)});if(D.isValid===!1)throw new m(d.InvalidTimeStamp);return D}if(t=al.exec(a),t!==null){const[,l,h,g,T,O,S,x,D,b,K]=t,ee=Y.fromParts(parseInt(l,10),parseInt(h,10),parseInt(g,10),parseInt(T,10),parseInt(O,10),parseInt(S,10),x?parseInt(x.replace(".",""),10):0,D==="-",parseInt(b,10),parseInt(K,10));if(ee.isValid===!1)throw new m(d.InvalidTimeStamp);return ee}if(t=sl.exec(a),t!==null){const[,l,h,g,T,O,S,x,D]=t,b=Y.fromParts(parseInt(l,10),parseInt(h,10),parseInt(g,10),parseInt(T,10),parseInt(O,10),0,0,S==="-",parseInt(x,10),parseInt(D,10));if(b.isValid===!1)throw new m(d.InvalidTimeStamp);return b}if(t=ul.exec(a),t!==null){const[,l,h,g,T,O]=t,S=U.fromObject({year:parseInt(l,10),month:parseInt(h,10),day:parseInt(g,10),hour:parseInt(T,10),minute:parseInt(O,10),second:0},{zone:Ye(o)});if(S.isValid===!1)throw new m(d.InvalidTimeStamp);return S}if(t=hr.exec(a),t!==null){const[,l,h,g]=t,T=U.fromObject({year:parseInt(l,10),month:parseInt(h,10),day:parseInt(g,10),hour:0,minute:0,second:0},{zone:Ye(o)});if(T.isValid===!1)throw new m(d.InvalidTimeStamp);return T}throw new m(d.InvalidTimeStamp)}function vr(a,o){const u=hr.exec(a);if(u===null)try{return Fe(a,o)}catch{throw new m(d.InvalidDate)}const[,t,l,h]=u,g=q.fromParts(parseInt(t,10),parseInt(l,10),parseInt(h,10));if(g===null)throw new m(d.InvalidDate);return g}const il=321408e5,ll=26784e5,cl=864e5,fl=36e5,dl=6e4;function Qe(a){return!!F(a)||!!P(a)}function Ge(a){return!!F(a)||!!A(a)||!!P(a)||!!L(a)}function Ae(a){if(F(a))return a.toMillis();if(A(a))return a.toNumber();if(P(a))return a.toMilliseconds();throw new m(d.InvalidDataType)}function k(a,o,u,t){if(a==null||o==null)return null;if(J(a)){if(J(o))return Q(a,o,u);if(V(o))return pl(a,o,u);if(Ge(o))throw new m(d.InvalidOperator);if(A(o))throw new m(d.InvalidOperator)}else if(V(a)){if(J(o))return ml(a,o,u);if(V(o))return hl(a,o,u);if(F(o))throw new m(d.InvalidOperator);if(A(o))throw new m(d.InvalidOperator);if(L(o))throw new m(d.InvalidOperator);if(P(o))throw new m(d.InvalidOperator)}else if(F(a)){if(Qe(o)){if(a instanceof U&&pe(a.zone)){if(o instanceof U&&pe(o.zone)===!1||o instanceof Y)return We(a,o,u)}else if(o instanceof U&&pe(o.zone)&&(a instanceof U&&pe(a.zone)===!1||a instanceof Y))return We(a,o,u);return Q(Ae(a),Ae(o),u)}if(V(o))throw new m(d.InvalidOperator);if(A(o))return vl(a,o,u);if(L(o))throw new m(d.InvalidOperator);if(J(o))throw new m(d.InvalidOperator)}else if(A(a)){if(P(o))return gl(a,o,u);if(F(o))return Il(a,o,u);if(V(o))throw new m(d.InvalidOperator);if(A(o))return Q(a.toNumber(),o.toNumber(),u);if(L(o))throw new m(d.InvalidOperator);if(J(o))throw new m(d.InvalidOperator)}else if(L(a)){if(L(o))return Q(a.toNumber(),o.toNumber(),u);if(V(o))throw new m(d.InvalidOperator);if(J(o))throw new m(d.InvalidOperator);if(A(o))throw new m(d.InvalidOperator);if(Qe(o))throw new m(d.InvalidOperator)}else if(P(a)){if(Qe(o))return o instanceof U&&pe(o.zone)?We(a,o,u):Q(Ae(a),Ae(o),u);if(V(o))throw new m(d.InvalidOperator);if(A(o))return wl(a,o,u);if(L(o))throw new m(d.InvalidOperator);if(J(o))throw new m(d.InvalidOperator)}switch(u){case"<>":return a!==o;case"=":return a===o;case">":return a>o;case"<":return a<o;case">=":return a>=o;case"<=":return a<=o}}function Q(a,o,u){switch(u){case"<>":return a!==o;case"=":return a===o;case">":return a>o;case"<":return a<o;case">=":return a>=o;case"<=":return a<=o}}function pl(a,o,u){const t=parseFloat(o);if(!isNaN(t))return Q(a,t,u);const l=a.toString();switch(u){case"<>":return l!==o;case"=":return l===o;case">":return l>o;case"<":return l<o;case">=":return l>=o;case"<=":return l<=o}}function ml(a,o,u){const t=parseFloat(a);if(!isNaN(t))return Q(t,o,u);const l=o.toString();switch(u){case"<>":return a!==l;case"=":return a===l;case">":return a>l;case"<":return a<l;case">=":return a>=l;case"<=":return a<=l}}function hl(a,o,u){switch(u){case"<>":return a!==o;case"=":return a===o;case">":return a>o;case"<":return a<o;case">=":return a>=o;case"<=":return a<=o}}function vl(a,o,u){const t=o.toDateTimeLuxon(a.zone);return Q((a=a.startOf("day")).toMillis(),t.toMillis(),u)}function wl(a,o,u){const t=o.toDateTimeLuxon(a.toDateTime().zone);return Q((a=a.startOfDay()).toMilliseconds(),t.toMillis(),u)}function Il(a,o,u){const t=a.toDateTimeLuxon(o.zone);return o=o.startOf("day"),Q(t.toMillis(),o.toMillis(),u)}function gl(a,o,u){const t=a.toDateTimeLuxon(o.toDateTime().zone);return o=o.startOfDay(),Q(t.toMillis(),o.toMilliseconds(),u)}function We(a,o,u){a instanceof Y&&(a=a.toDateTime()),o instanceof Y&&(o=o.toDateTime());const t=wr(a),l=wr(o);switch(u){case"<>":return t!==l;case"=":return t===l;case">":return t>l;case"<":return t<l;case">=":return t>=l;case"<=":return t<=l}}function wr(a){return a.year*il+a.month*ll+a.day*cl+a.hour*fl+a.minute*dl+1e3*a.second+a.millisecond}function Xe(a,o,u){const t=gr[a.toLowerCase()];if(t==null)throw new m(d.FunctionNotRecognized);if(o.length<t.minParams||o.length>t.maxParams)throw new m(d.InvalidParameterCount,{name:a.toUpperCase()});return t.evaluate(o,u)}function yl(a,o){const u=gr[a.toLowerCase()];return u!=null&&o>=u.minParams&&o<=u.maxParams}function Pe(a){return typeof a=="string"||a instanceof String}function Ke(a){return!j(a)&&!A(a)&&!F(a)&&!L(a)&&!P(a)}function Ir(a){return A(a)||L(a)?a.toString():P(a)?a.toSQLValue():F(a)?a.millisecond===0?a.toFormat("yyyy-LL-dd HH:mm:ss"):a.toSQL({includeOffset:!1}):j(a)?Ir(U.fromJSDate(a)):a.toString()}function Tl(a){if(j(a))return q.fromDateJS(a);if(F(a))return q.fromParts(a.year,a.month,a.day);if(A(a))return a;if(L(a))throw new m(d.CannotCastValue);if(P(a)&&q.fromParts(a.year,a.month,a.day)===null)throw new m(d.CannotCastValue);if(Pe(a)){const o=q.fromReader(a);if(o!==null&&o.isValid)return o}throw new m(d.CannotCastValue)}function Nl(a,o,u){if(j(a))return be(a,o);if(F(a))return a;if(A(a))return a.toDateTimeLuxon("unknown");if(L(a))throw new m(d.CannotCastValue);if(P(a))return a;if(Pe(a))return Fe(a,"unknown",u);throw new m(d.CannotCastValue)}function Sl(a){if(j(a))return z.fromDateJS(a);if(F(a))return z.fromDateTime(a);if(A(a))throw new m(d.CannotCastValue);if(L(a))return a;if(P(a))return z.fromSqlTimeStampOffset(a);if(Pe(a))return Be(a);throw new m(d.CannotCastValue)}const gr={extract:{minParams:2,maxParams:2,evaluate:([a,o])=>{if(o==null)return null;if(j(o))switch(a.toUpperCase()){case"SECOND":return o.getSeconds();case"MINUTE":return o.getMinutes();case"HOUR":return o.getHours();case"DAY":return o.getDate();case"MONTH":return o.getMonth()+1;case"YEAR":return o.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(F(o))switch(a.toUpperCase()){case"SECOND":return o.second;case"MINUTE":return o.minute;case"HOUR":return o.hour;case"DAY":return o.day;case"MONTH":return o.month;case"YEAR":return o.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(A(o))switch(a.toUpperCase()){case"DAY":return o.day;case"MONTH":return o.month;case"YEAR":return o.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(L(o))switch(a.toUpperCase()){case"SECOND":return o.second;case"MINUTE":return o.minute;case"HOUR":return o.hour}else if(P(o))switch(a.toUpperCase()){case"SECOND":return o.second;case"MINUTE":return o.minute;case"HOUR":return o.hour;case"DAY":return o.day;case"MONTH":return o.month;case"YEAR":return o.year;case"TIMEZONE_HOUR":return o.timezoneOffsetHour;case"TIMEZONE_MINUTE":return o.timezoneOffsetMinutes}throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(a.length===2){const[o,u]=a;return o==null||u==null?null:o.toString().substring(u-1)}if(a.length===3){const[o,u,t]=a;return o==null||u==null||t==null?null:t<=0?"":o.toString().substring(u-1,u+t-1)}}},position:{minParams:2,maxParams:2,evaluate:([a,o])=>a==null||o==null?null:o.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:a=>{const o=a.length===3,u=o?a[1]:" ",t=o?a[2]:a[1];if(u==null||t==null)return null;const l=`(${Qi(u)})`;switch(a[0]){case"BOTH":return t.replaceAll(new RegExp(`^${l}*|${l}*$`,"g"),"");case"LEADING":return t.replaceAll(new RegExp(`^${l}*`,"g"),"");case"TRAILING":return t.replaceAll(new RegExp(`${l}*$`,"g"),"")}throw new m(d.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0]>0?1:a[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>a[0]==null||a[1]==null?null:a[0]**a[1]},mod:{minParams:2,maxParams:2,evaluate:a=>a[0]==null||a[1]==null?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const o=a[0],u=a.length===2?10**a[1]:1;return o==null?null:Math.round(o*u)/u}},truncate:{minParams:1,maxParams:2,evaluate:a=>a[0]==null?null:a.length===1||a[1]===0?Math.trunc(a[0]):Gi("trunc",a[0],-Number(a[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>Pe(a[0])?a[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:a=>{let o="";for(let u=0;u<a.length;u++){if(a[u]==null)return null;o+=a[u].toString()}return o}},lower:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:a=>{for(const o of a)if(o!==null)return o;return null}},cosh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.cosh(a[0])},sinh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.sinh(a[0])},tanh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.tanh(a[0])},nullif:{minParams:2,maxParams:2,evaluate:(a,o)=>k(a[0],a[1],"=")?null:a[0]},cast:{minParams:2,maxParams:2,evaluate:(a,o)=>{const u=a[0],t=a[1];if(u===null)return null;switch(t.type){case"integer":{if(!Ke(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"smallint":{if(!Ke(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);if(l>32767||l<-32767)throw new m(d.CannotCastValue);return l}case"float":case"real":{if(!Ke(u))throw new m(d.CannotCastValue);const l=parseFloat(u);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"time":return Sl(u);case"date":return Tl(u);case"timestamp":return Nl(u,o,t.withtimezone===!0);case"varchar":{const l=Ir(u);if(l.length>t.size)throw new m(d.CannotCastValue);return l}default:throw new m(d.InvalidDataType)}}}};function yr(a,o,u,t){if(a==="||")return Xe("concat",[o,u],t);if(o===null||u===null)return null;if(J(o)){if(J(u))return et(o,u,a);if(X(u))return Al(o,u,a);if(L(u))return Zl();if(A(u))return zl();if(P(u))return Vl();if(F(u))return $l();if(V(u))return kl(o,u,a);throw new m(d.InvalidOperator)}if(A(o)){if(J(u))return _l(o,u,a);if(X(u))return Pl(o,u,a);if(L(u))return Wl();if(A(u))return Gl(o,u,a);if(P(u))return Ql(o,u,a);if(F(u))return Bl(o,u,a);if(V(u))return cc();throw new m(d.InvalidOperator)}if(L(o)){if(J(u))return Ul(o,u,a);if(X(u))return Ml(o,u,a);if(L(u))return ac();if(A(u))return nc();if(P(u))return oc();if(F(u))return rc();if(V(u))return fc();throw new m(d.InvalidOperator)}if(X(o)){if(J(u))return Fl(o,u,a);if(X(u))return bl(o,u,a);if(L(u))return xl(o,u,a);if(A(u))return Cl(o,u,a);if(P(u))return El(o,u,a);if(F(u))return Ol(o,u,a);if(V(u))return Yl();throw new m(d.InvalidOperator)}if(F(o)){if(J(u))return Rl(o,u,a);if(X(u))return Dl(o,u,a);if(L(u))return lc();if(A(u))return uc(o,u,a);if(P(u))return ic(o,u,a);if(F(u))return sc(o,u,a);if(V(u))return dc();throw new m(d.InvalidOperator)}if(P(o)){if(J(u))return Jl(o,u,a);if(X(u))return Ll(o,u,a);if(L(u))return Xl();if(A(u))return Kl(o,u,a);if(P(u))return tc(o,u,a);if(F(u))return ec(o,u,a);if(V(u))return pc();throw new m(d.InvalidOperator)}if(V(o)){if(J(u))return Hl(o,u,a);if(X(u))return jl();if(L(u))return mc();if(A(u))return hc();if(P(u))return wc();if(F(u))return vc();if(V(u))return ql(o,u,a);throw new m(d.InvalidOperator)}throw new m(d.InvalidOperator)}function et(a,o,u){switch(u){case"+":return a+o;case"-":return a-o;case"*":return a*o;case"/":return a/o}throw new m(d.InvalidOperator)}function Ol(a,o,u){switch(u){case"+":return o.plus({milliseconds:a.valueInMilliseconds()});case"-":return a.valueInMilliseconds()-o.toMillis()}throw new m(d.InvalidOperator)}function xl(a,o,u){if(u==="+")return o.plus("milliseconds",a.valueInMilliseconds());throw new m(d.InvalidOperator)}function Cl(a,o,u){if(u==="+")return o.plus("milliseconds",a.valueInMilliseconds());throw new m(d.InvalidOperator)}function Ml(a,o,u){switch(u){case"+":return a.plus("milliseconds",o.valueInMilliseconds());case"-":return a.plus("milliseconds",-1*o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function El(a,o,u){if(u==="+")return o.addMilliseconds(a.valueInMilliseconds());throw new m(d.InvalidOperator)}function bl(a,o,u){switch(u){case"+":return E.createFromMilliseconds(a.valueInMilliseconds()+o.valueInMilliseconds());case"-":return E.createFromMilliseconds(a.valueInMilliseconds()-o.valueInMilliseconds());case"*":return E.createFromMilliseconds(a.valueInMilliseconds()*o.valueInMilliseconds());case"/":return E.createFromMilliseconds(a.valueInMilliseconds()/o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Fl(a,o,u){switch(u){case"+":return E.createFromMilliseconds(a.valueInMilliseconds()+o);case"-":return E.createFromMilliseconds(a.valueInMilliseconds()-o);case"*":return E.createFromMilliseconds(a.valueInMilliseconds()*o);case"/":return E.createFromMilliseconds(a.valueInMilliseconds()/o)}throw new m(d.InvalidOperator)}function Al(a,o,u){switch(u){case"+":return E.createFromMilliseconds(a+o.valueInMilliseconds());case"-":return E.createFromMilliseconds(a-o.valueInMilliseconds());case"*":return E.createFromMilliseconds(a*o.valueInMilliseconds());case"/":return E.createFromMilliseconds(a/o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Pl(a,o,u){switch(u){case"+":return a.plus("milliseconds",o.valueInMilliseconds());case"-":return a.plus("milliseconds",-1*o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Dl(a,o,u){switch(u){case"+":return a.plus({milliseconds:o.valueInMilliseconds()});case"-":return a.minus({milliseconds:o.valueInMilliseconds()})}throw new m(d.InvalidOperator)}function Ll(a,o,u){switch(u){case"+":return a.addMilliseconds(o.valueInMilliseconds());case"-":return a.addMilliseconds(-1*o.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Rl(a,o,u){const t=1e3*o*24*60*60;switch(u){case"+":return a.plus({milliseconds:t});case"-":return a.minus({milliseconds:t})}throw new m(d.InvalidOperator)}function _l(a,o,u){const t=1e3*o*24*60*60;switch(u){case"+":return a.plus("milliseconds",t);case"-":return a.plus("milliseconds",-1*t)}throw new m(d.InvalidOperator)}function Ul(a,o,u){const t=1e3*o*24*60*60;switch(u){case"+":return a.plus("milliseconds",t);case"-":return a.plus("milliseconds",-1*t)}throw new m(d.InvalidOperator)}function $l(a,o,u){throw new m(d.InvalidOperator)}function Jl(a,o,u){const t=1e3*o*24*60*60;switch(u){case"+":return a.addMilliseconds(t);case"-":return a.addMilliseconds(-1*t)}throw new m(d.InvalidOperator)}function Vl(a,o,u){throw new m(d.InvalidOperator)}function Zl(a,o,u){throw new m(d.InvalidOperator)}function zl(a,o,u){throw new m(d.InvalidOperator)}function kl(a,o,u){const t=parseFloat(o);if(isNaN(t))throw new m(d.InvalidOperator);return et(a,t,u)}function Hl(a,o,u){const t=parseFloat(a);if(isNaN(t))throw new m(d.InvalidOperator);return et(t,o,u)}function ql(a,o,u){if(u==="+")return a+o;throw new m(d.InvalidOperator)}function Yl(a,o,u){throw new m(d.InvalidOperator)}function jl(a,o,u){throw new m(d.InvalidOperator)}function Bl(a,o,u){if(u==="-")return a.toDateTimeLuxon(o.zone).diff(o).as("days");throw new m(d.InvalidOperator)}function Ql(a,o,u){if(u==="-")return a.toDateTimeLuxon(o.toDateTime().zone).diff(o.toDateTime()).as("days");throw new m(d.InvalidOperator)}function Gl(a,o,u){if(u==="-")return a.toDateTimeLuxon("UTC").diff(o.toDateTimeLuxon("UTC")).as("days");throw new m(d.InvalidOperator)}function Wl(a,o,u){throw new m(d.InvalidOperator)}function Xl(a,o,u){throw new m(d.InvalidOperator)}function Kl(a,o,u){if(u==="-")return a.toDateTime().diff(o.toDateTimeLuxon(a.toDateTime().zone)).as("days");throw new m(d.InvalidOperator)}function ec(a,o,u){if(u==="-")return a.toDateTime().diff(o).as("days");throw new m(d.InvalidOperator)}function tc(a,o,u){if(u==="-")return a.toDateTime().diff(o.toDateTime()).as("days");throw new m(d.InvalidOperator)}function rc(a,o,u){throw new m(d.InvalidOperator)}function nc(a,o,u){throw new m(d.InvalidOperator)}function oc(a,o,u){throw new m(d.InvalidOperator)}function ac(a,o,u){throw new m(d.InvalidOperator)}function sc(a,o,u){if(u==="-")return a.diff(o).as("days");throw new m(d.InvalidOperator)}function uc(a,o,u){if(u==="-")return a.diff(o.toDateTimeLuxon(a.zone)).as("days");throw new m(d.InvalidOperator)}function ic(a,o,u){if(u==="-")return a.diff(o.toDateTime()).as("days");throw new m(d.InvalidOperator)}function lc(a,o,u){throw new m(d.InvalidOperator)}function cc(a,o,u){throw new m(d.InvalidOperator)}function fc(a,o,u){throw new m(d.InvalidOperator)}function dc(a,o,u){throw new m(d.InvalidOperator)}function pc(a,o,u){throw new m(d.InvalidOperator)}function mc(a,o,u){throw new m(d.InvalidOperator)}function hc(a,o,u){throw new m(d.InvalidOperator)}function vc(a,o,u){throw new m(d.InvalidOperator)}function wc(a,o,u){throw new m(d.InvalidOperator)}function Ic(a,o){function u(){this.constructor=a}u.prototype=o.prototype,a.prototype=new u}function ae(a,o,u,t){var l=Error.call(this,a);return Object.setPrototypeOf&&Object.setPrototypeOf(l,ae.prototype),l.expected=o,l.found=u,l.location=t,l.name="SyntaxError",l}function tt(a,o,u){return u=u||" ",a.length>o?a:(o-=a.length,a+(u+=u.repeat(o)).slice(0,o))}function gc(a,o){var u,t={},l=(o=o!==void 0?o:{}).grammarSource,h={start:Ot},g=Ot,T="!",O="=",S=">=",x=">",D="<=",b="<>",K="!=",ee="||",Mr="@",at="'",st="N'",me="''",Er=".",br="null",Fr="true",Ar="false",Pr="in",Dr="is",Lr="like",Rr="escape",_r="not",Ur="and",$r="or",Jr="between",Vr="from",Zr="for",zr="substring",kr="extract",Hr="trim",qr="position",Yr="timestamp",jr="date",Br="time",Qr="leading",Gr="trailing",Wr="both",Xr="cast",Kr="as",en="integer",tn="int",rn="smallint",nn="float",on="real",an="varchar",sn="to",un="interval",ln="year",cn="timezone_hour",fn="timezone_minute",dn="month",pn="day",mn="hour",hn="minute",vn="second",wn="case",In="end",gn="when",yn="then",Tn="else",Nn=",",Sn="(",On=")",ut="`",xn=/^[<-=]/,he=/^[+\-]/,Cn=/^[*\/]/,Mn=/^[A-Za-z_\x80-\uFFFF]/,En=/^[A-Za-z0-9_]/,it=/^[A-Za-z0-9_.\x80-\uFFFF]/,bn=/^["]/,lt=/^[^']/,Fn=/^[0-9]/,An=/^[eE]/,Pn=/^[ \t\n\r]/,ct=/^[^`]/,Dn=y("!",!1),Ln=y("=",!1),Rn=y(">=",!1),_n=y(">",!1),Un=y("<=",!1),$n=y("<>",!1),Jn=H([["<","="]],!1,!1),Vn=y("!=",!1),ve=H(["+","-"],!1,!1),Zn=y("||",!1),zn=H(["*","/"],!1,!1),kn=H([["A","Z"],["a","z"],"_",["\x80","\uFFFF"]],!1,!1),Hn=H([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),ft=H([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","\uFFFF"]],!1,!1),qn=H(['"'],!1,!1),Yn=y("@",!1),dt=y("'",!1),jn=y("N'",!1),pt=y("''",!1),mt=H(["'"],!0,!1),Bn=y(".",!1),Qn=H([["0","9"]],!1,!1),Gn=H(["e","E"],!1,!1),Wn=y("NULL",!0),Xn=y("TRUE",!0),Kn=y("FALSE",!0),eo=y("IN",!0),to=y("IS",!0),ro=y("LIKE",!0),no=y("ESCAPE",!0),oo=y("NOT",!0),ao=y("AND",!0),so=y("OR",!0),uo=y("BETWEEN",!0),io=y("FROM",!0),lo=y("FOR",!0),co=y("SUBSTRING",!0),fo=y("EXTRACT",!0),po=y("TRIM",!0),mo=y("POSITION",!0),ho=y("TIMESTAMP",!0),vo=y("DATE",!0),wo=y("TIME",!0),Io=y("LEADING",!0),go=y("TRAILING",!0),yo=y("BOTH",!0),To=y("CAST",!0),No=y("AS",!0),So=y("INTEGER",!0),Oo=y("INT",!0),xo=y("SMALLINT",!0),Co=y("FLOAT",!0),Mo=y("REAL",!0),Eo=y("VARCHAR",!0),bo=y("TO",!0),Fo=y("INTERVAL",!0),Ao=y("YEAR",!0),Po=y("TIMEZONE_HOUR",!0),Do=y("TIMEZONE_MINUTE",!0),Lo=y("MONTH",!0),Ro=y("DAY",!0),_o=y("HOUR",!0),Uo=y("MINUTE",!0),$o=y("SECOND",!0),Jo=y("CASE",!0),Vo=y("END",!0),Zo=y("WHEN",!0),zo=y("THEN",!0),ko=y("ELSE",!0),Ho=y(",",!1),qo=y("(",!1),Yo=y(")",!1),jo=H([" ","	",`
`,"\r"],!1,!1),ht=y("`",!1),vt=H(["`"],!0,!1),Bo=function(e){return e},Qo=function(e){return Z(I(),...e)},wt=function(e,r,s){return{op:r,expr:s,location:I()}},Go=function(e,r){return de(e,r)},It=function(e,r,s){return{op:r,expr:s,location:I()}},Wo=function(e,r){return de(e,r)},Xo=function(e){return zi("NOT",e,I())},Ko=function(e,r){return r==""||r==null||r==null?e:r.type=="arithmetic"?de(e,r.tail):ar(r.op,e,r.right,r.escape,I())},gt=function(e,r){return{op:e,expr:r,location:I()}},ea=function(e){return{type:"arithmetic",tail:e}},ta=function(e,r){return{op:e+"NOT",right:r}},ra=function(e,r){return{op:e,right:r}},na=function(e,r,s){return Z(I(),r,s)},oa=function(e,r){return{op:"NOT"+e,right:r}},aa=function(e,r,s){return Z(I(),r,s)},sa=function(e,r){return{op:e,right:r}},ua=function(e){return e[0]+" "+e[2]},ia=function(e){return e[0]+" "+e[2]},la=function(e,r,s){return{op:e,right:r,escape:s.value}},ca=function(e,r){return{op:e,right:r,escape:""}},fa=function(e,r){return{op:e,right:r}},da=function(e,r){return{op:e,right:r}},yt=function(e,r,s){return{op:r,expr:s,location:I()}},pa=function(e,r){return de(e,r)},Tt=function(e,r,s){return{op:r,expr:s,location:I()}},ma=function(e,r){return de(e,r)},ha=function(e){return e.paren=!0,e},va=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current-time",location:I(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current-time",location:I(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(e)?{type:"current-time",location:I(),mode:"time"}:/^CURRENT_USER$/i.test(e)?{type:"current-user",location:I()}:{type:"column-reference",location:I(),table:"",column:e}},wa=function(e){return{type:"column-reference",location:I(),table:"",column:e,delimited:!0}},Ia=function(e){return e},ga=function(e,r){return e+r.join("")},ya=function(e,r){return e+r.join("")},Ta=function(e){return e},Na=function(e){return e.join("")},Sa=function(){return'"'},Oa=function(e){return{type:"parameter",location:I(),value:e[1]}},xa=function(e,r){return Z(I(),e,r)},Ca=function(e,r){return Z(I(),e,r)},Ma=function(e){return{type:"function",location:I(),name:"extract",args:e}},Ea=function(e,r,s){return Z(I(),e,r,...s?[s]:[])},ba=function(e,r,s){return Z(I(),e,r,s)},Fa=function(e){return{type:"function",location:I(),name:"substring",args:e}},Aa=function(e,r){return Z(I(),e,r)},Pa=function(e,r){return Z(I(),e,r)},Da=function(e){return{type:"function",location:I(),name:"cast",args:e}},La=function(){return{type:"data-type",location:I(),value:{type:"integer"}}},Ra=function(){return{type:"data-type",location:I(),value:{type:"smallint"}}},_a=function(){return{type:"data-type",location:I(),value:{type:"float"}}},Ua=function(){return{type:"data-type",location:I(),value:{type:"real"}}},$a=function(){return{type:"data-type",location:I(),value:{type:"date"}}},Ja=function(){return{type:"data-type",location:I(),value:{type:"timestamp"}}},Va=function(){return{type:"data-type",location:I(),value:{type:"time"}}},Za=function(e){return{type:"data-type",location:I(),value:{type:"varchar",size:parseInt(e)}}},za=function(e,r,s){return Z(I(),e,r,s)},ka=function(e,r){return Z(I(),e,r)},Ha=function(e){return{type:"function",location:I(),name:"trim",args:e}},qa=function(e){return{type:"string",location:I(),value:e??"BOTH"}},Ya=function(e,r){return Z(I(),e,r)},ja=function(e,r){return Z(I(),e,r)},Ba=function(e){return{type:"function",location:I(),name:"position",args:e}},Qa=function(e,r){return{type:"function",location:I(),name:e,args:r}},Ga=function(e){return{type:"string",location:I(),value:e}},Wa=function(e){return e.type==="string"&&ki(e.value),{type:"timestamp",location:I(),value:e.value}},Xa=function(e){return e.type==="string"&&Hi(e.value),{type:"time",location:I(),value:e.value}},Ka=function(e,r,s){return{type:"interval",location:I(),value:r,qualifier:s,op:e}},es=function(e,r){return{type:"interval",location:I(),value:e,qualifier:r,op:""}},ts=function(e,r){return{type:"interval-qualifier",location:I(),start:e,end:r}},rs=function(e,r){return{type:"interval-period",location:I(),period:e.value,precision:r,secondary:null}},ns=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},os=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},as=function(e,r){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:r}},ss=function(e){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:null}},us=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},is=function(e,r){return{type:"interval-period",location:I(),period:e.value,precision:r,secondary:null}},ls=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},cs=function(e,r){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:r}},fs=function(e){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:null}},ds=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},ps=function(){return{type:"string",location:I(),value:"day"}},ms=function(){return{type:"string",location:I(),value:"hour"}},hs=function(){return{type:"string",location:I(),value:"minute"}},vs=function(){return{type:"string",location:I(),value:"month"}},ws=function(){return{type:"string",location:I(),value:"year"}},Is=function(e){return parseFloat(e)},gs=function(e){return parseFloat(e)},ys=function(e){return e.type==="string"&&qi(e.value),{type:"date",location:I(),value:e.value}},Ts=function(){return{type:"null",location:I(),value:null}},Ns=function(){return{type:"boolean",location:I(),value:!0}},Ss=function(){return{type:"boolean",location:I(),value:!1}},Nt=function(){return"'"},Os=function(e){return{type:"string",location:I(),value:e.join("")}},xs=function(e,r){return{type:"case-expression",location:I(),format:"simple",operand:e,clauses:r,else:null,elseLocation:null}},Cs=function(e,r,s){return{type:"case-expression",location:I(),format:"simple",operand:e,clauses:r,else:s.value,elseLocation:s.location}},Ms=function(e){return{type:"case-expression",location:I(),format:"searched",clauses:e,else:null,elseLocation:null}},Es=function(e,r){return{type:"case-expression",location:I(),format:"searched",clauses:e,else:r.value,elseLocation:r.location}},bs=function(e,r){return{type:"when-clause",location:I(),operand:e,value:r}},Fs=function(e,r){return{type:"when-clause",location:I(),operand:e,value:r}},As=function(e){return{type:"else-clause",location:I(),value:e}},Ps=function(e){return{type:"number",location:I(),value:e}},Ds=function(e,r,s){return parseFloat(e+r+s)},Ls=function(e,r){return parseFloat(e+r)},Rs=function(e,r){return parseFloat(e+r)},_s=function(e){return parseFloat(e)},Us=function(e,r){return e[0]+r},$s=function(e){return"."+(e??"")},Js=function(e,r){return e+r},Vs=function(e){return e.join("")},Zs=function(e,r){return"e"+(r===null?"":r)},zs=function(){return"IN"},ks=function(){return"IS"},Hs=function(){return"LIKE"},qs=function(){return"ESCAPE"},Ys=function(){return"NOT"},js=function(){return"AND"},Bs=function(){return"OR"},Qs=function(){return"BETWEEN"},Gs=function(){return"FROM"},Ws=function(){return"FOR"},Xs=function(){return"SUBSTRING"},Ks=function(){return"EXTRACT"},eu=function(){return"TRIM"},tu=function(){return"POSITION"},ru=function(){return"TIMESTAMP"},nu=function(){return"DATE"},ou=function(){return"TIME"},au=function(){return"LEADING"},su=function(){return"TRAILING"},uu=function(){return"BOTH"},iu=function(){return"CAST"},lu=function(){return"AS"},cu=function(){return"INTEGER"},fu=function(){return"INT"},du=function(){return"SMALLINT"},pu=function(){return"FLOAT"},mu=function(){return"REAL"},hu=function(){return"VARCHAR"},vu=function(){return"TO"},wu=function(){return"INTERVAL"},Iu=function(){return"YEAR"},gu=function(){return"TIMEZONE_HOUR"},yu=function(){return"TIMEZONE_MINUTE"},Tu=function(){return"MONTH"},Nu=function(){return"DAY"},Su=function(){return"HOUR"},Ou=function(){return"MINUTE"},xu=function(){return"SECOND"},Cu=function(){return"CASE"},Mu=function(){return"END"},Eu=function(){return"WHEN"},bu=function(){return"THEN"},Fu=function(){return"ELSE"},Au=function(e){return e},Pu=function(e){return e.join("")},n=0|o.peg$currPos,f=n,ue=[{line:1,column:1}],B=n,we=o.peg$maxFailExpected||[],c=0|o.peg$silentFails;if(o.startRule){if(!(o.startRule in h))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');g=h[o.startRule]}function I(){return Ie(f,n)}function _e(e,r){throw Lu(e,r=r!==void 0?r:Ie(f,n))}function y(e,r){return{type:"literal",text:e,ignoreCase:r}}function H(e,r,s){return{type:"class",parts:e,inverted:r,ignoreCase:s}}function Du(){return{type:"end"}}function St(e){var r,s=ue[e];if(s)return s;if(e>=ue.length)r=ue.length-1;else for(r=e;!ue[--r];);for(s={line:(s=ue[r]).line,column:s.column};r<e;)a.charCodeAt(r)===10?(s.line++,s.column=1):s.column++,r++;return ue[e]=s,s}function Ie(e,r,s){var i=St(e),v=St(r);return{source:l,start:{offset:e,line:i.line,column:i.column},end:{offset:r,line:v.line,column:v.column}}}function w(e){n<B||(n>B&&(B=n,we=[]),we.push(e))}function Lu(e,r){return new ae(e,null,null,r)}function Ru(e,r,s){return new ae(ae.buildMessage(e,r),e,r,s)}function Ot(){var e,r;return e=n,p(),(r=M())!==t?(p(),f=e,e=Bo(r)):(n=e,e=t),e}function xt(){var e,r,s,i,v,C;if(e=n,R()!==t){for(p(),r=[],s=M();s!==t;)r.push(s),s=n,i=n,v=p(),(C=W())!==t?i=v=[v,C,p()]:(n=i,i=t),i!==t&&(i=M())===t?(n=s,s=t):s=i;s=p(),(i=_())!==t?(f=e,e=Qo(r)):(n=e,e=t)}else n=e,e=t;return e}function M(){var e,r,s,i,v,C;if(e=n,(r=Ue())!==t){for(s=[],i=n,p(),(v=Ht())!==t?(p(),(C=Ue())!==t?(f=i,i=wt(r,v,C)):(n=i,i=t)):(n=i,i=t);i!==t;)s.push(i),i=n,p(),(v=Ht())!==t?(p(),(C=Ue())!==t?(f=i,i=wt(r,v,C)):(n=i,i=t)):(n=i,i=t);f=e,e=Go(r,s)}else n=e,e=t;return e}function Ue(){var e,r,s,i,v,C;if(e=n,(r=ge())!==t){for(s=[],i=n,p(),(v=Ce())!==t?(p(),(C=ge())!==t?(f=i,i=It(r,v,C)):(n=i,i=t)):(n=i,i=t);i!==t;)s.push(i),i=n,p(),(v=Ce())!==t?(p(),(C=ge())!==t?(f=i,i=It(r,v,C)):(n=i,i=t)):(n=i,i=t);f=e,e=Wo(r,s)}else n=e,e=t;return e}function ge(){var e,r,s,i,v;return e=n,(r=fe())===t&&(r=n,a.charCodeAt(n)===33?(s=T,n++):(s=t,c===0&&w(Dn)),s!==t?(i=n,c++,a.charCodeAt(n)===61?(v=O,n++):(v=t,c===0&&w(Ln)),c--,v===t?i=void 0:(n=i,i=t),i!==t?r=s=[s,i]:(n=r,r=t)):(n=r,r=t)),r!==t?(s=p(),(i=ge())!==t?(f=e,e=Xo(i)):(n=e,e=t)):(n=e,e=t),e===t&&(e=_u()),e}function _u(){var e,r,s,i;return e=n,(r=G())!==t?(s=n,p(),(i=Uu())!==t?s=i:(n=s,s=t),s===t&&(s=null),f=e,e=Ko(r,s)):(n=e,e=t),e}function Uu(){var e;return(e=$u())===t&&(e=zu())===t&&(e=Vu())===t&&(e=Ju())===t&&(e=Zu()),e}function $u(){var e,r,s,i,v;if(e=n,r=[],s=n,p(),(i=Ct())!==t?(p(),(v=G())!==t?(f=s,s=gt(i,v)):(n=s,s=t)):(n=s,s=t),s!==t)for(;s!==t;)r.push(s),s=n,p(),(i=Ct())!==t?(p(),(v=G())!==t?(f=s,s=gt(i,v)):(n=s,s=t)):(n=s,s=t);else r=t;return r!==t&&(f=e,r=ea(r)),e=r}function Ct(){var e;return a.substr(n,2)===S?(e=S,n+=2):(e=t,c===0&&w(Rn)),e===t&&(a.charCodeAt(n)===62?(e=x,n++):(e=t,c===0&&w(_n)),e===t&&(a.substr(n,2)===D?(e=D,n+=2):(e=t,c===0&&w(Un)),e===t&&(a.substr(n,2)===b?(e=b,n+=2):(e=t,c===0&&w($n)),e===t&&(e=a.charAt(n),xn.test(e)?n++:(e=t,c===0&&w(Jn)),e===t&&(a.substr(n,2)===K?(e=K,n+=2):(e=t,c===0&&w(Vn))))))),e}function Ju(){var e,r,s,i;return e=n,(r=zt())!==t?(p(),(s=fe())!==t?(p(),(i=G())!==t?(f=e,e=ta(r,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=zt())!==t?(p(),(s=G())!==t?(f=e,e=ra(r,s)):(n=e,e=t)):(n=e,e=t)),e}function Vu(){var e,r,s,i,v,C,oe,sr;return e=n,(r=fe())!==t?(p(),(s=qt())!==t?(i=p(),v=n,(C=G())!==t?(p(),(oe=Ce())!==t?(p(),(sr=G())!==t?(f=v,v=na(s,C,sr)):(n=v,v=t)):(n=v,v=t)):(n=v,v=t),v!==t?(f=e,e=oa(s,v)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=qt())!==t?(p(),s=n,(i=G())!==t?(v=p(),(C=Ce())!==t?(p(),(oe=G())!==t?(f=s,s=aa(r,i,oe)):(n=s,s=t)):(n=s,s=t)):(n=s,s=t),s!==t?(f=e,e=sa(r,s)):(n=e,e=t)):(n=e,e=t)),e}function Mt(){var e,r,s,i,v;return e=n,r=n,(s=fe())!==t?(i=p(),(v=kt())!==t?r=s=[s,i,v]:(n=r,r=t)):(n=r,r=t),r!==t&&(f=e,r=ua(r)),(e=r)===t&&(e=kt()),e}function Et(){var e,r,s,i,v;return e=n,r=n,(s=fe())!==t?(i=p(),(v=ke())!==t?r=s=[s,i,v]:(n=r,r=t)):(n=r,r=t),r!==t&&(f=e,r=ia(r)),(e=r)===t&&(e=ke()),e}function Zu(){var e,r,s,i;return e=n,(r=Mt())!==t?(p(),(s=te())!==t?(p(),Ti()!==t?(p(),(i=ze())!==t?(f=e,e=la(r,s,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Mt())!==t?(p(),(s=te())!==t?(f=e,e=ca(r,s)):(n=e,e=t)):(n=e,e=t)),e}function zu(){var e,r,s;return e=n,(r=Et())!==t?(p(),(s=xt())!==t?(f=e,e=fa(r,s)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Et())!==t?(p(),(s=Ze())!==t?(f=e,e=da(r,s)):(n=e,e=t)):(n=e,e=t)),e}function G(){var e,r,s,i,v,C;if(e=n,(r=$e())!==t){for(s=[],i=n,p(),(v=bt())!==t?(p(),(C=$e())!==t?(f=i,i=yt(r,v,C)):(n=i,i=t)):(n=i,i=t);i!==t;)s.push(i),i=n,p(),(v=bt())!==t?(p(),(C=$e())!==t?(f=i,i=yt(r,v,C)):(n=i,i=t)):(n=i,i=t);f=e,e=pa(r,s)}else n=e,e=t;return e}function bt(){var e;return e=a.charAt(n),he.test(e)?n++:(e=t,c===0&&w(ve)),e===t&&(a.substr(n,2)===ee?(e=ee,n+=2):(e=t,c===0&&w(Zn))),e}function $e(){var e,r,s,i,v,C;if(e=n,(r=Je())!==t){for(s=[],i=n,p(),(v=Ft())!==t?(p(),(C=Je())!==t?(f=i,i=Tt(r,v,C)):(n=i,i=t)):(n=i,i=t);i!==t;)s.push(i),i=n,p(),(v=Ft())!==t?(p(),(C=Je())!==t?(f=i,i=Tt(r,v,C)):(n=i,i=t)):(n=i,i=t);f=e,e=ma(r,s)}else n=e,e=t;return e}function Ft(){var e;return e=a.charAt(n),Cn.test(e)?n++:(e=t,c===0&&w(zn)),e}function Je(){var e,r;return(e=ri())===t&&(e=Gu())===t&&(e=Wu())===t&&(e=Ku())===t&&(e=ei())===t&&(e=Xu())===t&&(e=ti())===t&&(e=di())===t&&(e=ku())===t&&(e=Ze())===t&&(e=n,R()!==t?(p(),(r=M())!==t?(p(),_()!==t?(f=e,e=ha(r)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function ku(){var e,r;return e=n,(r=Hu())!==t&&(f=e,r=va(r)),(e=r)===t&&(e=n,(r=Yu())!==t&&(f=e,r=wa(r)),e=r),e}function Hu(){var e,r;return e=n,(r=qu())!==t&&(f=e,r=Ia(r)),e=r}function qu(){var e,r,s,i;if(e=n,(r=Ve())!==t){for(s=[],i=Pt();i!==t;)s.push(i),i=Pt();f=e,e=ga(r,s)}else n=e,e=t;return e}function At(){var e,r,s,i;if(e=n,(r=Ve())!==t){for(s=[],i=N();i!==t;)s.push(i),i=N();f=e,e=ya(r,s)}else n=e,e=t;return e}function Ve(){var e;return e=a.charAt(n),Mn.test(e)?n++:(e=t,c===0&&w(kn)),e}function N(){var e;return e=a.charAt(n),En.test(e)?n++:(e=t,c===0&&w(Hn)),e}function Pt(){var e;return e=a.charAt(n),it.test(e)?n++:(e=t,c===0&&w(ft)),e}function Yu(){var e,r;return e=n,ye()!==t?(r=ju(),ye()!==t?(f=e,e=Ta(r)):(n=e,e=t)):(n=e,e=t),e}function ju(){var e,r,s;for(e=n,r=[],s=Dt();s!==t;)r.push(s),s=Dt();return f=e,e=r=Na(r)}function Dt(){var e;return(e=Qu())===t&&(e=Bu()),e}function Bu(){var e;return e=n,ye()!==t&&ye()!==t?(f=e,e=Sa()):(n=e,e=t),e}function Qu(){var e;return e=a.charAt(n),it.test(e)?n++:(e=t,c===0&&w(ft)),e}function ye(){var e;return e=a.charAt(n),bn.test(e)?n++:(e=t,c===0&&w(qn)),e}function Ze(){var e,r,s,i;return e=n,r=n,a.charCodeAt(n)===64?(s=Mr,n++):(s=t,c===0&&w(Yn)),s!==t&&(i=At())!==t?r=s=[s,i]:(n=r,r=t),r!==t&&(f=e,r=Oa(r)),e=r}function Gu(){var e,r,s,i;return e=n,Yt()!==t?(p(),r=n,R()!==t?(p(),(s=_t())!==t?(p(),He()!==t?(p(),(i=M())!==t?(p(),_()!==t?(f=r,r=xa(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=_t())!==t?(p(),W()!==t?(p(),(i=M())!==t?(p(),_()!==t?(f=r,r=Ca(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Ma(r)):(n=e,e=t)):(n=e,e=t),e}function Wu(){var e,r,s,i,v,C,oe;return e=n,Si()!==t?(p(),r=n,R()!==t?(p(),(s=M())!==t?(p(),He()!==t?(p(),(i=M())!==t?(p(),v=n,Ni()!==t?(C=p(),(oe=M())!==t?(p(),v=oe):(n=v,v=t)):(n=v,v=t),v===t&&(v=null),_()!==t?(f=r,r=Ea(s,i,v)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=M())!==t?(p(),W()!==t?(p(),(i=M())!==t?(p(),(v=W())!==t?(p(),(C=M())!==t&&(oe=_())!==t?(f=r,r=ba(s,i,C)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Fa(r)):(n=e,e=t)):(n=e,e=t),e}function Xu(){var e,r,s,i;return e=n,bi()!==t?(p(),r=n,R()!==t?(p(),(s=M())!==t?(p(),Fi()!==t?(p(),(i=Lt())!==t?(p(),_()!==t?(f=r,r=Aa(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=M())!==t?(p(),W()!==t?(p(),(i=Lt())!==t?(p(),_()!==t?(f=r,r=Pa(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Da(r)):(n=e,e=t)):(n=e,e=t),e}function Lt(){var e,r,s;return e=n,(r=Ai())===t&&(r=Pi()),r!==t&&(f=e,r=La()),(e=r)===t&&(e=n,(r=Di())!==t&&(f=e,r=Ra()),(e=r)===t&&(e=n,(r=Li())!==t&&(f=e,r=_a()),(e=r)===t&&(e=n,(r=Ri())!==t&&(f=e,r=Ua()),(e=r)===t&&(e=n,(r=Bt())!==t&&(f=e,r=$a()),(e=r)===t&&(e=n,(r=jt())!==t&&(f=e,r=Ja()),(e=r)===t&&(e=n,(r=Qt())!==t&&(f=e,r=Va()),(e=r)===t&&(e=n,(r=_i())!==t?(p(),R()!==t?(p(),(s=re())!==t?(p(),_()!==t?(f=e,e=Za(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)))))))),e}function Ku(){var e,r,s,i,v;return e=n,Oi()!==t?(p(),r=n,R()!==t?(p(),s=Rt(),p(),(i=M())!==t?(p(),He()!==t?(p(),(v=M())!==t?(p(),_()!==t?(f=r,r=za(s,i,v)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),s=Rt(),p(),(i=M())!==t?(p(),_()!==t?(f=r,r=ka(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Ha(r)):(n=e,e=t)):(n=e,e=t),e}function Rt(){var e,r;return e=n,(r=Ci())===t&&(r=Mi())===t&&(r=Ei()),r===t&&(r=null),f=e,e=r=qa(r)}function ei(){var e,r,s,i;return e=n,xi()!==t?(p(),r=n,R()!==t?(p(),(s=M())!==t?(p(),ke()!==t?(p(),(i=M())!==t?(p(),_()!==t?(f=r,r=Ya(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=M())!==t?(p(),W()!==t?(p(),(i=M())!==t?(p(),_()!==t?(f=r,r=ja(s,i)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Ba(r)):(n=e,e=t)):(n=e,e=t),e}function ti(){var e,r,s,i;return e=n,r=n,c++,s=Yt(),c--,s===t?r=void 0:(n=r,r=t),r!==t&&(s=Zi())!==t?(p(),(i=xt())!==t?(f=e,e=Qa(s,i)):(n=e,e=t)):(n=e,e=t),e}function _t(){var e,r;return e=n,(r=Wt())===t&&(r=Xt())===t&&(r=Kt())===t&&(r=er())===t&&(r=tr())===t&&(r=ne())===t&&(r=$i())===t&&(r=Ji()),r!==t&&(f=e,r=Ga(r)),e=r}function ri(){var e;return(e=ze())===t&&(e=hi())===t&&(e=fi())===t&&(e=ci())===t&&(e=li())===t&&(e=ni())===t&&(e=ai())===t&&(e=oi()),e}function ni(){var e,r;return e=n,jt()!==t?(p(),(r=te())!==t?(f=e,e=Wa(r)):(n=e,e=t)):(n=e,e=t),e}function oi(){var e,r;return e=n,Qt()!==t?(p(),(r=te())!==t?(f=e,e=Xa(r)):(n=e,e=t)):(n=e,e=t),e}function ai(){var e,r,s,i;return e=n,Gt()!==t?(p(),r=a.charAt(n),he.test(r)?n++:(r=t,c===0&&w(ve)),r!==t?(p(),(s=te())!==t?(p(),(i=Ut())!==t?(f=e,e=Ka(r,s,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Gt()!==t?(p(),(r=te())!==t?(p(),(s=Ut())!==t?(f=e,e=es(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Ut(){var e,r,s;return e=n,(r=si())!==t?(p(),Ui()!==t?(p(),(s=ui())!==t?(f=e,e=ts(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=ii()),e}function si(){var e,r,s;return e=n,(r=ce())!==t?(p(),R()!==t?(p(),(s=Ne())!==t?(p(),_()!==t?(f=e,e=rs(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ce())!==t&&(f=e,r=ns(r)),e=r),e}function ui(){var e,r,s,i;return e=n,(r=ce())!==t&&(f=e,r=os(r)),(e=r)===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Ne())!==t?(p(),W()!==t?(p(),(i=Te())!==t?(p(),_()!==t?(f=e,e=as(s,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Ne())!==t?(p(),_()!==t?(f=e,e=ss(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t&&(f=e,r=us()),e=r))),e}function ii(){var e,r,s,i;return e=n,(r=ce())!==t?(p(),R()!==t?(p(),(s=Te())!==t?(p(),_()!==t?(f=e,e=is(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ce())!==t&&(f=e,r=ls(r)),(e=r)===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Ne())!==t?(p(),W()!==t?(p(),(i=Te())!==t?(p(),_()!==t?(f=e,e=cs(s,i)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Te())!==t?(p(),_()!==t?(f=e,e=fs(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t&&(f=e,r=ds()),e=r)))),e}function ce(){var e,r;return e=n,(r=Kt())!==t&&(f=e,r=ps()),(e=r)===t&&(e=n,(r=er())!==t&&(f=e,r=ms()),(e=r)===t&&(e=n,(r=tr())!==t&&(f=e,r=hs()),(e=r)===t&&(e=n,(r=Xt())!==t&&(f=e,r=vs()),(e=r)===t&&(e=n,(r=Wt())!==t&&(f=e,r=ws()),e=r)))),e}function Te(){var e,r;return e=n,(r=re())!==t&&(f=e,r=Is(r)),e=r}function Ne(){var e,r;return e=n,(r=re())!==t&&(f=e,r=gs(r)),e=r}function li(){var e,r;return e=n,Bt()!==t?(p(),(r=te())!==t?(f=e,e=ys(r)):(n=e,e=t)):(n=e,e=t),e}function ci(){var e,r;return e=n,(r=Ii())!==t&&(f=e,r=Ts()),e=r}function fi(){var e,r;return e=n,(r=gi())!==t&&(f=e,r=Ns()),(e=r)===t&&(e=n,(r=yi())!==t&&(f=e,r=Ss()),e=r),e}function te(){var e;return(e=ze())===t&&(e=Ze()),e}function ze(){var e,r,s,i,v;if(e=n,a.charCodeAt(n)===39?(r=at,n++):(r=t,c===0&&w(dt)),r===t&&(a.substr(n,2)===st?(r=st,n+=2):(r=t,c===0&&w(jn))),r!==t){for(s=[],i=n,a.substr(n,2)===me?(v=me,n+=2):(v=t,c===0&&w(pt)),v!==t&&(f=i,v=Nt()),(i=v)===t&&(i=a.charAt(n),lt.test(i)?n++:(i=t,c===0&&w(mt)));i!==t;)s.push(i),i=n,a.substr(n,2)===me?(v=me,n+=2):(v=t,c===0&&w(pt)),v!==t&&(f=i,v=Nt()),(i=v)===t&&(i=a.charAt(n),lt.test(i)?n++:(i=t,c===0&&w(mt)));a.charCodeAt(n)===39?(i=at,n++):(i=t,c===0&&w(dt)),i!==t?(f=e,e=Os(s)):(n=e,e=t)}else n=e,e=t;return e}function di(){var e;return(e=pi())===t&&(e=mi()),e}function pi(){var e,r,s,i,v;if(e=n,Me()!==t)if(p(),(r=M())!==t){for(p(),s=[],i=n,(v=Oe())!==t?(p(),i=v):(n=i,i=t);i!==t;)s.push(i),i=n,(v=Oe())!==t?(p(),i=v):(n=i,i=t);(i=Ee())!==t?(f=e,e=xs(r,s)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,Me()!==t)if(p(),(r=M())!==t){for(p(),s=[],i=n,(v=Oe())!==t?(p(),i=v):(n=i,i=t);i!==t;)s.push(i),i=n,(v=Oe())!==t?(p(),i=v):(n=i,i=t);(i=$t())!==t?(v=p(),Ee()!==t?(f=e,e=Cs(r,s,i)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;return e}function mi(){var e,r,s,i;if(e=n,Me()!==t){for(p(),r=[],s=n,(i=Se())!==t?(p(),s=i):(n=s,s=t);s!==t;)r.push(s),s=n,(i=Se())!==t?(p(),s=i):(n=s,s=t);(s=Ee())!==t?(f=e,e=Ms(r)):(n=e,e=t)}else n=e,e=t;if(e===t)if(e=n,Me()!==t){for(p(),r=[],s=n,(i=Se())!==t?(p(),s=i):(n=s,s=t);s!==t;)r.push(s),s=n,(i=Se())!==t?(p(),s=i):(n=s,s=t);(s=$t())!==t?(i=p(),Ee()!==t?(f=e,e=Es(r,s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function Se(){var e,r,s;return e=n,rr()!==t?(p(),(r=M())!==t?(p(),nr()!==t?(p(),(s=M())!==t?(f=e,e=bs(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Oe(){var e,r,s;return e=n,rr()!==t?(p(),(r=M())!==t?(p(),nr()!==t?(p(),(s=M())!==t?(f=e,e=Fs(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function $t(){var e,r;return e=n,Vi()!==t?(p(),(r=M())!==t?(f=e,e=As(r)):(n=e,e=t)):(n=e,e=t),e}function hi(){var e,r,s,i;return e=n,(r=vi())!==t?(s=n,c++,i=Ve(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ps(r)):(n=e,e=t)):(n=e,e=t),e}function vi(){var e,r,s,i;return e=n,(r=xe())!==t&&(s=Jt())!==t&&(i=Vt())!==t?(f=e,e=Ds(r,s,i)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(s=Jt())!==t?(f=e,e=Ls(r,s)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(s=Vt())!==t?(f=e,e=Rs(r,s)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(f=e,r=_s(r)),e=r))),e}function xe(){var e,r,s;return(e=re())===t&&(e=n,r=a.charAt(n),he.test(r)?n++:(r=t,c===0&&w(ve)),r!==t&&(s=re())!==t?(f=e,e=Us(r,s)):(n=e,e=t)),e}function Jt(){var e,r,s;return e=n,a.charCodeAt(n)===46?(r=Er,n++):(r=t,c===0&&w(Bn)),r!==t?((s=re())===t&&(s=null),f=e,e=$s(s)):(n=e,e=t),e}function Vt(){var e,r,s;return e=n,(r=wi())!==t&&(s=re())!==t?(f=e,e=Js(r,s)):(n=e,e=t),e}function re(){var e,r,s;if(e=n,r=[],(s=Zt())!==t)for(;s!==t;)r.push(s),s=Zt();else r=t;return r!==t&&(f=e,r=Vs(r)),e=r}function Zt(){var e;return e=a.charAt(n),Fn.test(e)?n++:(e=t,c===0&&w(Qn)),e}function wi(){var e,r,s;return e=n,r=a.charAt(n),An.test(r)?n++:(r=t,c===0&&w(Gn)),r!==t?(s=a.charAt(n),he.test(s)?n++:(s=t,c===0&&w(ve)),s===t&&(s=null),f=e,e=Zs(r,s)):(n=e,e=t),e}function Ii(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===br?n+=4:(r=t,c===0&&w(Wn)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function gi(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Fr?n+=4:(r=t,c===0&&w(Xn)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function yi(){var e,r,s,i;return e=n,(r=a.substr(n,5)).toLowerCase()===Ar?n+=5:(r=t,c===0&&w(Kn)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function ke(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===Pr?n+=2:(r=t,c===0&&w(eo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=zs()):(n=e,e=t)):(n=e,e=t),e}function zt(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===Dr?n+=2:(r=t,c===0&&w(to)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=ks()):(n=e,e=t)):(n=e,e=t),e}function kt(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Lr?n+=4:(r=t,c===0&&w(ro)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Hs()):(n=e,e=t)):(n=e,e=t),e}function Ti(){var e,r,s,i;return e=n,(r=a.substr(n,6)).toLowerCase()===Rr?n+=6:(r=t,c===0&&w(no)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=qs()):(n=e,e=t)):(n=e,e=t),e}function fe(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===_r?n+=3:(r=t,c===0&&w(oo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ys()):(n=e,e=t)):(n=e,e=t),e}function Ce(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===Ur?n+=3:(r=t,c===0&&w(ao)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=js()):(n=e,e=t)):(n=e,e=t),e}function Ht(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===$r?n+=2:(r=t,c===0&&w(so)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Bs()):(n=e,e=t)):(n=e,e=t),e}function qt(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===Jr?n+=7:(r=t,c===0&&w(uo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Qs()):(n=e,e=t)):(n=e,e=t),e}function He(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Vr?n+=4:(r=t,c===0&&w(io)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Gs()):(n=e,e=t)):(n=e,e=t),e}function Ni(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===Zr?n+=3:(r=t,c===0&&w(lo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ws()):(n=e,e=t)):(n=e,e=t),e}function Si(){var e,r,s,i;return e=n,(r=a.substr(n,9)).toLowerCase()===zr?n+=9:(r=t,c===0&&w(co)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Xs()):(n=e,e=t)):(n=e,e=t),e}function Yt(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===kr?n+=7:(r=t,c===0&&w(fo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ks()):(n=e,e=t)):(n=e,e=t),e}function Oi(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Hr?n+=4:(r=t,c===0&&w(po)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=eu()):(n=e,e=t)):(n=e,e=t),e}function xi(){var e,r,s,i;return e=n,(r=a.substr(n,8)).toLowerCase()===qr?n+=8:(r=t,c===0&&w(mo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=tu()):(n=e,e=t)):(n=e,e=t),e}function jt(){var e,r,s,i;return e=n,(r=a.substr(n,9)).toLowerCase()===Yr?n+=9:(r=t,c===0&&w(ho)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=ru()):(n=e,e=t)):(n=e,e=t),e}function Bt(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===jr?n+=4:(r=t,c===0&&w(vo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=nu()):(n=e,e=t)):(n=e,e=t),e}function Qt(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Br?n+=4:(r=t,c===0&&w(wo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=ou()):(n=e,e=t)):(n=e,e=t),e}function Ci(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===Qr?n+=7:(r=t,c===0&&w(Io)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=au()):(n=e,e=t)):(n=e,e=t),e}function Mi(){var e,r,s,i;return e=n,(r=a.substr(n,8)).toLowerCase()===Gr?n+=8:(r=t,c===0&&w(go)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=su()):(n=e,e=t)):(n=e,e=t),e}function Ei(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Wr?n+=4:(r=t,c===0&&w(yo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=uu()):(n=e,e=t)):(n=e,e=t),e}function bi(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Xr?n+=4:(r=t,c===0&&w(To)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=iu()):(n=e,e=t)):(n=e,e=t),e}function Fi(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===Kr?n+=2:(r=t,c===0&&w(No)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=lu()):(n=e,e=t)):(n=e,e=t),e}function Ai(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===en?n+=7:(r=t,c===0&&w(So)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=cu()):(n=e,e=t)):(n=e,e=t),e}function Pi(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===tn?n+=3:(r=t,c===0&&w(Oo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=fu()):(n=e,e=t)):(n=e,e=t),e}function Di(){var e,r,s,i;return e=n,(r=a.substr(n,8)).toLowerCase()===rn?n+=8:(r=t,c===0&&w(xo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=du()):(n=e,e=t)):(n=e,e=t),e}function Li(){var e,r,s,i;return e=n,(r=a.substr(n,5)).toLowerCase()===nn?n+=5:(r=t,c===0&&w(Co)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=pu()):(n=e,e=t)):(n=e,e=t),e}function Ri(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===on?n+=4:(r=t,c===0&&w(Mo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=mu()):(n=e,e=t)):(n=e,e=t),e}function _i(){var e,r,s,i;return e=n,(r=a.substr(n,7)).toLowerCase()===an?n+=7:(r=t,c===0&&w(Eo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=hu()):(n=e,e=t)):(n=e,e=t),e}function Ui(){var e,r,s,i;return e=n,(r=a.substr(n,2)).toLowerCase()===sn?n+=2:(r=t,c===0&&w(bo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=vu()):(n=e,e=t)):(n=e,e=t),e}function Gt(){var e,r,s,i;return e=n,(r=a.substr(n,8)).toLowerCase()===un?n+=8:(r=t,c===0&&w(Fo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=wu()):(n=e,e=t)):(n=e,e=t),e}function Wt(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===ln?n+=4:(r=t,c===0&&w(Ao)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Iu()):(n=e,e=t)):(n=e,e=t),e}function $i(){var e,r,s,i;return e=n,(r=a.substr(n,13)).toLowerCase()===cn?n+=13:(r=t,c===0&&w(Po)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=gu()):(n=e,e=t)):(n=e,e=t),e}function Ji(){var e,r,s,i;return e=n,(r=a.substr(n,15)).toLowerCase()===fn?n+=15:(r=t,c===0&&w(Do)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=yu()):(n=e,e=t)):(n=e,e=t),e}function Xt(){var e,r,s,i;return e=n,(r=a.substr(n,5)).toLowerCase()===dn?n+=5:(r=t,c===0&&w(Lo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Tu()):(n=e,e=t)):(n=e,e=t),e}function Kt(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===pn?n+=3:(r=t,c===0&&w(Ro)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Nu()):(n=e,e=t)):(n=e,e=t),e}function er(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===mn?n+=4:(r=t,c===0&&w(_o)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Su()):(n=e,e=t)):(n=e,e=t),e}function tr(){var e,r,s,i;return e=n,(r=a.substr(n,6)).toLowerCase()===hn?n+=6:(r=t,c===0&&w(Uo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ou()):(n=e,e=t)):(n=e,e=t),e}function ne(){var e,r,s,i;return e=n,(r=a.substr(n,6)).toLowerCase()===vn?n+=6:(r=t,c===0&&w($o)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=xu()):(n=e,e=t)):(n=e,e=t),e}function Me(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===wn?n+=4:(r=t,c===0&&w(Jo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Cu()):(n=e,e=t)):(n=e,e=t),e}function Ee(){var e,r,s,i;return e=n,(r=a.substr(n,3)).toLowerCase()===In?n+=3:(r=t,c===0&&w(Vo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Mu()):(n=e,e=t)):(n=e,e=t),e}function rr(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===gn?n+=4:(r=t,c===0&&w(Zo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Eu()):(n=e,e=t)):(n=e,e=t),e}function nr(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===yn?n+=4:(r=t,c===0&&w(zo)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=bu()):(n=e,e=t)):(n=e,e=t),e}function Vi(){var e,r,s,i;return e=n,(r=a.substr(n,4)).toLowerCase()===Tn?n+=4:(r=t,c===0&&w(ko)),r!==t?(s=n,c++,i=N(),c--,i===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Fu()):(n=e,e=t)):(n=e,e=t),e}function W(){var e;return a.charCodeAt(n)===44?(e=Nn,n++):(e=t,c===0&&w(Ho)),e}function R(){var e;return a.charCodeAt(n)===40?(e=Sn,n++):(e=t,c===0&&w(qo)),e}function _(){var e;return a.charCodeAt(n)===41?(e=On,n++):(e=t,c===0&&w(Yo)),e}function p(){var e,r;for(e=[],r=or();r!==t;)e.push(r),r=or();return e}function or(){var e;return e=a.charAt(n),Pn.test(e)?n++:(e=t,c===0&&w(jo)),e}function Zi(){var e,r,s,i;if(e=n,(r=At())!==t&&(f=e,r=Au(r)),(e=r)===t)if(e=n,a.charCodeAt(n)===96?(r=ut,n++):(r=t,c===0&&w(ht)),r!==t){if(s=[],i=a.charAt(n),ct.test(i)?n++:(i=t,c===0&&w(vt)),i!==t)for(;i!==t;)s.push(i),i=a.charAt(n),ct.test(i)?n++:(i=t,c===0&&w(vt));else s=t;s!==t?(a.charCodeAt(n)===96?(i=ut,n++):(i=t,c===0&&w(ht)),i!==t?(f=e,e=Pu(s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function zi(e,r,s){return{type:"unary-expression",location:s,operator:e,expr:r}}function ar(e,r,s,i,v){const C={type:"binary-expression",location:v,operator:e,left:r,right:s};return i!==void 0&&(C.escape=i),C}function Z(e,...r){return{type:"expression-list",location:e,value:r}}function de(e,r){let s=e;for(const{op:i,expr:v,location:{end:C}}of r)s=ar(i,s,v,void 0,{...s.location,end:C});return s}function ki(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&_e("Timestamp literal is invalid")}function Hi(e){/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(e)!==!0&&_e("Time literal is invalid")}function qi(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&_e("Date literal is invalid")}if(u=g(),o.peg$library)return{peg$result:u,peg$currPos:n,peg$FAILED:t,peg$maxFailExpected:we,peg$maxFailPos:B};if(u!==t&&n===a.length)return u;throw u!==t&&n<a.length&&w(Du()),Ru(we,B<a.length?a.charAt(B):null,B<a.length?Ie(B,B+1):Ie(B,B))}Ic(ae,Error),ae.prototype.format=function(a){var o="Error: "+this.message;if(this.location){var u,t=null;for(u=0;u<a.length;u++)if(a[u].source===this.location.source){t=a[u].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,h=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,g=this.location.source+":"+h.line+":"+h.column;if(t){var T=this.location.end,O=tt("",h.line.toString().length," "),S=t[l.line-1],x=(l.line===T.line?T.column:S.length+1)-l.column||1;o+=`
 --> `+g+`
`+O+` |
`+h.line+" | "+S+`
`+O+" | "+tt("",l.column-1," ")+tt("",x,"^")}else o+=`
 at `+g}return o},ae.buildMessage=function(a,o){var u={literal:function(S){return'"'+l(S.text)+'"'},class:function(S){var x=S.parts.map(function(D){return Array.isArray(D)?h(D[0])+"-"+h(D[1]):h(D)});return"["+(S.inverted?"^":"")+x.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(S){return S.description}};function t(S){return S.charCodeAt(0).toString(16).toUpperCase()}function l(S){return S.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+t(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+t(x)})}function h(S){return S.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+t(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+t(x)})}function g(S){return u[S.type](S)}function T(S){var x,D,b=S.map(g);if(b.sort(),b.length>0){for(x=1,D=1;x<b.length;x++)b[x-1]!==b[x]&&(b[D]=b[x],D++);b.length=D}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}function O(S){return S?'"'+l(S)+'"':"end of input"}return"Expected "+T(a)+" but "+O(o)+" found."};class yc{static parse(o){return gc(o)}}function $(a,o){if(a!=null)switch(o(a),a.type){case"when-clause":$(a.operand,o),$(a.value,o);break;case"case-expression":for(const u of a.clauses)$(u,o);a.format==="simple"&&$(a.operand,o),a.else!==null&&$(a.else,o);break;case"expression-list":for(const u of a.value)$(u,o);break;case"unary-expression":$(a.expr,o);break;case"binary-expression":$(a.left,o),$(a.right,o);break;case"function":$(a.args,o);break;case"interval":$(a.value,o),$(a.qualifier,o);break;case"interval-qualifier":$(a.start,o),$(a.end,o)}}const Tc=new Set(["current_timestamp","current_date","current_time"]);class De{static makeBool(o){return Tr(o)}static featureValue(o,u,t,l){return xr(o,u,t,l)}static equalsNull(o){return o===null}static applyLike(o,u,t){return ot(o,u,t)}static ensureArray(o){return rt(o)}static applyIn(o,u,t){return nt(o,u)}static currentTimestamp(o){return be(new Date,o)}static currentDate(o){return q.fromNow(o)}static currentTime(o){const u=be(new Date,o);return z.fromDateTime(u)}static makeSqlInterval(o,u,t){return E.createFromValueAndQualifier(o,u,t)}static convertInterval(o){return o instanceof E?o.valueInMilliseconds():o}static compare(o,u,t,l){return k(u,t,o)}static calculate(o,u,t,l){return yr(o,u,t,l)}static evaluateTime(o){return Be(o)}static evaluateTimestamp(o,u,t){return Fe(o,u,t)}static evaluateDate(o,u){return vr(o,u)}static evaluateFunction(o,u,t){return Xe(o,u,t)}static lookup(o,u){const t=u[o];return t===void 0?null:t}static between(o,u,t){return o==null||u[0]==null||u[1]==null?null:k(o,u[0],">=")&&k(o,u[1],"<=")}static notbetween(o,u,t){return o==null||u[0]==null||u[1]==null?null:k(o,u[0],"<")||k(o,u[1],">")}static ternaryNot(o){return Le(o)}static ternaryAnd(o,u){return Nr(o,u)}static ternaryOr(o,u){return Sr(o,u)}}class Re{constructor(o,u,t="UTC",l=null){this.fieldsIndex=u,this.timeZone=t,this.currentUser=l,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=yc.parse(o);const{isStandardized:h,isAggregate:g,currentUserRequired:T,referencedFieldNames:O}=this._extractExpressionInfo(u);this._referencedFieldNames=O,this.isStandardized=h,this.isAggregate=g,this.currentUserRequired=T}static convertValueToStorageFormat(o,u=null){if(u===null)return j(o)?o.getTime():F(o)?o.toMillis():P(o)?o.toStorageFormat():L(o)?o.toStorageString():A(o)?o.toStorageFormat():o;switch(u){case"date":return j(o)?o.getTime():F(o)?o.toMillis():P(o)?o.toMilliseconds():A(o)?o.toNumber():o;case"date-only":return j(o)?q.fromDateJS(o).toString():P(o)?q.fromSqlTimeStampOffset(o).toString():F(o)?q.fromDateTime(o).toString():o;case"time-only":return j(o)?z.fromDateJS(o).toStorageString():F(o)?z.fromDateTime(o).toStorageString():P(o)?z.fromSqlTimeStampOffset(o).toStorageString():L(o)?o.toStorageString():o;case"timestamp-offset":if(j(o))return Y.fromJSDate(o).toStorageFormat();if(F(o))return Y.fromDateTime(o).toStorageFormat();if(P(o))return o.toStorageFormat()}return o}static create(o,u={}){return new Re(o,u.fieldsIndex,u.timeZone??void 0,u.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(o,u=ie,t=this.currentUser){return!!this._evaluateNode(this.parseTree,null,u,o,t)}calculateValue(o,u=ie,t=this.currentUser){const l=this._evaluateNode(this.parseTree,o,u,null,t);return l instanceof E?l.valueInMilliseconds()/864e5:l}calculateValueCompiled(o,u=ie,t=this.currentUser){return this.parseTree._compiledVersion!=null?this.parseTree._compiledVersion(o,this.parameters,u,this.fieldsIndex,this.timeZone,t??null):ur("esri-csp-restrictions")?this.calculateValue(o,u):(this._compileMe(),this.parseTree._compiledVersion(o,this.parameters,u,this.fieldsIndex,this.timeZone,t??null))}testFeature(o,u=ie,t=this.currentUser){return!!this._evaluateNode(this.parseTree,o,u,null,t)}testFeatureCompiled(o,u=ie,t=this.currentUser){return this.parseTree._compiledVersion!=null?!!this.parseTree._compiledVersion(o,this.parameters,u,this.fieldsIndex,this.timeZone,t??null):ur("esri-csp-restrictions")?this.testFeature(o,u):(this._compileMe(),!!this.parseTree._compiledVersion(o,this.parameters,u,this.fieldsIndex,this.timeZone,t??null))}get hasDateFunctions(){return this._hasDateFunctions!=null||(this._hasDateFunctions=!1,$(this.parseTree,o=>{o.type==="current-time"?this._hasDateFunctions=!0:o.type==="function"&&(this._hasDateFunctions=this._hasDateFunctions||Tc.has(o.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const o=new Set;return $(this.parseTree,u=>{u.type==="function"&&o.add(u.name.toLowerCase())}),Array.from(o)}getExpressions(){const o=new Map;return $(this.parseTree,u=>{if(u.type==="function"){const t=u.name.toLowerCase(),l=u.args.value[0];if(l.type==="column-reference"){const h=l.column,g=`${t}-${h}`;o.has(g)||o.set(g,{aggregateType:t,field:h})}}}),[...o.values()]}getVariables(){const o=new Set;return $(this.parseTree,u=>{u.type==="parameter"&&o.add(u.value.toLowerCase())}),Array.from(o)}_compileMe(){const o="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone","currentUser",o).bind(De)}_extractExpressionInfo(o){const u=[],t=new Set;let l=!0,h=!1,g=!1;return $(this.parseTree,T=>{switch(T.type){case"column-reference":{const O=o?.get(T.column);let S,x;O?S=x=O.name??"":(x=T.column,S=x.toLowerCase()),t.has(S)||(t.add(S),u.push(x)),T.column=x;break}case"current-user":g=!0;break;case"function":{const{name:O,args:S}=T,x=S.value.length;l&&(l=yl(O,x)),h===!1&&(h=cr(O,x));break}}}),{referencedFieldNames:Array.from(u),isStandardized:l,isAggregate:h,currentUserRequired:g}}evaluateNodeToJavaScript(o){switch(o.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(o.value)+", "+JSON.stringify(o.qualifier)+","+JSON.stringify(o.op)+")";case"case-expression":{let u="";if(o.format==="simple"){const t=this.evaluateNodeToJavaScript(o.operand);u="( ";for(let l=0;l<o.clauses.length;l++)u+=" (this.compare('=',"+t+","+this.evaluateNodeToJavaScript(o.clauses[l].operand)+") ? ("+this.evaluateNodeToJavaScript(o.clauses[l].value)+") : ";o.else!==null?u+=this.evaluateNodeToJavaScript(o.else):u+="null",u+=" )"}else{u="( ";for(let t=0;t<o.clauses.length;t++)u+=" this.makeBool("+this.evaluateNodeToJavaScript(o.clauses[t].operand)+")===true ? ("+this.evaluateNodeToJavaScript(o.clauses[t].value)+") : ";o.else!==null?u+=this.evaluateNodeToJavaScript(o.else):u+="null",u+=" )"}return u}case"parameter":return"this.lookup("+JSON.stringify(o.value.toLowerCase())+",lookups)";case"expression-list":{let u="[";for(const t of o.value)u!=="["&&(u+=","),u+=this.evaluateNodeToJavaScript(t);return u+="]",u}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(o.expr)+")";case"binary-expression":switch(o.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+" )";case"IS":if(o.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(o.left)+")";case"ISNOT":if(o.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(o.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(o.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(o.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(o.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(o.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+","+JSON.stringify(o.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+","+JSON.stringify(o.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(o.operator)+","+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(o.operator)+","+this.evaluateNodeToJavaScript(o.left)+","+this.evaluateNodeToJavaScript(o.right)+", timeZone)";default:throw new m(d.UnsupportedOperator,{operator:o.operator})}case"null":case"boolean":case"string":case"number":return JSON.stringify(o.value);case"time":return"this.evaluateTime("+JSON.stringify(o.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(o.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(o.value)+", 'unknown')";case"current-time":return o.mode==="date"?"this.currentDate(timeZone)":o.mode==="time"?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case"current-user":return"currentUser";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(o.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(o.name)+","+this.evaluateNodeToJavaScript(o.args)+", timeZone)"}throw new m(d.UnsupportedSyntax,{node:o.type})}_evaluateNode(o,u,t,l,h){let g;switch(o.type){case"interval":{const T=this._evaluateNode(o.value,u,t,l,h);return E.createFromValueAndQualifier(T,o.qualifier,o.op)}case"case-expression":if(o.format==="simple"){const T=this._evaluateNode(o.operand,u,t,l,h);for(let O=0;O<o.clauses.length;O++)if(k(T,this._evaluateNode(o.clauses[O].operand,u,t,l,h),"=",this.timeZone))return this._evaluateNode(o.clauses[O].value,u,t,l,h);if(o.else!==null)return this._evaluateNode(o.else,u,t,l,h)}else{for(let T=0;T<o.clauses.length;T++)if(Tr(this._evaluateNode(o.clauses[T].operand,u,t,l,h)))return this._evaluateNode(o.clauses[T].value,u,t,l,h);if(o.else!==null)return this._evaluateNode(o.else,u,t,l,h)}return null;case"parameter":return g=this.parameters[o.value.toLowerCase()],j(g)?U.fromJSDate(g):g instanceof Yi?g.toDateTime():g;case"expression-list":{const T=[];for(const O of o.value)T.push(this._evaluateNode(O,u,t,l,h));return T}case"unary-expression":return Le(this._evaluateNode(o.expr,u,t,l,h));case"binary-expression":switch(o.operator){case"AND":return Nr(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h));case"OR":return Sr(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h));case"IS":if(o.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(o.left,u,t,l,h)===null;case"ISNOT":if(o.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(o.left,u,t,l,h)!==null;case"IN":{const T=rt(this._evaluateNode(o.right,u,t,l,h));return nt(this._evaluateNode(o.left,u,t,l,h),T,this.timeZone)}case"NOT IN":{const T=rt(this._evaluateNode(o.right,u,t,l,h));return Le(nt(this._evaluateNode(o.left,u,t,l,h),T,this.timeZone))}case"BETWEEN":{const T=this._evaluateNode(o.left,u,t,l,h),O=this._evaluateNode(o.right,u,t,l,h);return T==null||O[0]==null||O[1]==null?null:k(T,O[0],">=",this.timeZone)&&k(T,O[1],"<=",this.timeZone)}case"NOTBETWEEN":{const T=this._evaluateNode(o.left,u,t,l,h),O=this._evaluateNode(o.right,u,t,l,h);return T==null||O[0]==null||O[1]==null?null:k(T,O[0],"<",this.timeZone)||k(T,O[1],">",this.timeZone)}case"LIKE":return ot(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h),o.escape);case"NOT LIKE":return Le(ot(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h),o.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return k(this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h),o.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return yr(o.operator,this._evaluateNode(o.left,u,t,l,h),this._evaluateNode(o.right,u,t,l,h),this.timeZone)}case"null":case"boolean":case"string":case"number":return o.value;case"date":return o.parsedValue??=vr(o.value,"unknown"),o.parsedValue;case"timestamp":return o.parsedValue??=Fe(o.value,"unknown"),o.parsedValue;case"time":return Be(o.value);case"current-time":return o.mode==="date"?De.currentDate(this.timeZone):o.mode==="time"?De.currentTime(this.timeZone):De.currentTimestamp(this.timeZone);case"current-user":return h??null;case"column-reference":return xr(u,o.column,this.fieldsIndex,t);case"data-type":return o.value;case"function":{if(this.isAggregate&&cr(o.name,o.args.value.length)){const O=[];for(const S of o.args?.value||[]){const x=[];for(const D of l||[])x.push(this._evaluateNode(S,D,t,null,h));O.push(x)}return lr(o.name,O)}const T=this._evaluateNode(o.args,u,t,l,h);return Xe(o.name,T,this.timeZone)}}throw new m(d.UnsupportedSyntax,{node:o.type})}}function Tr(a){return a===!0}function rt(a){return Array.isArray(a)?a:[a]}function Le(a){return a!==null?a!==!0:null}function Nr(a,o){return a!=null&&o!=null?a===!0&&o===!0:a!==!1&&o!==!1&&null}function Sr(a,o){return a!=null&&o!=null?a===!0||o===!0:a===!0||o===!0||null}function nt(a,o,u){if(a==null)return null;let t=!1;for(const l of o)if(l==null)t=null;else{if(a===l){t=!0;break}if(Ge(a)&&Ge(l)&&(t=k(a,l,"="),t))break}return t}const Or="-[]/{}()*+?.\\^$|";var se;function Nc(a,o){const u=o;let t="",l=se.Normal;for(let h=0;h<a.length;h++){const g=a.charAt(h);switch(l){case se.Normal:g===u?l=se.Escaped:Or.includes(g)?t+="\\"+g:t+=g==="%"?".*":g==="_"?".":g;break;case se.Escaped:Or.includes(g)?t+="\\"+g:t+=g,l=se.Normal}}return new RegExp("^"+t+"$","m")}function ot(a,o,u){return a==null?null:Nc(o,u).test(a)}function Sc(a){return a&&typeof a.attributes=="object"}function xr(a,o,u,t){const l=t.getAttribute(a,o),h=u?.get(o);return l==null||h?.type!=="esriFieldTypeDate"&&h?.type!=="date"?l==null||h?.type!=="esriFieldTypeDateOnly"&&h?.type!=="date-only"?l==null||h?.type!=="esriFieldTypeTimeOnly"&&h?.type!=="time-only"?l==null||h?.type!=="esriFieldTypeTimestampOffset"&&h?.type!=="timestamp-offset"?l:new Y(l):z.fromReader(l):q.fromReader(l):be(new Date(l),u?.getLuxonTimeZone(h.name)??Wi.utcInstance)}(function(a){a[a.Normal=0]="Normal",a[a.Escaped=1]="Escaped"})(se||(se={}));const ie={getAttribute:(a,o)=>(Sc(a)?a.attributes:a)[o]},Oc=Object.freeze(Object.defineProperty({__proto__:null,WhereClause:Re,defaultAttributeAdapter:ie},Symbol.toStringTag,{value:"Module"}));export{Oc as W,Re as Z,d as a,m as n,Y as r,lr as u};
