import{cY as Y,b3 as z,D,cZ as O,c_ as V,c$ as T,d0 as _,d1 as A,aY as L,d2 as P,d3 as R}from"./main-DCIX61zy.js";import{$ as Z}from"./utils-BszyTz9P.js";import{m as E,B}from"./utils-DN5yax8A.js";let u=null;const U=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;function j(n,e,o){return n.x<0?n.x+=e:n.x>o&&(n.x-=e),n}function H(n,e,o,s){const t=Y(o)?z(o):null,c=t?Math.round((t.valid[1]-t.valid[0])/e.scale[0]):null;return n.map(r=>{const i=new D(r.geometry);return O(e,i,i),r.geometry=t?j(i,c??0,s[0]):i,r})}function J(n,e=18,o,s,t){const c=new Float64Array(s*t);e=Math.round(P(e));let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const M=R(o);for(const{geometry:h,attributes:g}of n){const{x:I,y:m}=h,w=Math.max(0,I-e),$=Math.max(0,m-e),F=Math.min(t,m+e),b=Math.min(s,I+e),p=+M(g);for(let f=$;f<F;f++)for(let d=w;d<b;d++){const y=f*s+d,N=V(d-I,f-m,e)*p,l=c[y]+=N;r=Math.min(r,l),i=Math.max(i,l)}}return{min:r,max:i}}function C(n){const e=U.exec(n);if(!e)return null;const{hh:o,mm:s,ss:t,ms:c}=e.groups;return Number(o)*T.hours+Number(s)*T.minutes+Number(t)*T.seconds+Number(c||0)}async function K(n,e,o=!0){if(!e)return[];const{field:s,field2:t,field3:c,fieldDelimiter:r,fieldInfos:i,timeZone:M}=n,h=s&&i?.find(l=>l.name.toLowerCase()===s.toLowerCase()),g=!!h&&_(h),I=!!h&&Z(h),m=n.valueExpression,w=n.normalizationType,$=n.normalizationField,F=n.normalizationTotal,b=[],p=n.viewInfoParams;let f=null,d=null;if(m){if(!u){const{arcadeUtils:l}=await A();u=l}u.hasGeometryOperations(m)&&await u.enableGeometryOperations(),f=u.createFunction(m),d=p?u.getViewInfo({viewingMode:p.viewingMode,scale:p.scale,spatialReference:new L(p.spatialReference)}):null}const y=n.fieldInfos,N=!(e[0]&&"declaredClass"in e[0]&&e[0].declaredClass==="esri.Graphic")&&y?{fields:y}:null;return e.forEach(l=>{const x=l.attributes;let a;if(m){const v=N?{...l,layer:N}:l,G=u.createExecContext(v,d,M);a=u.executeFunction(f,G)}else x&&(a=x[s],t?(a=`${E(a)}${r}${E(x[t])}`,c&&(a=`${a}${r}${E(x[c])}`)):typeof a=="string"&&o&&(I?a=a?new Date(a).getTime():null:g&&(a=a?C(a):null)));if(w&&typeof a=="number"&&isFinite(a)){const v=x&&parseFloat(x[$]);a=B(a,w,v,F)}b.push(a)}),b}export{C as I,K as b,J as w,H as x};
