{"version":3,"file":"geohashUtils-D-cE2_5U.js","sources":["../../node_modules/@arcgis/core/geohash/geohashUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport\"../core/has.js\";import{rad2deg as t}from\"../core/mathUtils.js\";import o from\"../geometry/Extent.js\";import r from\"../geometry/Polygon.js\";import n from\"../geometry/SpatialReference.js\";import{earth as e}from\"../geometry/support/Ellipsoid.js\";import{convertFromPolygon as s}from\"../layers/graphics/featureConversionUtils.js\";import i from\"../layers/graphics/OptimizedGeometry.js\";import{project as c}from\"../layers/graphics/data/projectionSupport.js\";const f=16,l=8,a=4,u=2,h=1,m=new Float64Array(2),p=new Float64Array(2),g=-90,y=90,d=-180,x=180,M=\"0123456789bcdefghjkmnpqrstuvwxyz\",j=64;function S(t,e,f,l){const a=[t.xmin,t.ymin,t.xmax,t.ymax],u=r.fromExtent(o.fromBounds(a,l)),h=c(u,l,n.WGS84,{densificationStep:e*j});if(!h)return null;const m=s(new i,h,!1,!1),p=m.coords.filter(((t,o)=>!(o%2))),g=m.coords.filter(((t,o)=>o%2)),y=Math.min(...p),d=Math.min(...g),x=Math.max(...p),M=Math.max(...g),S=A(y,d,f,n.WGS84),G=A(x,M,f,n.WGS84);return S&&G?{bounds:a,geohashBounds:{xLL:S[0],yLL:S[1],xTR:G[0],yTR:G[1]},level:f}:null}function A(o,r,s,i){if(i.isWebMercator){const n=t(o/e.radius),i=n-360*Math.floor((n+180)/360),c=[0,0];return Y(c,0,t(Math.PI/2-2*Math.atan(Math.exp(-r/e.radius))),i,s),c}const f=c({x:o,y:r},i,n.WGS84);if(!f)return null;const l=[0,0];return Y(l,0,f.y,f.x,s),l}function G(t){return t<=57?t-48:t<=104?t-88:t<=107?t-89:t<=110?t-90:t-91}function W(t){return M[t]}function b(t){return(t[0]+t[1])/2}function w(t,o,r){return t[0]=o,t[1]=r,t}function C(t,o){const r=b(t),n=o,e=!o;t[0]=e*t[0]+n*r,t[1]=e*r+n*t[1]}function L(t,o){const r=o>b(t);return C(t,r),r}function v(t,o){const r=w(m,g,y),n=w(p,d,x);for(let e=0;e<o.length;e++){const t=G(o.charCodeAt(e));e%2==0?(C(n,!!(f&t)),C(n,!!(a&t)),C(n,!!(h&t)),C(r,!!(l&t)),C(r,!!(u&t))):(C(r,!!(f&t)),C(r,!!(a&t)),C(r,!!(h&t)),C(n,!!(l&t)),C(n,!!(u&t)))}return t[0]=b(r),t[1]=b(n),t}function E(t,o){let r=0,n=0,e=30,s=30;for(let i=0;i<o.length;i++){const t=G(o.charCodeAt(i)),c=i%2==0;e-=c?3:2,s-=c?2:3,r|=F(t,c)<<e,n|=P(t,c)<<s}return{geohashX:r,geohashY:n}}function R(t,o){let r=-90,n=90,e=-180,s=180;for(let i=0;i<o;i++){const o=Math.ceil((i+1)/2),c=Math.floor((i+1)/2),f=1-i%2,l=30-(3*o+2*c),a=30-(2*o+3*c),u=3*f+2*(1-f),h=2*f+3*(1-f),m=3*f+7*(1-f)<<a,p=(7*f+3*(1-f)<<l&t.geohashX)>>l,g=(m&t.geohashY)>>a;for(let t=u-1;t>=0;t--){const o=(e+s)/2,r=p&1<<t?1:0;e=(1-r)*e+r*o,s=(1-r)*o+r*s}for(let t=h-1;t>=0;t--){const o=(r+n)/2,e=g&1<<t?1:0;r=(1-e)*r+e*o,n=(1-e)*o+e*n}}return[e,r,s,n]}function X(t,o,r,n){n%2&&(n+=1);let e=0,s=0,i=-90,c=90,f=-180,l=180;for(let a=0;a<n/2;a++){for(let t=0;t<5;t++){const o=(f+l)/2,n=r>o?1:0;e|=n<<29-(t+5*a),f=(1-n)*f+n*o,l=(1-n)*o+n*l}for(let t=0;t<5;t++){const r=(i+c)/2,n=o>r?1:0;s|=n<<29-(t+5*a),i=(1-n)*i+n*r,c=(1-n)*r+n*c}}t.geohashX=e,t.geohashY=s}function Y(t,o,r,n,e){e%2&&(e+=1);let s=0,i=0,c=-90,f=90,l=-180,a=180;for(let u=0;u<e/2;u++){for(let t=0;t<5;t++){const o=(l+a)/2,r=n>o?1:0;s|=r<<29-(t+5*u),l=(1-r)*l+r*o,a=(1-r)*o+r*a}for(let t=0;t<5;t++){const o=(c+f)/2,n=r>o?1:0;i|=n<<29-(t+5*u),c=(1-n)*c+n*o,f=(1-n)*o+n*f}}t[2*o]=s,t[2*o+1]=i}function z(t,o,r){let n=\"\";const e=w(m,-90,90),s=w(p,-180,180);for(let i=0;i<r;i++){let r=0;!(i%2)?(r|=L(s,o)<<4,r|=L(e,t)<<3,r|=L(s,o)<<2,r|=L(e,t)<<1,r|=L(s,o)<<0):(r|=L(e,t)<<4,r|=L(s,o)<<3,r|=L(e,t)<<2,r|=L(s,o)<<1,r|=L(e,t)<<0),n+=W(r)}return n}function B(t,o,r){return r?t&h|(o&h)<<1|(t&u)<<1|(o&u)<<2|(t&a)<<2:o&h|(t&h)<<1|(o&u)<<1|(t&u)<<2|(o&a)<<2}function F(t,o){return o?h&t|(a&t)>>1|(f&t)>>2:(u&t)>>1|(l&t)>>2}function P(t,o){return o?(u&t)>>1|(l&t)>>2:h&t|(a&t)>>1|(f&t)>>2}function T(t,o,r){const n=!((t.length-1)%2),e=t.substring(0,t.length-1),s=G(t.charCodeAt(t.length-1));let i=0,c=0,m=0,p=0;n?(i=8,c=4,m=h&s|(a&s)>>1|(f&s)>>2,p=(u&s)>>1|(l&s)>>2):(i=4,c=8,p=h&s|(a&s)>>1|(f&s)>>2,m=(u&s)>>1|(l&s)>>2);const g=m+o,y=p+r,d=Math.floor(g/i),x=Math.floor(y/c),M=W(B(g-d*i,y-x*c,n));return t.length>1&&(d||x)?T(e,d,x)+M:e+M}export{E as convertGeohash32ToXY,G as decodeBase32Char,v as decodeGeohash,R as decodeGeohashXY,W as encodeBase32Char,z as encodeGeohash,A as getGeohash,S as getGeohashBounds,T as getRelativeGeohash,Y as setGeohashBuf,X as setGeohashXY,F as unpackXBits,P as unpackYBits};\n"],"names":["m","p","M","j","S","t","e","f","l","a","u","r","o","h","c","n","s","i","g","d","x","A","G","Y","W","b","w","L","R","z"],"mappings":"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","x_google_ignoreList":[0]}