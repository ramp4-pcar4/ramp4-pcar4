{"version":3,"file":"rasterUtils-yY6UQhy7.js","sources":["../../node_modules/@arcgis/core/views/webgl/rasterUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{ZEROS as e}from\"../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{PixelType as t,SizedPixelFormat as n,PixelFormat as r,TextureSamplingMode as a,TextureWrapMode as i,UniformType as o}from\"./enums.js\";import{Texture as s}from\"./Texture.js\";import{TextureDescriptor as u}from\"./TextureDescriptor.js\";function f(e,o,f=\"nearest\",c=!1){const m=!(c&&\"u8\"===o.pixelType),l=m?t.FLOAT:t.UNSIGNED_BYTE,_=null==o.pixels||0===o.pixels.length?null:m?o.getAsRGBAFloat():o.getAsRGBA(),g=e.capabilities.textureFloat?.textureFloatLinear,p=new u;return p.width=o.width,p.height=o.height,p.internalFormat=m?n.RGBA32F:r.RGBA,p.samplingMode=!g||\"bilinear\"!==f&&\"cubic\"!==f?a.NEAREST:a.LINEAR,p.dataType=l,p.wrapMode=i.CLAMP_TO_EDGE,new s(e,p,_)}function c(e,r){const{spacing:o,offsets:f,coefficients:c,size:[m,l]}=r,_=o[0]>1,g=new u;g.width=_?4*m:m,g.height=l,g.internalFormat=n.RGBA32F,g.dataType=t.FLOAT,g.samplingMode=a.NEAREST,g.wrapMode=i.CLAMP_TO_EDGE;const p=new Float32Array(_?m*l*16:2*f.length);if(_&&null!=c)for(let t=0,n=0;t<c.length;t++)p[n++]=c[t],t%3==2&&(p[n++]=1);else for(let t=0;t<l;t++)for(let e=0;e<m;e++){const n=4*(t*m+e),r=2*(e*l+t);p[n]=f[r],p[n+1]=f[r+1],p[n+3]=-1===f[r]?0:1}return new s(e,g,p)}function m(e,t){const n=new u;return n.internalFormat=r.RGBA,n.width=t.length/4,n.height=1,n.samplingMode=a.NEAREST,n.wrapMode=i.CLAMP_TO_EDGE,new s(e,n,t)}function l(t,n,r,a=1,i=!0){return{u_flipY:i,u_applyTransform:!!t,u_opacity:a,u_transformSpacing:t?t.spacing:e,u_transformGridSize:t?t.size:e,u_targetImageSize:n,u_srcImageSize:r}}function _(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function g(e,t){return{u_scale:e,u_offset:t}}function p(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function A(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function T(e,t){const n=e.gl,r=t.glName,a=new Map;if(null==r)return a;const i=n.getProgramParameter(r,n.ACTIVE_UNIFORMS);let o;for(let s=0;s<i;s++)o=n.getActiveUniform(r,s),o&&a.set(o.name,{location:n.getUniformLocation(r,o.name),info:o});return a}function h(e,t,n){Object.keys(n).forEach((r=>{const a=t.get(r)||t.get(r+\"[0]\");a&&E(e,r,n[r],a)}))}function O(e,t,n,r){n.length===r.length&&(r.some((e=>null==e))||n.some((e=>null==e))||n.forEach(((n,a)=>{t.setUniform1i(n,a),e.bindTexture(r[a],a)})))}function E(e,t,n,r){if(null===r||null==n)return!1;const{info:a}=r;switch(a.type){case o.FLOAT:a.size>1?e.setUniform1fv(t,n):e.setUniform1f(t,n);break;case o.FLOAT_VEC2:e.setUniform2fv(t,n);break;case o.FLOAT_VEC3:e.setUniform3fv(t,n);break;case o.FLOAT_VEC4:e.setUniform4fv(t,n);break;case o.FLOAT_MAT3:e.setUniformMatrix3fv(t,n);break;case o.FLOAT_MAT4:e.setUniformMatrix4fv(t,n);break;case o.INT:a.size>1?e.setUniform1iv(t,n):e.setUniform1i(t,n);break;case o.BOOL:e.setUniform1i(t,n?1:0);break;case o.INT_VEC2:case o.BOOL_VEC2:e.setUniform2iv(t,n);break;case o.INT_VEC3:case o.BOOL_VEC3:e.setUniform3iv(t,n);break;case o.INT_VEC4:case o.BOOL_VEC4:e.setUniform4iv(t,n);break;default:return!1}return!0}export{m as createColormapTexture,f as createRasterTexture,c as createTransformTexture,g as getBasicGridUniforms,_ as getColormapUniforms,l as getCommonUniforms,A as getShadedReliefUniforms,p as getStretchUniforms,T as getUniformLocationInfos,O as setTextures,h as setUniforms};\n"],"names":["f","e","o","c","m","l","t","_","g","p","u","n","r","a","i","s","A","T","h","E","O"],"mappings":"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","x_google_ignoreList":[0]}